{'sphere_lamr_small': {'weight': 0.5, 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 9, 0), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([-1.42215872e+03, -3.75500869e+02, -6.98401558e+03, -6.11725664e+00,
       -4.00335027e+00,  1.46370517e+00]), 'covar': array([[1.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 1.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 1.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 1.e-06, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 0.e+00, 1.e-06, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00, 1.e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}}, 'cubesat_nadir': {'weight': 0.5, 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 9, 0), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([-1.42215872e+03, -3.75500869e+02, -6.98401558e+03, -6.11725664e+00,
       -4.00335027e+00,  1.46370517e+00,  1.03556064e-01, -2.98808893e-03,
        9.54048626e-01, -2.81173314e-01, -2.54109884e-20, -1.04426738e-03,
       -1.35525272e-20]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[1.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 1.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 1.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 1.e-06, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 0.e+00, 1.e-06, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00, 1.e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}}}
Current time:  2018-07-12 20:18:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 9, 0), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([-1.42215872e+03, -3.75500869e+02, -6.98401558e+03, -6.11725664e+00,
       -4.00335027e+00,  1.46370517e+00,  1.03556064e-01, -2.98808893e-03,
        9.54048626e-01, -2.81173314e-01, -2.54109884e-20, -1.04426738e-03,
       -1.35525272e-20]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[1.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 1.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 1.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 1.e-06, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 0.e+00, 1.e-06, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00, 1.e-06]])}
[[-1.42215872e+03]
 [-3.75500869e+02]
 [-6.98401558e+03]
 [-6.11725664e+00]
 [-4.00335027e+00]
 [ 1.46370517e+00]
 [ 1.03556064e-01]
 [-2.98808893e-03]
 [ 9.54048626e-01]
 [-2.81173314e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.35525272e-20]]
2018-07-12 09:00:00
delta_t 40710.0


 Predictor Step
2018-07-12 20:18:30
[[ 4.89635557e+03]
 [ 3.38754857e+03]
 [-3.91839320e+03]
 [-3.67963282e+00]
 [-1.85254301e+00]
 [-6.22836071e+00]
 [ 5.63018481e-01]
 [ 1.90785625e-01]
 [-7.77137587e-01]
 [ 2.06562840e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.77772625e-19]]
[[ 8.05860755e+03  4.08179162e+03  1.33304976e+04  1.15060367e+01
   7.95493277e+00 -9.17487478e+00]
 [ 4.08179162e+03  2.06875896e+03  6.75051761e+03  5.82668389e+00
   4.02850844e+00 -4.64754728e+00]
 [ 1.33304976e+04  6.75051761e+03  2.20848737e+04  1.90605541e+01
   1.31765470e+01 -1.51807311e+01]
 [ 1.15060367e+01  5.82668389e+00  1.90605541e+01  1.64519878e-02
   1.13723552e-02 -1.31008499e-02]
 [ 7.95493277e+00  4.02850844e+00  1.31765470e+01  1.13723552e-02
   7.86286812e-03 -9.05787840e-03]
 [-9.17487478e+00 -4.64754728e+00 -1.51807311e+01 -1.31008499e-02
  -9.05787840e-03  1.04521460e-02]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 9, 0), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([-1.42215872e+03, -3.75500869e+02, -6.98401558e+03, -6.11725664e+00,
       -4.00335027e+00,  1.46370517e+00]), 'covar': array([[1.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 1.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 1.e+00, 0.e+00, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 1.e-06, 0.e+00, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 0.e+00, 1.e-06, 0.e+00],
       [0.e+00, 0.e+00, 0.e+00, 0.e+00, 0.e+00, 1.e-06]])}
[[-1.42215872e+03]
 [-3.75500869e+02]
 [-6.98401558e+03]
 [-6.11725664e+00]
 [-4.00335027e+00]
 [ 1.46370517e+00]]
2018-07-12 09:00:00
delta_t 40710.0


 Predictor Step
2018-07-12 20:18:30
[[ 4.89687485e+03]
 [ 3.38781383e+03]
 [-3.91761130e+03]
 [-3.67891348e+00]
 [-1.85204993e+00]
 [-6.22889294e+00]]
[[ 8.05092260e+03  4.07760227e+03  1.33218879e+04  1.14983923e+01
   7.94944527e+00 -9.16604871e+00]
 [ 4.07760227e+03  2.06648793e+03  6.74567175e+03  5.82238746e+00
   4.02543686e+00 -4.64275493e+00]
 [ 1.33218879e+04  6.74567175e+03  2.20770388e+04  1.90535095e+01
   1.31713415e+01 -1.51706135e+01]
 [ 1.14983923e+01  5.82238746e+00  1.90535095e+01  1.64456671e-02
   1.13676914e-02 -1.30918639e-02]
 [ 7.94944527e+00  4.02543686e+00  1.31713415e+01  1.13676914e-02
   7.85944184e-03 -9.05144847e-03]
 [-9.16604871e+00 -4.64275493e+00 -1.51706135e+01 -1.30918639e-02
  -9.05144847e-03  1.04420440e-02]]
predictor
{'sphere_lamr_small': {'weight': 0.5, 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 9, 0), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.89687485e+03],
       [ 3.38781383e+03],
       [-3.91761130e+03],
       [-3.67891348e+00],
       [-1.85204993e+00],
       [-6.22889294e+00]]), 'covar': array([[ 8.05092260e+03,  4.07760227e+03,  1.33218879e+04,
         1.14983923e+01,  7.94944527e+00, -9.16604871e+00],
       [ 4.07760227e+03,  2.06648793e+03,  6.74567175e+03,
         5.82238746e+00,  4.02543686e+00, -4.64275493e+00],
       [ 1.33218879e+04,  6.74567175e+03,  2.20770388e+04,
         1.90535095e+01,  1.31713415e+01, -1.51706135e+01],
       [ 1.14983923e+01,  5.82238746e+00,  1.90535095e+01,
         1.64456671e-02,  1.13676914e-02, -1.30918639e-02],
       [ 7.94944527e+00,  4.02543686e+00,  1.31713415e+01,
         1.13676914e-02,  7.85944184e-03, -9.05144847e-03],
       [-9.16604871e+00, -4.64275493e+00, -1.51706135e+01,
        -1.30918639e-02, -9.05144847e-03,  1.04420440e-02]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}}, 'cubesat_nadir': {'weight': 0.5, 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 9, 0), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.89635557e+03],
       [ 3.38754857e+03],
       [-3.91839320e+03],
       [-3.67963282e+00],
       [-1.85254301e+00],
       [-6.22836071e+00],
       [ 5.63018481e-01],
       [ 1.90785625e-01],
       [-7.77137587e-01],
       [ 2.06562840e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.77772625e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.05860755e+03,  4.08179162e+03,  1.33304976e+04,
         1.15060367e+01,  7.95493277e+00, -9.17487478e+00],
       [ 4.08179162e+03,  2.06875896e+03,  6.75051761e+03,
         5.82668389e+00,  4.02850844e+00, -4.64754728e+00],
       [ 1.33304976e+04,  6.75051761e+03,  2.20848737e+04,
         1.90605541e+01,  1.31765470e+01, -1.51807311e+01],
       [ 1.15060367e+01,  5.82668389e+00,  1.90605541e+01,
         1.64519878e-02,  1.13723552e-02, -1.31008499e-02],
       [ 7.95493277e+00,  4.02850844e+00,  1.31765470e+01,
         1.13723552e-02,  7.86286812e-03, -9.05787840e-03],
       [-9.17487478e+00, -4.64754728e+00, -1.51807311e+01,
        -1.31008499e-02, -9.05787840e-03,  1.04521460e-02]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}}}
Yi [[ 1.44927721]
 [-0.19045187]
 [18.85529348]]
posterior
[[ 4.89635557e+03]
 [ 3.38754857e+03]
 [-3.91839320e+03]
 [-3.67963282e+00]
 [-1.85254301e+00]
 [-6.22836071e+00]
 [ 5.63018481e-01]
 [ 1.90785625e-01]
 [-7.77137587e-01]
 [ 2.06562840e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.77772625e-19]]
[[ 4.89909421e+03]
 [ 3.38898588e+03]
 [-3.91549154e+03]
 [-3.67704564e+00]
 [-1.85068975e+00]
 [-6.23128816e+00]
 [ 5.63018481e-01]
 [ 1.90785625e-01]
 [-7.77137587e-01]
 [ 2.06562840e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.77772625e-19]]
[[ 2.33105453e-02  1.70142502e-01 -3.21970765e-02 -2.57308446e-05
  -8.60824428e-06 -8.60334553e-05]
 [ 1.70142502e-01  1.41181202e+00 -2.77809303e-01 -2.24236576e-04
  -7.94341958e-05 -6.96135007e-04]
 [-3.21970765e-02 -2.77809303e-01  5.65792254e-02  4.57928249e-05
   1.67658464e-05  1.35831187e-04]
 [-2.57308446e-05 -2.24236576e-04  4.57928249e-05  1.55158010e-06
   1.00766595e-07  2.10703454e-06]
 [-8.60824428e-06 -7.94341958e-05  1.67658464e-05  1.00766595e-07
   1.12921689e-06  9.52257964e-07]
 [-8.60334553e-05 -6.96135007e-04  1.35831187e-04  2.10703454e-06
   9.52257964e-07  6.08867023e-06]]
[[ 1.45422709]
 [-0.19500368]
 [27.1349194 ]]
[[-4.94988335e-03]
 [ 4.55181503e-03]
 [-8.27962592e+00]]


 Corrector Step
2018-07-12 20:18:30
[[ 4.89909421e+03]
 [ 3.38898588e+03]
 [-3.91549154e+03]
 [-3.67704564e+00]
 [-1.85068975e+00]
 [-6.23128816e+00]
 [ 5.63018481e-01]
 [ 1.90785625e-01]
 [-7.77137587e-01]
 [ 2.06562840e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.77772625e-19]]
[[ 2.33105453e-02  1.70142502e-01 -3.21970765e-02 -2.57308446e-05
  -8.60824428e-06 -8.60334553e-05]
 [ 1.70142502e-01  1.41181202e+00 -2.77809303e-01 -2.24236576e-04
  -7.94341958e-05 -6.96135007e-04]
 [-3.21970765e-02 -2.77809303e-01  5.65792254e-02  4.57928249e-05
   1.67658464e-05  1.35831187e-04]
 [-2.57308446e-05 -2.24236576e-04  4.57928249e-05  1.55158010e-06
   1.00766595e-07  2.10703454e-06]
 [-8.60824428e-06 -7.94341958e-05  1.67658464e-05  1.00766595e-07
   1.12921689e-06  9.52257964e-07]
 [-8.60334553e-05 -6.96135007e-04  1.35831187e-04  2.10703454e-06
   9.52257964e-07  6.08867023e-06]]
13.404910300896193
post
cubesat_nadir
Ybar_post [[ 1.44924297]
 [-0.19042747]
 [18.75282922]]
resids [[ 3.42413805e-05]
 [-2.43921269e-05]
 [ 1.02464260e-01]]
posterior
[[ 4.89687485e+03]
 [ 3.38781383e+03]
 [-3.91761130e+03]
 [-3.67891348e+00]
 [-1.85204993e+00]
 [-6.22889294e+00]]
[[ 4.88431504e+03]
 [ 3.38195746e+03]
 [-3.92400101e+03]
 [-3.68514900e+00]
 [-1.85689829e+00]
 [-6.21663572e+00]]
[[ 7.97459491e+00  4.47413489e+00  4.39957259e+00  4.22840922e-03
   3.28262494e-03 -8.15889798e-03]
 [ 4.47413489e+00  3.74228358e+00  2.12138850e+00  2.07478917e-03
   1.70059554e-03 -5.07672944e-03]
 [ 4.39957259e+00  2.12138850e+00  2.52646445e+00  2.41783185e-03
   1.85155044e-03 -4.36085751e-03]
 [ 4.22840922e-03  2.07478917e-03  2.41783185e-03  3.83855737e-06
   1.86628859e-06 -2.18414312e-06]
 [ 3.28262494e-03  1.70059554e-03  1.85155044e-03  1.86628859e-06
   2.49349077e-06 -2.37734813e-06]
 [-8.15889798e-03 -5.07672944e-03 -4.36085751e-03 -2.18414312e-06
  -2.37734813e-06  1.43563784e-05]]
[[ 1.45383853]
 [-0.194367  ]
 [14.62806296]]
[[-4.56132067e-03]
 [ 3.91512939e-03]
 [ 4.22723052e+00]]


 Corrector Step
2018-07-12 20:18:30
[[ 4.88431504e+03]
 [ 3.38195746e+03]
 [-3.92400101e+03]
 [-3.68514900e+00]
 [-1.85689829e+00]
 [-6.21663572e+00]]
[[ 7.97459491e+00  4.47413489e+00  4.39957259e+00  4.22840922e-03
   3.28262494e-03 -8.15889798e-03]
 [ 4.47413489e+00  3.74228358e+00  2.12138850e+00  2.07478917e-03
   1.70059554e-03 -5.07672944e-03]
 [ 4.39957259e+00  2.12138850e+00  2.52646445e+00  2.41783185e-03
   1.85155044e-03 -4.36085751e-03]
 [ 4.22840922e-03  2.07478917e-03  2.41783185e-03  3.83855737e-06
   1.86628859e-06 -2.18414312e-06]
 [ 3.28262494e-03  1.70059554e-03  1.85155044e-03  1.86628859e-06
   2.49349077e-06 -2.37734813e-06]
 [-8.15889798e-03 -5.07672944e-03 -4.36085751e-03 -2.18414312e-06
  -2.37734813e-06  1.43563784e-05]]
0.0
post
sphere_lamr_small
Ybar_post [[ 1.46029899]
 [-0.19827259]
 [14.63652498]]
resids [[-0.01102179]
 [ 0.00782072]
 [ 4.2187685 ]]
Update Weights
wbar [0.5, 0.5]
beta_list [13.404910300896193, 0.0]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.89909421e+03],
       [ 3.38898588e+03],
       [-3.91549154e+03],
       [-3.67704564e+00],
       [-1.85068975e+00],
       [-6.23128816e+00]]), 'est_covars': array([[ 2.33105453e-02,  1.70142502e-01, -3.21970765e-02,
        -2.57308446e-05, -8.60824428e-06, -8.60334553e-05],
       [ 1.70142502e-01,  1.41181202e+00, -2.77809303e-01,
        -2.24236576e-04, -7.94341958e-05, -6.96135007e-04],
       [-3.21970765e-02, -2.77809303e-01,  5.65792254e-02,
         4.57928249e-05,  1.67658464e-05,  1.35831187e-04],
       [-2.57308446e-05, -2.24236576e-04,  4.57928249e-05,
         1.55158010e-06,  1.00766595e-07,  2.10703454e-06],
       [-8.60824428e-06, -7.94341958e-05,  1.67658464e-05,
         1.00766595e-07,  1.12921689e-06,  9.52257964e-07],
       [-8.60334553e-05, -6.96135007e-04,  1.35831187e-04,
         2.10703454e-06,  9.52257964e-07,  6.08867023e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 18, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.88431504e+03],
       [ 3.38195746e+03],
       [-3.92400101e+03],
       [-3.68514900e+00],
       [-1.85689829e+00],
       [-6.21663572e+00]]), 'covar': array([[ 7.97459491e+00,  4.47413489e+00,  4.39957259e+00,
         4.22840922e-03,  3.28262494e-03, -8.15889798e-03],
       [ 4.47413489e+00,  3.74228358e+00,  2.12138850e+00,
         2.07478917e-03,  1.70059554e-03, -5.07672944e-03],
       [ 4.39957259e+00,  2.12138850e+00,  2.52646445e+00,
         2.41783185e-03,  1.85155044e-03, -4.36085751e-03],
       [ 4.22840922e-03,  2.07478917e-03,  2.41783185e-03,
         3.83855737e-06,  1.86628859e-06, -2.18414312e-06],
       [ 3.28262494e-03,  1.70059554e-03,  1.85155044e-03,
         1.86628859e-06,  2.49349077e-06, -2.37734813e-06],
       [-8.15889798e-03, -5.07672944e-03, -4.36085751e-03,
        -2.18414312e-06, -2.37734813e-06,  1.43563784e-05]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-0.01102179],
       [ 0.00782072],
       [ 4.2187685 ]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 18, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.89909421e+03],
       [ 3.38898588e+03],
       [-3.91549154e+03],
       [-3.67704564e+00],
       [-1.85068975e+00],
       [-6.23128816e+00],
       [ 5.63018481e-01],
       [ 1.90785625e-01],
       [-7.77137587e-01],
       [ 2.06562840e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.77772625e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.33105453e-02,  1.70142502e-01, -3.21970765e-02,
        -2.57308446e-05, -8.60824428e-06, -8.60334553e-05],
       [ 1.70142502e-01,  1.41181202e+00, -2.77809303e-01,
        -2.24236576e-04, -7.94341958e-05, -6.96135007e-04],
       [-3.21970765e-02, -2.77809303e-01,  5.65792254e-02,
         4.57928249e-05,  1.67658464e-05,  1.35831187e-04],
       [-2.57308446e-05, -2.24236576e-04,  4.57928249e-05,
         1.55158010e-06,  1.00766595e-07,  2.10703454e-06],
       [-8.60824428e-06, -7.94341958e-05,  1.67658464e-05,
         1.00766595e-07,  1.12921689e-06,  9.52257964e-07],
       [-8.60334553e-05, -6.96135007e-04,  1.35831187e-04,
         2.10703454e-06,  9.52257964e-07,  6.08867023e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 3.42413805e-05],
       [-2.43921269e-05],
       [ 1.02464260e-01]])}}
Current time:  2018-07-12 20:18:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 18, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.89909421e+03],
       [ 3.38898588e+03],
       [-3.91549154e+03],
       [-3.67704564e+00],
       [-1.85068975e+00],
       [-6.23128816e+00],
       [ 5.63018481e-01],
       [ 1.90785625e-01],
       [-7.77137587e-01],
       [ 2.06562840e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.77772625e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.33105453e-02,  1.70142502e-01, -3.21970765e-02,
        -2.57308446e-05, -8.60824428e-06, -8.60334553e-05],
       [ 1.70142502e-01,  1.41181202e+00, -2.77809303e-01,
        -2.24236576e-04, -7.94341958e-05, -6.96135007e-04],
       [-3.21970765e-02, -2.77809303e-01,  5.65792254e-02,
         4.57928249e-05,  1.67658464e-05,  1.35831187e-04],
       [-2.57308446e-05, -2.24236576e-04,  4.57928249e-05,
         1.55158010e-06,  1.00766595e-07,  2.10703454e-06],
       [-8.60824428e-06, -7.94341958e-05,  1.67658464e-05,
         1.00766595e-07,  1.12921689e-06,  9.52257964e-07],
       [-8.60334553e-05, -6.96135007e-04,  1.35831187e-04,
         2.10703454e-06,  9.52257964e-07,  6.08867023e-06]])}
[[ 4.89909421e+03]
 [ 3.38898588e+03]
 [-3.91549154e+03]
 [-3.67704564e+00]
 [-1.85068975e+00]
 [-6.23128816e+00]
 [ 5.63018481e-01]
 [ 1.90785625e-01]
 [-7.77137587e-01]
 [ 2.06562840e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.77772625e-19]]
2018-07-12 20:18:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:18:40
[[ 4.86205504e+03]
 [ 3.37029289e+03]
 [-3.97758732e+03]
 [-3.73070892e+00]
 [-1.88784991e+00]
 [-6.18778173e+00]
 [ 5.58953128e-01]
 [ 1.89704495e-01]
 [-7.80066689e-01]
 [ 2.07556175e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.77984912e-19]]
[[ 2.29743607e-02  1.67920624e-01 -3.24170238e-02 -7.88142811e-06
  -7.68529702e-06 -6.67310407e-05]
 [ 1.67920624e-01  1.41032844e+00 -2.84577491e-01 -2.03878407e-04
  -6.89168845e-05 -7.00735915e-04]
 [-3.24170238e-02 -2.84577491e-01  5.99332883e-02  6.29470832e-05
   2.64540544e-05  1.99634010e-04]
 [-7.88142811e-06 -2.03878407e-04  6.29470832e-05  1.55549096e-06
   9.97835566e-08  2.09915147e-06]
 [-7.68529702e-06 -6.89168845e-05  2.64540544e-05  9.97835566e-08
   1.13920077e-06  9.53224072e-07]
 [-6.67310407e-05 -7.00735915e-04  1.99634010e-04  2.09915147e-06
   9.53224072e-07  6.11242890e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 18, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.88431504e+03],
       [ 3.38195746e+03],
       [-3.92400101e+03],
       [-3.68514900e+00],
       [-1.85689829e+00],
       [-6.21663572e+00]]), 'covar': array([[ 7.97459491e+00,  4.47413489e+00,  4.39957259e+00,
         4.22840922e-03,  3.28262494e-03, -8.15889798e-03],
       [ 4.47413489e+00,  3.74228358e+00,  2.12138850e+00,
         2.07478917e-03,  1.70059554e-03, -5.07672944e-03],
       [ 4.39957259e+00,  2.12138850e+00,  2.52646445e+00,
         2.41783185e-03,  1.85155044e-03, -4.36085751e-03],
       [ 4.22840922e-03,  2.07478917e-03,  2.41783185e-03,
         3.83855737e-06,  1.86628859e-06, -2.18414312e-06],
       [ 3.28262494e-03,  1.70059554e-03,  1.85155044e-03,
         1.86628859e-06,  2.49349077e-06, -2.37734813e-06],
       [-8.15889798e-03, -5.07672944e-03, -4.36085751e-03,
        -2.18414312e-06, -2.37734813e-06,  1.43563784e-05]])}
[[ 4.88431504e+03]
 [ 3.38195746e+03]
 [-3.92400101e+03]
 [-3.68514900e+00]
 [-1.85689829e+00]
 [-6.21663572e+00]]
2018-07-12 20:18:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:18:40
[[ 4.84719469e+03]
 [ 3.36320217e+03]
 [-3.98594903e+03]
 [-3.73884723e+00]
 [-1.89411802e+00]
 [-6.17287460e+00]]
[[ 8.05983332e+00  4.52822175e+00  4.34127544e+00  4.29525341e-03
   3.33272226e-03 -8.32502334e-03]
 [ 4.52822175e+00  3.77670795e+00  2.08852880e+00  2.12707985e-03
   1.74181871e-03 -5.19213953e-03]
 [ 4.34127544e+00  2.08852880e+00  2.43993704e+00  2.40589962e-03
   1.84477929e-03 -4.29116617e-03]
 [ 4.29525341e-03  2.12707985e-03  2.40589962e-03  3.86031896e-06
   1.89288424e-06 -2.29473723e-06]
 [ 3.33272226e-03  1.74181871e-03  1.84477929e-03  1.89288424e-06
   2.51961433e-06 -2.46729399e-06]
 [-8.32502334e-03 -5.19213953e-03 -4.29116617e-03 -2.29473723e-06
  -2.46729399e-06  1.46605972e-05]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 18, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.84719469e+03],
       [ 3.36320217e+03],
       [-3.98594903e+03],
       [-3.73884723e+00],
       [-1.89411802e+00],
       [-6.17287460e+00]]), 'covar': array([[ 8.05983332e+00,  4.52822175e+00,  4.34127544e+00,
         4.29525341e-03,  3.33272226e-03, -8.32502334e-03],
       [ 4.52822175e+00,  3.77670795e+00,  2.08852880e+00,
         2.12707985e-03,  1.74181871e-03, -5.19213953e-03],
       [ 4.34127544e+00,  2.08852880e+00,  2.43993704e+00,
         2.40589962e-03,  1.84477929e-03, -4.29116617e-03],
       [ 4.29525341e-03,  2.12707985e-03,  2.40589962e-03,
         3.86031896e-06,  1.89288424e-06, -2.29473723e-06],
       [ 3.33272226e-03,  1.74181871e-03,  1.84477929e-03,
         1.89288424e-06,  2.51961433e-06, -2.46729399e-06],
       [-8.32502334e-03, -5.19213953e-03, -4.29116617e-03,
        -2.29473723e-06, -2.46729399e-06,  1.46605972e-05]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-0.01102179],
       [ 0.00782072],
       [ 4.2187685 ]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 18, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.86205504e+03],
       [ 3.37029289e+03],
       [-3.97758732e+03],
       [-3.73070892e+00],
       [-1.88784991e+00],
       [-6.18778173e+00],
       [ 5.58953128e-01],
       [ 1.89704495e-01],
       [-7.80066689e-01],
       [ 2.07556175e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.77984912e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.29743607e-02,  1.67920624e-01, -3.24170238e-02,
        -7.88142811e-06, -7.68529702e-06, -6.67310407e-05],
       [ 1.67920624e-01,  1.41032844e+00, -2.84577491e-01,
        -2.03878407e-04, -6.89168845e-05, -7.00735915e-04],
       [-3.24170238e-02, -2.84577491e-01,  5.99332883e-02,
         6.29470832e-05,  2.64540544e-05,  1.99634010e-04],
       [-7.88142811e-06, -2.03878407e-04,  6.29470832e-05,
         1.55549096e-06,  9.97835566e-08,  2.09915147e-06],
       [-7.68529702e-06, -6.89168845e-05,  2.64540544e-05,
         9.97835566e-08,  1.13920077e-06,  9.53224072e-07],
       [-6.67310407e-05, -7.00735915e-04,  1.99634010e-04,
         2.09915147e-06,  9.53224072e-07,  6.11242890e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 3.42413805e-05],
       [-2.43921269e-05],
       [ 1.02464260e-01]])}}
Yi [[ 1.4756305 ]
 [-0.24232522]
 [17.21827851]]
posterior
[[ 4.86205504e+03]
 [ 3.37029289e+03]
 [-3.97758732e+03]
 [-3.73070892e+00]
 [-1.88784991e+00]
 [-6.18778173e+00]
 [ 5.58953128e-01]
 [ 1.89704495e-01]
 [-7.80066689e-01]
 [ 2.07556175e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.77984912e-19]]
[[ 4.86206627e+03]
 [ 3.37035699e+03]
 [-3.97759859e+03]
 [-3.73069923e+00]
 [-1.88785313e+00]
 [-6.18779638e+00]
 [ 5.58953128e-01]
 [ 1.89704495e-01]
 [-7.80066689e-01]
 [ 2.07556175e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.77984912e-19]]
[[ 7.63182877e-03  7.24249415e-02 -1.69581735e-02 -3.01798833e-05
  -1.64625147e-05 -9.34292081e-05]
 [ 7.24249415e-02  7.51201025e-01 -1.76982206e-01 -3.32995113e-04
  -1.56666160e-04 -9.44683011e-04]
 [-1.69581735e-02 -1.76982206e-01  4.23575473e-02  8.37083470e-05
   4.11114589e-05  2.40177188e-04]
 [-3.01798833e-05 -3.32995113e-04  8.37083470e-05  1.52158874e-06
   9.19325972e-08  2.07179438e-06]
 [-1.64625147e-05 -1.56666160e-04  4.11114589e-05  9.19325972e-08
   1.11719903e-06  8.98008153e-07]
 [-9.34292081e-05 -9.44683011e-04  2.40177188e-04  2.07179438e-06
   8.98008153e-07  5.97190112e-06]]
[[ 1.47563547]
 [-0.24232869]
 [17.11047721]]
[[-4.97144730e-06]
 [ 3.46664210e-06]
 [ 1.07801298e-01]]


 Corrector Step
2018-07-12 20:18:40
[[ 4.86206627e+03]
 [ 3.37035699e+03]
 [-3.97759859e+03]
 [-3.73069923e+00]
 [-1.88785313e+00]
 [-6.18779638e+00]
 [ 5.58953128e-01]
 [ 1.89704495e-01]
 [-7.80066689e-01]
 [ 2.07556175e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.77984912e-19]]
[[ 7.63182877e-03  7.24249415e-02 -1.69581735e-02 -3.01798833e-05
  -1.64625147e-05 -9.34292081e-05]
 [ 7.24249415e-02  7.51201025e-01 -1.76982206e-01 -3.32995113e-04
  -1.56666160e-04 -9.44683011e-04]
 [-1.69581735e-02 -1.76982206e-01  4.23575473e-02  8.37083470e-05
   4.11114589e-05  2.40177188e-04]
 [-3.01798833e-05 -3.32995113e-04  8.37083470e-05  1.52158874e-06
   9.19325972e-08  2.07179438e-06]
 [-1.64625147e-05 -1.56666160e-04  4.11114589e-05  9.19325972e-08
   1.11719903e-06  8.98008153e-07]
 [-9.34292081e-05 -9.44683011e-04  2.40177188e-04  2.07179438e-06
   8.98008153e-07  5.97190112e-06]]
123209658.68486966
post
cubesat_nadir
Ybar_post [[ 1.47563132]
 [-0.24232501]
 [17.11070103]]
resids [[-8.26834517e-07]
 [-2.14415831e-07]
 [ 1.07577478e-01]]
posterior
[[ 4.84719469e+03]
 [ 3.36320217e+03]
 [-3.98594903e+03]
 [-3.73884723e+00]
 [-1.89411802e+00]
 [-6.17287460e+00]]
[[ 4.86209873e+03]
 [ 3.37189211e+03]
 [-3.97801618e+03]
 [-3.73100625e+00]
 [-1.88802098e+00]
 [-6.18852079e+00]]
[[ 6.76372407e-03  7.65634195e-02 -1.87619429e-02 -2.30897658e-05
  -1.61011094e-05 -7.89036048e-05]
 [ 7.65634195e-02  9.77389151e-01 -2.41711049e-01 -2.74762548e-04
  -1.79948736e-04 -8.87313646e-04]
 [-1.87619429e-02 -2.41711049e-01  6.04720849e-02  7.13580150e-05
   4.83423375e-05  2.33246462e-04]
 [-2.30897658e-05 -2.74762548e-04  7.13580150e-05  1.54399023e-06
   9.40140061e-08  2.11594109e-06]
 [-1.61011094e-05 -1.79948736e-04  4.83423375e-05  9.40140061e-08
   1.11225944e-06  9.08751333e-07]
 [-7.89036048e-05 -8.87313646e-04  2.33246462e-04  2.11594109e-06
   9.08751333e-07  6.02615173e-06]]
[[ 1.48717189]
 [-0.25034661]
 [14.51581621]]
[[-0.01154139]
 [ 0.00802139]
 [ 2.7024623 ]]


 Corrector Step
2018-07-12 20:18:40
[[ 4.86209873e+03]
 [ 3.37189211e+03]
 [-3.97801618e+03]
 [-3.73100625e+00]
 [-1.88802098e+00]
 [-6.18852079e+00]]
[[ 6.76372407e-03  7.65634195e-02 -1.87619429e-02 -2.30897658e-05
  -1.61011094e-05 -7.89036048e-05]
 [ 7.65634195e-02  9.77389151e-01 -2.41711049e-01 -2.74762548e-04
  -1.79948736e-04 -8.87313646e-04]
 [-1.87619429e-02 -2.41711049e-01  6.04720849e-02  7.13580150e-05
   4.83423375e-05  2.33246462e-04]
 [-2.30897658e-05 -2.74762548e-04  7.13580150e-05  1.54399023e-06
   9.40140061e-08  2.11594109e-06]
 [-1.61011094e-05 -1.79948736e-04  4.83423375e-05  9.40140061e-08
   1.11225944e-06  9.08751333e-07]
 [-7.89036048e-05 -8.87313646e-04  2.33246462e-04  2.11594109e-06
   9.08751333e-07  6.02615173e-06]]
4.080885519936688e-157
post
sphere_lamr_small
Ybar_post [[ 1.47572333]
 [-0.24235485]
 [14.52817667]]
resids [[-9.28283952e-05]
 [ 2.96288861e-05]
 [ 2.69010184e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [123209658.68486966, 4.080885519936688e-157]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.86206627e+03],
       [ 3.37035699e+03],
       [-3.97759859e+03],
       [-3.73069923e+00],
       [-1.88785313e+00],
       [-6.18779638e+00]]), 'est_covars': array([[ 7.63182877e-03,  7.24249415e-02, -1.69581735e-02,
        -3.01798833e-05, -1.64625147e-05, -9.34292081e-05],
       [ 7.24249415e-02,  7.51201025e-01, -1.76982206e-01,
        -3.32995113e-04, -1.56666160e-04, -9.44683011e-04],
       [-1.69581735e-02, -1.76982206e-01,  4.23575473e-02,
         8.37083470e-05,  4.11114589e-05,  2.40177188e-04],
       [-3.01798833e-05, -3.32995113e-04,  8.37083470e-05,
         1.52158874e-06,  9.19325972e-08,  2.07179438e-06],
       [-1.64625147e-05, -1.56666160e-04,  4.11114589e-05,
         9.19325972e-08,  1.11719903e-06,  8.98008153e-07],
       [-9.34292081e-05, -9.44683011e-04,  2.40177188e-04,
         2.07179438e-06,  8.98008153e-07,  5.97190112e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 18, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.86209873e+03],
       [ 3.37189211e+03],
       [-3.97801618e+03],
       [-3.73100625e+00],
       [-1.88802098e+00],
       [-6.18852079e+00]]), 'covar': array([[ 6.76372407e-03,  7.65634195e-02, -1.87619429e-02,
        -2.30897658e-05, -1.61011094e-05, -7.89036048e-05],
       [ 7.65634195e-02,  9.77389151e-01, -2.41711049e-01,
        -2.74762548e-04, -1.79948736e-04, -8.87313646e-04],
       [-1.87619429e-02, -2.41711049e-01,  6.04720849e-02,
         7.13580150e-05,  4.83423375e-05,  2.33246462e-04],
       [-2.30897658e-05, -2.74762548e-04,  7.13580150e-05,
         1.54399023e-06,  9.40140061e-08,  2.11594109e-06],
       [-1.61011094e-05, -1.79948736e-04,  4.83423375e-05,
         9.40140061e-08,  1.11225944e-06,  9.08751333e-07],
       [-7.89036048e-05, -8.87313646e-04,  2.33246462e-04,
         2.11594109e-06,  9.08751333e-07,  6.02615173e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-9.28283952e-05],
       [ 2.96288861e-05],
       [ 2.69010184e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 18, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.86206627e+03],
       [ 3.37035699e+03],
       [-3.97759859e+03],
       [-3.73069923e+00],
       [-1.88785313e+00],
       [-6.18779638e+00],
       [ 5.58953128e-01],
       [ 1.89704495e-01],
       [-7.80066689e-01],
       [ 2.07556175e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.77984912e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.63182877e-03,  7.24249415e-02, -1.69581735e-02,
        -3.01798833e-05, -1.64625147e-05, -9.34292081e-05],
       [ 7.24249415e-02,  7.51201025e-01, -1.76982206e-01,
        -3.32995113e-04, -1.56666160e-04, -9.44683011e-04],
       [-1.69581735e-02, -1.76982206e-01,  4.23575473e-02,
         8.37083470e-05,  4.11114589e-05,  2.40177188e-04],
       [-3.01798833e-05, -3.32995113e-04,  8.37083470e-05,
         1.52158874e-06,  9.19325972e-08,  2.07179438e-06],
       [-1.64625147e-05, -1.56666160e-04,  4.11114589e-05,
         9.19325972e-08,  1.11719903e-06,  8.98008153e-07],
       [-9.34292081e-05, -9.44683011e-04,  2.40177188e-04,
         2.07179438e-06,  8.98008153e-07,  5.97190112e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.26834517e-07],
       [-2.14415831e-07],
       [ 1.07577478e-01]])}}
Current time:  2018-07-12 20:18:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 18, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.86206627e+03],
       [ 3.37035699e+03],
       [-3.97759859e+03],
       [-3.73069923e+00],
       [-1.88785313e+00],
       [-6.18779638e+00],
       [ 5.58953128e-01],
       [ 1.89704495e-01],
       [-7.80066689e-01],
       [ 2.07556175e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.77984912e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.63182877e-03,  7.24249415e-02, -1.69581735e-02,
        -3.01798833e-05, -1.64625147e-05, -9.34292081e-05],
       [ 7.24249415e-02,  7.51201025e-01, -1.76982206e-01,
        -3.32995113e-04, -1.56666160e-04, -9.44683011e-04],
       [-1.69581735e-02, -1.76982206e-01,  4.23575473e-02,
         8.37083470e-05,  4.11114589e-05,  2.40177188e-04],
       [-3.01798833e-05, -3.32995113e-04,  8.37083470e-05,
         1.52158874e-06,  9.19325972e-08,  2.07179438e-06],
       [-1.64625147e-05, -1.56666160e-04,  4.11114589e-05,
         9.19325972e-08,  1.11719903e-06,  8.98008153e-07],
       [-9.34292081e-05, -9.44683011e-04,  2.40177188e-04,
         2.07179438e-06,  8.98008153e-07,  5.97190112e-06]])}
[[ 4.86206627e+03]
 [ 3.37035699e+03]
 [-3.97759859e+03]
 [-3.73069923e+00]
 [-1.88785313e+00]
 [-6.18779638e+00]
 [ 5.58953128e-01]
 [ 1.89704495e-01]
 [-7.80066689e-01]
 [ 2.07556175e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.77984912e-19]]
2018-07-12 20:18:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:18:50
[[ 4.82449244e+03]
 [ 3.35129357e+03]
 [-4.03925625e+03]
 [-3.78394474e+00]
 [-1.92480097e+00]
 [-6.14361433e+00]
 [ 5.54872536e-01]
 [ 1.88618193e-01]
 [-7.82974525e-01]
 [ 2.08543853e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78197199e-19]]
[[ 7.19052433e-03  6.89918283e-02 -1.68647026e-02 -1.39707442e-05
  -1.55872859e-05 -7.34676970e-05]
 [ 6.89918283e-02  7.48175473e-01 -1.85964385e-01 -3.21592615e-04
  -1.45864711e-04 -9.43062257e-04]
 [-1.68647026e-02 -1.85964385e-01  4.77767873e-02  1.01821303e-04
   5.01950631e-05  3.01819433e-04]
 [-1.39707442e-05 -3.21592615e-04  1.01821303e-04  1.52215656e-06
   8.98503693e-08  2.06116802e-06]
 [-1.55872859e-05 -1.45864711e-04  5.01950631e-05  8.98503693e-08
   1.12717330e-06  8.99728351e-07]
 [-7.34676970e-05 -9.43062257e-04  3.01819433e-04  2.06116802e-06
   8.99728351e-07  6.00027225e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 18, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.86209873e+03],
       [ 3.37189211e+03],
       [-3.97801618e+03],
       [-3.73100625e+00],
       [-1.88802098e+00],
       [-6.18852079e+00]]), 'covar': array([[ 6.76372407e-03,  7.65634195e-02, -1.87619429e-02,
        -2.30897658e-05, -1.61011094e-05, -7.89036048e-05],
       [ 7.65634195e-02,  9.77389151e-01, -2.41711049e-01,
        -2.74762548e-04, -1.79948736e-04, -8.87313646e-04],
       [-1.87619429e-02, -2.41711049e-01,  6.04720849e-02,
         7.13580150e-05,  4.83423375e-05,  2.33246462e-04],
       [-2.30897658e-05, -2.74762548e-04,  7.13580150e-05,
         1.54399023e-06,  9.40140061e-08,  2.11594109e-06],
       [-1.61011094e-05, -1.79948736e-04,  4.83423375e-05,
         9.40140061e-08,  1.11225944e-06,  9.08751333e-07],
       [-7.89036048e-05, -8.87313646e-04,  2.33246462e-04,
         2.11594109e-06,  9.08751333e-07,  6.02615173e-06]])}
[[ 4.86209873e+03]
 [ 3.37189211e+03]
 [-3.97801618e+03]
 [-3.73100625e+00]
 [-1.88802098e+00]
 [-6.18852079e+00]]
2018-07-12 20:18:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:18:50
[[ 4.82452201e+03]
 [ 3.35282690e+03]
 [-4.03968102e+03]
 [-3.78423023e+00]
 [-1.92497043e+00]
 [-6.14435221e+00]]
[[ 6.46683793e-03  7.37325313e-02 -1.86470981e-02 -6.63213829e-06
  -1.52154607e-05 -5.85277019e-05]
 [ 7.37325313e-02  9.73895105e-01 -2.50055848e-01 -2.60131090e-04
  -1.69459983e-04 -8.87585335e-04]
 [-1.86470981e-02 -2.50055848e-01  6.57636180e-02  8.89997171e-05
   5.75927219e-05  2.95952177e-04]
 [-6.63213829e-06 -2.60131090e-04  8.89997171e-05  1.53630140e-06
   9.15599333e-08  2.10544664e-06]
 [-1.52154607e-05 -1.69459983e-04  5.75927219e-05  9.15599333e-08
   1.11238347e-06  9.10666641e-07]
 [-5.85277019e-05 -8.87585335e-04  2.95952177e-04  2.10544664e-06
   9.10666641e-07  6.04326521e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 18, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.82452201e+03],
       [ 3.35282690e+03],
       [-4.03968102e+03],
       [-3.78423023e+00],
       [-1.92497043e+00],
       [-6.14435221e+00]]), 'covar': array([[ 6.46683793e-03,  7.37325313e-02, -1.86470981e-02,
        -6.63213829e-06, -1.52154607e-05, -5.85277019e-05],
       [ 7.37325313e-02,  9.73895105e-01, -2.50055848e-01,
        -2.60131090e-04, -1.69459983e-04, -8.87585335e-04],
       [-1.86470981e-02, -2.50055848e-01,  6.57636180e-02,
         8.89997171e-05,  5.75927219e-05,  2.95952177e-04],
       [-6.63213829e-06, -2.60131090e-04,  8.89997171e-05,
         1.53630140e-06,  9.15599333e-08,  2.10544664e-06],
       [-1.52154607e-05, -1.69459983e-04,  5.75927219e-05,
         9.15599333e-08,  1.11238347e-06,  9.10666641e-07],
       [-5.85277019e-05, -8.87585335e-04,  2.95952177e-04,
         2.10544664e-06,  9.10666641e-07,  6.04326521e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-9.28283952e-05],
       [ 2.96288861e-05],
       [ 2.69010184e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 18, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.82449244e+03],
       [ 3.35129357e+03],
       [-4.03925625e+03],
       [-3.78394474e+00],
       [-1.92480097e+00],
       [-6.14361433e+00],
       [ 5.54872536e-01],
       [ 1.88618193e-01],
       [-7.82974525e-01],
       [ 2.08543853e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78197199e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.19052433e-03,  6.89918283e-02, -1.68647026e-02,
        -1.39707442e-05, -1.55872859e-05, -7.34676970e-05],
       [ 6.89918283e-02,  7.48175473e-01, -1.85964385e-01,
        -3.21592615e-04, -1.45864711e-04, -9.43062257e-04],
       [-1.68647026e-02, -1.85964385e-01,  4.77767873e-02,
         1.01821303e-04,  5.01950631e-05,  3.01819433e-04],
       [-1.39707442e-05, -3.21592615e-04,  1.01821303e-04,
         1.52215656e-06,  8.98503693e-08,  2.06116802e-06],
       [-1.55872859e-05, -1.45864711e-04,  5.01950631e-05,
         8.98503693e-08,  1.12717330e-06,  8.99728351e-07],
       [-7.34676970e-05, -9.43062257e-04,  3.01819433e-04,
         2.06116802e-06,  8.99728351e-07,  6.00027225e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.26834517e-07],
       [-2.14415831e-07],
       [ 1.07577478e-01]])}}
Yi [[ 1.50351036]
 [-0.29452532]
 [16.27355967]]
posterior
[[ 4.82449244e+03]
 [ 3.35129357e+03]
 [-4.03925625e+03]
 [-3.78394474e+00]
 [-1.92480097e+00]
 [-6.14361433e+00]
 [ 5.54872536e-01]
 [ 1.88618193e-01]
 [-7.82974525e-01]
 [ 2.08543853e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78197199e-19]]
[[ 4.82461036e+03]
 [ 3.35241205e+03]
 [-4.03949730e+03]
 [-3.78378416e+00]
 [-1.92473595e+00]
 [-6.14340874e+00]
 [ 5.54872536e-01]
 [ 1.88618193e-01]
 [-7.82974525e-01]
 [ 2.08543853e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78197199e-19]]
[[ 2.55780294e-03  2.78960034e-02 -7.85536133e-03 -2.26585161e-05
  -1.46315962e-05 -7.49079824e-05]
 [ 2.78960034e-02  3.62797362e-01 -1.02855164e-01 -3.83337406e-04
  -1.64912405e-04 -1.01230129e-03]
 [-7.85536133e-03 -1.02855164e-01  2.97674088e-02  1.16366533e-04
   5.25486818e-05  3.13253773e-04]
 [-2.26585161e-05 -3.83337406e-04  1.16366533e-04  1.49455119e-06
   1.11858199e-07  2.09985595e-06]
 [-1.46315962e-05 -1.64912405e-04  5.25486818e-05  1.11858199e-07
   1.09056528e-06  8.25265851e-07]
 [-7.49079824e-05 -1.01230129e-03  3.13253773e-04  2.09985595e-06
   8.25265851e-07  5.84616974e-06]]
[[ 1.50355256]
 [-0.29461803]
 [16.15361547]]
[[-4.21912794e-05]
 [ 9.27060036e-05]
 [ 1.19944192e-01]]


 Corrector Step
2018-07-12 20:18:50
[[ 4.82461036e+03]
 [ 3.35241205e+03]
 [-4.03949730e+03]
 [-3.78378416e+00]
 [-1.92473595e+00]
 [-6.14340874e+00]
 [ 5.54872536e-01]
 [ 1.88618193e-01]
 [-7.82974525e-01]
 [ 2.08543853e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78197199e-19]]
[[ 2.55780294e-03  2.78960034e-02 -7.85536133e-03 -2.26585161e-05
  -1.46315962e-05 -7.49079824e-05]
 [ 2.78960034e-02  3.62797362e-01 -1.02855164e-01 -3.83337406e-04
  -1.64912405e-04 -1.01230129e-03]
 [-7.85536133e-03 -1.02855164e-01  2.97674088e-02  1.16366533e-04
   5.25486818e-05  3.13253773e-04]
 [-2.26585161e-05 -3.83337406e-04  1.16366533e-04  1.49455119e-06
   1.11858199e-07  2.09985595e-06]
 [-1.46315962e-05 -1.64912405e-04  5.25486818e-05  1.11858199e-07
   1.09056528e-06  8.25265851e-07]
 [-7.49079824e-05 -1.01230129e-03  3.13253773e-04  2.09985595e-06
   8.25265851e-07  5.84616974e-06]]
34805871.71992995
post
cubesat_nadir
Ybar_post [[ 1.50351746]
 [-0.29454224]
 [16.15683249]]
resids [[-7.09247073e-06]
 [ 1.69203110e-05]
 [ 1.16727181e-01]]
posterior
[[ 4.82452201e+03]
 [ 3.35282690e+03]
 [-4.03968102e+03]
 [-3.78423023e+00]
 [-1.92497043e+00]
 [-6.14435221e+00]]
[[ 4.82466256e+03]
 [ 3.35390138e+03]
 [-4.03993116e+03]
 [-3.78356073e+00]
 [-1.92524917e+00]
 [-6.14445283e+00]]
[[ 2.91259930e-03  3.61450646e-02 -1.02711541e-02 -1.98997720e-05
  -1.73553087e-05 -7.77686750e-05]
 [ 3.61450646e-02  5.25820918e-01 -1.50167407e-01 -3.66045314e-04
  -2.23005951e-04 -1.13663222e-03]
 [-1.02711541e-02 -1.50167407e-01  4.34952736e-02  1.12569903e-04
   6.95458376e-05  3.51470065e-04]
 [-1.98997720e-05 -3.66045314e-04  1.12569903e-04  1.46332750e-06
   1.04556068e-07  2.06442222e-06]
 [-1.73553087e-05 -2.23005951e-04  6.95458376e-05  1.04556068e-07
   1.09215925e-06  8.71068960e-07]
 [-7.77686750e-05 -1.13663222e-03  3.51470065e-04  2.06442222e-06
   8.71068960e-07  5.89735527e-06]]
[[ 1.50361344]
 [-0.29458768]
 [14.40853214]]
[[-1.03077424e-04]
 [ 6.23523382e-05]
 [ 1.86502752e+00]]


 Corrector Step
2018-07-12 20:18:50
[[ 4.82466256e+03]
 [ 3.35390138e+03]
 [-4.03993116e+03]
 [-3.78356073e+00]
 [-1.92524917e+00]
 [-6.14445283e+00]]
[[ 2.91259930e-03  3.61450646e-02 -1.02711541e-02 -1.98997720e-05
  -1.73553087e-05 -7.77686750e-05]
 [ 3.61450646e-02  5.25820918e-01 -1.50167407e-01 -3.66045314e-04
  -2.23005951e-04 -1.13663222e-03]
 [-1.02711541e-02 -1.50167407e-01  4.34952736e-02  1.12569903e-04
   6.95458376e-05  3.51470065e-04]
 [-1.98997720e-05 -3.66045314e-04  1.12569903e-04  1.46332750e-06
   1.04556068e-07  2.06442222e-06]
 [-1.73553087e-05 -2.23005951e-04  6.95458376e-05  1.04556068e-07
   1.09215925e-06  8.71068960e-07]
 [-7.77686750e-05 -1.13663222e-03  3.51470065e-04  2.06442222e-06
   8.71068960e-07  5.89735527e-06]]
1.7471854131995456e-69
post
sphere_lamr_small
Ybar_post [[ 1.50355716]
 [-0.29452862]
 [14.41051028]]
resids [[-4.67945058e-05]
 [ 3.29724177e-06]
 [ 1.86304939e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [34805871.71992995, 1.7471854131995456e-69]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.82461036e+03],
       [ 3.35241205e+03],
       [-4.03949730e+03],
       [-3.78378416e+00],
       [-1.92473595e+00],
       [-6.14340874e+00]]), 'est_covars': array([[ 2.55780294e-03,  2.78960034e-02, -7.85536133e-03,
        -2.26585161e-05, -1.46315962e-05, -7.49079824e-05],
       [ 2.78960034e-02,  3.62797362e-01, -1.02855164e-01,
        -3.83337406e-04, -1.64912405e-04, -1.01230129e-03],
       [-7.85536133e-03, -1.02855164e-01,  2.97674088e-02,
         1.16366533e-04,  5.25486818e-05,  3.13253773e-04],
       [-2.26585161e-05, -3.83337406e-04,  1.16366533e-04,
         1.49455119e-06,  1.11858199e-07,  2.09985595e-06],
       [-1.46315962e-05, -1.64912405e-04,  5.25486818e-05,
         1.11858199e-07,  1.09056528e-06,  8.25265851e-07],
       [-7.49079824e-05, -1.01230129e-03,  3.13253773e-04,
         2.09985595e-06,  8.25265851e-07,  5.84616974e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 18, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.82466256e+03],
       [ 3.35390138e+03],
       [-4.03993116e+03],
       [-3.78356073e+00],
       [-1.92524917e+00],
       [-6.14445283e+00]]), 'covar': array([[ 2.91259930e-03,  3.61450646e-02, -1.02711541e-02,
        -1.98997720e-05, -1.73553087e-05, -7.77686750e-05],
       [ 3.61450646e-02,  5.25820918e-01, -1.50167407e-01,
        -3.66045314e-04, -2.23005951e-04, -1.13663222e-03],
       [-1.02711541e-02, -1.50167407e-01,  4.34952736e-02,
         1.12569903e-04,  6.95458376e-05,  3.51470065e-04],
       [-1.98997720e-05, -3.66045314e-04,  1.12569903e-04,
         1.46332750e-06,  1.04556068e-07,  2.06442222e-06],
       [-1.73553087e-05, -2.23005951e-04,  6.95458376e-05,
         1.04556068e-07,  1.09215925e-06,  8.71068960e-07],
       [-7.77686750e-05, -1.13663222e-03,  3.51470065e-04,
         2.06442222e-06,  8.71068960e-07,  5.89735527e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-4.67945058e-05],
       [ 3.29724177e-06],
       [ 1.86304939e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 18, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.82461036e+03],
       [ 3.35241205e+03],
       [-4.03949730e+03],
       [-3.78378416e+00],
       [-1.92473595e+00],
       [-6.14340874e+00],
       [ 5.54872536e-01],
       [ 1.88618193e-01],
       [-7.82974525e-01],
       [ 2.08543853e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78197199e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.55780294e-03,  2.78960034e-02, -7.85536133e-03,
        -2.26585161e-05, -1.46315962e-05, -7.49079824e-05],
       [ 2.78960034e-02,  3.62797362e-01, -1.02855164e-01,
        -3.83337406e-04, -1.64912405e-04, -1.01230129e-03],
       [-7.85536133e-03, -1.02855164e-01,  2.97674088e-02,
         1.16366533e-04,  5.25486818e-05,  3.13253773e-04],
       [-2.26585161e-05, -3.83337406e-04,  1.16366533e-04,
         1.49455119e-06,  1.11858199e-07,  2.09985595e-06],
       [-1.46315962e-05, -1.64912405e-04,  5.25486818e-05,
         1.11858199e-07,  1.09056528e-06,  8.25265851e-07],
       [-7.49079824e-05, -1.01230129e-03,  3.13253773e-04,
         2.09985595e-06,  8.25265851e-07,  5.84616974e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-7.09247073e-06],
       [ 1.69203110e-05],
       [ 1.16727181e-01]])}}
Current time:  2018-07-12 20:19:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 18, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.82461036e+03],
       [ 3.35241205e+03],
       [-4.03949730e+03],
       [-3.78378416e+00],
       [-1.92473595e+00],
       [-6.14340874e+00],
       [ 5.54872536e-01],
       [ 1.88618193e-01],
       [-7.82974525e-01],
       [ 2.08543853e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78197199e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.55780294e-03,  2.78960034e-02, -7.85536133e-03,
        -2.26585161e-05, -1.46315962e-05, -7.49079824e-05],
       [ 2.78960034e-02,  3.62797362e-01, -1.02855164e-01,
        -3.83337406e-04, -1.64912405e-04, -1.01230129e-03],
       [-7.85536133e-03, -1.02855164e-01,  2.97674088e-02,
         1.16366533e-04,  5.25486818e-05,  3.13253773e-04],
       [-2.26585161e-05, -3.83337406e-04,  1.16366533e-04,
         1.49455119e-06,  1.11858199e-07,  2.09985595e-06],
       [-1.46315962e-05, -1.64912405e-04,  5.25486818e-05,
         1.11858199e-07,  1.09056528e-06,  8.25265851e-07],
       [-7.49079824e-05, -1.01230129e-03,  3.13253773e-04,
         2.09985595e-06,  8.25265851e-07,  5.84616974e-06]])}
[[ 4.82461036e+03]
 [ 3.35241205e+03]
 [-4.03949730e+03]
 [-3.78378416e+00]
 [-1.92473595e+00]
 [-6.14340874e+00]
 [ 5.54872536e-01]
 [ 1.88618193e-01]
 [-7.82974525e-01]
 [ 2.08543853e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78197199e-19]]
2018-07-12 20:18:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:00
[[ 4.78650813e+03]
 [ 3.33298072e+03]
 [-4.10070762e+03]
 [-3.83659170e+00]
 [-1.96146832e+00]
 [-6.09856687e+00]
 [ 5.50776817e-01]
 [ 1.87526750e-01]
 [-7.85861016e-01]
 [ 2.09525845e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78409486e-19]]
[[ 2.25780721e-03  2.39535089e-02 -7.24020114e-03 -7.34369550e-06
  -1.35299505e-05 -5.42247434e-05]
 [ 2.39535089e-02  3.59607062e-01 -1.12387498e-01 -3.77003730e-04
  -1.54092429e-04 -1.00754227e-03]
 [-7.24020114e-03 -1.12387498e-01  3.66282983e-02  1.35737898e-04
   6.08427849e-05  3.72904290e-04]
 [-7.34369550e-06 -3.77003730e-04  1.35737898e-04  1.49331999e-06
   1.09579467e-07  2.08826568e-06]
 [-1.35299505e-05 -1.54092429e-04  6.08427849e-05  1.09579467e-07
   1.10046798e-06  8.26932629e-07]
 [-5.42247434e-05 -1.00754227e-03  3.72904290e-04  2.08826568e-06
   8.26932629e-07  5.87553981e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 18, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.82466256e+03],
       [ 3.35390138e+03],
       [-4.03993116e+03],
       [-3.78356073e+00],
       [-1.92524917e+00],
       [-6.14445283e+00]]), 'covar': array([[ 2.91259930e-03,  3.61450646e-02, -1.02711541e-02,
        -1.98997720e-05, -1.73553087e-05, -7.77686750e-05],
       [ 3.61450646e-02,  5.25820918e-01, -1.50167407e-01,
        -3.66045314e-04, -2.23005951e-04, -1.13663222e-03],
       [-1.02711541e-02, -1.50167407e-01,  4.34952736e-02,
         1.12569903e-04,  6.95458376e-05,  3.51470065e-04],
       [-1.98997720e-05, -3.66045314e-04,  1.12569903e-04,
         1.46332750e-06,  1.04556068e-07,  2.06442222e-06],
       [-1.73553087e-05, -2.23005951e-04,  6.95458376e-05,
         1.04556068e-07,  1.09215925e-06,  8.71068960e-07],
       [-7.77686750e-05, -1.13663222e-03,  3.51470065e-04,
         2.06442222e-06,  8.71068960e-07,  5.89735527e-06]])}
[[ 4.82466256e+03]
 [ 3.35390138e+03]
 [-4.03993116e+03]
 [-3.78356073e+00]
 [-1.92524917e+00]
 [-6.14445283e+00]]
2018-07-12 20:18:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:00
[[ 4.78656232e+03]
 [ 3.33446502e+03]
 [-4.10115213e+03]
 [-3.83634698e+00]
 [-1.96198275e+00]
 [-6.09962443e+00]]
[[ 2.66595993e-03  3.23591426e-02 -9.72997188e-03 -4.82523895e-06
  -1.63363555e-05 -5.75276000e-05]
 [ 3.23591426e-02  5.21467634e-01 -1.60775934e-01 -3.57461101e-04
  -2.12316761e-04 -1.13294402e-03]
 [-9.72997188e-03 -1.60775934e-01  5.11298751e-02  1.30891078e-04
   7.83297077e-05  4.12045554e-04]
 [-4.82523895e-06 -3.57461101e-04  1.30891078e-04  1.45271387e-06
   1.01438583e-07  2.05083890e-06]
 [-1.63363555e-05 -2.12316761e-04  7.83297077e-05  1.01438583e-07
   1.09223393e-06  8.73369801e-07]
 [-5.75276000e-05 -1.13294402e-03  4.12045554e-04  2.05083890e-06
   8.73369801e-07  5.91909227e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 18, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.78656232e+03],
       [ 3.33446502e+03],
       [-4.10115213e+03],
       [-3.83634698e+00],
       [-1.96198275e+00],
       [-6.09962443e+00]]), 'covar': array([[ 2.66595993e-03,  3.23591426e-02, -9.72997188e-03,
        -4.82523895e-06, -1.63363555e-05, -5.75276000e-05],
       [ 3.23591426e-02,  5.21467634e-01, -1.60775934e-01,
        -3.57461101e-04, -2.12316761e-04, -1.13294402e-03],
       [-9.72997188e-03, -1.60775934e-01,  5.11298751e-02,
         1.30891078e-04,  7.83297077e-05,  4.12045554e-04],
       [-4.82523895e-06, -3.57461101e-04,  1.30891078e-04,
         1.45271387e-06,  1.01438583e-07,  2.05083890e-06],
       [-1.63363555e-05, -2.12316761e-04,  7.83297077e-05,
         1.01438583e-07,  1.09223393e-06,  8.73369801e-07],
       [-5.75276000e-05, -1.13294402e-03,  4.12045554e-04,
         2.05083890e-06,  8.73369801e-07,  5.91909227e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-4.67945058e-05],
       [ 3.29724177e-06],
       [ 1.86304939e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 18, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.78650813e+03],
       [ 3.33298072e+03],
       [-4.10070762e+03],
       [-3.83659170e+00],
       [-1.96146832e+00],
       [-6.09856687e+00],
       [ 5.50776817e-01],
       [ 1.87526750e-01],
       [-7.85861016e-01],
       [ 2.09525845e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78409486e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.25780721e-03,  2.39535089e-02, -7.24020114e-03,
        -7.34369550e-06, -1.35299505e-05, -5.42247434e-05],
       [ 2.39535089e-02,  3.59607062e-01, -1.12387498e-01,
        -3.77003730e-04, -1.54092429e-04, -1.00754227e-03],
       [-7.24020114e-03, -1.12387498e-01,  3.66282983e-02,
         1.35737898e-04,  6.08427849e-05,  3.72904290e-04],
       [-7.34369550e-06, -3.77003730e-04,  1.35737898e-04,
         1.49331999e-06,  1.09579467e-07,  2.08826568e-06],
       [-1.35299505e-05, -1.54092429e-04,  6.08427849e-05,
         1.09579467e-07,  1.10046798e-06,  8.26932629e-07],
       [-5.42247434e-05, -1.00754227e-03,  3.72904290e-04,
         2.08826568e-06,  8.26932629e-07,  5.87553981e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-7.09247073e-06],
       [ 1.69203110e-05],
       [ 1.16727181e-01]])}}
Yi [[ 1.53300004]
 [-0.34679683]
 [15.62884406]]
posterior
[[ 4.78650813e+03]
 [ 3.33298072e+03]
 [-4.10070762e+03]
 [-3.83659170e+00]
 [-1.96146832e+00]
 [-6.09856687e+00]
 [ 5.50776817e-01]
 [ 1.87526750e-01]
 [-7.85861016e-01]
 [ 2.09525845e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78409486e-19]]
[[ 4.78653152e+03]
 [ 3.33322070e+03]
 [-4.10076826e+03]
 [-3.83655148e+00]
 [-1.96149348e+00]
 [-6.09865753e+00]
 [ 5.50776817e-01]
 [ 1.87526750e-01]
 [-7.85861016e-01]
 [ 2.09525845e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78409486e-19]]
[[ 9.95880365e-04  1.24155274e-02 -4.20733629e-03 -1.16075030e-05
  -9.98815637e-06 -4.61896938e-05]
 [ 1.24155274e-02  2.42154557e-01 -8.31170106e-02 -4.02043829e-04
  -1.45037212e-04 -9.79004192e-04]
 [-4.20733629e-03 -8.31170106e-02  2.91403226e-02  1.44185397e-04
   5.53312022e-05  3.59363600e-04]
 [-1.16075030e-05 -4.02043829e-04  1.44185397e-04  1.46262465e-06
   1.48711573e-07  2.16766393e-06]
 [-9.98815637e-06 -1.45037212e-04  5.53312022e-05  1.48711573e-07
   1.04497880e-06  7.16574659e-07]
 [-4.61896938e-05 -9.79004192e-04  3.59363600e-04  2.16766393e-06
   7.16574659e-07  5.65495018e-06]]
[[ 1.53301767]
 [-0.3468229 ]
 [15.47107911]]
[[-1.76287434e-05]
 [ 2.60722151e-05]
 [ 1.57764952e-01]]


 Corrector Step
2018-07-12 20:19:00
[[ 4.78653152e+03]
 [ 3.33322070e+03]
 [-4.10076826e+03]
 [-3.83655148e+00]
 [-1.96149348e+00]
 [-6.09865753e+00]
 [ 5.50776817e-01]
 [ 1.87526750e-01]
 [-7.85861016e-01]
 [ 2.09525845e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78409486e-19]]
[[ 9.95880365e-04  1.24155274e-02 -4.20733629e-03 -1.16075030e-05
  -9.98815637e-06 -4.61896938e-05]
 [ 1.24155274e-02  2.42154557e-01 -8.31170106e-02 -4.02043829e-04
  -1.45037212e-04 -9.79004192e-04]
 [-4.20733629e-03 -8.31170106e-02  2.91403226e-02  1.44185397e-04
   5.53312022e-05  3.59363600e-04]
 [-1.16075030e-05 -4.02043829e-04  1.44185397e-04  1.46262465e-06
   1.48711573e-07  2.16766393e-06]
 [-9.98815637e-06 -1.45037212e-04  5.53312022e-05  1.48711573e-07
   1.04497880e-06  7.16574659e-07]
 [-4.61896938e-05 -9.79004192e-04  3.59363600e-04  2.16766393e-06
   7.16574659e-07  5.65495018e-06]]
98749967.3108774
post
cubesat_nadir
Ybar_post [[ 1.53300556]
 [-0.34680321]
 [15.47176536]]
resids [[-5.52776773e-06]
 [ 6.37731440e-06]
 [ 1.57078705e-01]]
posterior
[[ 4.78656232e+03]
 [ 3.33446502e+03]
 [-4.10115213e+03]
 [-3.83634698e+00]
 [-1.96198275e+00]
 [-6.09962443e+00]]
[[ 4.78656072e+03]
 [ 3.33429491e+03]
 [-4.10112627e+03]
 [-3.83628301e+00]
 [-1.96224337e+00]
 [-6.10026327e+00]]
[[ 1.08147999e-03  1.48857949e-02 -5.03047620e-03 -1.08708643e-05
  -1.16082078e-05 -4.90245094e-05]
 [ 1.48857949e-02  3.06478001e-01 -1.04669772e-01 -4.02394726e-04
  -1.87550106e-04 -1.08674960e-03]
 [-5.03047620e-03 -1.04669772e-01  3.63690578e-02  1.44645150e-04
   6.95586022e-05  3.95945776e-04]
 [-1.08708643e-05 -4.02394726e-04  1.44645150e-04  1.40842204e-06
   1.46131108e-07  2.12952167e-06]
 [-1.16082078e-05 -1.87550106e-04  6.95586022e-05  1.46131108e-07
   1.04448255e-06  7.89445632e-07]
 [-4.90245094e-05 -1.08674960e-03  3.95945776e-04  2.12952167e-06
   7.89445632e-07  5.77136703e-06]]
[[ 1.53301927]
 [-0.34675401]
 [14.29235935]]
[[-1.92380688e-05]
 [-4.28158531e-05]
 [ 1.33648471e+00]]


 Corrector Step
2018-07-12 20:19:00
[[ 4.78656072e+03]
 [ 3.33429491e+03]
 [-4.10112627e+03]
 [-3.83628301e+00]
 [-1.96224337e+00]
 [-6.10026327e+00]]
[[ 1.08147999e-03  1.48857949e-02 -5.03047620e-03 -1.08708643e-05
  -1.16082078e-05 -4.90245094e-05]
 [ 1.48857949e-02  3.06478001e-01 -1.04669772e-01 -4.02394726e-04
  -1.87550106e-04 -1.08674960e-03]
 [-5.03047620e-03 -1.04669772e-01  3.63690578e-02  1.44645150e-04
   6.95586022e-05  3.95945776e-04]
 [-1.08708643e-05 -4.02394726e-04  1.44645150e-04  1.40842204e-06
   1.46131108e-07  2.12952167e-06]
 [-1.16082078e-05 -1.87550106e-04  6.95586022e-05  1.46131108e-07
   1.04448255e-06  7.89445632e-07]
 [-4.90245094e-05 -1.08674960e-03  3.95945776e-04  2.12952167e-06
   7.89445632e-07  5.77136703e-06]]
2.718393554996044e-31
post
sphere_lamr_small
Ybar_post [[ 1.53301519]
 [-0.34678057]
 [14.2919766 ]]
resids [[-1.51493061e-05]
 [-1.62645671e-05]
 [ 1.33686746e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [98749967.3108774, 2.718393554996044e-31]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.78653152e+03],
       [ 3.33322070e+03],
       [-4.10076826e+03],
       [-3.83655148e+00],
       [-1.96149348e+00],
       [-6.09865753e+00]]), 'est_covars': array([[ 9.95880365e-04,  1.24155274e-02, -4.20733629e-03,
        -1.16075030e-05, -9.98815637e-06, -4.61896938e-05],
       [ 1.24155274e-02,  2.42154557e-01, -8.31170106e-02,
        -4.02043829e-04, -1.45037212e-04, -9.79004192e-04],
       [-4.20733629e-03, -8.31170106e-02,  2.91403226e-02,
         1.44185397e-04,  5.53312022e-05,  3.59363600e-04],
       [-1.16075030e-05, -4.02043829e-04,  1.44185397e-04,
         1.46262465e-06,  1.48711573e-07,  2.16766393e-06],
       [-9.98815637e-06, -1.45037212e-04,  5.53312022e-05,
         1.48711573e-07,  1.04497880e-06,  7.16574659e-07],
       [-4.61896938e-05, -9.79004192e-04,  3.59363600e-04,
         2.16766393e-06,  7.16574659e-07,  5.65495018e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.78656072e+03],
       [ 3.33429491e+03],
       [-4.10112627e+03],
       [-3.83628301e+00],
       [-1.96224337e+00],
       [-6.10026327e+00]]), 'covar': array([[ 1.08147999e-03,  1.48857949e-02, -5.03047620e-03,
        -1.08708643e-05, -1.16082078e-05, -4.90245094e-05],
       [ 1.48857949e-02,  3.06478001e-01, -1.04669772e-01,
        -4.02394726e-04, -1.87550106e-04, -1.08674960e-03],
       [-5.03047620e-03, -1.04669772e-01,  3.63690578e-02,
         1.44645150e-04,  6.95586022e-05,  3.95945776e-04],
       [-1.08708643e-05, -4.02394726e-04,  1.44645150e-04,
         1.40842204e-06,  1.46131108e-07,  2.12952167e-06],
       [-1.16082078e-05, -1.87550106e-04,  6.95586022e-05,
         1.46131108e-07,  1.04448255e-06,  7.89445632e-07],
       [-4.90245094e-05, -1.08674960e-03,  3.95945776e-04,
         2.12952167e-06,  7.89445632e-07,  5.77136703e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.51493061e-05],
       [-1.62645671e-05],
       [ 1.33686746e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.78653152e+03],
       [ 3.33322070e+03],
       [-4.10076826e+03],
       [-3.83655148e+00],
       [-1.96149348e+00],
       [-6.09865753e+00],
       [ 5.50776817e-01],
       [ 1.87526750e-01],
       [-7.85861016e-01],
       [ 2.09525845e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78409486e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.95880365e-04,  1.24155274e-02, -4.20733629e-03,
        -1.16075030e-05, -9.98815637e-06, -4.61896938e-05],
       [ 1.24155274e-02,  2.42154557e-01, -8.31170106e-02,
        -4.02043829e-04, -1.45037212e-04, -9.79004192e-04],
       [-4.20733629e-03, -8.31170106e-02,  2.91403226e-02,
         1.44185397e-04,  5.53312022e-05,  3.59363600e-04],
       [-1.16075030e-05, -4.02043829e-04,  1.44185397e-04,
         1.46262465e-06,  1.48711573e-07,  2.16766393e-06],
       [-9.98815637e-06, -1.45037212e-04,  5.53312022e-05,
         1.48711573e-07,  1.04497880e-06,  7.16574659e-07],
       [-4.61896938e-05, -9.79004192e-04,  3.59363600e-04,
         2.16766393e-06,  7.16574659e-07,  5.65495018e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-5.52776773e-06],
       [ 6.37731440e-06],
       [ 1.57078705e-01]])}}
Current time:  2018-07-12 20:19:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.78653152e+03],
       [ 3.33322070e+03],
       [-4.10076826e+03],
       [-3.83655148e+00],
       [-1.96149348e+00],
       [-6.09865753e+00],
       [ 5.50776817e-01],
       [ 1.87526750e-01],
       [-7.85861016e-01],
       [ 2.09525845e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78409486e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.95880365e-04,  1.24155274e-02, -4.20733629e-03,
        -1.16075030e-05, -9.98815637e-06, -4.61896938e-05],
       [ 1.24155274e-02,  2.42154557e-01, -8.31170106e-02,
        -4.02043829e-04, -1.45037212e-04, -9.79004192e-04],
       [-4.20733629e-03, -8.31170106e-02,  2.91403226e-02,
         1.44185397e-04,  5.53312022e-05,  3.59363600e-04],
       [-1.16075030e-05, -4.02043829e-04,  1.44185397e-04,
         1.46262465e-06,  1.48711573e-07,  2.16766393e-06],
       [-9.98815637e-06, -1.45037212e-04,  5.53312022e-05,
         1.48711573e-07,  1.04497880e-06,  7.16574659e-07],
       [-4.61896938e-05, -9.79004192e-04,  3.59363600e-04,
         2.16766393e-06,  7.16574659e-07,  5.65495018e-06]])}
[[ 4.78653152e+03]
 [ 3.33322070e+03]
 [-4.10076826e+03]
 [-3.83655148e+00]
 [-1.96149348e+00]
 [-6.09865753e+00]
 [ 5.50776817e-01]
 [ 1.87526750e-01]
 [-7.85861016e-01]
 [ 2.09525845e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78409486e-19]]
2018-07-12 20:19:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:10
[[ 4.74790368e+03]
 [ 3.31342280e+03]
 [-4.16152794e+03]
 [-3.88892751e+00]
 [-1.99800576e+00]
 [-6.05315165e+00]
 [ 5.46666083e-01]
 [ 1.86430193e-01]
 [-7.88726082e-01]
 [ 2.10502125e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78621773e-19]]
[[ 9.11516485e-04  8.32817758e-03 -3.01805885e-03  3.16447693e-06
  -8.50935241e-06 -2.46746656e-05]
 [ 8.32817758e-03  2.39358315e-01 -9.22934442e-02 -3.96938345e-04
  -1.34573907e-04 -9.74123136e-04]
 [-3.01805885e-03 -9.22934442e-02  3.69021440e-02  1.64471173e-04
   6.25094587e-05  4.16888944e-04]
 [ 3.16447693e-06 -3.96938345e-04  1.64471173e-04  1.46045146e-06
   1.46603183e-07  2.15619213e-06]
 [-8.50935241e-06 -1.34573907e-04  6.25094587e-05  1.46603183e-07
   1.05481181e-06  7.17872637e-07]
 [-2.46746656e-05 -9.74123136e-04  4.16888944e-04  2.15619213e-06
   7.17872637e-07  5.68337994e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.78656072e+03],
       [ 3.33429491e+03],
       [-4.10112627e+03],
       [-3.83628301e+00],
       [-1.96224337e+00],
       [-6.10026327e+00]]), 'covar': array([[ 1.08147999e-03,  1.48857949e-02, -5.03047620e-03,
        -1.08708643e-05, -1.16082078e-05, -4.90245094e-05],
       [ 1.48857949e-02,  3.06478001e-01, -1.04669772e-01,
        -4.02394726e-04, -1.87550106e-04, -1.08674960e-03],
       [-5.03047620e-03, -1.04669772e-01,  3.63690578e-02,
         1.44645150e-04,  6.95586022e-05,  3.95945776e-04],
       [-1.08708643e-05, -4.02394726e-04,  1.44645150e-04,
         1.40842204e-06,  1.46131108e-07,  2.12952167e-06],
       [-1.16082078e-05, -1.87550106e-04,  6.95586022e-05,
         1.46131108e-07,  1.04448255e-06,  7.89445632e-07],
       [-4.90245094e-05, -1.08674960e-03,  3.95945776e-04,
         2.12952167e-06,  7.89445632e-07,  5.77136703e-06]])}
[[ 4.78656072e+03]
 [ 3.33429491e+03]
 [-4.10112627e+03]
 [-3.83628301e+00]
 [-1.96224337e+00]
 [-6.10026327e+00]]
2018-07-12 20:19:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:10
[[ 4.74793576e+03]
 [ 3.31448972e+03]
 [-4.16190210e+03]
 [-3.88864321e+00]
 [-1.99875633e+00]
 [-6.05476726e+00]]
[[ 1.00652701e-03  1.07831273e-02 -3.87055524e-03  3.34584376e-06
  -1.01593045e-05 -2.79220675e-05]
 [ 1.07831273e-02  3.02830795e-01 -1.14777085e-01 -3.96373381e-04
  -1.77163529e-04 -1.08174146e-03]
 [-3.87055524e-03 -1.14777085e-01  4.48761035e-02  1.64215876e-04
   7.74755987e-05  4.54803696e-04]
 [ 3.34584376e-06 -3.96373381e-04  1.64215876e-04  1.39635520e-06
   1.43396681e-07  2.11645472e-06]
 [-1.01593045e-05 -1.77163529e-04  7.74755987e-05  1.43396681e-07
   1.04444681e-06  7.91191123e-07]
 [-2.79220675e-05 -1.08174146e-03  4.54803696e-04  2.11645472e-06
   7.91191123e-07  5.79190261e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.74793576e+03],
       [ 3.31448972e+03],
       [-4.16190210e+03],
       [-3.88864321e+00],
       [-1.99875633e+00],
       [-6.05476726e+00]]), 'covar': array([[ 1.00652701e-03,  1.07831273e-02, -3.87055524e-03,
         3.34584376e-06, -1.01593045e-05, -2.79220675e-05],
       [ 1.07831273e-02,  3.02830795e-01, -1.14777085e-01,
        -3.96373381e-04, -1.77163529e-04, -1.08174146e-03],
       [-3.87055524e-03, -1.14777085e-01,  4.48761035e-02,
         1.64215876e-04,  7.74755987e-05,  4.54803696e-04],
       [ 3.34584376e-06, -3.96373381e-04,  1.64215876e-04,
         1.39635520e-06,  1.43396681e-07,  2.11645472e-06],
       [-1.01593045e-05, -1.77163529e-04,  7.74755987e-05,
         1.43396681e-07,  1.04444681e-06,  7.91191123e-07],
       [-2.79220675e-05, -1.08174146e-03,  4.54803696e-04,
         2.11645472e-06,  7.91191123e-07,  5.79190261e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.51493061e-05],
       [-1.62645671e-05],
       [ 1.33686746e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.74790368e+03],
       [ 3.31342280e+03],
       [-4.16152794e+03],
       [-3.88892751e+00],
       [-1.99800576e+00],
       [-6.05315165e+00],
       [ 5.46666083e-01],
       [ 1.86430193e-01],
       [-7.88726082e-01],
       [ 2.10502125e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78621773e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.11516485e-04,  8.32817758e-03, -3.01805885e-03,
         3.16447693e-06, -8.50935241e-06, -2.46746656e-05],
       [ 8.32817758e-03,  2.39358315e-01, -9.22934442e-02,
        -3.96938345e-04, -1.34573907e-04, -9.74123136e-04],
       [-3.01805885e-03, -9.22934442e-02,  3.69021440e-02,
         1.64471173e-04,  6.25094587e-05,  4.16888944e-04],
       [ 3.16447693e-06, -3.96938345e-04,  1.64471173e-04,
         1.46045146e-06,  1.46603183e-07,  2.15619213e-06],
       [-8.50935241e-06, -1.34573907e-04,  6.25094587e-05,
         1.46603183e-07,  1.05481181e-06,  7.17872637e-07],
       [-2.46746656e-05, -9.74123136e-04,  4.16888944e-04,
         2.15619213e-06,  7.17872637e-07,  5.68337994e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-5.52776773e-06],
       [ 6.37731440e-06],
       [ 1.57078705e-01]])}}
Yi [[ 1.56417026]
 [-0.39871653]
 [14.93053495]]
posterior
[[ 4.74790368e+03]
 [ 3.31342280e+03]
 [-4.16152794e+03]
 [-3.88892751e+00]
 [-1.99800576e+00]
 [-6.05315165e+00]
 [ 5.46666083e-01]
 [ 1.86430193e-01]
 [-7.88726082e-01]
 [ 2.10502125e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78621773e-19]]
[[ 4.74791270e+03]
 [ 3.31353027e+03]
 [-4.16155792e+03]
 [-3.88891358e+00]
 [-1.99800626e+00]
 [-6.05321018e+00]
 [ 5.46666083e-01]
 [ 1.86430193e-01]
 [-7.88726082e-01]
 [ 2.10502125e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78621773e-19]]
[[ 4.27788382e-04  4.04990680e-03 -1.59786923e-03  5.02564900e-07
  -5.22281529e-06 -1.60673525e-05]
 [ 4.04990680e-03  1.93517311e-01 -7.87010031e-02 -4.10084860e-04
  -1.22860830e-04 -9.26818855e-04]
 [-1.59786923e-03 -7.87010031e-02  3.25987895e-02  1.70942214e-04
   5.50908041e-05  3.95311360e-04]
 [ 5.02564900e-07 -4.10084860e-04  1.70942214e-04  1.43227837e-06
   1.87199847e-07  2.24088832e-06]
 [-5.22281529e-06 -1.22860830e-04  5.50908041e-05  1.87199847e-07
   9.94780240e-07  5.96670202e-07]
 [-1.60673525e-05 -9.26818855e-04  3.95311360e-04  2.24088832e-06
   5.96670202e-07  5.42570626e-06]]
[[ 1.56418154]
 [-0.39873403]
 [14.9367528 ]]
[[-1.12759643e-05]
 [ 1.75015540e-05]
 [-6.21784525e-03]]


 Corrector Step
2018-07-12 20:19:10
[[ 4.74791270e+03]
 [ 3.31353027e+03]
 [-4.16155792e+03]
 [-3.88891358e+00]
 [-1.99800626e+00]
 [-6.05321018e+00]
 [ 5.46666083e-01]
 [ 1.86430193e-01]
 [-7.88726082e-01]
 [ 2.10502125e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78621773e-19]]
[[ 4.27788382e-04  4.04990680e-03 -1.59786923e-03  5.02564900e-07
  -5.22281529e-06 -1.60673525e-05]
 [ 4.04990680e-03  1.93517311e-01 -7.87010031e-02 -4.10084860e-04
  -1.22860830e-04 -9.26818855e-04]
 [-1.59786923e-03 -7.87010031e-02  3.25987895e-02  1.70942214e-04
   5.50908041e-05  3.95311360e-04]
 [ 5.02564900e-07 -4.10084860e-04  1.70942214e-04  1.43227837e-06
   1.87199847e-07  2.24088832e-06]
 [-5.22281529e-06 -1.22860830e-04  5.50908041e-05  1.87199847e-07
   9.94780240e-07  5.96670202e-07]
 [-1.60673525e-05 -9.26818855e-04  3.95311360e-04  2.24088832e-06
   5.96670202e-07  5.42570626e-06]]
430484266.2569503
post
cubesat_nadir
Ybar_post [[ 1.56417441]
 [-0.39872283]
 [14.93706545]]
resids [[-4.14459150e-06]
 [ 6.29388381e-06]
 [-6.53050407e-03]]
posterior
[[ 4.74793576e+03]
 [ 3.31448972e+03]
 [-4.16190210e+03]
 [-3.88864321e+00]
 [-1.99875633e+00]
 [-6.05476726e+00]]
[[ 4.74792395e+03]
 [ 3.31429535e+03]
 [-4.16185257e+03]
 [-3.88866248e+00]
 [-1.99881395e+00]
 [-6.05486646e+00]]
[[ 4.40463874e-04  4.67591429e-03 -1.83624572e-03  5.92533720e-07
  -5.86057003e-06 -1.70820642e-05]
 [ 4.67591429e-03  2.23063920e-01 -9.01743991e-02 -4.10980757e-04
  -1.50664063e-04 -9.94728480e-04]
 [-1.83624572e-03 -9.01743991e-02  3.70568077e-02  1.71218898e-04
   6.58247612e-05  4.21556498e-04]
 [ 5.92533720e-07 -4.10980757e-04  1.71218898e-04  1.36651539e-06
   1.85903178e-07  2.20164400e-06]
 [-5.86057003e-06 -1.50664063e-04  6.58247612e-05  1.85903178e-07
   9.83277330e-07  6.65819177e-07]
 [-1.70820642e-05 -9.94728480e-04  4.21556498e-04  2.20164400e-06
   6.65819177e-07  5.51915307e-06]]
[[ 1.56416005]
 [-0.39867888]
 [14.17744112]]
[[ 1.02115101e-05]
 [-3.76550942e-05]
 [ 7.53093831e-01]]


 Corrector Step
2018-07-12 20:19:10
[[ 4.74792395e+03]
 [ 3.31429535e+03]
 [-4.16185257e+03]
 [-3.88866248e+00]
 [-1.99881395e+00]
 [-6.05486646e+00]]
[[ 4.40463874e-04  4.67591429e-03 -1.83624572e-03  5.92533720e-07
  -5.86057003e-06 -1.70820642e-05]
 [ 4.67591429e-03  2.23063920e-01 -9.01743991e-02 -4.10980757e-04
  -1.50664063e-04 -9.94728480e-04]
 [-1.83624572e-03 -9.01743991e-02  3.70568077e-02  1.71218898e-04
   6.58247612e-05  4.21556498e-04]
 [ 5.92533720e-07 -4.10980757e-04  1.71218898e-04  1.36651539e-06
   1.85903178e-07  2.20164400e-06]
 [-5.86057003e-06 -1.50664063e-04  6.58247612e-05  1.85903178e-07
   9.83277330e-07  6.65819177e-07]
 [-1.70820642e-05 -9.94728480e-04  4.21556498e-04  2.20164400e-06
   6.65819177e-07  5.51915307e-06]]
0.00014028805221994858
post
sphere_lamr_small
Ybar_post [[ 1.56416907]
 [-0.39870256]
 [14.17703861]]
resids [[ 1.18674580e-06]
 [-1.39736538e-05]
 [ 7.53496338e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [430484266.2569503, 0.00014028805221994858]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.74791270e+03],
       [ 3.31353027e+03],
       [-4.16155792e+03],
       [-3.88891358e+00],
       [-1.99800626e+00],
       [-6.05321018e+00]]), 'est_covars': array([[ 4.27788382e-04,  4.04990680e-03, -1.59786923e-03,
         5.02564900e-07, -5.22281529e-06, -1.60673525e-05],
       [ 4.04990680e-03,  1.93517311e-01, -7.87010031e-02,
        -4.10084860e-04, -1.22860830e-04, -9.26818855e-04],
       [-1.59786923e-03, -7.87010031e-02,  3.25987895e-02,
         1.70942214e-04,  5.50908041e-05,  3.95311360e-04],
       [ 5.02564900e-07, -4.10084860e-04,  1.70942214e-04,
         1.43227837e-06,  1.87199847e-07,  2.24088832e-06],
       [-5.22281529e-06, -1.22860830e-04,  5.50908041e-05,
         1.87199847e-07,  9.94780240e-07,  5.96670202e-07],
       [-1.60673525e-05, -9.26818855e-04,  3.95311360e-04,
         2.24088832e-06,  5.96670202e-07,  5.42570626e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.74792395e+03],
       [ 3.31429535e+03],
       [-4.16185257e+03],
       [-3.88866248e+00],
       [-1.99881395e+00],
       [-6.05486646e+00]]), 'covar': array([[ 4.40463874e-04,  4.67591429e-03, -1.83624572e-03,
         5.92533720e-07, -5.86057003e-06, -1.70820642e-05],
       [ 4.67591429e-03,  2.23063920e-01, -9.01743991e-02,
        -4.10980757e-04, -1.50664063e-04, -9.94728480e-04],
       [-1.83624572e-03, -9.01743991e-02,  3.70568077e-02,
         1.71218898e-04,  6.58247612e-05,  4.21556498e-04],
       [ 5.92533720e-07, -4.10980757e-04,  1.71218898e-04,
         1.36651539e-06,  1.85903178e-07,  2.20164400e-06],
       [-5.86057003e-06, -1.50664063e-04,  6.58247612e-05,
         1.85903178e-07,  9.83277330e-07,  6.65819177e-07],
       [-1.70820642e-05, -9.94728480e-04,  4.21556498e-04,
         2.20164400e-06,  6.65819177e-07,  5.51915307e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.18674580e-06],
       [-1.39736538e-05],
       [ 7.53496338e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.74791270e+03],
       [ 3.31353027e+03],
       [-4.16155792e+03],
       [-3.88891358e+00],
       [-1.99800626e+00],
       [-6.05321018e+00],
       [ 5.46666083e-01],
       [ 1.86430193e-01],
       [-7.88726082e-01],
       [ 2.10502125e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78621773e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.27788382e-04,  4.04990680e-03, -1.59786923e-03,
         5.02564900e-07, -5.22281529e-06, -1.60673525e-05],
       [ 4.04990680e-03,  1.93517311e-01, -7.87010031e-02,
        -4.10084860e-04, -1.22860830e-04, -9.26818855e-04],
       [-1.59786923e-03, -7.87010031e-02,  3.25987895e-02,
         1.70942214e-04,  5.50908041e-05,  3.95311360e-04],
       [ 5.02564900e-07, -4.10084860e-04,  1.70942214e-04,
         1.43227837e-06,  1.87199847e-07,  2.24088832e-06],
       [-5.22281529e-06, -1.22860830e-04,  5.50908041e-05,
         1.87199847e-07,  9.94780240e-07,  5.96670202e-07],
       [-1.60673525e-05, -9.26818855e-04,  3.95311360e-04,
         2.24088832e-06,  5.96670202e-07,  5.42570626e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-4.14459150e-06],
       [ 6.29388381e-06],
       [-6.53050407e-03]])}}
Current time:  2018-07-12 20:19:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.74791270e+03],
       [ 3.31353027e+03],
       [-4.16155792e+03],
       [-3.88891358e+00],
       [-1.99800626e+00],
       [-6.05321018e+00],
       [ 5.46666083e-01],
       [ 1.86430193e-01],
       [-7.88726082e-01],
       [ 2.10502125e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78621773e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.27788382e-04,  4.04990680e-03, -1.59786923e-03,
         5.02564900e-07, -5.22281529e-06, -1.60673525e-05],
       [ 4.04990680e-03,  1.93517311e-01, -7.87010031e-02,
        -4.10084860e-04, -1.22860830e-04, -9.26818855e-04],
       [-1.59786923e-03, -7.87010031e-02,  3.25987895e-02,
         1.70942214e-04,  5.50908041e-05,  3.95311360e-04],
       [ 5.02564900e-07, -4.10084860e-04,  1.70942214e-04,
         1.43227837e-06,  1.87199847e-07,  2.24088832e-06],
       [-5.22281529e-06, -1.22860830e-04,  5.50908041e-05,
         1.87199847e-07,  9.94780240e-07,  5.96670202e-07],
       [-1.60673525e-05, -9.26818855e-04,  3.95311360e-04,
         2.24088832e-06,  5.96670202e-07,  5.42570626e-06]])}
[[ 4.74791270e+03]
 [ 3.31353027e+03]
 [-4.16155792e+03]
 [-3.88891358e+00]
 [-1.99800626e+00]
 [-6.05321018e+00]
 [ 5.46666083e-01]
 [ 1.86430193e-01]
 [-7.88726082e-01]
 [ 2.10502125e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78621773e-19]]
2018-07-12 20:19:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:20
[[ 4.70876354e+03]
 [ 3.29336861e+03]
 [-4.22185965e+03]
 [-3.94085424e+00]
 [-2.03429450e+00]
 [-6.00704419e+00]
 [ 5.42540446e-01]
 [ 1.85328555e-01]
 [-7.91569645e-01]
 [ 2.11472666e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78834060e-19]]
[[ 5.81298863e-04 -6.94488550e-05  1.68022260e-04  1.48426962e-05
  -3.35653782e-06  6.26195015e-06]
 [-6.94488550e-05  1.91159878e-01 -8.73676092e-02 -4.05203085e-04
  -1.12851893e-04 -9.22640406e-04]
 [ 1.68022260e-04 -8.73676092e-02  4.10560534e-02  1.91981302e-04
   6.10504219e-05  4.50477912e-04]
 [ 1.48426962e-05 -4.05203085e-04  1.91981302e-04  1.42942033e-06
   1.85291220e-07  2.22973397e-06]
 [-3.35653782e-06 -1.12851893e-04  6.10504219e-05  1.85291220e-07
   1.00457434e-06  5.97589265e-07]
 [ 6.26195015e-06 -9.22640406e-04  4.50477912e-04  2.22973397e-06
   5.97589265e-07  5.45285274e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.74792395e+03],
       [ 3.31429535e+03],
       [-4.16185257e+03],
       [-3.88866248e+00],
       [-1.99881395e+00],
       [-6.05486646e+00]]), 'covar': array([[ 4.40463874e-04,  4.67591429e-03, -1.83624572e-03,
         5.92533720e-07, -5.86057003e-06, -1.70820642e-05],
       [ 4.67591429e-03,  2.23063920e-01, -9.01743991e-02,
        -4.10980757e-04, -1.50664063e-04, -9.94728480e-04],
       [-1.83624572e-03, -9.01743991e-02,  3.70568077e-02,
         1.71218898e-04,  6.58247612e-05,  4.21556498e-04],
       [ 5.92533720e-07, -4.10980757e-04,  1.71218898e-04,
         1.36651539e-06,  1.85903178e-07,  2.20164400e-06],
       [-5.86057003e-06, -1.50664063e-04,  6.58247612e-05,
         1.85903178e-07,  9.83277330e-07,  6.65819177e-07],
       [-1.70820642e-05, -9.94728480e-04,  4.21556498e-04,
         2.20164400e-06,  6.65819177e-07,  5.51915307e-06]])}
[[ 4.74792395e+03]
 [ 3.31429535e+03]
 [-4.16185257e+03]
 [-3.88866248e+00]
 [-1.99881395e+00]
 [-6.05486646e+00]]
2018-07-12 20:19:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:20
[[ 4.70877726e+03]
 [ 3.29412541e+03]
 [-4.22217086e+03]
 [-3.94059151e+00]
 [-2.03510232e+00]
 [-6.00870792e+00]]
[[ 5.89074987e-04  5.43369979e-04 -8.26411957e-05  1.42348633e-05
  -4.00951671e-06  4.84388113e-06]
 [ 5.43369979e-04  2.20149086e-01 -9.94072978e-02 -4.05665585e-04
  -1.40821971e-04 -9.90133595e-04]
 [-8.26411957e-05 -9.94072978e-02  4.60492377e-02  1.91680303e-04
   7.24781952e-05  4.77725227e-04]
 [ 1.42348633e-05 -4.05665585e-04  1.91680303e-04  1.35374487e-06
   1.83567889e-07  2.18946871e-06]
 [-4.00951671e-06 -1.40821971e-04  7.24781952e-05  1.83567889e-07
   9.83177044e-07  6.67011914e-07]
 [ 4.84388113e-06 -9.90133595e-04  4.77725227e-04  2.18946871e-06
   6.67011914e-07  5.53767106e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.70877726e+03],
       [ 3.29412541e+03],
       [-4.22217086e+03],
       [-3.94059151e+00],
       [-2.03510232e+00],
       [-6.00870792e+00]]), 'covar': array([[ 5.89074987e-04,  5.43369979e-04, -8.26411957e-05,
         1.42348633e-05, -4.00951671e-06,  4.84388113e-06],
       [ 5.43369979e-04,  2.20149086e-01, -9.94072978e-02,
        -4.05665585e-04, -1.40821971e-04, -9.90133595e-04],
       [-8.26411957e-05, -9.94072978e-02,  4.60492377e-02,
         1.91680303e-04,  7.24781952e-05,  4.77725227e-04],
       [ 1.42348633e-05, -4.05665585e-04,  1.91680303e-04,
         1.35374487e-06,  1.83567889e-07,  2.18946871e-06],
       [-4.00951671e-06, -1.40821971e-04,  7.24781952e-05,
         1.83567889e-07,  9.83177044e-07,  6.67011914e-07],
       [ 4.84388113e-06, -9.90133595e-04,  4.77725227e-04,
         2.18946871e-06,  6.67011914e-07,  5.53767106e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.18674580e-06],
       [-1.39736538e-05],
       [ 7.53496338e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.70876354e+03],
       [ 3.29336861e+03],
       [-4.22185965e+03],
       [-3.94085424e+00],
       [-2.03429450e+00],
       [-6.00704419e+00],
       [ 5.42540446e-01],
       [ 1.85328555e-01],
       [-7.91569645e-01],
       [ 2.11472666e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78834060e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.81298863e-04, -6.94488550e-05,  1.68022260e-04,
         1.48426962e-05, -3.35653782e-06,  6.26195015e-06],
       [-6.94488550e-05,  1.91159878e-01, -8.73676092e-02,
        -4.05203085e-04, -1.12851893e-04, -9.22640406e-04],
       [ 1.68022260e-04, -8.73676092e-02,  4.10560534e-02,
         1.91981302e-04,  6.10504219e-05,  4.50477912e-04],
       [ 1.48426962e-05, -4.05203085e-04,  1.91981302e-04,
         1.42942033e-06,  1.85291220e-07,  2.22973397e-06],
       [-3.35653782e-06, -1.12851893e-04,  6.10504219e-05,
         1.85291220e-07,  1.00457434e-06,  5.97589265e-07],
       [ 6.26195015e-06, -9.22640406e-04,  4.50477912e-04,
         2.22973397e-06,  5.97589265e-07,  5.45285274e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-4.14459150e-06],
       [ 6.29388381e-06],
       [-6.53050407e-03]])}}
Yi [[ 1.5970855 ]
 [-0.44993524]
 [14.63583387]]
posterior
[[ 4.70876354e+03]
 [ 3.29336861e+03]
 [-4.22185965e+03]
 [-3.94085424e+00]
 [-2.03429450e+00]
 [-6.00704419e+00]
 [ 5.42540446e-01]
 [ 1.85328555e-01]
 [-7.91569645e-01]
 [ 2.11472666e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78834060e-19]]
[[ 4.70876999e+03]
 [ 3.29339513e+03]
 [-4.22187981e+03]
 [-3.94077640e+00]
 [-2.03443761e+00]
 [-6.00734576e+00]
 [ 5.42540446e-01]
 [ 1.85328555e-01]
 [-7.91569645e-01]
 [ 2.11472666e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78834060e-19]]
[[ 3.52545832e-04 -2.06951925e-03  1.01631511e-03  1.32439447e-05
  -9.47311923e-07  1.32744536e-05]
 [-2.06951925e-03  1.67429965e-01 -7.88741869e-02 -4.11433962e-04
  -1.04765621e-04 -8.75726398e-04]
 [ 1.01631511e-03 -7.88741869e-02  3.77235763e-02  1.96570659e-04
   5.43440289e-05  4.26928893e-04]
 [ 1.32439447e-05 -4.11433962e-04  1.96570659e-04  1.40862108e-06
   2.18205419e-07  2.29653107e-06]
 [-9.47311923e-07 -1.04765621e-04  5.43440289e-05  2.18205419e-07
   9.52121833e-07  4.93541799e-07]
 [ 1.32744536e-05 -8.75726398e-04  4.26928893e-04  2.29653107e-06
   4.93541799e-07  5.20398636e-06]]
[[ 1.59710047]
 [-0.4499227 ]
 [14.50367498]]
[[-1.49654312e-05]
 [-1.25394695e-05]
 [ 1.32158882e-01]]


 Corrector Step
2018-07-12 20:19:20
[[ 4.70876999e+03]
 [ 3.29339513e+03]
 [-4.22187981e+03]
 [-3.94077640e+00]
 [-2.03443761e+00]
 [-6.00734576e+00]
 [ 5.42540446e-01]
 [ 1.85328555e-01]
 [-7.91569645e-01]
 [ 2.11472666e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78834060e-19]]
[[ 3.52545832e-04 -2.06951925e-03  1.01631511e-03  1.32439447e-05
  -9.47311923e-07  1.32744536e-05]
 [-2.06951925e-03  1.67429965e-01 -7.88741869e-02 -4.11433962e-04
  -1.04765621e-04 -8.75726398e-04]
 [ 1.01631511e-03 -7.88741869e-02  3.77235763e-02  1.96570659e-04
   5.43440289e-05  4.26928893e-04]
 [ 1.32439447e-05 -4.11433962e-04  1.96570659e-04  1.40862108e-06
   2.18205419e-07  2.29653107e-06]
 [-9.47311923e-07 -1.04765621e-04  5.43440289e-05  2.18205419e-07
   9.52121833e-07  4.93541799e-07]
 [ 1.32744536e-05 -8.75726398e-04  4.26928893e-04  2.29653107e-06
   4.93541799e-07  5.20398636e-06]]
188182915.80087063
post
cubesat_nadir
Ybar_post [[ 1.59709424]
 [-0.44992802]
 [14.50372922]]
resids [[-8.73805174e-06]
 [-7.22684024e-06]
 [ 1.32104643e-01]]
posterior
[[ 4.70877726e+03]
 [ 3.29412541e+03]
 [-4.22217086e+03]
 [-3.94059151e+00]
 [-2.03510232e+00]
 [-6.00870792e+00]]
[[ 4.70876957e+03]
 [ 3.29392698e+03]
 [-4.22211441e+03]
 [-3.94053213e+00]
 [-2.03520674e+00]
 [-6.00870292e+00]]
[[ 3.50761410e-04 -2.02493683e-03  9.97675763e-04  1.28956717e-05
  -1.05577144e-06  1.31300888e-05]
 [-2.02493683e-03  1.82030607e-01 -8.53471979e-02 -4.09029310e-04
  -1.22893519e-04 -9.12564427e-04]
 [ 9.97675763e-04 -8.53471979e-02  4.05913376e-02  1.95184798e-04
   6.23008280e-05  4.42858046e-04]
 [ 1.28956717e-05 -4.09029310e-04  1.95184798e-04  1.33447174e-06
   2.14880212e-07  2.24839037e-06]
 [-1.05577144e-06 -1.22893519e-04  6.23008280e-05  2.14880212e-07
   9.27985094e-07  5.48499764e-07]
 [ 1.31300888e-05 -9.12564427e-04  4.42858046e-04  2.24839037e-06
   5.48499764e-07  5.23583886e-06]]
[[ 1.59707093]
 [-0.44988421]
 [14.06814098]]
[[ 1.45686703e-05]
 [-5.10366194e-05]
 [ 5.67692882e-01]]


 Corrector Step
2018-07-12 20:19:20
[[ 4.70876957e+03]
 [ 3.29392698e+03]
 [-4.22211441e+03]
 [-3.94053213e+00]
 [-2.03520674e+00]
 [-6.00870292e+00]]
[[ 3.50761410e-04 -2.02493683e-03  9.97675763e-04  1.28956717e-05
  -1.05577144e-06  1.31300888e-05]
 [-2.02493683e-03  1.82030607e-01 -8.53471979e-02 -4.09029310e-04
  -1.22893519e-04 -9.12564427e-04]
 [ 9.97675763e-04 -8.53471979e-02  4.05913376e-02  1.95184798e-04
   6.23008280e-05  4.42858046e-04]
 [ 1.28956717e-05 -4.09029310e-04  1.95184798e-04  1.33447174e-06
   2.14880212e-07  2.24839037e-06]
 [-1.05577144e-06 -1.22893519e-04  6.23008280e-05  2.14880212e-07
   9.27985094e-07  5.48499764e-07]
 [ 1.31300888e-05 -9.12564427e-04  4.42858046e-04  2.24839037e-06
   5.48499764e-07  5.23583886e-06]]
18.344101623970708
post
sphere_lamr_small
Ybar_post [[ 1.59708231]
 [-0.4499122 ]
 [14.06771994]]
resids [[ 3.19343754e-06]
 [-2.30427553e-05]
 [ 5.68113928e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [188182915.80087063, 18.344101623970708]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.70876999e+03],
       [ 3.29339513e+03],
       [-4.22187981e+03],
       [-3.94077640e+00],
       [-2.03443761e+00],
       [-6.00734576e+00]]), 'est_covars': array([[ 3.52545832e-04, -2.06951925e-03,  1.01631511e-03,
         1.32439447e-05, -9.47311923e-07,  1.32744536e-05],
       [-2.06951925e-03,  1.67429965e-01, -7.88741869e-02,
        -4.11433962e-04, -1.04765621e-04, -8.75726398e-04],
       [ 1.01631511e-03, -7.88741869e-02,  3.77235763e-02,
         1.96570659e-04,  5.43440289e-05,  4.26928893e-04],
       [ 1.32439447e-05, -4.11433962e-04,  1.96570659e-04,
         1.40862108e-06,  2.18205419e-07,  2.29653107e-06],
       [-9.47311923e-07, -1.04765621e-04,  5.43440289e-05,
         2.18205419e-07,  9.52121833e-07,  4.93541799e-07],
       [ 1.32744536e-05, -8.75726398e-04,  4.26928893e-04,
         2.29653107e-06,  4.93541799e-07,  5.20398636e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.70876957e+03],
       [ 3.29392698e+03],
       [-4.22211441e+03],
       [-3.94053213e+00],
       [-2.03520674e+00],
       [-6.00870292e+00]]), 'covar': array([[ 3.50761410e-04, -2.02493683e-03,  9.97675763e-04,
         1.28956717e-05, -1.05577144e-06,  1.31300888e-05],
       [-2.02493683e-03,  1.82030607e-01, -8.53471979e-02,
        -4.09029310e-04, -1.22893519e-04, -9.12564427e-04],
       [ 9.97675763e-04, -8.53471979e-02,  4.05913376e-02,
         1.95184798e-04,  6.23008280e-05,  4.42858046e-04],
       [ 1.28956717e-05, -4.09029310e-04,  1.95184798e-04,
         1.33447174e-06,  2.14880212e-07,  2.24839037e-06],
       [-1.05577144e-06, -1.22893519e-04,  6.23008280e-05,
         2.14880212e-07,  9.27985094e-07,  5.48499764e-07],
       [ 1.31300888e-05, -9.12564427e-04,  4.42858046e-04,
         2.24839037e-06,  5.48499764e-07,  5.23583886e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 3.19343754e-06],
       [-2.30427553e-05],
       [ 5.68113928e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.70876999e+03],
       [ 3.29339513e+03],
       [-4.22187981e+03],
       [-3.94077640e+00],
       [-2.03443761e+00],
       [-6.00734576e+00],
       [ 5.42540446e-01],
       [ 1.85328555e-01],
       [-7.91569645e-01],
       [ 2.11472666e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78834060e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.52545832e-04, -2.06951925e-03,  1.01631511e-03,
         1.32439447e-05, -9.47311923e-07,  1.32744536e-05],
       [-2.06951925e-03,  1.67429965e-01, -7.88741869e-02,
        -4.11433962e-04, -1.04765621e-04, -8.75726398e-04],
       [ 1.01631511e-03, -7.88741869e-02,  3.77235763e-02,
         1.96570659e-04,  5.43440289e-05,  4.26928893e-04],
       [ 1.32439447e-05, -4.11433962e-04,  1.96570659e-04,
         1.40862108e-06,  2.18205419e-07,  2.29653107e-06],
       [-9.47311923e-07, -1.04765621e-04,  5.43440289e-05,
         2.18205419e-07,  9.52121833e-07,  4.93541799e-07],
       [ 1.32744536e-05, -8.75726398e-04,  4.26928893e-04,
         2.29653107e-06,  4.93541799e-07,  5.20398636e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.73805174e-06],
       [-7.22684024e-06],
       [ 1.32104643e-01]])}}
Current time:  2018-07-12 20:19:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.70876999e+03],
       [ 3.29339513e+03],
       [-4.22187981e+03],
       [-3.94077640e+00],
       [-2.03443761e+00],
       [-6.00734576e+00],
       [ 5.42540446e-01],
       [ 1.85328555e-01],
       [-7.91569645e-01],
       [ 2.11472666e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.78834060e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.52545832e-04, -2.06951925e-03,  1.01631511e-03,
         1.32439447e-05, -9.47311923e-07,  1.32744536e-05],
       [-2.06951925e-03,  1.67429965e-01, -7.88741869e-02,
        -4.11433962e-04, -1.04765621e-04, -8.75726398e-04],
       [ 1.01631511e-03, -7.88741869e-02,  3.77235763e-02,
         1.96570659e-04,  5.43440289e-05,  4.26928893e-04],
       [ 1.32439447e-05, -4.11433962e-04,  1.96570659e-04,
         1.40862108e-06,  2.18205419e-07,  2.29653107e-06],
       [-9.47311923e-07, -1.04765621e-04,  5.43440289e-05,
         2.18205419e-07,  9.52121833e-07,  4.93541799e-07],
       [ 1.32744536e-05, -8.75726398e-04,  4.26928893e-04,
         2.29653107e-06,  4.93541799e-07,  5.20398636e-06]])}
[[ 4.70876999e+03]
 [ 3.29339513e+03]
 [-4.22187981e+03]
 [-3.94077640e+00]
 [-2.03443761e+00]
 [-6.00734576e+00]
 [ 5.42540446e-01]
 [ 1.85328555e-01]
 [-7.91569645e-01]
 [ 2.11472666e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.78834060e-19]]
2018-07-12 20:19:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:30
[[ 4.66910409e+03]
 [ 3.27287011e+03]
 [-4.28171970e+03]
 [-3.99227706e+00]
 [-2.07049774e+00]
 [-5.96052487e+00]
 [ 5.38400017e-01]
 [ 1.84221863e-01]
 [-7.94391629e-01]
 [ 2.12437441e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79046346e-19]]
[[ 7.57726049e-04 -6.15789443e-03  3.33751617e-03  2.72464268e-05
   1.22831078e-06  3.62181436e-05]
 [-6.15789443e-03  1.65430568e-01 -8.70463822e-02 -4.06543171e-04
  -9.51520692e-05 -8.72307910e-04]
 [ 3.33751617e-03 -8.70463822e-02  4.67907927e-02  2.18117087e-04
   5.92546316e-05  4.79856068e-04]
 [ 2.72464268e-05 -4.06543171e-04  2.18117087e-04  1.40523860e-06
   2.16437550e-07  2.28564796e-06]
 [ 1.22831078e-06 -9.51520692e-05  5.92546316e-05  2.16437550e-07
   9.61897094e-07  4.94134326e-07]
 [ 3.62181436e-05 -8.72307910e-04  4.79856068e-04  2.28564796e-06
   4.94134326e-07  5.22990205e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.70876957e+03],
       [ 3.29392698e+03],
       [-4.22211441e+03],
       [-3.94053213e+00],
       [-2.03520674e+00],
       [-6.00870292e+00]]), 'covar': array([[ 3.50761410e-04, -2.02493683e-03,  9.97675763e-04,
         1.28956717e-05, -1.05577144e-06,  1.31300888e-05],
       [-2.02493683e-03,  1.82030607e-01, -8.53471979e-02,
        -4.09029310e-04, -1.22893519e-04, -9.12564427e-04],
       [ 9.97675763e-04, -8.53471979e-02,  4.05913376e-02,
         1.95184798e-04,  6.23008280e-05,  4.42858046e-04],
       [ 1.28956717e-05, -4.09029310e-04,  1.95184798e-04,
         1.33447174e-06,  2.14880212e-07,  2.24839037e-06],
       [-1.05577144e-06, -1.22893519e-04,  6.23008280e-05,
         2.14880212e-07,  9.27985094e-07,  5.48499764e-07],
       [ 1.31300888e-05, -9.12564427e-04,  4.42858046e-04,
         2.24839037e-06,  5.48499764e-07,  5.23583886e-06]])}
[[ 4.70876957e+03]
 [ 3.29392698e+03]
 [-4.22211441e+03]
 [-3.94053213e+00]
 [-2.03520674e+00]
 [-6.00870292e+00]]
2018-07-12 20:19:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:30
[[ 4.66910631e+03]
 [ 3.27339432e+03]
 [-4.28196802e+03]
 [-3.99202429e+00]
 [-2.07126682e+00]
 [-5.96188686e+00]]
[[ 7.41172935e-04 -6.08962615e-03  3.29825518e-03  2.61085065e-05
   1.08512425e-06  3.55888802e-05]
 [-6.08962615e-03  1.79665980e-01 -9.38033508e-02 -4.03944318e-04
  -1.13567821e-04 -9.08732115e-04]
 [ 3.29825518e-03 -9.38033508e-02  4.99807440e-02  2.16141859e-04
   6.77604886e-05  4.96120368e-04]
 [ 2.61085065e-05 -4.03944318e-04  2.16141859e-04  1.32128008e-06
   2.12821288e-07  2.23692015e-06]
 [ 1.08512425e-06 -1.13567821e-04  6.77604886e-05  2.12821288e-07
   9.27854626e-07  5.49261012e-07]
 [ 3.55888802e-05 -9.08732115e-04  4.96120368e-04  2.23692015e-06
   5.49261012e-07  5.25255305e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.66910631e+03],
       [ 3.27339432e+03],
       [-4.28196802e+03],
       [-3.99202429e+00],
       [-2.07126682e+00],
       [-5.96188686e+00]]), 'covar': array([[ 7.41172935e-04, -6.08962615e-03,  3.29825518e-03,
         2.61085065e-05,  1.08512425e-06,  3.55888802e-05],
       [-6.08962615e-03,  1.79665980e-01, -9.38033508e-02,
        -4.03944318e-04, -1.13567821e-04, -9.08732115e-04],
       [ 3.29825518e-03, -9.38033508e-02,  4.99807440e-02,
         2.16141859e-04,  6.77604886e-05,  4.96120368e-04],
       [ 2.61085065e-05, -4.03944318e-04,  2.16141859e-04,
         1.32128008e-06,  2.12821288e-07,  2.23692015e-06],
       [ 1.08512425e-06, -1.13567821e-04,  6.77604886e-05,
         2.12821288e-07,  9.27854626e-07,  5.49261012e-07],
       [ 3.55888802e-05, -9.08732115e-04,  4.96120368e-04,
         2.23692015e-06,  5.49261012e-07,  5.25255305e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 3.19343754e-06],
       [-2.30427553e-05],
       [ 5.68113928e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.66910409e+03],
       [ 3.27287011e+03],
       [-4.28171970e+03],
       [-3.99227706e+00],
       [-2.07049774e+00],
       [-5.96052487e+00],
       [ 5.38400017e-01],
       [ 1.84221863e-01],
       [-7.94391629e-01],
       [ 2.12437441e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79046346e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.57726049e-04, -6.15789443e-03,  3.33751617e-03,
         2.72464268e-05,  1.22831078e-06,  3.62181436e-05],
       [-6.15789443e-03,  1.65430568e-01, -8.70463822e-02,
        -4.06543171e-04, -9.51520692e-05, -8.72307910e-04],
       [ 3.33751617e-03, -8.70463822e-02,  4.67907927e-02,
         2.18117087e-04,  5.92546316e-05,  4.79856068e-04],
       [ 2.72464268e-05, -4.06543171e-04,  2.18117087e-04,
         1.40523860e-06,  2.16437550e-07,  2.28564796e-06],
       [ 1.22831078e-06, -9.51520692e-05,  5.92546316e-05,
         2.16437550e-07,  9.61897094e-07,  4.94134326e-07],
       [ 3.62181436e-05, -8.72307910e-04,  4.79856068e-04,
         2.28564796e-06,  4.94134326e-07,  5.22990205e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.73805174e-06],
       [-7.22684024e-06],
       [ 1.32104643e-01]])}}
Yi [[ 1.6318136 ]
 [-0.50005434]
 [14.02829171]]
posterior
[[ 4.66910409e+03]
 [ 3.27287011e+03]
 [-4.28171970e+03]
 [-3.99227706e+00]
 [-2.07049774e+00]
 [-5.96052487e+00]
 [ 5.38400017e-01]
 [ 1.84221863e-01]
 [-7.94391629e-01]
 [ 2.12437441e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79046346e-19]]
[[ 4.66911330e+03]
 [ 3.27287393e+03]
 [-4.28174179e+03]
 [-3.99211624e+00]
 [-2.07075679e+00]
 [-5.96093171e+00]
 [ 5.38400017e-01]
 [ 1.84221863e-01]
 [-7.94391629e-01]
 [ 2.12437441e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79046346e-19]]
[[ 6.46754550e-04 -7.15312079e-03  3.87287262e-03  2.63786746e-05
   2.83445935e-06  4.12258005e-05]
 [-7.15312079e-03  1.50171772e-01 -8.05506743e-02 -4.07401820e-04
  -9.18646558e-05 -8.28813244e-04]
 [ 3.87287262e-03 -8.05506743e-02  4.37534626e-02  2.20448368e-04
   5.44678723e-05  4.56050041e-04]
 [ 2.63786746e-05 -4.07401820e-04  2.20448368e-04  1.39087892e-06
   2.41124601e-07  2.32629957e-06]
 [ 2.83445935e-06 -9.18646558e-05  5.44678723e-05  2.41124601e-07
   9.19011572e-07  4.18909093e-07]
 [ 4.12258005e-05 -8.28813244e-04  4.56050041e-04  2.32629957e-06
   4.18909093e-07  5.00306212e-06]]
[[ 1.63183594]
 [-0.50002123]
 [14.1479454 ]]
[[-2.23325190e-05]
 [-3.31053347e-05]
 [-1.19653694e-01]]


 Corrector Step
2018-07-12 20:19:30
[[ 4.66911330e+03]
 [ 3.27287393e+03]
 [-4.28174179e+03]
 [-3.99211624e+00]
 [-2.07075679e+00]
 [-5.96093171e+00]
 [ 5.38400017e-01]
 [ 1.84221863e-01]
 [-7.94391629e-01]
 [ 2.12437441e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79046346e-19]]
[[ 6.46754550e-04 -7.15312079e-03  3.87287262e-03  2.63786746e-05
   2.83445935e-06  4.12258005e-05]
 [-7.15312079e-03  1.50171772e-01 -8.05506743e-02 -4.07401820e-04
  -9.18646558e-05 -8.28813244e-04]
 [ 3.87287262e-03 -8.05506743e-02  4.37534626e-02  2.20448368e-04
   5.44678723e-05  4.56050041e-04]
 [ 2.63786746e-05 -4.07401820e-04  2.20448368e-04  1.39087892e-06
   2.41124601e-07  2.32629957e-06]
 [ 2.83445935e-06 -9.18646558e-05  5.44678723e-05  2.41124601e-07
   9.19011572e-07  4.18909093e-07]
 [ 4.12258005e-05 -8.28813244e-04  4.56050041e-04  2.32629957e-06
   4.18909093e-07  5.00306212e-06]]
128541691.945677
post
cubesat_nadir
Ybar_post [[ 1.63182759]
 [-0.50003528]
 [14.14794003]]
resids [[-1.39850209e-05]
 [-1.90569615e-05]
 [-1.19648321e-01]]
posterior
[[ 4.66910631e+03]
 [ 3.27339432e+03]
 [-4.28196802e+03]
 [-3.99202429e+00]
 [-2.07126682e+00]
 [-5.96188686e+00]]
[[ 4.66910761e+03]
 [ 3.27323270e+03]
 [-4.28192030e+03]
 [-3.99184850e+00]
 [-2.07147431e+00]
 [-5.96185851e+00]]
[[ 6.39067808e-04 -7.21260166e-03  3.89805208e-03  2.54918263e-05
   2.93334035e-06  4.09529540e-05]
 [-7.21260166e-03  1.56985912e-01 -8.39151638e-02 -4.00761093e-04
  -1.03659282e-04 -8.43193240e-04]
 [ 3.89805208e-03 -8.39151638e-02  4.54075156e-02  2.16586329e-04
   6.02142248e-05  4.62504151e-04]
 [ 2.54918263e-05 -4.00761093e-04  2.16586329e-04  1.30793446e-06
   2.34012295e-07  2.26295130e-06]
 [ 2.93334035e-06 -1.03659282e-04  6.02142248e-05  2.34012295e-07
   8.83806071e-07  4.58572028e-07]
 [ 4.09529540e-05 -8.43193240e-04  4.62504151e-04  2.26295130e-06
   4.58572028e-07  4.96616825e-06]]
[[ 1.63180533]
 [-0.49999536]
 [13.96613574]]
[[ 8.27446613e-06]
 [-5.89812011e-05]
 [ 6.21559698e-02]]


 Corrector Step
2018-07-12 20:19:30
[[ 4.66910761e+03]
 [ 3.27323270e+03]
 [-4.28192030e+03]
 [-3.99184850e+00]
 [-2.07147431e+00]
 [-5.96185851e+00]]
[[ 6.39067808e-04 -7.21260166e-03  3.89805208e-03  2.54918263e-05
   2.93334035e-06  4.09529540e-05]
 [-7.21260166e-03  1.56985912e-01 -8.39151638e-02 -4.00761093e-04
  -1.03659282e-04 -8.43193240e-04]
 [ 3.89805208e-03 -8.39151638e-02  4.54075156e-02  2.16586329e-04
   6.02142248e-05  4.62504151e-04]
 [ 2.54918263e-05 -4.00761093e-04  2.16586329e-04  1.30793446e-06
   2.34012295e-07  2.26295130e-06]
 [ 2.93334035e-06 -1.03659282e-04  6.02142248e-05  2.34012295e-07
   8.83806071e-07  4.58572028e-07]
 [ 4.09529540e-05 -8.43193240e-04  4.62504151e-04  2.26295130e-06
   4.58572028e-07  4.96616825e-06]]
98748539.59732322
post
sphere_lamr_small
Ybar_post [[ 1.63181306]
 [-0.50002332]
 [13.96577747]]
resids [[ 5.45256166e-07]
 [-3.10220605e-05]
 [ 6.25142392e-02]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [128541691.945677, 98748539.59732322]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.66911330e+03],
       [ 3.27287393e+03],
       [-4.28174179e+03],
       [-3.99211624e+00],
       [-2.07075679e+00],
       [-5.96093171e+00]]), 'est_covars': array([[ 6.46754550e-04, -7.15312079e-03,  3.87287262e-03,
         2.63786746e-05,  2.83445935e-06,  4.12258005e-05],
       [-7.15312079e-03,  1.50171772e-01, -8.05506743e-02,
        -4.07401820e-04, -9.18646558e-05, -8.28813244e-04],
       [ 3.87287262e-03, -8.05506743e-02,  4.37534626e-02,
         2.20448368e-04,  5.44678723e-05,  4.56050041e-04],
       [ 2.63786746e-05, -4.07401820e-04,  2.20448368e-04,
         1.39087892e-06,  2.41124601e-07,  2.32629957e-06],
       [ 2.83445935e-06, -9.18646558e-05,  5.44678723e-05,
         2.41124601e-07,  9.19011572e-07,  4.18909093e-07],
       [ 4.12258005e-05, -8.28813244e-04,  4.56050041e-04,
         2.32629957e-06,  4.18909093e-07,  5.00306212e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.66910761e+03],
       [ 3.27323270e+03],
       [-4.28192030e+03],
       [-3.99184850e+00],
       [-2.07147431e+00],
       [-5.96185851e+00]]), 'covar': array([[ 6.39067808e-04, -7.21260166e-03,  3.89805208e-03,
         2.54918263e-05,  2.93334035e-06,  4.09529540e-05],
       [-7.21260166e-03,  1.56985912e-01, -8.39151638e-02,
        -4.00761093e-04, -1.03659282e-04, -8.43193240e-04],
       [ 3.89805208e-03, -8.39151638e-02,  4.54075156e-02,
         2.16586329e-04,  6.02142248e-05,  4.62504151e-04],
       [ 2.54918263e-05, -4.00761093e-04,  2.16586329e-04,
         1.30793446e-06,  2.34012295e-07,  2.26295130e-06],
       [ 2.93334035e-06, -1.03659282e-04,  6.02142248e-05,
         2.34012295e-07,  8.83806071e-07,  4.58572028e-07],
       [ 4.09529540e-05, -8.43193240e-04,  4.62504151e-04,
         2.26295130e-06,  4.58572028e-07,  4.96616825e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 5.45256166e-07],
       [-3.10220605e-05],
       [ 6.25142392e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.66911330e+03],
       [ 3.27287393e+03],
       [-4.28174179e+03],
       [-3.99211624e+00],
       [-2.07075679e+00],
       [-5.96093171e+00],
       [ 5.38400017e-01],
       [ 1.84221863e-01],
       [-7.94391629e-01],
       [ 2.12437441e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79046346e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.46754550e-04, -7.15312079e-03,  3.87287262e-03,
         2.63786746e-05,  2.83445935e-06,  4.12258005e-05],
       [-7.15312079e-03,  1.50171772e-01, -8.05506743e-02,
        -4.07401820e-04, -9.18646558e-05, -8.28813244e-04],
       [ 3.87287262e-03, -8.05506743e-02,  4.37534626e-02,
         2.20448368e-04,  5.44678723e-05,  4.56050041e-04],
       [ 2.63786746e-05, -4.07401820e-04,  2.20448368e-04,
         1.39087892e-06,  2.41124601e-07,  2.32629957e-06],
       [ 2.83445935e-06, -9.18646558e-05,  5.44678723e-05,
         2.41124601e-07,  9.19011572e-07,  4.18909093e-07],
       [ 4.12258005e-05, -8.28813244e-04,  4.56050041e-04,
         2.32629957e-06,  4.18909093e-07,  5.00306212e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.39850209e-05],
       [-1.90569615e-05],
       [-1.19648321e-01]])}}
Current time:  2018-07-12 20:19:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.66911330e+03],
       [ 3.27287393e+03],
       [-4.28174179e+03],
       [-3.99211624e+00],
       [-2.07075679e+00],
       [-5.96093171e+00],
       [ 5.38400017e-01],
       [ 1.84221863e-01],
       [-7.94391629e-01],
       [ 2.12437441e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79046346e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.46754550e-04, -7.15312079e-03,  3.87287262e-03,
         2.63786746e-05,  2.83445935e-06,  4.12258005e-05],
       [-7.15312079e-03,  1.50171772e-01, -8.05506743e-02,
        -4.07401820e-04, -9.18646558e-05, -8.28813244e-04],
       [ 3.87287262e-03, -8.05506743e-02,  4.37534626e-02,
         2.20448368e-04,  5.44678723e-05,  4.56050041e-04],
       [ 2.63786746e-05, -4.07401820e-04,  2.20448368e-04,
         1.39087892e-06,  2.41124601e-07,  2.32629957e-06],
       [ 2.83445935e-06, -9.18646558e-05,  5.44678723e-05,
         2.41124601e-07,  9.19011572e-07,  4.18909093e-07],
       [ 4.12258005e-05, -8.28813244e-04,  4.56050041e-04,
         2.32629957e-06,  4.18909093e-07,  5.00306212e-06]])}
[[ 4.66911330e+03]
 [ 3.27287393e+03]
 [-4.28174179e+03]
 [-3.99211624e+00]
 [-2.07075679e+00]
 [-5.96093171e+00]
 [ 5.38400017e-01]
 [ 1.84221863e-01]
 [-7.94391629e-01]
 [ 2.12437441e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79046346e-19]]
2018-07-12 20:19:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:40
[[ 4.62893637e+03]
 [ 3.25198700e+03]
 [-4.34111406e+03]
 [-4.04317156e+00]
 [-2.10658464e+00]
 [-5.91346043e+00]
 [ 5.34244911e-01]
 [ 1.83110150e-01]
 [-7.97191956e-01]
 [ 2.13396426e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79258633e-19]]
[[ 1.31182909e-03 -1.11620950e-02  6.71509751e-03  4.01134706e-05
   5.23611976e-06  6.45129058e-05]
 [-1.11620950e-02  1.48427265e-01 -8.82591738e-02 -4.02464143e-04
  -8.25567921e-05 -8.25960335e-04]
 [ 6.71509751e-03 -8.82591738e-02  5.33831390e-02  2.42215568e-04
   5.86138151e-05  5.06961543e-04]
 [ 4.01134706e-05 -4.02464143e-04  2.42215568e-04  1.38711445e-06
   2.39418826e-07  2.31560178e-06]
 [ 5.23611976e-06 -8.25567921e-05  5.86138151e-05  2.39418826e-07
   9.28773351e-07  4.19230470e-07]
 [ 6.45129058e-05 -8.25960335e-04  5.06961543e-04  2.31560178e-06
   4.19230470e-07  5.02787027e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.66910761e+03],
       [ 3.27323270e+03],
       [-4.28192030e+03],
       [-3.99184850e+00],
       [-2.07147431e+00],
       [-5.96185851e+00]]), 'covar': array([[ 6.39067808e-04, -7.21260166e-03,  3.89805208e-03,
         2.54918263e-05,  2.93334035e-06,  4.09529540e-05],
       [-7.21260166e-03,  1.56985912e-01, -8.39151638e-02,
        -4.00761093e-04, -1.03659282e-04, -8.43193240e-04],
       [ 3.89805208e-03, -8.39151638e-02,  4.54075156e-02,
         2.16586329e-04,  6.02142248e-05,  4.62504151e-04],
       [ 2.54918263e-05, -4.00761093e-04,  2.16586329e-04,
         1.30793446e-06,  2.34012295e-07,  2.26295130e-06],
       [ 2.93334035e-06, -1.03659282e-04,  6.02142248e-05,
         2.34012295e-07,  8.83806071e-07,  4.58572028e-07],
       [ 4.09529540e-05, -8.43193240e-04,  4.62504151e-04,
         2.26295130e-06,  4.58572028e-07,  4.96616825e-06]])}
[[ 4.66910761e+03]
 [ 3.27323270e+03]
 [-4.28192030e+03]
 [-3.99184850e+00]
 [-2.07147431e+00]
 [-5.96185851e+00]]
2018-07-12 20:19:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:40
[[ 4.62893341e+03]
 [ 3.25233854e+03]
 [-4.34130193e+03]
 [-4.04289803e+00]
 [-2.10730199e+00]
 [-5.91439060e+00]]
[[ 1.27785681e-03 -1.11543341e-02  6.69234025e-03  3.83485432e-05
   5.26279526e-06  6.36057023e-05]
 [-1.11543341e-02  1.55001798e-01 -9.17063749e-02 -3.95785893e-04
  -9.47494265e-05 -8.40007742e-04]
 [ 6.69234025e-03 -9.17063749e-02  5.51625997e-02  2.37663042e-04
   6.47555146e-05  5.13031599e-04]
 [ 3.83485432e-05 -3.95785893e-04  2.37663042e-04  1.29450372e-06
   2.32110013e-07  2.25198344e-06]
 [ 5.26279526e-06 -9.47494265e-05  6.47555146e-05  2.32110013e-07
   8.83658449e-07  4.59002503e-07]
 [ 6.36057023e-05 -8.40007742e-04  5.13031599e-04  2.25198344e-06
   4.59002503e-07  4.98136491e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.62893341e+03],
       [ 3.25233854e+03],
       [-4.34130193e+03],
       [-4.04289803e+00],
       [-2.10730199e+00],
       [-5.91439060e+00]]), 'covar': array([[ 1.27785681e-03, -1.11543341e-02,  6.69234025e-03,
         3.83485432e-05,  5.26279526e-06,  6.36057023e-05],
       [-1.11543341e-02,  1.55001798e-01, -9.17063749e-02,
        -3.95785893e-04, -9.47494265e-05, -8.40007742e-04],
       [ 6.69234025e-03, -9.17063749e-02,  5.51625997e-02,
         2.37663042e-04,  6.47555146e-05,  5.13031599e-04],
       [ 3.83485432e-05, -3.95785893e-04,  2.37663042e-04,
         1.29450372e-06,  2.32110013e-07,  2.25198344e-06],
       [ 5.26279526e-06, -9.47494265e-05,  6.47555146e-05,
         2.32110013e-07,  8.83658449e-07,  4.59002503e-07],
       [ 6.36057023e-05, -8.40007742e-04,  5.13031599e-04,
         2.25198344e-06,  4.59002503e-07,  4.98136491e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 5.45256166e-07],
       [-3.10220605e-05],
       [ 6.25142392e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.62893637e+03],
       [ 3.25198700e+03],
       [-4.34111406e+03],
       [-4.04317156e+00],
       [-2.10658464e+00],
       [-5.91346043e+00],
       [ 5.34244911e-01],
       [ 1.83110150e-01],
       [-7.97191956e-01],
       [ 2.13396426e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79258633e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.31182909e-03, -1.11620950e-02,  6.71509751e-03,
         4.01134706e-05,  5.23611976e-06,  6.45129058e-05],
       [-1.11620950e-02,  1.48427265e-01, -8.82591738e-02,
        -4.02464143e-04, -8.25567921e-05, -8.25960335e-04],
       [ 6.71509751e-03, -8.82591738e-02,  5.33831390e-02,
         2.42215568e-04,  5.86138151e-05,  5.06961543e-04],
       [ 4.01134706e-05, -4.02464143e-04,  2.42215568e-04,
         1.38711445e-06,  2.39418826e-07,  2.31560178e-06],
       [ 5.23611976e-06, -8.25567921e-05,  5.86138151e-05,
         2.39418826e-07,  9.28773351e-07,  4.19230470e-07],
       [ 6.45129058e-05, -8.25960335e-04,  5.06961543e-04,
         2.31560178e-06,  4.19230470e-07,  5.02787027e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.39850209e-05],
       [-1.90569615e-05],
       [-1.19648321e-01]])}}
Yi [[ 1.6683756 ]
 [-0.54860793]
 [13.8917011 ]]
posterior
[[ 4.62893637e+03]
 [ 3.25198700e+03]
 [-4.34111406e+03]
 [-4.04317156e+00]
 [-2.10658464e+00]
 [-5.91346043e+00]
 [ 5.34244911e-01]
 [ 1.83110150e-01]
 [-7.97191956e-01]
 [ 2.13396426e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79258633e-19]]
[[ 4.62894259e+03]
 [ 3.25224617e+03]
 [-4.34123577e+03]
 [-4.04329799e+00]
 [-2.10647481e+00]
 [-5.91428321e+00]
 [ 5.34244911e-01]
 [ 1.83110150e-01]
 [-7.97191956e-01]
 [ 2.13396426e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79258633e-19]]
[[ 1.26061573e-03 -1.15638295e-02  7.00859083e-03  3.96032605e-05
   6.36815997e-06  6.75155146e-05]
 [-1.15638295e-02  1.36799032e-01 -8.25007770e-02 -3.98894928e-04
  -8.37674122e-05 -7.84149285e-04]
 [ 7.00859083e-03 -8.25007770e-02  5.02908228e-02  2.42050691e-04
   5.62267745e-05  4.82288583e-04]
 [ 3.96032605e-05 -3.98894928e-04  2.42050691e-04  1.37526616e-06
   2.59690003e-07  2.32917634e-06]
 [ 6.36815997e-06 -8.37674122e-05  5.62267745e-05  2.59690003e-07
   8.91589663e-07  3.74355954e-07]
 [ 6.75155146e-05 -7.84149285e-04  4.82288583e-04  2.32917634e-06
   3.74355954e-07  4.81212799e-06]]
[[ 1.66843733]
 [-0.54865959]
 [13.85598183]]
[[-6.17368311e-05]
 [ 5.16620424e-05]
 [ 3.57192748e-02]]


 Corrector Step
2018-07-12 20:19:40
[[ 4.62894259e+03]
 [ 3.25224617e+03]
 [-4.34123577e+03]
 [-4.04329799e+00]
 [-2.10647481e+00]
 [-5.91428321e+00]
 [ 5.34244911e-01]
 [ 1.83110150e-01]
 [-7.97191956e-01]
 [ 2.13396426e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79258633e-19]]
[[ 1.26061573e-03 -1.15638295e-02  7.00859083e-03  3.96032605e-05
   6.36815997e-06  6.75155146e-05]
 [-1.15638295e-02  1.36799032e-01 -8.25007770e-02 -3.98894928e-04
  -8.37674122e-05 -7.84149285e-04]
 [ 7.00859083e-03 -8.25007770e-02  5.02908228e-02  2.42050691e-04
   5.62267745e-05  4.82288583e-04]
 [ 3.96032605e-05 -3.98894928e-04  2.42050691e-04  1.37526616e-06
   2.59690003e-07  2.32917634e-06]
 [ 6.36815997e-06 -8.37674122e-05  5.62267745e-05  2.59690003e-07
   8.91589663e-07  3.74355954e-07]
 [ 6.75155146e-05 -7.84149285e-04  4.82288583e-04  2.32917634e-06
   3.74355954e-07  4.81212799e-06]]
30212661.648465313
post
cubesat_nadir
Ybar_post [[ 1.66840859]
 [-0.54863591]
 [13.85667228]]
resids [[-3.29955340e-05]
 [ 2.79796759e-05]
 [ 3.50288254e-02]]
posterior
[[ 4.62893341e+03]
 [ 3.25233854e+03]
 [-4.34130193e+03]
 [-4.04289803e+00]
 [-2.10730199e+00]
 [-5.91439060e+00]]
[[ 4.62893465e+03]
 [ 3.25251057e+03]
 [-4.34138262e+03]
 [-4.04302204e+00]
 [-2.10726464e+00]
 [-5.91491186e+00]]
[[ 1.23507468e-03 -1.14992293e-02  6.95759837e-03  3.79570831e-05
   6.45050220e-06  6.63205569e-05]
 [-1.14992293e-02  1.39019028e-01 -8.36292436e-02 -3.87942012e-04
  -9.11176536e-05 -7.82230847e-04]
 [ 6.95759837e-03 -8.36292436e-02  5.08455533e-02  2.35140449e-04
   6.00544176e-05  4.80036665e-04]
 [ 3.79570831e-05 -3.87942012e-04  2.35140449e-04  1.28175407e-06
   2.47910797e-07  2.24689026e-06]
 [ 6.45050220e-06 -9.11176536e-05  6.00544176e-05  2.47910797e-07
   8.47904543e-07  3.99608573e-07]
 [ 6.63205569e-05 -7.82230847e-04  4.80036665e-04  2.24689026e-06
   3.99608573e-07  4.71120702e-06]]
[[ 1.66840872]
 [-0.54864217]
 [13.87279367]]
[[-3.31266016e-05]
 [ 3.42425850e-05]
 [ 1.89074271e-02]]


 Corrector Step
2018-07-12 20:19:40
[[ 4.62893465e+03]
 [ 3.25251057e+03]
 [-4.34138262e+03]
 [-4.04302204e+00]
 [-2.10726464e+00]
 [-5.91491186e+00]]
[[ 1.23507468e-03 -1.14992293e-02  6.95759837e-03  3.79570831e-05
   6.45050220e-06  6.63205569e-05]
 [-1.14992293e-02  1.39019028e-01 -8.36292436e-02 -3.87942012e-04
  -9.11176536e-05 -7.82230847e-04]
 [ 6.95759837e-03 -8.36292436e-02  5.08455533e-02  2.35140449e-04
   6.00544176e-05  4.80036665e-04]
 [ 3.79570831e-05 -3.87942012e-04  2.35140449e-04  1.28175407e-06
   2.47910797e-07  2.24689026e-06]
 [ 6.45050220e-06 -9.11176536e-05  6.00544176e-05  2.47910797e-07
   8.47904543e-07  3.99608573e-07]
 [ 6.63205569e-05 -7.82230847e-04  4.80036665e-04  2.24689026e-06
   3.99608573e-07  4.71120702e-06]]
220363516.80670142
post
sphere_lamr_small
Ybar_post [[ 1.66839226]
 [-0.54862629]
 [13.87314659]]
resids [[-1.66648940e-05]
 [ 1.83606711e-05]
 [ 1.85545087e-02]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [30212661.648465313, 220363516.80670142]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.62894259e+03],
       [ 3.25224617e+03],
       [-4.34123577e+03],
       [-4.04329799e+00],
       [-2.10647481e+00],
       [-5.91428321e+00]]), 'est_covars': array([[ 1.26061573e-03, -1.15638295e-02,  7.00859083e-03,
         3.96032605e-05,  6.36815997e-06,  6.75155146e-05],
       [-1.15638295e-02,  1.36799032e-01, -8.25007770e-02,
        -3.98894928e-04, -8.37674122e-05, -7.84149285e-04],
       [ 7.00859083e-03, -8.25007770e-02,  5.02908228e-02,
         2.42050691e-04,  5.62267745e-05,  4.82288583e-04],
       [ 3.96032605e-05, -3.98894928e-04,  2.42050691e-04,
         1.37526616e-06,  2.59690003e-07,  2.32917634e-06],
       [ 6.36815997e-06, -8.37674122e-05,  5.62267745e-05,
         2.59690003e-07,  8.91589663e-07,  3.74355954e-07],
       [ 6.75155146e-05, -7.84149285e-04,  4.82288583e-04,
         2.32917634e-06,  3.74355954e-07,  4.81212799e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.62893465e+03],
       [ 3.25251057e+03],
       [-4.34138262e+03],
       [-4.04302204e+00],
       [-2.10726464e+00],
       [-5.91491186e+00]]), 'covar': array([[ 1.23507468e-03, -1.14992293e-02,  6.95759837e-03,
         3.79570831e-05,  6.45050220e-06,  6.63205569e-05],
       [-1.14992293e-02,  1.39019028e-01, -8.36292436e-02,
        -3.87942012e-04, -9.11176536e-05, -7.82230847e-04],
       [ 6.95759837e-03, -8.36292436e-02,  5.08455533e-02,
         2.35140449e-04,  6.00544176e-05,  4.80036665e-04],
       [ 3.79570831e-05, -3.87942012e-04,  2.35140449e-04,
         1.28175407e-06,  2.47910797e-07,  2.24689026e-06],
       [ 6.45050220e-06, -9.11176536e-05,  6.00544176e-05,
         2.47910797e-07,  8.47904543e-07,  3.99608573e-07],
       [ 6.63205569e-05, -7.82230847e-04,  4.80036665e-04,
         2.24689026e-06,  3.99608573e-07,  4.71120702e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.66648940e-05],
       [ 1.83606711e-05],
       [ 1.85545087e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.62894259e+03],
       [ 3.25224617e+03],
       [-4.34123577e+03],
       [-4.04329799e+00],
       [-2.10647481e+00],
       [-5.91428321e+00],
       [ 5.34244911e-01],
       [ 1.83110150e-01],
       [-7.97191956e-01],
       [ 2.13396426e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79258633e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.26061573e-03, -1.15638295e-02,  7.00859083e-03,
         3.96032605e-05,  6.36815997e-06,  6.75155146e-05],
       [-1.15638295e-02,  1.36799032e-01, -8.25007770e-02,
        -3.98894928e-04, -8.37674122e-05, -7.84149285e-04],
       [ 7.00859083e-03, -8.25007770e-02,  5.02908228e-02,
         2.42050691e-04,  5.62267745e-05,  4.82288583e-04],
       [ 3.96032605e-05, -3.98894928e-04,  2.42050691e-04,
         1.37526616e-06,  2.59690003e-07,  2.32917634e-06],
       [ 6.36815997e-06, -8.37674122e-05,  5.62267745e-05,
         2.59690003e-07,  8.91589663e-07,  3.74355954e-07],
       [ 6.75155146e-05, -7.84149285e-04,  4.82288583e-04,
         2.32917634e-06,  3.74355954e-07,  4.81212799e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.29955340e-05],
       [ 2.79796759e-05],
       [ 3.50288254e-02]])}}
Current time:  2018-07-12 20:19:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.62894259e+03],
       [ 3.25224617e+03],
       [-4.34123577e+03],
       [-4.04329799e+00],
       [-2.10647481e+00],
       [-5.91428321e+00],
       [ 5.34244911e-01],
       [ 1.83110150e-01],
       [-7.97191956e-01],
       [ 2.13396426e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79258633e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.26061573e-03, -1.15638295e-02,  7.00859083e-03,
         3.96032605e-05,  6.36815997e-06,  6.75155146e-05],
       [-1.15638295e-02,  1.36799032e-01, -8.25007770e-02,
        -3.98894928e-04, -8.37674122e-05, -7.84149285e-04],
       [ 7.00859083e-03, -8.25007770e-02,  5.02908228e-02,
         2.42050691e-04,  5.62267745e-05,  4.82288583e-04],
       [ 3.96032605e-05, -3.98894928e-04,  2.42050691e-04,
         1.37526616e-06,  2.59690003e-07,  2.32917634e-06],
       [ 6.36815997e-06, -8.37674122e-05,  5.62267745e-05,
         2.59690003e-07,  8.91589663e-07,  3.74355954e-07],
       [ 6.75155146e-05, -7.84149285e-04,  4.82288583e-04,
         2.32917634e-06,  3.74355954e-07,  4.81212799e-06]])}
[[ 4.62894259e+03]
 [ 3.25224617e+03]
 [-4.34123577e+03]
 [-4.04329799e+00]
 [-2.10647481e+00]
 [-5.91428321e+00]
 [ 5.34244911e-01]
 [ 1.83110150e-01]
 [-7.97191956e-01]
 [ 2.13396426e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79258633e-19]]
2018-07-12 20:19:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:50
[[ 4.58825606e+03]
 [ 3.23100318e+03]
 [-4.40013875e+03]
 [-4.09389882e+00]
 [-2.14206670e+00]
 [-5.86616960e+00]
 [ 5.30075239e-01]
 [ 1.81993444e-01]
 [-7.99970549e-01]
 [ 2.14349592e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79470920e-19]]
[[ 2.18783168e-03 -1.54511824e-02  1.03299530e-02  5.30974910e-05
   8.95010955e-06  9.08694455e-05]
 [-1.54511824e-02  1.35213997e-01 -8.97488055e-02 -3.93904787e-04
  -7.47108062e-05 -7.81603386e-04]
 [ 1.03299530e-02 -8.97488055e-02  6.04260740e-02  2.63759660e-04
   5.99068555e-05  5.31288089e-04]
 [ 5.30974910e-05 -3.93904787e-04  2.63759660e-04  1.37125308e-06
   2.57968427e-07  2.31861549e-06]
 [ 8.95010955e-06 -7.47108062e-05  5.99068555e-05  2.57968427e-07
   9.01333546e-07  3.74452533e-07]
 [ 9.08694455e-05 -7.81603386e-04  5.31288089e-04  2.31861549e-06
   3.74452533e-07  4.83592056e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.62893465e+03],
       [ 3.25251057e+03],
       [-4.34138262e+03],
       [-4.04302204e+00],
       [-2.10726464e+00],
       [-5.91491186e+00]]), 'covar': array([[ 1.23507468e-03, -1.14992293e-02,  6.95759837e-03,
         3.79570831e-05,  6.45050220e-06,  6.63205569e-05],
       [-1.14992293e-02,  1.39019028e-01, -8.36292436e-02,
        -3.87942012e-04, -9.11176536e-05, -7.82230847e-04],
       [ 6.95759837e-03, -8.36292436e-02,  5.08455533e-02,
         2.35140449e-04,  6.00544176e-05,  4.80036665e-04],
       [ 3.79570831e-05, -3.87942012e-04,  2.35140449e-04,
         1.28175407e-06,  2.47910797e-07,  2.24689026e-06],
       [ 6.45050220e-06, -9.11176536e-05,  6.00544176e-05,
         2.47910797e-07,  8.47904543e-07,  3.99608573e-07],
       [ 6.63205569e-05, -7.82230847e-04,  4.80036665e-04,
         2.24689026e-06,  3.99608573e-07,  4.71120702e-06]])}
[[ 4.62893465e+03]
 [ 3.25251057e+03]
 [-4.34138262e+03]
 [-4.04302204e+00]
 [-2.10726464e+00]
 [-5.91491186e+00]]
2018-07-12 20:19:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:19:50
[[ 4.58825094e+03]
 [ 3.23125960e+03]
 [-4.40029164e+03]
 [-4.09361819e+00]
 [-2.14285625e+00]
 [-5.86680077e+00]]
[[ 2.11972022e-03 -1.52772593e-02  1.01894715e-02  5.04708844e-05
   8.91397276e-06  8.88508275e-05]
 [-1.52772593e-02  1.37282435e-01 -9.08175235e-02 -3.83035182e-04
  -8.25450661e-05 -7.79454949e-04]
 [ 1.01894715e-02 -9.08175235e-02  6.09255202e-02  2.56008838e-04
   6.39862002e-05  5.27989660e-04]
 [ 5.04708844e-05 -3.83035182e-04  2.56008838e-04  1.26823307e-06
   2.46065699e-07  2.23629850e-06]
 [ 8.91397276e-06 -8.25450661e-05  6.39862002e-05  2.46065699e-07
   8.47739437e-07  3.99780700e-07]
 [ 8.88508275e-05 -7.79454949e-04  5.27989660e-04  2.23629850e-06
   3.99780700e-07  4.72509603e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.58825094e+03],
       [ 3.23125960e+03],
       [-4.40029164e+03],
       [-4.09361819e+00],
       [-2.14285625e+00],
       [-5.86680077e+00]]), 'covar': array([[ 2.11972022e-03, -1.52772593e-02,  1.01894715e-02,
         5.04708844e-05,  8.91397276e-06,  8.88508275e-05],
       [-1.52772593e-02,  1.37282435e-01, -9.08175235e-02,
        -3.83035182e-04, -8.25450661e-05, -7.79454949e-04],
       [ 1.01894715e-02, -9.08175235e-02,  6.09255202e-02,
         2.56008838e-04,  6.39862002e-05,  5.27989660e-04],
       [ 5.04708844e-05, -3.83035182e-04,  2.56008838e-04,
         1.26823307e-06,  2.46065699e-07,  2.23629850e-06],
       [ 8.91397276e-06, -8.25450661e-05,  6.39862002e-05,
         2.46065699e-07,  8.47739437e-07,  3.99780700e-07],
       [ 8.88508275e-05, -7.79454949e-04,  5.27989660e-04,
         2.23629850e-06,  3.99780700e-07,  4.72509603e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.66648940e-05],
       [ 1.83606711e-05],
       [ 1.85545087e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.58825606e+03],
       [ 3.23100318e+03],
       [-4.40013875e+03],
       [-4.09389882e+00],
       [-2.14206670e+00],
       [-5.86616960e+00],
       [ 5.30075239e-01],
       [ 1.81993444e-01],
       [-7.99970549e-01],
       [ 2.14349592e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79470920e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.18783168e-03, -1.54511824e-02,  1.03299530e-02,
         5.30974910e-05,  8.95010955e-06,  9.08694455e-05],
       [-1.54511824e-02,  1.35213997e-01, -8.97488055e-02,
        -3.93904787e-04, -7.47108062e-05, -7.81603386e-04],
       [ 1.03299530e-02, -8.97488055e-02,  6.04260740e-02,
         2.63759660e-04,  5.99068555e-05,  5.31288089e-04],
       [ 5.30974910e-05, -3.93904787e-04,  2.63759660e-04,
         1.37125308e-06,  2.57968427e-07,  2.31861549e-06],
       [ 8.95010955e-06, -7.47108062e-05,  5.99068555e-05,
         2.57968427e-07,  9.01333546e-07,  3.74452533e-07],
       [ 9.08694455e-05, -7.81603386e-04,  5.31288089e-04,
         2.31861549e-06,  3.74452533e-07,  4.83592056e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.29955340e-05],
       [ 2.79796759e-05],
       [ 3.50288254e-02]])}}
Yi [[ 1.70685935]
 [-0.59545744]
 [13.77214574]]
posterior
[[ 4.58825606e+03]
 [ 3.23100318e+03]
 [-4.40013875e+03]
 [-4.09389882e+00]
 [-2.14206670e+00]
 [-5.86616960e+00]
 [ 5.30075239e-01]
 [ 1.81993444e-01]
 [-7.99970549e-01]
 [ 2.14349592e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79470920e-19]]
[[ 4.58826124e+03]
 [ 3.23115284e+03]
 [-4.40024060e+03]
 [-4.09391469e+00]
 [-2.14220576e+00]
 [-5.86704592e+00]
 [ 5.30075239e-01]
 [ 1.81993444e-01]
 [-7.99970549e-01]
 [ 2.14349592e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79470920e-19]]
[[ 2.15700343e-03 -1.54022166e-02  1.03827713e-02  5.25658018e-05
   9.99050773e-06  9.17965147e-05]
 [-1.54022166e-02  1.25166120e-01 -8.40676492e-02 -3.86518239e-04
  -7.99078688e-05 -7.39109943e-04]
 [ 1.03827713e-02 -8.40676492e-02  5.70008926e-02  2.60886580e-04
   6.01600276e-05  5.04260574e-04]
 [ 5.25658018e-05 -3.86518239e-04  2.60886580e-04  1.35778921e-06
   2.78223233e-07  2.30573813e-06]
 [ 9.99050773e-06 -7.99078688e-05  6.01600276e-05  2.78223233e-07
   8.64792840e-07  3.58594712e-07]
 [ 9.17965147e-05 -7.39109943e-04  5.04260574e-04  2.30573813e-06
   3.58594712e-07  4.61392107e-06]]
[[ 1.70691705]
 [-0.59544921]
 [13.61917257]]
[[-5.76955429e-05]
 [-8.22656944e-06]
 [ 1.52973164e-01]]


 Corrector Step
2018-07-12 20:19:50
[[ 4.58826124e+03]
 [ 3.23115284e+03]
 [-4.40024060e+03]
 [-4.09391469e+00]
 [-2.14220576e+00]
 [-5.86704592e+00]
 [ 5.30075239e-01]
 [ 1.81993444e-01]
 [-7.99970549e-01]
 [ 2.14349592e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79470920e-19]]
[[ 2.15700343e-03 -1.54022166e-02  1.03827713e-02  5.25658018e-05
   9.99050773e-06  9.17965147e-05]
 [-1.54022166e-02  1.25166120e-01 -8.40676492e-02 -3.86518239e-04
  -7.99078688e-05 -7.39109943e-04]
 [ 1.03827713e-02 -8.40676492e-02  5.70008926e-02  2.60886580e-04
   6.01600276e-05  5.04260574e-04]
 [ 5.25658018e-05 -3.86518239e-04  2.60886580e-04  1.35778921e-06
   2.78223233e-07  2.30573813e-06]
 [ 9.99050773e-06 -7.99078688e-05  6.01600276e-05  2.78223233e-07
   8.64792840e-07  3.58594712e-07]
 [ 9.17965147e-05 -7.39109943e-04  5.04260574e-04  2.30573813e-06
   3.58594712e-07  4.61392107e-06]]
36326285.006009705
post
cubesat_nadir
Ybar_post [[ 1.70689338]
 [-0.59545042]
 [13.61956252]]
resids [[-3.40249733e-05]
 [-7.02061750e-06]
 [ 1.52583220e-01]]
posterior
[[ 4.58825094e+03]
 [ 3.23125960e+03]
 [-4.40029164e+03]
 [-4.09361819e+00]
 [-2.14285625e+00]
 [-5.86680077e+00]]
[[ 4.58825578e+03]
 [ 3.23131790e+03]
 [-4.40034072e+03]
 [-4.09358557e+00]
 [-2.14304361e+00]
 [-5.86725823e+00]]
[[ 2.08939717e-03 -1.50872849e-02  1.01556989e-02  4.98894283e-05
   9.87099867e-06  8.90736560e-05]
 [-1.50872849e-02  1.24469229e-01 -8.34418403e-02 -3.71491367e-04
  -8.37735548e-05 -7.25234170e-04]
 [ 1.01556989e-02 -8.34418403e-02  5.64711881e-02  2.50490048e-04
   6.21026437e-05  4.93943259e-04]
 [ 4.98894283e-05 -3.71491367e-04  2.50490048e-04  1.25171097e-06
   2.61162217e-07  2.20274675e-06]
 [ 9.87099867e-06 -8.37735548e-05  6.21026437e-05  2.61162217e-07
   8.15454024e-07  3.69777642e-07]
 [ 8.90736560e-05 -7.25234170e-04  4.93943259e-04  2.20274675e-06
   3.69777642e-07  4.45712829e-06]]
[[ 1.70688939]
 [-0.59543665]
 [13.78966641]]
[[-3.00389877e-05]
 [-2.07807977e-05]
 [-1.75206776e-02]]


 Corrector Step
2018-07-12 20:19:50
[[ 4.58825578e+03]
 [ 3.23131790e+03]
 [-4.40034072e+03]
 [-4.09358557e+00]
 [-2.14304361e+00]
 [-5.86725823e+00]]
[[ 2.08939717e-03 -1.50872849e-02  1.01556989e-02  4.98894283e-05
   9.87099867e-06  8.90736560e-05]
 [-1.50872849e-02  1.24469229e-01 -8.34418403e-02 -3.71491367e-04
  -8.37735548e-05 -7.25234170e-04]
 [ 1.01556989e-02 -8.34418403e-02  5.64711881e-02  2.50490048e-04
   6.21026437e-05  4.93943259e-04]
 [ 4.98894283e-05 -3.71491367e-04  2.50490048e-04  1.25171097e-06
   2.61162217e-07  2.20274675e-06]
 [ 9.87099867e-06 -8.37735548e-05  6.21026437e-05  2.61162217e-07
   8.15454024e-07  3.69777642e-07]
 [ 8.90736560e-05 -7.25234170e-04  4.93943259e-04  2.20274675e-06
   3.69777642e-07  4.45712829e-06]]
310971108.71507233
post
sphere_lamr_small
Ybar_post [[ 1.70687757]
 [-0.59544329]
 [13.78976464]]
resids [[-1.82151900e-05]
 [-1.41498713e-05]
 [-1.76189072e-02]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [36326285.006009705, 310971108.71507233]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.58826124e+03],
       [ 3.23115284e+03],
       [-4.40024060e+03],
       [-4.09391469e+00],
       [-2.14220576e+00],
       [-5.86704592e+00]]), 'est_covars': array([[ 2.15700343e-03, -1.54022166e-02,  1.03827713e-02,
         5.25658018e-05,  9.99050773e-06,  9.17965147e-05],
       [-1.54022166e-02,  1.25166120e-01, -8.40676492e-02,
        -3.86518239e-04, -7.99078688e-05, -7.39109943e-04],
       [ 1.03827713e-02, -8.40676492e-02,  5.70008926e-02,
         2.60886580e-04,  6.01600276e-05,  5.04260574e-04],
       [ 5.25658018e-05, -3.86518239e-04,  2.60886580e-04,
         1.35778921e-06,  2.78223233e-07,  2.30573813e-06],
       [ 9.99050773e-06, -7.99078688e-05,  6.01600276e-05,
         2.78223233e-07,  8.64792840e-07,  3.58594712e-07],
       [ 9.17965147e-05, -7.39109943e-04,  5.04260574e-04,
         2.30573813e-06,  3.58594712e-07,  4.61392107e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.58825578e+03],
       [ 3.23131790e+03],
       [-4.40034072e+03],
       [-4.09358557e+00],
       [-2.14304361e+00],
       [-5.86725823e+00]]), 'covar': array([[ 2.08939717e-03, -1.50872849e-02,  1.01556989e-02,
         4.98894283e-05,  9.87099867e-06,  8.90736560e-05],
       [-1.50872849e-02,  1.24469229e-01, -8.34418403e-02,
        -3.71491367e-04, -8.37735548e-05, -7.25234170e-04],
       [ 1.01556989e-02, -8.34418403e-02,  5.64711881e-02,
         2.50490048e-04,  6.21026437e-05,  4.93943259e-04],
       [ 4.98894283e-05, -3.71491367e-04,  2.50490048e-04,
         1.25171097e-06,  2.61162217e-07,  2.20274675e-06],
       [ 9.87099867e-06, -8.37735548e-05,  6.21026437e-05,
         2.61162217e-07,  8.15454024e-07,  3.69777642e-07],
       [ 8.90736560e-05, -7.25234170e-04,  4.93943259e-04,
         2.20274675e-06,  3.69777642e-07,  4.45712829e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.82151900e-05],
       [-1.41498713e-05],
       [-1.76189072e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.58826124e+03],
       [ 3.23115284e+03],
       [-4.40024060e+03],
       [-4.09391469e+00],
       [-2.14220576e+00],
       [-5.86704592e+00],
       [ 5.30075239e-01],
       [ 1.81993444e-01],
       [-7.99970549e-01],
       [ 2.14349592e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79470920e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.15700343e-03, -1.54022166e-02,  1.03827713e-02,
         5.25658018e-05,  9.99050773e-06,  9.17965147e-05],
       [-1.54022166e-02,  1.25166120e-01, -8.40676492e-02,
        -3.86518239e-04, -7.99078688e-05, -7.39109943e-04],
       [ 1.03827713e-02, -8.40676492e-02,  5.70008926e-02,
         2.60886580e-04,  6.01600276e-05,  5.04260574e-04],
       [ 5.25658018e-05, -3.86518239e-04,  2.60886580e-04,
         1.35778921e-06,  2.78223233e-07,  2.30573813e-06],
       [ 9.99050773e-06, -7.99078688e-05,  6.01600276e-05,
         2.78223233e-07,  8.64792840e-07,  3.58594712e-07],
       [ 9.17965147e-05, -7.39109943e-04,  5.04260574e-04,
         2.30573813e-06,  3.58594712e-07,  4.61392107e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.40249733e-05],
       [-7.02061750e-06],
       [ 1.52583220e-01]])}}
Current time:  2018-07-12 20:20:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.58826124e+03],
       [ 3.23115284e+03],
       [-4.40024060e+03],
       [-4.09391469e+00],
       [-2.14220576e+00],
       [-5.86704592e+00],
       [ 5.30075239e-01],
       [ 1.81993444e-01],
       [-7.99970549e-01],
       [ 2.14349592e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79470920e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.15700343e-03, -1.54022166e-02,  1.03827713e-02,
         5.25658018e-05,  9.99050773e-06,  9.17965147e-05],
       [-1.54022166e-02,  1.25166120e-01, -8.40676492e-02,
        -3.86518239e-04, -7.99078688e-05, -7.39109943e-04],
       [ 1.03827713e-02, -8.40676492e-02,  5.70008926e-02,
         2.60886580e-04,  6.01600276e-05,  5.04260574e-04],
       [ 5.25658018e-05, -3.86518239e-04,  2.60886580e-04,
         1.35778921e-06,  2.78223233e-07,  2.30573813e-06],
       [ 9.99050773e-06, -7.99078688e-05,  6.01600276e-05,
         2.78223233e-07,  8.64792840e-07,  3.58594712e-07],
       [ 9.17965147e-05, -7.39109943e-04,  5.04260574e-04,
         2.30573813e-06,  3.58594712e-07,  4.61392107e-06]])}
[[ 4.58826124e+03]
 [ 3.23115284e+03]
 [-4.40024060e+03]
 [-4.09391469e+00]
 [-2.14220576e+00]
 [-5.86704592e+00]
 [ 5.30075239e-01]
 [ 1.81993444e-01]
 [-7.99970549e-01]
 [ 2.14349592e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79470920e-19]]
2018-07-12 20:19:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:00
[[ 4.54707082e+03]
 [ 3.20955382e+03]
 [-4.45866770e+03]
 [-4.14405687e+00]
 [-2.17755753e+00]
 [-5.81829450e+00]
 [ 5.25891117e-01]
 [ 1.80871777e-01]
 [-8.02727333e-01]
 [ 2.15296915e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79683207e-19]]
[[ 3.34092674e-03 -1.91283916e-02  1.41325288e-02  6.58056277e-05
   1.27504245e-05  1.14948101e-04]
 [-1.91283916e-02  1.23655767e-01 -9.08271145e-02 -3.81458151e-04
  -7.10981979e-05 -7.36604385e-04]
 [ 1.41325288e-02 -9.08271145e-02  6.75557437e-02  2.82275388e-04
   6.36603853e-05  5.51273834e-04]
 [ 6.58056277e-05 -3.81458151e-04  2.82275388e-04  1.35365657e-06
   2.76412401e-07  2.29531803e-06]
 [ 1.27504245e-05 -7.10981979e-05  6.36603853e-05  2.76412401e-07
   8.74509075e-07  3.58509301e-07]
 [ 1.14948101e-04 -7.36604385e-04  5.51273834e-04  2.29531803e-06
   3.58509301e-07  4.63674346e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.58825578e+03],
       [ 3.23131790e+03],
       [-4.40034072e+03],
       [-4.09358557e+00],
       [-2.14304361e+00],
       [-5.86725823e+00]]), 'covar': array([[ 2.08939717e-03, -1.50872849e-02,  1.01556989e-02,
         4.98894283e-05,  9.87099867e-06,  8.90736560e-05],
       [-1.50872849e-02,  1.24469229e-01, -8.34418403e-02,
        -3.71491367e-04, -8.37735548e-05, -7.25234170e-04],
       [ 1.01556989e-02, -8.34418403e-02,  5.64711881e-02,
         2.50490048e-04,  6.21026437e-05,  4.93943259e-04],
       [ 4.98894283e-05, -3.71491367e-04,  2.50490048e-04,
         1.25171097e-06,  2.61162217e-07,  2.20274675e-06],
       [ 9.87099867e-06, -8.37735548e-05,  6.21026437e-05,
         2.61162217e-07,  8.15454024e-07,  3.69777642e-07],
       [ 8.90736560e-05, -7.25234170e-04,  4.93943259e-04,
         2.20274675e-06,  3.69777642e-07,  4.45712829e-06]])}
[[ 4.58825578e+03]
 [ 3.23131790e+03]
 [-4.40034072e+03]
 [-4.09358557e+00]
 [-2.14304361e+00]
 [-5.86725823e+00]]
2018-07-12 20:19:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:00
[[ 4.54706889e+03]
 [ 3.20971045e+03]
 [-4.45876989e+03]
 [-4.14372439e+00]
 [-2.17839519e+00]
 [-5.81850872e+00]]
[[ 3.20894282e-03 -1.86661925e-02  1.37641304e-02  6.20291280e-05
   1.24601454e-05  1.11193266e-04]
 [-1.86661925e-02  1.22876398e-01 -9.00420193e-02 -3.66617690e-04
  -7.55064064e-05 -7.22613485e-04]
 [ 1.37641304e-02 -9.00420193e-02  6.68037460e-02  2.70864346e-04
   6.57151222e-05  5.39334143e-04]
 [ 6.20291280e-05 -3.66617690e-04  2.70864346e-04  1.23823363e-06
   2.59292046e-07  2.19248172e-06]
 [ 1.24601454e-05 -7.55064064e-05  6.57151222e-05  2.59292046e-07
   8.15264483e-07  3.69748503e-07]
 [ 1.11193266e-04 -7.22613485e-04  5.39334143e-04  2.19248172e-06
   3.69748503e-07  4.46983813e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 19, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.54706889e+03],
       [ 3.20971045e+03],
       [-4.45876989e+03],
       [-4.14372439e+00],
       [-2.17839519e+00],
       [-5.81850872e+00]]), 'covar': array([[ 3.20894282e-03, -1.86661925e-02,  1.37641304e-02,
         6.20291280e-05,  1.24601454e-05,  1.11193266e-04],
       [-1.86661925e-02,  1.22876398e-01, -9.00420193e-02,
        -3.66617690e-04, -7.55064064e-05, -7.22613485e-04],
       [ 1.37641304e-02, -9.00420193e-02,  6.68037460e-02,
         2.70864346e-04,  6.57151222e-05,  5.39334143e-04],
       [ 6.20291280e-05, -3.66617690e-04,  2.70864346e-04,
         1.23823363e-06,  2.59292046e-07,  2.19248172e-06],
       [ 1.24601454e-05, -7.55064064e-05,  6.57151222e-05,
         2.59292046e-07,  8.15264483e-07,  3.69748503e-07],
       [ 1.11193266e-04, -7.22613485e-04,  5.39334143e-04,
         2.19248172e-06,  3.69748503e-07,  4.46983813e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.82151900e-05],
       [-1.41498713e-05],
       [-1.76189072e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 19, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.54707082e+03],
       [ 3.20955382e+03],
       [-4.45866770e+03],
       [-4.14405687e+00],
       [-2.17755753e+00],
       [-5.81829450e+00],
       [ 5.25891117e-01],
       [ 1.80871777e-01],
       [-8.02727333e-01],
       [ 2.15296915e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79683207e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.34092674e-03, -1.91283916e-02,  1.41325288e-02,
         6.58056277e-05,  1.27504245e-05,  1.14948101e-04],
       [-1.91283916e-02,  1.23655767e-01, -9.08271145e-02,
        -3.81458151e-04, -7.10981979e-05, -7.36604385e-04],
       [ 1.41325288e-02, -9.08271145e-02,  6.75557437e-02,
         2.82275388e-04,  6.36603853e-05,  5.51273834e-04],
       [ 6.58056277e-05, -3.81458151e-04,  2.82275388e-04,
         1.35365657e-06,  2.76412401e-07,  2.29531803e-06],
       [ 1.27504245e-05, -7.10981979e-05,  6.36603853e-05,
         2.76412401e-07,  8.74509075e-07,  3.58509301e-07],
       [ 1.14948101e-04, -7.36604385e-04,  5.51273834e-04,
         2.29531803e-06,  3.58509301e-07,  4.63674346e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.40249733e-05],
       [-7.02061750e-06],
       [ 1.52583220e-01]])}}
Yi [[ 1.74730518]
 [-0.6401178 ]
 [13.39890234]]
posterior
[[ 4.54707082e+03]
 [ 3.20955382e+03]
 [-4.45866770e+03]
 [-4.14405687e+00]
 [-2.17755753e+00]
 [-5.81829450e+00]
 [ 5.25891117e-01]
 [ 1.80871777e-01]
 [-8.02727333e-01]
 [ 2.15296915e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79683207e-19]]
[[ 4.54706050e+03]
 [ 3.20965858e+03]
 [-4.45871961e+03]
 [-4.14425729e+00]
 [-2.17727167e+00]
 [-5.81861430e+00]
 [ 5.25891117e-01]
 [ 1.80871777e-01]
 [-8.02727333e-01]
 [ 2.15296915e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79683207e-19]]
[[ 3.29328162e-03 -1.86620122e-02  1.39045008e-02  6.48853397e-05
   1.40609522e-05  1.13561359e-04]
 [-1.86620122e-02  1.14203939e-01 -8.48114685e-02 -3.70559193e-04
  -7.97878136e-05 -6.91563072e-04]
 [ 1.39045008e-02 -8.48114685e-02  6.35338699e-02  2.76406289e-04
   6.67142567e-05  5.20260386e-04]
 [ 6.48853397e-05 -3.70559193e-04  2.76406289e-04  1.33514871e-06
   3.00114191e-07  2.25634849e-06]
 [ 1.40609522e-05 -7.97878136e-05  6.67142567e-05  3.00114191e-07
   8.34770584e-07  3.69834395e-07]
 [ 1.13561359e-04 -6.91563072e-04  5.20260386e-04  2.25634849e-06
   3.69834395e-07  4.39359952e-06]]
[[ 1.74732116]
 [-0.64016162]
 [13.42916369]]
[[-1.59834403e-05]
 [ 4.38179391e-05]
 [-3.02613585e-02]]


 Corrector Step
2018-07-12 20:20:00
[[ 4.54706050e+03]
 [ 3.20965858e+03]
 [-4.45871961e+03]
 [-4.14425729e+00]
 [-2.17727167e+00]
 [-5.81861430e+00]
 [ 5.25891117e-01]
 [ 1.80871777e-01]
 [-8.02727333e-01]
 [ 2.15296915e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79683207e-19]]
[[ 3.29328162e-03 -1.86620122e-02  1.39045008e-02  6.48853397e-05
   1.40609522e-05  1.13561359e-04]
 [-1.86620122e-02  1.14203939e-01 -8.48114685e-02 -3.70559193e-04
  -7.97878136e-05 -6.91563072e-04]
 [ 1.39045008e-02 -8.48114685e-02  6.35338699e-02  2.76406289e-04
   6.67142567e-05  5.20260386e-04]
 [ 6.48853397e-05 -3.70559193e-04  2.76406289e-04  1.33514871e-06
   3.00114191e-07  2.25634849e-06]
 [ 1.40609522e-05 -7.97878136e-05  6.67142567e-05  3.00114191e-07
   8.34770584e-07  3.69834395e-07]
 [ 1.13561359e-04 -6.91563072e-04  5.20260386e-04  2.25634849e-06
   3.69834395e-07  4.39359952e-06]]
203752557.252459
post
cubesat_nadir
Ybar_post [[ 1.74731336]
 [-0.6401456 ]
 [13.42941874]]
resids [[-8.18095101e-06]
 [ 2.78033770e-05]
 [-3.05164026e-02]]
posterior
[[ 4.54706889e+03]
 [ 3.20971045e+03]
 [-4.45876989e+03]
 [-4.14372439e+00]
 [-2.17839519e+00]
 [-5.81850872e+00]]
[[ 4.54706288e+03]
 [ 3.20973185e+03]
 [-4.45876642e+03]
 [-4.14381638e+00]
 [-2.17816520e+00]
 [-5.81841117e+00]]
[[ 3.15097172e-03 -1.80212205e-02  1.34100207e-02  6.08866783e-05
   1.35535212e-05  1.08844837e-04]
 [-1.80212205e-02  1.11571964e-01 -8.27311854e-02 -3.51771133e-04
  -8.05970479e-05 -6.68801835e-04]
 [ 1.34100207e-02 -8.27311854e-02  6.18872548e-02  2.62140945e-04
   6.66064918e-05  5.02374309e-04]
 [ 6.08866783e-05 -3.51771133e-04  2.62140945e-04  1.21461328e-06
   2.77169026e-07  2.13186859e-06]
 [ 1.35535212e-05 -8.05970479e-05  6.66064918e-05  2.77169026e-07
   7.82378248e-07  3.66474221e-07]
 [ 1.08844837e-04 -6.68801835e-04  5.02374309e-04  2.13186859e-06
   3.66474221e-07  4.18895096e-06]]
[[ 1.74729693]
 [-0.64015375]
 [13.71627569]]
[[ 8.24584784e-06]
 [ 3.59501260e-05]
 [-3.17373356e-01]]


 Corrector Step
2018-07-12 20:20:00
[[ 4.54706288e+03]
 [ 3.20973185e+03]
 [-4.45876642e+03]
 [-4.14381638e+00]
 [-2.17816520e+00]
 [-5.81841117e+00]]
[[ 3.15097172e-03 -1.80212205e-02  1.34100207e-02  6.08866783e-05
   1.35535212e-05  1.08844837e-04]
 [-1.80212205e-02  1.11571964e-01 -8.27311854e-02 -3.51771133e-04
  -8.05970479e-05 -6.68801835e-04]
 [ 1.34100207e-02 -8.27311854e-02  6.18872548e-02  2.62140945e-04
   6.66064918e-05  5.02374309e-04]
 [ 6.08866783e-05 -3.51771133e-04  2.62140945e-04  1.21461328e-06
   2.77169026e-07  2.13186859e-06]
 [ 1.35535212e-05 -8.05970479e-05  6.66064918e-05  2.77169026e-07
   7.82378248e-07  3.66474221e-07]
 [ 1.08844837e-04 -6.68801835e-04  5.02374309e-04  2.13186859e-06
   3.66474221e-07  4.18895096e-06]]
2019000.5802167451
post
sphere_lamr_small
Ybar_post [[ 1.74729894]
 [-0.64014158]
 [13.71633735]]
resids [[ 6.23623516e-06]
 [ 2.37806429e-05]
 [-3.17435010e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [203752557.252459, 2019000.5802167451]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.54706050e+03],
       [ 3.20965858e+03],
       [-4.45871961e+03],
       [-4.14425729e+00],
       [-2.17727167e+00],
       [-5.81861430e+00]]), 'est_covars': array([[ 3.29328162e-03, -1.86620122e-02,  1.39045008e-02,
         6.48853397e-05,  1.40609522e-05,  1.13561359e-04],
       [-1.86620122e-02,  1.14203939e-01, -8.48114685e-02,
        -3.70559193e-04, -7.97878136e-05, -6.91563072e-04],
       [ 1.39045008e-02, -8.48114685e-02,  6.35338699e-02,
         2.76406289e-04,  6.67142567e-05,  5.20260386e-04],
       [ 6.48853397e-05, -3.70559193e-04,  2.76406289e-04,
         1.33514871e-06,  3.00114191e-07,  2.25634849e-06],
       [ 1.40609522e-05, -7.97878136e-05,  6.67142567e-05,
         3.00114191e-07,  8.34770584e-07,  3.69834395e-07],
       [ 1.13561359e-04, -6.91563072e-04,  5.20260386e-04,
         2.25634849e-06,  3.69834395e-07,  4.39359952e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.54706288e+03],
       [ 3.20973185e+03],
       [-4.45876642e+03],
       [-4.14381638e+00],
       [-2.17816520e+00],
       [-5.81841117e+00]]), 'covar': array([[ 3.15097172e-03, -1.80212205e-02,  1.34100207e-02,
         6.08866783e-05,  1.35535212e-05,  1.08844837e-04],
       [-1.80212205e-02,  1.11571964e-01, -8.27311854e-02,
        -3.51771133e-04, -8.05970479e-05, -6.68801835e-04],
       [ 1.34100207e-02, -8.27311854e-02,  6.18872548e-02,
         2.62140945e-04,  6.66064918e-05,  5.02374309e-04],
       [ 6.08866783e-05, -3.51771133e-04,  2.62140945e-04,
         1.21461328e-06,  2.77169026e-07,  2.13186859e-06],
       [ 1.35535212e-05, -8.05970479e-05,  6.66064918e-05,
         2.77169026e-07,  7.82378248e-07,  3.66474221e-07],
       [ 1.08844837e-04, -6.68801835e-04,  5.02374309e-04,
         2.13186859e-06,  3.66474221e-07,  4.18895096e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 6.23623516e-06],
       [ 2.37806429e-05],
       [-3.17435010e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.54706050e+03],
       [ 3.20965858e+03],
       [-4.45871961e+03],
       [-4.14425729e+00],
       [-2.17727167e+00],
       [-5.81861430e+00],
       [ 5.25891117e-01],
       [ 1.80871777e-01],
       [-8.02727333e-01],
       [ 2.15296915e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79683207e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.29328162e-03, -1.86620122e-02,  1.39045008e-02,
         6.48853397e-05,  1.40609522e-05,  1.13561359e-04],
       [-1.86620122e-02,  1.14203939e-01, -8.48114685e-02,
        -3.70559193e-04, -7.97878136e-05, -6.91563072e-04],
       [ 1.39045008e-02, -8.48114685e-02,  6.35338699e-02,
         2.76406289e-04,  6.67142567e-05,  5.20260386e-04],
       [ 6.48853397e-05, -3.70559193e-04,  2.76406289e-04,
         1.33514871e-06,  3.00114191e-07,  2.25634849e-06],
       [ 1.40609522e-05, -7.97878136e-05,  6.67142567e-05,
         3.00114191e-07,  8.34770584e-07,  3.69834395e-07],
       [ 1.13561359e-04, -6.91563072e-04,  5.20260386e-04,
         2.25634849e-06,  3.69834395e-07,  4.39359952e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.18095101e-06],
       [ 2.78033770e-05],
       [-3.05164026e-02]])}}
Current time:  2018-07-12 20:20:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.54706050e+03],
       [ 3.20965858e+03],
       [-4.45871961e+03],
       [-4.14425729e+00],
       [-2.17727167e+00],
       [-5.81861430e+00],
       [ 5.25891117e-01],
       [ 1.80871777e-01],
       [-8.02727333e-01],
       [ 2.15296915e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79683207e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.29328162e-03, -1.86620122e-02,  1.39045008e-02,
         6.48853397e-05,  1.40609522e-05,  1.13561359e-04],
       [-1.86620122e-02,  1.14203939e-01, -8.48114685e-02,
        -3.70559193e-04, -7.97878136e-05, -6.91563072e-04],
       [ 1.39045008e-02, -8.48114685e-02,  6.35338699e-02,
         2.76406289e-04,  6.67142567e-05,  5.20260386e-04],
       [ 6.48853397e-05, -3.70559193e-04,  2.76406289e-04,
         1.33514871e-06,  3.00114191e-07,  2.25634849e-06],
       [ 1.40609522e-05, -7.97878136e-05,  6.67142567e-05,
         3.00114191e-07,  8.34770584e-07,  3.69834395e-07],
       [ 1.13561359e-04, -6.91563072e-04,  5.20260386e-04,
         2.25634849e-06,  3.69834395e-07,  4.39359952e-06]])}
[[ 4.54706050e+03]
 [ 3.20965858e+03]
 [-4.45871961e+03]
 [-4.14425729e+00]
 [-2.17727167e+00]
 [-5.81861430e+00]
 [ 5.25891117e-01]
 [ 1.80871777e-01]
 [-8.02727333e-01]
 [ 2.15296915e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79683207e-19]]
2018-07-12 20:20:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:10
[[ 4.50536943e+03]
 [ 3.18771004e+03]
 [-4.51665881e+03]
 [-4.19393624e+00]
 [-2.21237995e+00]
 [-5.76922992e+00]
 [ 5.21692658e-01]
 [ 1.79745179e-01]
 [-8.05462233e-01]
 [ 2.16238369e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79895494e-19]]
[[ 4.72065415e-03 -2.21863770e-02  1.80223813e-02  7.78246725e-05
   1.70304624e-05  1.36245760e-04]
 [-2.21863770e-02  1.12693188e-01 -9.10284895e-02 -3.65394930e-04
  -7.12595239e-05 -6.88838646e-04]
 [ 1.80223813e-02 -9.10284895e-02  7.43874820e-02  2.97225388e-04
   7.03032196e-05  5.65060678e-04]
 [ 7.78246725e-05 -3.65394930e-04  2.97225388e-04  1.33103107e-06
   2.98143894e-07  2.24612087e-06]
 [ 1.70304624e-05 -7.12595239e-05  7.03032196e-05  2.98143894e-07
   8.44445472e-07  3.69608419e-07]
 [ 1.36245760e-04 -6.88838646e-04  5.65060678e-04  2.24612087e-06
   3.69608419e-07  4.41545713e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.54706288e+03],
       [ 3.20973185e+03],
       [-4.45876642e+03],
       [-4.14381638e+00],
       [-2.17816520e+00],
       [-5.81841117e+00]]), 'covar': array([[ 3.15097172e-03, -1.80212205e-02,  1.34100207e-02,
         6.08866783e-05,  1.35535212e-05,  1.08844837e-04],
       [-1.80212205e-02,  1.11571964e-01, -8.27311854e-02,
        -3.51771133e-04, -8.05970479e-05, -6.68801835e-04],
       [ 1.34100207e-02, -8.27311854e-02,  6.18872548e-02,
         2.62140945e-04,  6.66064918e-05,  5.02374309e-04],
       [ 6.08866783e-05, -3.51771133e-04,  2.62140945e-04,
         1.21461328e-06,  2.77169026e-07,  2.13186859e-06],
       [ 1.35535212e-05, -8.05970479e-05,  6.66064918e-05,
         2.77169026e-07,  7.82378248e-07,  3.66474221e-07],
       [ 1.08844837e-04, -6.68801835e-04,  5.02374309e-04,
         2.13186859e-06,  3.66474221e-07,  4.18895096e-06]])}
[[ 4.54706288e+03]
 [ 3.20973185e+03]
 [-4.45876642e+03]
 [-4.14381638e+00]
 [-2.17816520e+00]
 [-5.81841117e+00]]
2018-07-12 20:20:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:10
[[ 4.50537576e+03]
 [ 3.18777444e+03]
 [-4.51670416e+03]
 [-4.19349403e+00]
 [-2.21327309e+00]
 [-5.76902743e+00]]
[[ 4.48618802e-03 -2.13652593e-02  1.73254292e-02  7.25889459e-05
   1.62941342e-05  1.30280039e-04]
 [-2.13652593e-02  1.10039509e-01 -8.87217792e-02 -3.46888310e-04
  -7.26442375e-05 -6.66091189e-04]
 [ 1.73254292e-02 -8.87217792e-02  7.23613172e-02  2.81760100e-04
   7.01640996e-05  5.45060086e-04]
 [ 7.25889459e-05 -3.46888310e-04  2.81760100e-04  1.20131573e-06
   2.75202952e-07  2.12194673e-06]
 [ 1.62941342e-05 -7.26442375e-05  7.01640996e-05  2.75202952e-07
   7.82153224e-07  3.66293005e-07]
 [ 1.30280039e-04 -6.66091189e-04  5.45060086e-04  2.12194673e-06
   3.66293005e-07  4.20054563e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.50537576e+03],
       [ 3.18777444e+03],
       [-4.51670416e+03],
       [-4.19349403e+00],
       [-2.21327309e+00],
       [-5.76902743e+00]]), 'covar': array([[ 4.48618802e-03, -2.13652593e-02,  1.73254292e-02,
         7.25889459e-05,  1.62941342e-05,  1.30280039e-04],
       [-2.13652593e-02,  1.10039509e-01, -8.87217792e-02,
        -3.46888310e-04, -7.26442375e-05, -6.66091189e-04],
       [ 1.73254292e-02, -8.87217792e-02,  7.23613172e-02,
         2.81760100e-04,  7.01640996e-05,  5.45060086e-04],
       [ 7.25889459e-05, -3.46888310e-04,  2.81760100e-04,
         1.20131573e-06,  2.75202952e-07,  2.12194673e-06],
       [ 1.62941342e-05, -7.26442375e-05,  7.01640996e-05,
         2.75202952e-07,  7.82153224e-07,  3.66293005e-07],
       [ 1.30280039e-04, -6.66091189e-04,  5.45060086e-04,
         2.12194673e-06,  3.66293005e-07,  4.20054563e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 6.23623516e-06],
       [ 2.37806429e-05],
       [-3.17435010e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.50536943e+03],
       [ 3.18771004e+03],
       [-4.51665881e+03],
       [-4.19393624e+00],
       [-2.21237995e+00],
       [-5.76922992e+00],
       [ 5.21692658e-01],
       [ 1.79745179e-01],
       [-8.05462233e-01],
       [ 2.16238369e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79895494e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.72065415e-03, -2.21863770e-02,  1.80223813e-02,
         7.78246725e-05,  1.70304624e-05,  1.36245760e-04],
       [-2.21863770e-02,  1.12693188e-01, -9.10284895e-02,
        -3.65394930e-04, -7.12595239e-05, -6.88838646e-04],
       [ 1.80223813e-02, -9.10284895e-02,  7.43874820e-02,
         2.97225388e-04,  7.03032196e-05,  5.65060678e-04],
       [ 7.78246725e-05, -3.65394930e-04,  2.97225388e-04,
         1.33103107e-06,  2.98143894e-07,  2.24612087e-06],
       [ 1.70304624e-05, -7.12595239e-05,  7.03032196e-05,
         2.98143894e-07,  8.44445472e-07,  3.69608419e-07],
       [ 1.36245760e-04, -6.88838646e-04,  5.65060678e-04,
         2.24612087e-06,  3.69608419e-07,  4.41545713e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.18095101e-06],
       [ 2.78033770e-05],
       [-3.05164026e-02]])}}
Yi [[ 1.78964425]
 [-0.68246526]
 [13.46653733]]
posterior
[[ 4.50536943e+03]
 [ 3.18771004e+03]
 [-4.51665881e+03]
 [-4.19393624e+00]
 [-2.21237995e+00]
 [-5.76922992e+00]
 [ 5.21692658e-01]
 [ 1.79745179e-01]
 [-8.05462233e-01]
 [ 2.16238369e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79895494e-19]]
[[ 4.50535690e+03]
 [ 3.18779618e+03]
 [-4.51670808e+03]
 [-4.19413271e+00]
 [-2.21212409e+00]
 [-5.76955429e+00]
 [ 5.21692658e-01]
 [ 1.79745179e-01]
 [-8.05462233e-01]
 [ 2.16238369e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79895494e-19]]
[[ 4.61896821e-03 -2.13126123e-02  1.74617892e-02  7.62238306e-05
   1.88666163e-05  1.32306385e-04]
 [-2.13126123e-02  1.03497213e-01 -8.45160515e-02 -3.51514442e-04
  -8.26777769e-05 -6.40905072e-04]
 [ 1.74617892e-02 -8.45160515e-02  6.95930196e-02  2.88274150e-04
   7.60325609e-05  5.29186750e-04]
 [ 7.62238306e-05 -3.51514442e-04  2.88274150e-04  1.30581956e-06
   3.26721333e-07  2.18305708e-06]
 [ 1.88666163e-05 -8.26777769e-05  7.60325609e-05  3.26721333e-07
   7.99821784e-07  4.04219697e-07]
 [ 1.32306385e-04 -6.40905072e-04  5.29186750e-04  2.18305708e-06
   4.04219697e-07  4.14522970e-06]]
[[ 1.78965673]
 [-0.68250085]
 [13.27984309]]
[[-1.24749289e-05]
 [ 3.55898363e-05]
 [ 1.86694241e-01]]


 Corrector Step
2018-07-12 20:20:10
[[ 4.50535690e+03]
 [ 3.18779618e+03]
 [-4.51670808e+03]
 [-4.19413271e+00]
 [-2.21212409e+00]
 [-5.76955429e+00]
 [ 5.21692658e-01]
 [ 1.79745179e-01]
 [-8.05462233e-01]
 [ 2.16238369e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79895494e-19]]
[[ 4.61896821e-03 -2.13126123e-02  1.74617892e-02  7.62238306e-05
   1.88666163e-05  1.32306385e-04]
 [-2.13126123e-02  1.03497213e-01 -8.45160515e-02 -3.51514442e-04
  -8.26777769e-05 -6.40905072e-04]
 [ 1.74617892e-02 -8.45160515e-02  6.95930196e-02  2.88274150e-04
   7.60325609e-05  5.29186750e-04]
 [ 7.62238306e-05 -3.51514442e-04  2.88274150e-04  1.30581956e-06
   3.26721333e-07  2.18305708e-06]
 [ 1.88666163e-05 -8.26777769e-05  7.60325609e-05  3.26721333e-07
   7.99821784e-07  4.04219697e-07]
 [ 1.32306385e-04 -6.40905072e-04  5.29186750e-04  2.18305708e-06
   4.04219697e-07  4.14522970e-06]]
55918897.78299045
post
cubesat_nadir
Ybar_post [[ 1.78965053]
 [-0.68248852]
 [13.28004568]]
resids [[-6.27220009e-06]
 [ 2.32554157e-05]
 [ 1.86491657e-01]]
posterior
[[ 4.50537576e+03]
 [ 3.18777444e+03]
 [-4.51670416e+03]
 [-4.19349403e+00]
 [-2.21327309e+00]
 [-5.76902743e+00]]
[[ 4.50536967e+03]
 [ 3.18779509e+03]
 [-4.51670370e+03]
 [-4.19357951e+00]
 [-2.21305714e+00]
 [-5.76898671e+00]]
[[ 4.36204086e-03 -2.02968887e-02  1.66092904e-02  7.05929693e-05
   1.77855625e-05  1.25217329e-04]
 [-2.02968887e-02  9.95492580e-02 -8.11809630e-02 -3.29252843e-04
  -8.06744436e-05 -6.11447204e-04]
 [ 1.66092904e-02 -8.11809630e-02  6.67645327e-02  2.69758110e-04
   7.36475449e-05  5.04072840e-04]
 [ 7.05929693e-05 -3.29252843e-04  2.69758110e-04  1.16906266e-06
   2.97472840e-07  2.03662536e-06]
 [ 1.77855625e-05 -8.06744436e-05  7.36475449e-05  2.97472840e-07
   7.46259829e-07  3.85940499e-07]
 [ 1.25217329e-04 -6.11447204e-04  5.04072840e-04  2.03662536e-06
   3.85940499e-07  3.89936216e-06]]
[[ 1.78963736]
 [-0.68249816]
 [13.65300608]]
[[ 6.89658062e-06]
 [ 3.28927261e-05]
 [-1.86468744e-01]]


 Corrector Step
2018-07-12 20:20:10
[[ 4.50536967e+03]
 [ 3.18779509e+03]
 [-4.51670370e+03]
 [-4.19357951e+00]
 [-2.21305714e+00]
 [-5.76898671e+00]]
[[ 4.36204086e-03 -2.02968887e-02  1.66092904e-02  7.05929693e-05
   1.77855625e-05  1.25217329e-04]
 [-2.02968887e-02  9.95492580e-02 -8.11809630e-02 -3.29252843e-04
  -8.06744436e-05 -6.11447204e-04]
 [ 1.66092904e-02 -8.11809630e-02  6.67645327e-02  2.69758110e-04
   7.36475449e-05  5.04072840e-04]
 [ 7.05929693e-05 -3.29252843e-04  2.69758110e-04  1.16906266e-06
   2.97472840e-07  2.03662536e-06]
 [ 1.77855625e-05 -8.06744436e-05  7.36475449e-05  2.97472840e-07
   7.46259829e-07  3.85940499e-07]
 [ 1.25217329e-04 -6.11447204e-04  5.04072840e-04  2.03662536e-06
   3.85940499e-07  3.89936216e-06]]
62791450.915019006
post
sphere_lamr_small
Ybar_post [[ 1.78963875]
 [-0.68248778]
 [13.65306163]]
resids [[ 5.50836178e-06]
 [ 2.25192039e-05]
 [-1.86524301e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [55918897.78299045, 62791450.915019006]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.50535690e+03],
       [ 3.18779618e+03],
       [-4.51670808e+03],
       [-4.19413271e+00],
       [-2.21212409e+00],
       [-5.76955429e+00]]), 'est_covars': array([[ 4.61896821e-03, -2.13126123e-02,  1.74617892e-02,
         7.62238306e-05,  1.88666163e-05,  1.32306385e-04],
       [-2.13126123e-02,  1.03497213e-01, -8.45160515e-02,
        -3.51514442e-04, -8.26777769e-05, -6.40905072e-04],
       [ 1.74617892e-02, -8.45160515e-02,  6.95930196e-02,
         2.88274150e-04,  7.60325609e-05,  5.29186750e-04],
       [ 7.62238306e-05, -3.51514442e-04,  2.88274150e-04,
         1.30581956e-06,  3.26721333e-07,  2.18305708e-06],
       [ 1.88666163e-05, -8.26777769e-05,  7.60325609e-05,
         3.26721333e-07,  7.99821784e-07,  4.04219697e-07],
       [ 1.32306385e-04, -6.40905072e-04,  5.29186750e-04,
         2.18305708e-06,  4.04219697e-07,  4.14522970e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.50536967e+03],
       [ 3.18779509e+03],
       [-4.51670370e+03],
       [-4.19357951e+00],
       [-2.21305714e+00],
       [-5.76898671e+00]]), 'covar': array([[ 4.36204086e-03, -2.02968887e-02,  1.66092904e-02,
         7.05929693e-05,  1.77855625e-05,  1.25217329e-04],
       [-2.02968887e-02,  9.95492580e-02, -8.11809630e-02,
        -3.29252843e-04, -8.06744436e-05, -6.11447204e-04],
       [ 1.66092904e-02, -8.11809630e-02,  6.67645327e-02,
         2.69758110e-04,  7.36475449e-05,  5.04072840e-04],
       [ 7.05929693e-05, -3.29252843e-04,  2.69758110e-04,
         1.16906266e-06,  2.97472840e-07,  2.03662536e-06],
       [ 1.77855625e-05, -8.06744436e-05,  7.36475449e-05,
         2.97472840e-07,  7.46259829e-07,  3.85940499e-07],
       [ 1.25217329e-04, -6.11447204e-04,  5.04072840e-04,
         2.03662536e-06,  3.85940499e-07,  3.89936216e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 5.50836178e-06],
       [ 2.25192039e-05],
       [-1.86524301e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.50535690e+03],
       [ 3.18779618e+03],
       [-4.51670808e+03],
       [-4.19413271e+00],
       [-2.21212409e+00],
       [-5.76955429e+00],
       [ 5.21692658e-01],
       [ 1.79745179e-01],
       [-8.05462233e-01],
       [ 2.16238369e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79895494e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.61896821e-03, -2.13126123e-02,  1.74617892e-02,
         7.62238306e-05,  1.88666163e-05,  1.32306385e-04],
       [-2.13126123e-02,  1.03497213e-01, -8.45160515e-02,
        -3.51514442e-04, -8.26777769e-05, -6.40905072e-04],
       [ 1.74617892e-02, -8.45160515e-02,  6.95930196e-02,
         2.88274150e-04,  7.60325609e-05,  5.29186750e-04],
       [ 7.62238306e-05, -3.51514442e-04,  2.88274150e-04,
         1.30581956e-06,  3.26721333e-07,  2.18305708e-06],
       [ 1.88666163e-05, -8.26777769e-05,  7.60325609e-05,
         3.26721333e-07,  7.99821784e-07,  4.04219697e-07],
       [ 1.32306385e-04, -6.40905072e-04,  5.29186750e-04,
         2.18305708e-06,  4.04219697e-07,  4.14522970e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-6.27220009e-06],
       [ 2.32554157e-05],
       [ 1.86491657e-01]])}}
Current time:  2018-07-12 20:20:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.50535690e+03],
       [ 3.18779618e+03],
       [-4.51670808e+03],
       [-4.19413271e+00],
       [-2.21212409e+00],
       [-5.76955429e+00],
       [ 5.21692658e-01],
       [ 1.79745179e-01],
       [-8.05462233e-01],
       [ 2.16238369e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.79895494e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.61896821e-03, -2.13126123e-02,  1.74617892e-02,
         7.62238306e-05,  1.88666163e-05,  1.32306385e-04],
       [-2.13126123e-02,  1.03497213e-01, -8.45160515e-02,
        -3.51514442e-04, -8.26777769e-05, -6.40905072e-04],
       [ 1.74617892e-02, -8.45160515e-02,  6.95930196e-02,
         2.88274150e-04,  7.60325609e-05,  5.29186750e-04],
       [ 7.62238306e-05, -3.51514442e-04,  2.88274150e-04,
         1.30581956e-06,  3.26721333e-07,  2.18305708e-06],
       [ 1.88666163e-05, -8.26777769e-05,  7.60325609e-05,
         3.26721333e-07,  7.99821784e-07,  4.04219697e-07],
       [ 1.32306385e-04, -6.40905072e-04,  5.29186750e-04,
         2.18305708e-06,  4.04219697e-07,  4.14522970e-06]])}
[[ 4.50535690e+03]
 [ 3.18779618e+03]
 [-4.51670808e+03]
 [-4.19413271e+00]
 [-2.21212409e+00]
 [-5.76955429e+00]
 [ 5.21692658e-01]
 [ 1.79745179e-01]
 [-8.05462233e-01]
 [ 2.16238369e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.79895494e-19]]
2018-07-12 20:20:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:20
[[ 4.46316910e+03]
 [ 3.16550052e+03]
 [-4.57415414e+03]
 [-4.24334327e+00]
 [-2.24698484e+00]
 [-5.71954228e+00]
 [ 5.17479976e-01]
 [ 1.78613681e-01]
 [-8.08175175e-01]
 [ 2.17173927e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80107781e-19]]
[[ 6.26936029e-03 -2.45964260e-02  2.18778874e-02  8.88026594e-05
   2.20913415e-05  1.54279117e-04]
 [-2.45964260e-02  1.01925334e-01 -9.01293673e-02 -3.46205527e-04
  -7.44828597e-05 -6.37736466e-04]
 [ 2.18778874e-02 -9.01293673e-02  8.05992269e-02  3.08300086e-04
   7.99409025e-05  5.71485811e-04]
 [ 8.88026594e-05 -3.46205527e-04  3.08300086e-04  1.30184905e-06
   3.24530160e-07  2.17309996e-06]
 [ 2.20913415e-05 -7.44828597e-05  7.99409025e-05  3.24530160e-07
   8.09439080e-07  4.03892714e-07]
 [ 1.54279117e-04 -6.37736466e-04  5.71485811e-04  2.17309996e-06
   4.03892714e-07  4.16611358e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.50536967e+03],
       [ 3.18779509e+03],
       [-4.51670370e+03],
       [-4.19357951e+00],
       [-2.21305714e+00],
       [-5.76898671e+00]]), 'covar': array([[ 4.36204086e-03, -2.02968887e-02,  1.66092904e-02,
         7.05929693e-05,  1.77855625e-05,  1.25217329e-04],
       [-2.02968887e-02,  9.95492580e-02, -8.11809630e-02,
        -3.29252843e-04, -8.06744436e-05, -6.11447204e-04],
       [ 1.66092904e-02, -8.11809630e-02,  6.67645327e-02,
         2.69758110e-04,  7.36475449e-05,  5.04072840e-04],
       [ 7.05929693e-05, -3.29252843e-04,  2.69758110e-04,
         1.16906266e-06,  2.97472840e-07,  2.03662536e-06],
       [ 1.77855625e-05, -8.06744436e-05,  7.36475449e-05,
         2.97472840e-07,  7.46259829e-07,  3.85940499e-07],
       [ 1.25217329e-04, -6.11447204e-04,  5.04072840e-04,
         2.03662536e-06,  3.85940499e-07,  3.89936216e-06]])}
[[ 4.50536967e+03]
 [ 3.18779509e+03]
 [-4.51670370e+03]
 [-4.19357951e+00]
 [-2.21305714e+00]
 [-5.76898671e+00]]
2018-07-12 20:20:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:20
[[ 4.46318757e+03]
 [ 3.16548989e+03]
 [-4.57414390e+03]
 [-4.24279011e+00]
 [-2.24791769e+00]
 [-5.71897494e+00]]
[[ 5.88617468e-03 -2.33722466e-02  2.07550487e-02  8.17819716e-05
   2.07195397e-05  1.45719244e-04]
 [-2.33722466e-02  9.80118333e-02 -8.65252482e-02 -3.24315998e-04
  -7.30693767e-05 -6.08430837e-04]
 [ 2.07550487e-02 -8.65252482e-02  7.72433875e-02  2.88392724e-04
   7.73777218e-05  5.43834359e-04]
 [ 8.17819716e-05 -3.24315998e-04  2.88392724e-04  1.15608086e-06
   2.95351472e-07  2.02710052e-06]
 [ 2.07195397e-05 -7.30693767e-05  7.73777218e-05  2.95351472e-07
   7.45985548e-07  3.85651293e-07]
 [ 1.45719244e-04 -6.08430837e-04  5.43834359e-04  2.02710052e-06
   3.85651293e-07  3.90987310e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.46318757e+03],
       [ 3.16548989e+03],
       [-4.57414390e+03],
       [-4.24279011e+00],
       [-2.24791769e+00],
       [-5.71897494e+00]]), 'covar': array([[ 5.88617468e-03, -2.33722466e-02,  2.07550487e-02,
         8.17819716e-05,  2.07195397e-05,  1.45719244e-04],
       [-2.33722466e-02,  9.80118333e-02, -8.65252482e-02,
        -3.24315998e-04, -7.30693767e-05, -6.08430837e-04],
       [ 2.07550487e-02, -8.65252482e-02,  7.72433875e-02,
         2.88392724e-04,  7.73777218e-05,  5.43834359e-04],
       [ 8.17819716e-05, -3.24315998e-04,  2.88392724e-04,
         1.15608086e-06,  2.95351472e-07,  2.02710052e-06],
       [ 2.07195397e-05, -7.30693767e-05,  7.73777218e-05,
         2.95351472e-07,  7.45985548e-07,  3.85651293e-07],
       [ 1.45719244e-04, -6.08430837e-04,  5.43834359e-04,
         2.02710052e-06,  3.85651293e-07,  3.90987310e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 5.50836178e-06],
       [ 2.25192039e-05],
       [-1.86524301e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.46316910e+03],
       [ 3.16550052e+03],
       [-4.57415414e+03],
       [-4.24334327e+00],
       [-2.24698484e+00],
       [-5.71954228e+00],
       [ 5.17479976e-01],
       [ 1.78613681e-01],
       [-8.08175175e-01],
       [ 2.17173927e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80107781e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.26936029e-03, -2.45964260e-02,  2.18778874e-02,
         8.88026594e-05,  2.20913415e-05,  1.54279117e-04],
       [-2.45964260e-02,  1.01925334e-01, -9.01293673e-02,
        -3.46205527e-04, -7.44828597e-05, -6.37736466e-04],
       [ 2.18778874e-02, -9.01293673e-02,  8.05992269e-02,
         3.08300086e-04,  7.99409025e-05,  5.71485811e-04],
       [ 8.88026594e-05, -3.46205527e-04,  3.08300086e-04,
         1.30184905e-06,  3.24530160e-07,  2.17309996e-06],
       [ 2.20913415e-05, -7.44828597e-05,  7.99409025e-05,
         3.24530160e-07,  8.09439080e-07,  4.03892714e-07],
       [ 1.54279117e-04, -6.37736466e-04,  5.71485811e-04,
         2.17309996e-06,  4.03892714e-07,  4.16611358e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-6.27220009e-06],
       [ 2.32554157e-05],
       [ 1.86491657e-01]])}}
Yi [[ 1.83386481]
 [-0.72227939]
 [13.20949845]]
posterior
[[ 4.46316910e+03]
 [ 3.16550052e+03]
 [-4.57415414e+03]
 [-4.24334327e+00]
 [-2.24698484e+00]
 [-5.71954228e+00]
 [ 5.17479976e-01]
 [ 1.78613681e-01]
 [-8.08175175e-01]
 [ 2.17173927e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80107781e-19]]
[[ 4.46316295e+03]
 [ 3.16554161e+03]
 [-4.57418526e+03]
 [-4.24342285e+00]
 [-2.24691311e+00]
 [-5.71976228e+00]
 [ 5.17479976e-01]
 [ 1.78613681e-01]
 [-8.08175175e-01]
 [ 2.17173927e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80107781e-19]]
[[ 6.08095591e-03 -2.33475989e-02  2.09513648e-02  8.63627142e-05
   2.45454202e-05  1.47764303e-04]
 [-2.33475989e-02  9.30260682e-02 -8.31819750e-02 -3.30230082e-04
  -8.75371554e-05 -5.88104679e-04]
 [ 2.09513648e-02 -8.31819750e-02  7.49964280e-02  2.96557133e-04
   8.78266112e-05  5.31074611e-04]
 [ 8.63627142e-05 -3.30230082e-04  2.96557133e-04  1.27018751e-06
   3.57330337e-07  2.09077786e-06]
 [ 2.45454202e-05 -8.75371554e-05  8.78266112e-05  3.57330337e-07
   7.60623408e-07  4.55273895e-07]
 [ 1.47764303e-04 -5.88104679e-04  5.31074611e-04  2.09077786e-06
   4.55273895e-07  3.87383882e-06]]
[[ 1.83387604]
 [-0.722287  ]
 [13.16574287]]
[[-1.12366408e-05]
 [ 7.61172008e-06]
 [ 4.37555800e-02]]


 Corrector Step
2018-07-12 20:20:20
[[ 4.46316295e+03]
 [ 3.16554161e+03]
 [-4.57418526e+03]
 [-4.24342285e+00]
 [-2.24691311e+00]
 [-5.71976228e+00]
 [ 5.17479976e-01]
 [ 1.78613681e-01]
 [-8.08175175e-01]
 [ 2.17173927e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80107781e-19]]
[[ 6.08095591e-03 -2.33475989e-02  2.09513648e-02  8.63627142e-05
   2.45454202e-05  1.47764303e-04]
 [-2.33475989e-02  9.30260682e-02 -8.31819750e-02 -3.30230082e-04
  -8.75371554e-05 -5.88104679e-04]
 [ 2.09513648e-02 -8.31819750e-02  7.49964280e-02  2.96557133e-04
   8.78266112e-05  5.31074611e-04]
 [ 8.63627142e-05 -3.30230082e-04  2.96557133e-04  1.27018751e-06
   3.57330337e-07  2.09077786e-06]
 [ 2.45454202e-05 -8.75371554e-05  8.78266112e-05  3.57330337e-07
   7.60623408e-07  4.55273895e-07]
 [ 1.47764303e-04 -5.88104679e-04  5.31074611e-04  2.09077786e-06
   4.55273895e-07  3.87383882e-06]]
579801530.5678856
post
cubesat_nadir
Ybar_post [[ 1.83387141]
 [-0.72228411]
 [13.16584239]]
resids [[-6.59861815e-06]
 [ 4.72427511e-06]
 [ 4.36560668e-02]]
posterior
[[ 4.46318757e+03]
 [ 3.16548989e+03]
 [-4.57414390e+03]
 [-4.24279011e+00]
 [-2.24791769e+00]
 [-5.71897494e+00]]
[[ 4.46318820e+03]
 [ 3.16548341e+03]
 [-4.57413350e+03]
 [-4.24277949e+00]
 [-2.24785048e+00]
 [-5.71889639e+00]]
[[ 5.66238053e-03 -2.19213780e-02  1.96475990e-02  7.87721398e-05
   2.27218269e-05  1.37961164e-04]
 [-2.19213780e-02  8.81628930e-02 -7.87266466e-02 -3.04721513e-04
  -8.29875265e-05 -5.53453552e-04]
 [ 1.96475990e-02 -7.87266466e-02  7.08971334e-02  2.73384043e-04
   8.29912748e-05  4.98893043e-04]
 [ 7.87721398e-05 -3.04721513e-04  2.73384043e-04  1.11558608e-06
   3.21709902e-07  1.92189530e-06]
 [ 2.27218269e-05 -8.29875265e-05  8.29912748e-05  3.21709902e-07
   7.06683932e-07  4.22574404e-07]
 [ 1.37961164e-04 -5.53453552e-04  4.98893043e-04  1.92189530e-06
   4.22574404e-07  3.59138562e-06]]
[[ 1.83386129]
 [-0.72228865]
 [13.59975958]]
[[ 3.51550882e-06]
 [ 9.26574897e-06]
 [-3.90261125e-01]]


 Corrector Step
2018-07-12 20:20:20
[[ 4.46318820e+03]
 [ 3.16548341e+03]
 [-4.57413350e+03]
 [-4.24277949e+00]
 [-2.24785048e+00]
 [-5.71889639e+00]]
[[ 5.66238053e-03 -2.19213780e-02  1.96475990e-02  7.87721398e-05
   2.27218269e-05  1.37961164e-04]
 [-2.19213780e-02  8.81628930e-02 -7.87266466e-02 -3.04721513e-04
  -8.29875265e-05 -5.53453552e-04]
 [ 1.96475990e-02 -7.87266466e-02  7.08971334e-02  2.73384043e-04
   8.29912748e-05  4.98893043e-04]
 [ 7.87721398e-05 -3.04721513e-04  2.73384043e-04  1.11558608e-06
   3.21709902e-07  1.92189530e-06]
 [ 2.27218269e-05 -8.29875265e-05  8.29912748e-05  3.21709902e-07
   7.06683932e-07  4.22574404e-07]
 [ 1.37961164e-04 -5.53453552e-04  4.98893043e-04  1.92189530e-06
   4.22574404e-07  3.59138562e-06]]
328819.03092462686
post
sphere_lamr_small
Ybar_post [[ 1.83386237]
 [-0.72228606]
 [13.59974828]]
resids [[ 2.43407146e-06]
 [ 6.67149576e-06]
 [-3.90249829e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [579801530.5678856, 328819.03092462686]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.46316295e+03],
       [ 3.16554161e+03],
       [-4.57418526e+03],
       [-4.24342285e+00],
       [-2.24691311e+00],
       [-5.71976228e+00]]), 'est_covars': array([[ 6.08095591e-03, -2.33475989e-02,  2.09513648e-02,
         8.63627142e-05,  2.45454202e-05,  1.47764303e-04],
       [-2.33475989e-02,  9.30260682e-02, -8.31819750e-02,
        -3.30230082e-04, -8.75371554e-05, -5.88104679e-04],
       [ 2.09513648e-02, -8.31819750e-02,  7.49964280e-02,
         2.96557133e-04,  8.78266112e-05,  5.31074611e-04],
       [ 8.63627142e-05, -3.30230082e-04,  2.96557133e-04,
         1.27018751e-06,  3.57330337e-07,  2.09077786e-06],
       [ 2.45454202e-05, -8.75371554e-05,  8.78266112e-05,
         3.57330337e-07,  7.60623408e-07,  4.55273895e-07],
       [ 1.47764303e-04, -5.88104679e-04,  5.31074611e-04,
         2.09077786e-06,  4.55273895e-07,  3.87383882e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.46318820e+03],
       [ 3.16548341e+03],
       [-4.57413350e+03],
       [-4.24277949e+00],
       [-2.24785048e+00],
       [-5.71889639e+00]]), 'covar': array([[ 5.66238053e-03, -2.19213780e-02,  1.96475990e-02,
         7.87721398e-05,  2.27218269e-05,  1.37961164e-04],
       [-2.19213780e-02,  8.81628930e-02, -7.87266466e-02,
        -3.04721513e-04, -8.29875265e-05, -5.53453552e-04],
       [ 1.96475990e-02, -7.87266466e-02,  7.08971334e-02,
         2.73384043e-04,  8.29912748e-05,  4.98893043e-04],
       [ 7.87721398e-05, -3.04721513e-04,  2.73384043e-04,
         1.11558608e-06,  3.21709902e-07,  1.92189530e-06],
       [ 2.27218269e-05, -8.29875265e-05,  8.29912748e-05,
         3.21709902e-07,  7.06683932e-07,  4.22574404e-07],
       [ 1.37961164e-04, -5.53453552e-04,  4.98893043e-04,
         1.92189530e-06,  4.22574404e-07,  3.59138562e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.43407146e-06],
       [ 6.67149576e-06],
       [-3.90249829e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.46316295e+03],
       [ 3.16554161e+03],
       [-4.57418526e+03],
       [-4.24342285e+00],
       [-2.24691311e+00],
       [-5.71976228e+00],
       [ 5.17479976e-01],
       [ 1.78613681e-01],
       [-8.08175175e-01],
       [ 2.17173927e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80107781e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.08095591e-03, -2.33475989e-02,  2.09513648e-02,
         8.63627142e-05,  2.45454202e-05,  1.47764303e-04],
       [-2.33475989e-02,  9.30260682e-02, -8.31819750e-02,
        -3.30230082e-04, -8.75371554e-05, -5.88104679e-04],
       [ 2.09513648e-02, -8.31819750e-02,  7.49964280e-02,
         2.96557133e-04,  8.78266112e-05,  5.31074611e-04],
       [ 8.63627142e-05, -3.30230082e-04,  2.96557133e-04,
         1.27018751e-06,  3.57330337e-07,  2.09077786e-06],
       [ 2.45454202e-05, -8.75371554e-05,  8.78266112e-05,
         3.57330337e-07,  7.60623408e-07,  4.55273895e-07],
       [ 1.47764303e-04, -5.88104679e-04,  5.31074611e-04,
         2.09077786e-06,  4.55273895e-07,  3.87383882e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-6.59861815e-06],
       [ 4.72427511e-06],
       [ 4.36560668e-02]])}}
Current time:  2018-07-12 20:20:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.46316295e+03],
       [ 3.16554161e+03],
       [-4.57418526e+03],
       [-4.24342285e+00],
       [-2.24691311e+00],
       [-5.71976228e+00],
       [ 5.17479976e-01],
       [ 1.78613681e-01],
       [-8.08175175e-01],
       [ 2.17173927e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80107781e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.08095591e-03, -2.33475989e-02,  2.09513648e-02,
         8.63627142e-05,  2.45454202e-05,  1.47764303e-04],
       [-2.33475989e-02,  9.30260682e-02, -8.31819750e-02,
        -3.30230082e-04, -8.75371554e-05, -5.88104679e-04],
       [ 2.09513648e-02, -8.31819750e-02,  7.49964280e-02,
         2.96557133e-04,  8.78266112e-05,  5.31074611e-04],
       [ 8.63627142e-05, -3.30230082e-04,  2.96557133e-04,
         1.27018751e-06,  3.57330337e-07,  2.09077786e-06],
       [ 2.45454202e-05, -8.75371554e-05,  8.78266112e-05,
         3.57330337e-07,  7.60623408e-07,  4.55273895e-07],
       [ 1.47764303e-04, -5.88104679e-04,  5.31074611e-04,
         2.09077786e-06,  4.55273895e-07,  3.87383882e-06]])}
[[ 4.46316295e+03]
 [ 3.16554161e+03]
 [-4.57418526e+03]
 [-4.24342285e+00]
 [-2.24691311e+00]
 [-5.71976228e+00]
 [ 5.17479976e-01]
 [ 1.78613681e-01]
 [-8.08175175e-01]
 [ 2.17173927e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80107781e-19]]
2018-07-12 20:20:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:30
[[ 4.42048437e+03]
 [ 3.14289910e+03]
 [-4.63113002e+03]
 [-4.29216051e+00]
 [-2.28152261e+00]
 [-5.66912816e+00]
 [ 5.13253186e-01]
 [ 1.77477313e-01]
 [-8.10866083e-01]
 [ 2.18103565e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80320068e-19]]
[[ 7.93015447e-03 -2.63593087e-02  2.55953258e-02  9.85256664e-05
   2.80639697e-05  1.68830680e-04]
 [-2.63593087e-02  9.13532434e-02 -8.81439674e-02 -3.24744028e-04
  -7.97212715e-05 -5.84330863e-04]
 [ 2.55953258e-02 -8.81439674e-02  8.60131879e-02  3.15617665e-04
   9.22207490e-05  5.70635612e-04]
 [ 9.85256664e-05 -3.24744028e-04  3.15617665e-04  1.26647712e-06
   3.54872650e-07  2.08116760e-06]
 [ 2.80639697e-05 -7.97212715e-05  9.22207490e-05  3.54872650e-07
   7.70166137e-07  4.54879551e-07]
 [ 1.68830680e-04 -5.84330863e-04  5.70635612e-04  2.08116760e-06
   4.54879551e-07  3.89375221e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.46318820e+03],
       [ 3.16548341e+03],
       [-4.57413350e+03],
       [-4.24277949e+00],
       [-2.24785048e+00],
       [-5.71889639e+00]]), 'covar': array([[ 5.66238053e-03, -2.19213780e-02,  1.96475990e-02,
         7.87721398e-05,  2.27218269e-05,  1.37961164e-04],
       [-2.19213780e-02,  8.81628930e-02, -7.87266466e-02,
        -3.04721513e-04, -8.29875265e-05, -5.53453552e-04],
       [ 1.96475990e-02, -7.87266466e-02,  7.08971334e-02,
         2.73384043e-04,  8.29912748e-05,  4.98893043e-04],
       [ 7.87721398e-05, -3.04721513e-04,  2.73384043e-04,
         1.11558608e-06,  3.21709902e-07,  1.92189530e-06],
       [ 2.27218269e-05, -8.29875265e-05,  8.29912748e-05,
         3.21709902e-07,  7.06683932e-07,  4.22574404e-07],
       [ 1.37961164e-04, -5.53453552e-04,  4.98893043e-04,
         1.92189530e-06,  4.22574404e-07,  3.59138562e-06]])}
[[ 4.46318820e+03]
 [ 3.16548341e+03]
 [-4.57413350e+03]
 [-4.24277949e+00]
 [-2.24785048e+00]
 [-5.71889639e+00]]
2018-07-12 20:20:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:30
[[ 4.42051639e+03]
 [ 3.14283153e+03]
 [-4.63106961e+03]
 [-4.29151848e+00]
 [-2.28246008e+00]
 [-5.66826190e+00]]
[[ 7.34422142e-03 -2.47004050e-02  2.39455575e-02  8.93776617e-05
   2.58873243e-05  1.57329497e-04]
 [-2.47004050e-02  8.65753475e-02 -8.33935242e-02 -2.99692792e-04
  -7.57678675e-05 -5.49968800e-04]
 [ 2.39455575e-02 -8.33935242e-02  8.12413844e-02  2.90856108e-04
   8.70659463e-05  5.35541063e-04]
 [ 8.93776617e-05 -2.99692792e-04  2.90856108e-04  1.10303847e-06
   3.19388604e-07  1.91282925e-06]
 [ 2.58873243e-05 -7.57678675e-05  8.70659463e-05  3.19388604e-07
   7.06345578e-07  4.22215457e-07]
 [ 1.57329497e-04 -5.49968800e-04  5.35541063e-04  1.91282925e-06
   4.22215457e-07  3.60084396e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.42051639e+03],
       [ 3.14283153e+03],
       [-4.63106961e+03],
       [-4.29151848e+00],
       [-2.28246008e+00],
       [-5.66826190e+00]]), 'covar': array([[ 7.34422142e-03, -2.47004050e-02,  2.39455575e-02,
         8.93776617e-05,  2.58873243e-05,  1.57329497e-04],
       [-2.47004050e-02,  8.65753475e-02, -8.33935242e-02,
        -2.99692792e-04, -7.57678675e-05, -5.49968800e-04],
       [ 2.39455575e-02, -8.33935242e-02,  8.12413844e-02,
         2.90856108e-04,  8.70659463e-05,  5.35541063e-04],
       [ 8.93776617e-05, -2.99692792e-04,  2.90856108e-04,
         1.10303847e-06,  3.19388604e-07,  1.91282925e-06],
       [ 2.58873243e-05, -7.57678675e-05,  8.70659463e-05,
         3.19388604e-07,  7.06345578e-07,  4.22215457e-07],
       [ 1.57329497e-04, -5.49968800e-04,  5.35541063e-04,
         1.91282925e-06,  4.22215457e-07,  3.60084396e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.43407146e-06],
       [ 6.67149576e-06],
       [-3.90249829e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.42048437e+03],
       [ 3.14289910e+03],
       [-4.63113002e+03],
       [-4.29216051e+00],
       [-2.28152261e+00],
       [-5.66912816e+00],
       [ 5.13253186e-01],
       [ 1.77477313e-01],
       [-8.10866083e-01],
       [ 2.18103565e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80320068e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.93015447e-03, -2.63593087e-02,  2.55953258e-02,
         9.85256664e-05,  2.80639697e-05,  1.68830680e-04],
       [-2.63593087e-02,  9.13532434e-02, -8.81439674e-02,
        -3.24744028e-04, -7.97212715e-05, -5.84330863e-04],
       [ 2.55953258e-02, -8.81439674e-02,  8.60131879e-02,
         3.15617665e-04,  9.22207490e-05,  5.70635612e-04],
       [ 9.85256664e-05, -3.24744028e-04,  3.15617665e-04,
         1.26647712e-06,  3.54872650e-07,  2.08116760e-06],
       [ 2.80639697e-05, -7.97212715e-05,  9.22207490e-05,
         3.54872650e-07,  7.70166137e-07,  4.54879551e-07],
       [ 1.68830680e-04, -5.84330863e-04,  5.70635612e-04,
         2.08116760e-06,  4.54879551e-07,  3.89375221e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-6.59861815e-06],
       [ 4.72427511e-06],
       [ 4.36560668e-02]])}}
Yi [[ 1.8798991 ]
 [-0.75938064]
 [12.99286081]]
posterior
[[ 4.42048437e+03]
 [ 3.14289910e+03]
 [-4.63113002e+03]
 [-4.29216051e+00]
 [-2.28152261e+00]
 [-5.66912816e+00]
 [ 5.13253186e-01]
 [ 1.77477313e-01]
 [-8.10866083e-01]
 [ 2.18103565e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80320068e-19]]
[[ 4.42048028e+03]
 [ 3.14292796e+03]
 [-4.63115937e+03]
 [-4.29219958e+00]
 [-2.28153392e+00]
 [-5.66933726e+00]
 [ 5.13253186e-01]
 [ 1.77477313e-01]
 [-8.10866083e-01]
 [ 2.18103565e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80320068e-19]]
[[ 7.63615554e-03 -2.48135237e-02  2.43142952e-02  9.52718659e-05
   3.10286094e-05  1.60070796e-04]
 [-2.48135237e-02  8.29869420e-02 -8.09994863e-02 -3.07842592e-04
  -9.31007351e-05 -5.35175519e-04]
 [ 2.43142952e-02 -8.09994863e-02  7.97293332e-02  3.01793623e-04
   1.01335557e-04  5.27150279e-04]
 [ 9.52718659e-05 -3.07842592e-04  3.01793623e-04  1.23028774e-06
   3.89594036e-07  1.98689624e-06]
 [ 3.10286094e-05 -9.31007351e-05  1.01335557e-04  3.89594036e-07
   7.19549183e-07  5.14416128e-07]
 [ 1.60070796e-04 -5.35175519e-04  5.27150279e-04  1.98689624e-06
   5.14416128e-07  3.59249035e-06]]
[[ 1.87991261]
 [-0.75937495]
 [13.081846  ]]
[[-1.35156307e-05]
 [-5.69567294e-06]
 [-8.89851879e-02]]


 Corrector Step
2018-07-12 20:20:30
[[ 4.42048028e+03]
 [ 3.14292796e+03]
 [-4.63115937e+03]
 [-4.29219958e+00]
 [-2.28153392e+00]
 [-5.66933726e+00]
 [ 5.13253186e-01]
 [ 1.77477313e-01]
 [-8.10866083e-01]
 [ 2.18103565e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80320068e-19]]
[[ 7.63615554e-03 -2.48135237e-02  2.43142952e-02  9.52718659e-05
   3.10286094e-05  1.60070796e-04]
 [-2.48135237e-02  8.29869420e-02 -8.09994863e-02 -3.07842592e-04
  -9.31007351e-05 -5.35175519e-04]
 [ 2.43142952e-02 -8.09994863e-02  7.97293332e-02  3.01793623e-04
   1.01335557e-04  5.27150279e-04]
 [ 9.52718659e-05 -3.07842592e-04  3.01793623e-04  1.23028774e-06
   3.89594036e-07  1.98689624e-06]
 [ 3.10286094e-05 -9.31007351e-05  1.01335557e-04  3.89594036e-07
   7.19549183e-07  5.14416128e-07]
 [ 1.60070796e-04 -5.35175519e-04  5.27150279e-04  1.98689624e-06
   5.14416128e-07  3.59249035e-06]]
422362799.0761463
post
cubesat_nadir
Ybar_post [[ 1.87990783]
 [-0.75937604]
 [13.08192216]]
resids [[-8.72634737e-06]
 [-4.60578177e-06]
 [-8.90613465e-02]]
posterior
[[ 4.42051639e+03]
 [ 3.14283153e+03]
 [-4.63106961e+03]
 [-4.29151848e+00]
 [-2.28246008e+00]
 [-5.66826190e+00]]
[[ 4.42051751e+03]
 [ 3.14283181e+03]
 [-4.63106962e+03]
 [-4.29150391e+00]
 [-2.28244822e+00]
 [-5.66826436e+00]]
[[ 7.00033778e-03 -2.29449604e-02  2.24563985e-02  8.53741990e-05
   2.83309003e-05  1.47207832e-04]
 [-2.29449604e-02  7.74653802e-02 -7.55044592e-02 -2.79258148e-04
  -8.63599759e-05 -4.96308027e-04]
 [ 2.24563985e-02 -7.55044592e-02  7.42368619e-02  2.73523165e-04
   9.39954816e-05  4.87855801e-04]
 [ 8.53741990e-05 -2.79258148e-04  2.73523165e-04  1.05643042e-06
   3.47858400e-07  1.79501954e-06]
 [ 2.83309003e-05 -8.63599759e-05  9.39954816e-05  3.47858400e-07
   6.64901346e-07  4.68816870e-07]
 [ 1.47207832e-04 -4.96308027e-04  4.87855801e-04  1.79501954e-06
   4.68816870e-07  3.27620338e-06]]
[[ 1.87990278]
 [-0.75938013]
 [13.55612326]]
[[-3.68086432e-06]
 [-5.10068846e-07]
 [-5.63262446e-01]]


 Corrector Step
2018-07-12 20:20:30
[[ 4.42051751e+03]
 [ 3.14283181e+03]
 [-4.63106962e+03]
 [-4.29150391e+00]
 [-2.28244822e+00]
 [-5.66826436e+00]]
[[ 7.00033778e-03 -2.29449604e-02  2.24563985e-02  8.53741990e-05
   2.83309003e-05  1.47207832e-04]
 [-2.29449604e-02  7.74653802e-02 -7.55044592e-02 -2.79258148e-04
  -8.63599759e-05 -4.96308027e-04]
 [ 2.24563985e-02 -7.55044592e-02  7.42368619e-02  2.73523165e-04
   9.39954816e-05  4.87855801e-04]
 [ 8.53741990e-05 -2.79258148e-04  2.73523165e-04  1.05643042e-06
   3.47858400e-07  1.79501954e-06]
 [ 2.83309003e-05 -8.63599759e-05  9.39954816e-05  3.47858400e-07
   6.64901346e-07  4.68816870e-07]
 [ 1.47207832e-04 -4.96308027e-04  4.87855801e-04  1.79501954e-06
   4.68816870e-07  3.27620338e-06]]
92.1245389563041
post
sphere_lamr_small
Ybar_post [[ 1.87990168]
 [-0.75938018]
 [13.55612303]]
resids [[-2.57799910e-06]
 [-4.62970230e-07]
 [-5.63262221e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [422362799.0761463, 92.1245389563041]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.42048028e+03],
       [ 3.14292796e+03],
       [-4.63115937e+03],
       [-4.29219958e+00],
       [-2.28153392e+00],
       [-5.66933726e+00]]), 'est_covars': array([[ 7.63615554e-03, -2.48135237e-02,  2.43142952e-02,
         9.52718659e-05,  3.10286094e-05,  1.60070796e-04],
       [-2.48135237e-02,  8.29869420e-02, -8.09994863e-02,
        -3.07842592e-04, -9.31007351e-05, -5.35175519e-04],
       [ 2.43142952e-02, -8.09994863e-02,  7.97293332e-02,
         3.01793623e-04,  1.01335557e-04,  5.27150279e-04],
       [ 9.52718659e-05, -3.07842592e-04,  3.01793623e-04,
         1.23028774e-06,  3.89594036e-07,  1.98689624e-06],
       [ 3.10286094e-05, -9.31007351e-05,  1.01335557e-04,
         3.89594036e-07,  7.19549183e-07,  5.14416128e-07],
       [ 1.60070796e-04, -5.35175519e-04,  5.27150279e-04,
         1.98689624e-06,  5.14416128e-07,  3.59249035e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.42051751e+03],
       [ 3.14283181e+03],
       [-4.63106962e+03],
       [-4.29150391e+00],
       [-2.28244822e+00],
       [-5.66826436e+00]]), 'covar': array([[ 7.00033778e-03, -2.29449604e-02,  2.24563985e-02,
         8.53741990e-05,  2.83309003e-05,  1.47207832e-04],
       [-2.29449604e-02,  7.74653802e-02, -7.55044592e-02,
        -2.79258148e-04, -8.63599759e-05, -4.96308027e-04],
       [ 2.24563985e-02, -7.55044592e-02,  7.42368619e-02,
         2.73523165e-04,  9.39954816e-05,  4.87855801e-04],
       [ 8.53741990e-05, -2.79258148e-04,  2.73523165e-04,
         1.05643042e-06,  3.47858400e-07,  1.79501954e-06],
       [ 2.83309003e-05, -8.63599759e-05,  9.39954816e-05,
         3.47858400e-07,  6.64901346e-07,  4.68816870e-07],
       [ 1.47207832e-04, -4.96308027e-04,  4.87855801e-04,
         1.79501954e-06,  4.68816870e-07,  3.27620338e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.57799910e-06],
       [-4.62970230e-07],
       [-5.63262221e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.42048028e+03],
       [ 3.14292796e+03],
       [-4.63115937e+03],
       [-4.29219958e+00],
       [-2.28153392e+00],
       [-5.66933726e+00],
       [ 5.13253186e-01],
       [ 1.77477313e-01],
       [-8.10866083e-01],
       [ 2.18103565e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80320068e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.63615554e-03, -2.48135237e-02,  2.43142952e-02,
         9.52718659e-05,  3.10286094e-05,  1.60070796e-04],
       [-2.48135237e-02,  8.29869420e-02, -8.09994863e-02,
        -3.07842592e-04, -9.31007351e-05, -5.35175519e-04],
       [ 2.43142952e-02, -8.09994863e-02,  7.97293332e-02,
         3.01793623e-04,  1.01335557e-04,  5.27150279e-04],
       [ 9.52718659e-05, -3.07842592e-04,  3.01793623e-04,
         1.23028774e-06,  3.89594036e-07,  1.98689624e-06],
       [ 3.10286094e-05, -9.31007351e-05,  1.01335557e-04,
         3.89594036e-07,  7.19549183e-07,  5.14416128e-07],
       [ 1.60070796e-04, -5.35175519e-04,  5.27150279e-04,
         1.98689624e-06,  5.14416128e-07,  3.59249035e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.72634737e-06],
       [-4.60578177e-06],
       [-8.90613465e-02]])}}
Current time:  2018-07-12 20:20:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.42048028e+03],
       [ 3.14292796e+03],
       [-4.63115937e+03],
       [-4.29219958e+00],
       [-2.28153392e+00],
       [-5.66933726e+00],
       [ 5.13253186e-01],
       [ 1.77477313e-01],
       [-8.10866083e-01],
       [ 2.18103565e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80320068e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.63615554e-03, -2.48135237e-02,  2.43142952e-02,
         9.52718659e-05,  3.10286094e-05,  1.60070796e-04],
       [-2.48135237e-02,  8.29869420e-02, -8.09994863e-02,
        -3.07842592e-04, -9.31007351e-05, -5.35175519e-04],
       [ 2.43142952e-02, -8.09994863e-02,  7.97293332e-02,
         3.01793623e-04,  1.01335557e-04,  5.27150279e-04],
       [ 9.52718659e-05, -3.07842592e-04,  3.01793623e-04,
         1.23028774e-06,  3.89594036e-07,  1.98689624e-06],
       [ 3.10286094e-05, -9.31007351e-05,  1.01335557e-04,
         3.89594036e-07,  7.19549183e-07,  5.14416128e-07],
       [ 1.60070796e-04, -5.35175519e-04,  5.27150279e-04,
         1.98689624e-06,  5.14416128e-07,  3.59249035e-06]])}
[[ 4.42048028e+03]
 [ 3.14292796e+03]
 [-4.63115937e+03]
 [-4.29219958e+00]
 [-2.28153392e+00]
 [-5.66933726e+00]
 [ 5.13253186e-01]
 [ 1.77477313e-01]
 [-8.10866083e-01]
 [ 2.18103565e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80320068e-19]]
2018-07-12 20:20:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:40
[[ 4.37731634e+03]
 [ 3.11994050e+03]
 [-4.68759709e+03]
 [-4.34045948e+00]
 [-2.31588855e+00]
 [-5.61808642e+00]
 [ 5.09012404e-01]
 [ 1.76336106e-01]
 [-8.13534886e-01]
 [ 2.19027256e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80532355e-19]]
[[ 9.65899201e-03 -2.75340052e-02  2.91234312e-02  1.06984030e-04
   3.48567598e-05  1.80110470e-04]
 [-2.75340052e-02  8.11988606e-02 -8.52907514e-02 -3.02165987e-04
  -8.56855545e-05 -5.30722140e-04]
 [ 2.91234312e-02 -8.52907514e-02  9.06390621e-02  3.19787629e-04
   1.06296193e-04  5.63868460e-04]
 [ 1.06984030e-04 -3.02165987e-04  3.19787629e-04  1.22691560e-06
   3.86846404e-07  1.97768585e-06]
 [ 3.48567598e-05 -8.56855545e-05  1.06296193e-04  3.86846404e-07
   7.29001937e-07  5.13978156e-07]
 [ 1.80110470e-04 -5.30722140e-04  5.63868460e-04  1.97768585e-06
   5.13978156e-07  3.61146653e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.42051751e+03],
       [ 3.14283181e+03],
       [-4.63106962e+03],
       [-4.29150391e+00],
       [-2.28244822e+00],
       [-5.66826436e+00]]), 'covar': array([[ 7.00033778e-03, -2.29449604e-02,  2.24563985e-02,
         8.53741990e-05,  2.83309003e-05,  1.47207832e-04],
       [-2.29449604e-02,  7.74653802e-02, -7.55044592e-02,
        -2.79258148e-04, -8.63599759e-05, -4.96308027e-04],
       [ 2.24563985e-02, -7.55044592e-02,  7.42368619e-02,
         2.73523165e-04,  9.39954816e-05,  4.87855801e-04],
       [ 8.53741990e-05, -2.79258148e-04,  2.73523165e-04,
         1.05643042e-06,  3.47858400e-07,  1.79501954e-06],
       [ 2.83309003e-05, -8.63599759e-05,  9.39954816e-05,
         3.47858400e-07,  6.64901346e-07,  4.68816870e-07],
       [ 1.47207832e-04, -4.96308027e-04,  4.87855801e-04,
         1.79501954e-06,  4.68816870e-07,  3.27620338e-06]])}
[[ 4.42051751e+03]
 [ 3.14283181e+03]
 [-4.63106962e+03]
 [-4.29150391e+00]
 [-2.28244822e+00]
 [-5.66826436e+00]]
2018-07-12 20:20:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:40
[[ 4.37736051e+03]
 [ 3.11983528e+03]
 [-4.68749622e+03]
 [-4.33976592e+00]
 [-2.31680289e+00]
 [-5.61701301e+00]]
[[ 8.80805009e-03 -2.54113767e-02  2.68353320e-02  9.53485950e-05
   3.17464413e-05  1.65316533e-04]
 [-2.54113767e-02  7.58062515e-02 -7.94848313e-02 -2.74118357e-04
  -7.95509968e-05 -4.92267574e-04]
 [ 2.68353320e-02 -7.94848313e-02  8.43285931e-02  2.89726981e-04
   9.85115164e-05  5.21314219e-04]
 [ 9.53485950e-05 -2.74118357e-04  2.89726981e-04  1.04440352e-06
   3.45313144e-07  1.78645822e-06]
 [ 3.17464413e-05 -7.95509968e-05  9.85115164e-05  3.45313144e-07
   6.64485559e-07  4.68417137e-07]
 [ 1.65316533e-04 -4.92267574e-04  5.21314219e-04  1.78645822e-06
   4.68417137e-07  3.28465913e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.37736051e+03],
       [ 3.11983528e+03],
       [-4.68749622e+03],
       [-4.33976592e+00],
       [-2.31680289e+00],
       [-5.61701301e+00]]), 'covar': array([[ 8.80805009e-03, -2.54113767e-02,  2.68353320e-02,
         9.53485950e-05,  3.17464413e-05,  1.65316533e-04],
       [-2.54113767e-02,  7.58062515e-02, -7.94848313e-02,
        -2.74118357e-04, -7.95509968e-05, -4.92267574e-04],
       [ 2.68353320e-02, -7.94848313e-02,  8.43285931e-02,
         2.89726981e-04,  9.85115164e-05,  5.21314219e-04],
       [ 9.53485950e-05, -2.74118357e-04,  2.89726981e-04,
         1.04440352e-06,  3.45313144e-07,  1.78645822e-06],
       [ 3.17464413e-05, -7.95509968e-05,  9.85115164e-05,
         3.45313144e-07,  6.64485559e-07,  4.68417137e-07],
       [ 1.65316533e-04, -4.92267574e-04,  5.21314219e-04,
         1.78645822e-06,  4.68417137e-07,  3.28465913e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.57799910e-06],
       [-4.62970230e-07],
       [-5.63262221e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.37731634e+03],
       [ 3.11994050e+03],
       [-4.68759709e+03],
       [-4.34045948e+00],
       [-2.31588855e+00],
       [-5.61808642e+00],
       [ 5.09012404e-01],
       [ 1.76336106e-01],
       [-8.13534886e-01],
       [ 2.19027256e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80532355e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.65899201e-03, -2.75340052e-02,  2.91234312e-02,
         1.06984030e-04,  3.48567598e-05,  1.80110470e-04],
       [-2.75340052e-02,  8.11988606e-02, -8.52907514e-02,
        -3.02165987e-04, -8.56855545e-05, -5.30722140e-04],
       [ 2.91234312e-02, -8.52907514e-02,  9.06390621e-02,
         3.19787629e-04,  1.06296193e-04,  5.63868460e-04],
       [ 1.06984030e-04, -3.02165987e-04,  3.19787629e-04,
         1.22691560e-06,  3.86846404e-07,  1.97768585e-06],
       [ 3.48567598e-05, -8.56855545e-05,  1.06296193e-04,
         3.86846404e-07,  7.29001937e-07,  5.13978156e-07],
       [ 1.80110470e-04, -5.30722140e-04,  5.63868460e-04,
         1.97768585e-06,  5.13978156e-07,  3.61146653e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.72634737e-06],
       [-4.60578177e-06],
       [-8.90613465e-02]])}}
Yi [[ 1.92766089]
 [-0.79367711]
 [13.14393171]]
posterior
[[ 4.37731634e+03]
 [ 3.11994050e+03]
 [-4.68759709e+03]
 [-4.34045948e+00]
 [-2.31588855e+00]
 [-5.61808642e+00]
 [ 5.09012404e-01]
 [ 1.76336106e-01]
 [-8.13534886e-01]
 [ 2.19027256e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80532355e-19]]
[[ 4.37732122e+03]
 [ 3.11992440e+03]
 [-4.68759185e+03]
 [-4.34040241e+00]
 [-2.31603692e+00]
 [-5.61805864e+00]
 [ 5.09012404e-01]
 [ 1.76336106e-01]
 [-8.13534886e-01]
 [ 2.19027256e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80532355e-19]]
[[ 9.25826496e-03 -2.58023273e-02  2.75445065e-02  1.03096899e-04
   3.80738746e-05  1.69718370e-04]
 [-2.58023273e-02  7.36298850e-02 -7.82610957e-02 -2.85520857e-04
  -9.81752244e-05 -4.84346776e-04]
 [ 2.75445065e-02 -7.82610957e-02  8.39179930e-02  3.04840052e-04
   1.15536958e-04  5.19371678e-04]
 [ 1.03096899e-04 -2.85520857e-04  3.04840052e-04  1.18893813e-06
   4.20579521e-07  1.87949651e-06]
 [ 3.80738746e-05 -9.81752244e-05  1.15536958e-04  4.20579521e-07
   6.79450316e-07  5.73014268e-07]
 [ 1.69718370e-04 -4.84346776e-04  5.19371678e-04  1.87949651e-06
   5.73014268e-07  3.31675027e-06]]
[[ 1.92766076]
 [-0.79365671]
 [13.02380729]]
[[ 1.27229057e-07]
 [-2.04013331e-05]
 [ 1.20124427e-01]]


 Corrector Step
2018-07-12 20:20:40
[[ 4.37732122e+03]
 [ 3.11992440e+03]
 [-4.68759185e+03]
 [-4.34040241e+00]
 [-2.31603692e+00]
 [-5.61805864e+00]
 [ 5.09012404e-01]
 [ 1.76336106e-01]
 [-8.13534886e-01]
 [ 2.19027256e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80532355e-19]]
[[ 9.25826496e-03 -2.58023273e-02  2.75445065e-02  1.03096899e-04
   3.80738746e-05  1.69718370e-04]
 [-2.58023273e-02  7.36298850e-02 -7.82610957e-02 -2.85520857e-04
  -9.81752244e-05 -4.84346776e-04]
 [ 2.75445065e-02 -7.82610957e-02  8.39179930e-02  3.04840052e-04
   1.15536958e-04  5.19371678e-04]
 [ 1.03096899e-04 -2.85520857e-04  3.04840052e-04  1.18893813e-06
   4.20579521e-07  1.87949651e-06]
 [ 3.80738746e-05 -9.81752244e-05  1.15536958e-04  4.20579521e-07
   6.79450316e-07  5.73014268e-07]
 [ 1.69718370e-04 -4.84346776e-04  5.19371678e-04  1.87949651e-06
   5.73014268e-07  3.31675027e-06]]
270555471.5989631
post
cubesat_nadir
Ybar_post [[ 1.92766184]
 [-0.79366254]
 [13.02377921]]
resids [[-9.46908778e-07]
 [-1.45708560e-05]
 [ 1.20152502e-01]]
posterior
[[ 4.37736051e+03]
 [ 3.11983528e+03]
 [-4.68749622e+03]
 [-4.33976592e+00]
 [-2.31680289e+00]
 [-5.61701301e+00]]
[[ 4.37736885e+03]
 [ 3.11980543e+03]
 [-4.68747262e+03]
 [-4.33967807e+00]
 [-2.31689089e+00]
 [-5.61685893e+00]]
[[ 8.34184888e-03 -2.34628013e-02  2.50198840e-02  9.05385913e-05
   3.44067105e-05  1.53459570e-04]
 [-2.34628013e-02  6.76209962e-02 -7.17734668e-02 -2.54026905e-04
  -8.96442382e-05 -4.41942271e-04]
 [ 2.50198840e-02 -7.17734668e-02  7.68833345e-02  2.71034975e-04
   1.05731612e-04  4.72807516e-04]
 [ 9.05385913e-05 -2.54026905e-04  2.71034975e-04  9.94772531e-07
   3.73082251e-07  1.66436578e-06]
 [ 3.44067105e-05 -8.96442382e-05  1.05731612e-04  3.73082251e-07
   6.22989994e-07  5.16577364e-07]
 [ 1.53459570e-04 -4.41942271e-04  4.72807516e-04  1.66436578e-06
   5.16577364e-07  2.96859584e-06]]
[[ 1.92765611]
 [-0.79366413]
 [13.521662  ]]
[[ 4.77639135e-06]
 [-1.29805548e-05]
 [-3.77730283e-01]]


 Corrector Step
2018-07-12 20:20:40
[[ 4.37736885e+03]
 [ 3.11980543e+03]
 [-4.68747262e+03]
 [-4.33967807e+00]
 [-2.31689089e+00]
 [-5.61685893e+00]]
[[ 8.34184888e-03 -2.34628013e-02  2.50198840e-02  9.05385913e-05
   3.44067105e-05  1.53459570e-04]
 [-2.34628013e-02  6.76209962e-02 -7.17734668e-02 -2.54026905e-04
  -8.96442382e-05 -4.41942271e-04]
 [ 2.50198840e-02 -7.17734668e-02  7.68833345e-02  2.71034975e-04
   1.05731612e-04  4.72807516e-04]
 [ 9.05385913e-05 -2.54026905e-04  2.71034975e-04  9.94772531e-07
   3.73082251e-07  1.66436578e-06]
 [ 3.44067105e-05 -8.96442382e-05  1.05731612e-04  3.73082251e-07
   6.22989994e-07  5.16577364e-07]
 [ 1.53459570e-04 -4.41942271e-04  4.72807516e-04  1.66436578e-06
   5.16577364e-07  2.96859584e-06]]
522142.3866484925
post
sphere_lamr_small
Ybar_post [[ 1.92765875]
 [-0.79366797]
 [13.52159418]]
resids [[ 2.13681558e-06]
 [-9.14103591e-06]
 [-3.77662462e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [270555471.5989631, 522142.3866484925]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.37732122e+03],
       [ 3.11992440e+03],
       [-4.68759185e+03],
       [-4.34040241e+00],
       [-2.31603692e+00],
       [-5.61805864e+00]]), 'est_covars': array([[ 9.25826496e-03, -2.58023273e-02,  2.75445065e-02,
         1.03096899e-04,  3.80738746e-05,  1.69718370e-04],
       [-2.58023273e-02,  7.36298850e-02, -7.82610957e-02,
        -2.85520857e-04, -9.81752244e-05, -4.84346776e-04],
       [ 2.75445065e-02, -7.82610957e-02,  8.39179930e-02,
         3.04840052e-04,  1.15536958e-04,  5.19371678e-04],
       [ 1.03096899e-04, -2.85520857e-04,  3.04840052e-04,
         1.18893813e-06,  4.20579521e-07,  1.87949651e-06],
       [ 3.80738746e-05, -9.81752244e-05,  1.15536958e-04,
         4.20579521e-07,  6.79450316e-07,  5.73014268e-07],
       [ 1.69718370e-04, -4.84346776e-04,  5.19371678e-04,
         1.87949651e-06,  5.73014268e-07,  3.31675027e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.37736885e+03],
       [ 3.11980543e+03],
       [-4.68747262e+03],
       [-4.33967807e+00],
       [-2.31689089e+00],
       [-5.61685893e+00]]), 'covar': array([[ 8.34184888e-03, -2.34628013e-02,  2.50198840e-02,
         9.05385913e-05,  3.44067105e-05,  1.53459570e-04],
       [-2.34628013e-02,  6.76209962e-02, -7.17734668e-02,
        -2.54026905e-04, -8.96442382e-05, -4.41942271e-04],
       [ 2.50198840e-02, -7.17734668e-02,  7.68833345e-02,
         2.71034975e-04,  1.05731612e-04,  4.72807516e-04],
       [ 9.05385913e-05, -2.54026905e-04,  2.71034975e-04,
         9.94772531e-07,  3.73082251e-07,  1.66436578e-06],
       [ 3.44067105e-05, -8.96442382e-05,  1.05731612e-04,
         3.73082251e-07,  6.22989994e-07,  5.16577364e-07],
       [ 1.53459570e-04, -4.41942271e-04,  4.72807516e-04,
         1.66436578e-06,  5.16577364e-07,  2.96859584e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.13681558e-06],
       [-9.14103591e-06],
       [-3.77662462e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.37732122e+03],
       [ 3.11992440e+03],
       [-4.68759185e+03],
       [-4.34040241e+00],
       [-2.31603692e+00],
       [-5.61805864e+00],
       [ 5.09012404e-01],
       [ 1.76336106e-01],
       [-8.13534886e-01],
       [ 2.19027256e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80532355e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.25826496e-03, -2.58023273e-02,  2.75445065e-02,
         1.03096899e-04,  3.80738746e-05,  1.69718370e-04],
       [-2.58023273e-02,  7.36298850e-02, -7.82610957e-02,
        -2.85520857e-04, -9.81752244e-05, -4.84346776e-04],
       [ 2.75445065e-02, -7.82610957e-02,  8.39179930e-02,
         3.04840052e-04,  1.15536958e-04,  5.19371678e-04],
       [ 1.03096899e-04, -2.85520857e-04,  3.04840052e-04,
         1.18893813e-06,  4.20579521e-07,  1.87949651e-06],
       [ 3.80738746e-05, -9.81752244e-05,  1.15536958e-04,
         4.20579521e-07,  6.79450316e-07,  5.73014268e-07],
       [ 1.69718370e-04, -4.84346776e-04,  5.19371678e-04,
         1.87949651e-06,  5.73014268e-07,  3.31675027e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-9.46908778e-07],
       [-1.45708560e-05],
       [ 1.20152502e-01]])}}
Current time:  2018-07-12 20:20:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.37732122e+03],
       [ 3.11992440e+03],
       [-4.68759185e+03],
       [-4.34040241e+00],
       [-2.31603692e+00],
       [-5.61805864e+00],
       [ 5.09012404e-01],
       [ 1.76336106e-01],
       [-8.13534886e-01],
       [ 2.19027256e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80532355e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.25826496e-03, -2.58023273e-02,  2.75445065e-02,
         1.03096899e-04,  3.80738746e-05,  1.69718370e-04],
       [-2.58023273e-02,  7.36298850e-02, -7.82610957e-02,
        -2.85520857e-04, -9.81752244e-05, -4.84346776e-04],
       [ 2.75445065e-02, -7.82610957e-02,  8.39179930e-02,
         3.04840052e-04,  1.15536958e-04,  5.19371678e-04],
       [ 1.03096899e-04, -2.85520857e-04,  3.04840052e-04,
         1.18893813e-06,  4.20579521e-07,  1.87949651e-06],
       [ 3.80738746e-05, -9.81752244e-05,  1.15536958e-04,
         4.20579521e-07,  6.79450316e-07,  5.73014268e-07],
       [ 1.69718370e-04, -4.84346776e-04,  5.19371678e-04,
         1.87949651e-06,  5.73014268e-07,  3.31675027e-06]])}
[[ 4.37732122e+03]
 [ 3.11992440e+03]
 [-4.68759185e+03]
 [-4.34040241e+00]
 [-2.31603692e+00]
 [-5.61805864e+00]
 [ 5.09012404e-01]
 [ 1.76336106e-01]
 [-8.13534886e-01]
 [ 2.19027256e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80532355e-19]]
2018-07-12 20:20:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:50
[[ 4.33367792e+03]
 [ 3.09659345e+03]
 [-4.74351364e+03]
 [-4.38817992e+00]
 [-2.35013271e+00]
 [-5.56619682e+00]
 [ 5.04757745e-01]
 [ 1.75190093e-01]
 [-8.16181510e-01]
 [ 2.19944977e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80744642e-19]]
[[ 1.14328378e-02 -2.82268437e-02  3.24697468e-02  1.14349768e-04
   4.21981081e-05  1.88693076e-04]
 [-2.82268437e-02  7.17363631e-02 -8.18959357e-02 -2.79664077e-04
  -9.11535294e-05 -4.79227250e-04]
 [ 3.24697468e-02 -8.18959357e-02  9.46442694e-02  3.21742760e-04
   1.21058882e-04  5.53301218e-04]
 [ 1.14349768e-04 -2.79664077e-04  3.21742760e-04  1.18593993e-06
   4.17542193e-07  1.87070462e-06]
 [ 4.21981081e-05 -9.11535294e-05  1.21058882e-04  4.17542193e-07
   6.88801839e-07  5.72544689e-07]
 [ 1.88693076e-04 -4.79227250e-04  5.53301218e-04  1.87070462e-06
   5.72544689e-07  3.33485483e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.37736885e+03],
       [ 3.11980543e+03],
       [-4.68747262e+03],
       [-4.33967807e+00],
       [-2.31689089e+00],
       [-5.61685893e+00]]), 'covar': array([[ 8.34184888e-03, -2.34628013e-02,  2.50198840e-02,
         9.05385913e-05,  3.44067105e-05,  1.53459570e-04],
       [-2.34628013e-02,  6.76209962e-02, -7.17734668e-02,
        -2.54026905e-04, -8.96442382e-05, -4.41942271e-04],
       [ 2.50198840e-02, -7.17734668e-02,  7.68833345e-02,
         2.71034975e-04,  1.05731612e-04,  4.72807516e-04],
       [ 9.05385913e-05, -2.54026905e-04,  2.71034975e-04,
         9.94772531e-07,  3.73082251e-07,  1.66436578e-06],
       [ 3.44067105e-05, -8.96442382e-05,  1.05731612e-04,
         3.73082251e-07,  6.22989994e-07,  5.16577364e-07],
       [ 1.53459570e-04, -4.41942271e-04,  4.72807516e-04,
         1.66436578e-06,  5.16577364e-07,  2.96859584e-06]])}
[[ 4.37736885e+03]
 [ 3.11980543e+03]
 [-4.68747262e+03]
 [-4.33967807e+00]
 [-2.31689089e+00]
 [-5.61685893e+00]]
2018-07-12 20:20:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:20:50
[[ 4.33373264e+03]
 [ 3.09646565e+03]
 [-4.74338227e+03]
 [-4.38745838e+00]
 [-2.35098700e+00]
 [-5.56499592e+00]]
[[ 1.02462686e-02 -2.56143626e-02  2.94235781e-02  9.98647470e-05
   3.80627887e-05  1.70267279e-04]
 [-2.56143626e-02  6.58921369e-02 -7.50877617e-02 -2.48780821e-04
  -8.32500376e-05 -4.37340689e-04]
 [ 2.94235781e-02 -7.50877617e-02  8.66428102e-02  2.85944493e-04
   1.10704977e-04  5.03150533e-04]
 [ 9.98647470e-05 -2.48780821e-04  2.85944493e-04  9.83310566e-07
   3.70310936e-07  1.65632513e-06]
 [ 3.80627887e-05 -8.32500376e-05  1.10704977e-04  3.70310936e-07
   6.22486671e-07  5.16154520e-07]
 [ 1.70267279e-04 -4.37340689e-04  5.03150533e-04  1.65632513e-06
   5.16154520e-07  2.97612575e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.33373264e+03],
       [ 3.09646565e+03],
       [-4.74338227e+03],
       [-4.38745838e+00],
       [-2.35098700e+00],
       [-5.56499592e+00]]), 'covar': array([[ 1.02462686e-02, -2.56143626e-02,  2.94235781e-02,
         9.98647470e-05,  3.80627887e-05,  1.70267279e-04],
       [-2.56143626e-02,  6.58921369e-02, -7.50877617e-02,
        -2.48780821e-04, -8.32500376e-05, -4.37340689e-04],
       [ 2.94235781e-02, -7.50877617e-02,  8.66428102e-02,
         2.85944493e-04,  1.10704977e-04,  5.03150533e-04],
       [ 9.98647470e-05, -2.48780821e-04,  2.85944493e-04,
         9.83310566e-07,  3.70310936e-07,  1.65632513e-06],
       [ 3.80627887e-05, -8.32500376e-05,  1.10704977e-04,
         3.70310936e-07,  6.22486671e-07,  5.16154520e-07],
       [ 1.70267279e-04, -4.37340689e-04,  5.03150533e-04,
         1.65632513e-06,  5.16154520e-07,  2.97612575e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.13681558e-06],
       [-9.14103591e-06],
       [-3.77662462e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.33367792e+03],
       [ 3.09659345e+03],
       [-4.74351364e+03],
       [-4.38817992e+00],
       [-2.35013271e+00],
       [-5.56619682e+00],
       [ 5.04757745e-01],
       [ 1.75190093e-01],
       [-8.16181510e-01],
       [ 2.19944977e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80744642e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.14328378e-02, -2.82268437e-02,  3.24697468e-02,
         1.14349768e-04,  4.21981081e-05,  1.88693076e-04],
       [-2.82268437e-02,  7.17363631e-02, -8.18959357e-02,
        -2.79664077e-04, -9.11535294e-05, -4.79227250e-04],
       [ 3.24697468e-02, -8.18959357e-02,  9.46442694e-02,
         3.21742760e-04,  1.21058882e-04,  5.53301218e-04],
       [ 1.14349768e-04, -2.79664077e-04,  3.21742760e-04,
         1.18593993e-06,  4.17542193e-07,  1.87070462e-06],
       [ 4.21981081e-05, -9.11535294e-05,  1.21058882e-04,
         4.17542193e-07,  6.88801839e-07,  5.72544689e-07],
       [ 1.88693076e-04, -4.79227250e-04,  5.53301218e-04,
         1.87070462e-06,  5.72544689e-07,  3.33485483e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-9.46908778e-07],
       [-1.45708560e-05],
       [ 1.20152502e-01]])}}
Yi [[ 1.97702682]
 [-0.82508982]
 [12.9220336 ]]
posterior
[[ 4.33367792e+03]
 [ 3.09659345e+03]
 [-4.74351364e+03]
 [-4.38817992e+00]
 [-2.35013271e+00]
 [-5.56619682e+00]
 [ 5.04757745e-01]
 [ 1.75190093e-01]
 [-8.16181510e-01]
 [ 2.19944977e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80744642e-19]]
[[ 4.33370981e+03]
 [ 3.09647749e+03]
 [-4.74339749e+03]
 [-4.38790469e+00]
 [-2.35032684e+00]
 [-5.56546483e+00]
 [ 5.04757745e-01]
 [ 1.75190093e-01]
 [-8.16181510e-01]
 [ 2.19944977e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80744642e-19]]
[[ 1.09373043e-02 -2.64203407e-02  3.06708702e-02  1.10069802e-04
   4.53685514e-05  1.77350964e-04]
 [-2.64203407e-02  6.51262614e-02 -7.52435425e-02 -2.64151579e-04
  -1.01930861e-04 -4.37252386e-04]
 [ 3.06708702e-02 -7.52435425e-02  8.77419425e-02  3.06560939e-04
   1.29466873e-04  5.09661753e-04]
 [ 1.10069802e-04 -2.64151579e-04  3.06560939e-04  1.14863420e-06
   4.47882335e-07  1.77509600e-06]
 [ 4.53685514e-05 -1.01930861e-04  1.29466873e-04  4.47882335e-07
   6.42555365e-07  6.24569320e-07]
 [ 1.77350964e-04 -4.37252386e-04  5.09661753e-04  1.77509600e-06
   6.24569320e-07  3.05891059e-06]]
[[ 1.97698471]
 [-0.82507613]
 [12.98762751]]
[[ 4.21081307e-05]
 [-1.36840675e-05]
 [-6.55939069e-02]]


 Corrector Step
2018-07-12 20:20:50
[[ 4.33370981e+03]
 [ 3.09647749e+03]
 [-4.74339749e+03]
 [-4.38790469e+00]
 [-2.35032684e+00]
 [-5.56546483e+00]
 [ 5.04757745e-01]
 [ 1.75190093e-01]
 [-8.16181510e-01]
 [ 2.19944977e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80744642e-19]]
[[ 1.09373043e-02 -2.64203407e-02  3.06708702e-02  1.10069802e-04
   4.53685514e-05  1.77350964e-04]
 [-2.64203407e-02  6.51262614e-02 -7.52435425e-02 -2.64151579e-04
  -1.01930861e-04 -4.37252386e-04]
 [ 3.06708702e-02 -7.52435425e-02  8.77419425e-02  3.06560939e-04
   1.29466873e-04  5.09661753e-04]
 [ 1.10069802e-04 -2.64151579e-04  3.06560939e-04  1.14863420e-06
   4.47882335e-07  1.77509600e-06]
 [ 4.53685514e-05 -1.01930861e-04  1.29466873e-04  4.47882335e-07
   6.42555365e-07  6.24569320e-07]
 [ 1.77350964e-04 -4.37252386e-04  5.09661753e-04  1.77509600e-06
   6.24569320e-07  3.05891059e-06]]
215245776.95178655
post
cubesat_nadir
Ybar_post [[ 1.97700146]
 [-0.8250821 ]
 [12.98734319]]
resids [[ 2.53599635e-05]
 [-7.71332940e-06]
 [-6.53095914e-02]]
posterior
[[ 4.33373264e+03]
 [ 3.09646565e+03]
 [-4.74338227e+03]
 [-4.38745838e+00]
 [-2.35098700e+00]
 [-5.56499592e+00]]
[[ 4.33376819e+03]
 [ 3.09634339e+03]
 [-4.74325343e+03]
 [-4.38712736e+00]
 [-2.35107846e+00]
 [-5.56419914e+00]]
[[ 9.67009538e-03 -2.35881036e-02  2.73628293e-02  9.45127031e-05
   4.06434185e-05  1.57403449e-04]
 [-2.35881036e-02  5.87611582e-02 -6.78050845e-02 -2.29965472e-04
  -9.19620182e-05 -3.91908150e-04]
 [ 2.73628293e-02 -6.78050845e-02  7.90120237e-02  2.66848964e-04
   1.17238495e-04  4.55727347e-04]
 [ 9.45127031e-05 -2.29965472e-04  2.66848964e-04  9.33587298e-07
   3.94764014e-07  1.53708740e-06]
 [ 4.06434185e-05 -9.19620182e-05  1.17238495e-04  3.94764014e-07
   5.82917114e-07  5.59129257e-07]
 [ 1.57403449e-04 -3.91908150e-04  4.55727347e-04  1.53708740e-06
   5.59129257e-07  2.68123839e-06]]
[[ 1.97698498]
 [-0.825085  ]
 [13.49567246]]
[[ 4.18399098e-05]
 [-4.81787661e-06]
 [-5.73638865e-01]]


 Corrector Step
2018-07-12 20:20:50
[[ 4.33376819e+03]
 [ 3.09634339e+03]
 [-4.74325343e+03]
 [-4.38712736e+00]
 [-2.35107846e+00]
 [-5.56419914e+00]]
[[ 9.67009538e-03 -2.35881036e-02  2.73628293e-02  9.45127031e-05
   4.06434185e-05  1.57403449e-04]
 [-2.35881036e-02  5.87611582e-02 -6.78050845e-02 -2.29965472e-04
  -9.19620182e-05 -3.91908150e-04]
 [ 2.73628293e-02 -6.78050845e-02  7.90120237e-02  2.66848964e-04
   1.17238495e-04  4.55727347e-04]
 [ 9.45127031e-05 -2.29965472e-04  2.66848964e-04  9.33587298e-07
   3.94764014e-07  1.53708740e-06]
 [ 4.06434185e-05 -9.19620182e-05  1.17238495e-04  3.94764014e-07
   5.82917114e-07  5.59129257e-07]
 [ 1.57403449e-04 -3.91908150e-04  4.55727347e-04  1.53708740e-06
   5.59129257e-07  2.68123839e-06]]
21.014605897002077
post
sphere_lamr_small
Ybar_post [[ 1.97700081]
 [-0.82508876]
 [13.49539427]]
resids [[ 2.60116105e-05]
 [-1.05774126e-06]
 [-5.73360668e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [215245776.95178655, 21.014605897002077]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.33370981e+03],
       [ 3.09647749e+03],
       [-4.74339749e+03],
       [-4.38790469e+00],
       [-2.35032684e+00],
       [-5.56546483e+00]]), 'est_covars': array([[ 1.09373043e-02, -2.64203407e-02,  3.06708702e-02,
         1.10069802e-04,  4.53685514e-05,  1.77350964e-04],
       [-2.64203407e-02,  6.51262614e-02, -7.52435425e-02,
        -2.64151579e-04, -1.01930861e-04, -4.37252386e-04],
       [ 3.06708702e-02, -7.52435425e-02,  8.77419425e-02,
         3.06560939e-04,  1.29466873e-04,  5.09661753e-04],
       [ 1.10069802e-04, -2.64151579e-04,  3.06560939e-04,
         1.14863420e-06,  4.47882335e-07,  1.77509600e-06],
       [ 4.53685514e-05, -1.01930861e-04,  1.29466873e-04,
         4.47882335e-07,  6.42555365e-07,  6.24569320e-07],
       [ 1.77350964e-04, -4.37252386e-04,  5.09661753e-04,
         1.77509600e-06,  6.24569320e-07,  3.05891059e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.33376819e+03],
       [ 3.09634339e+03],
       [-4.74325343e+03],
       [-4.38712736e+00],
       [-2.35107846e+00],
       [-5.56419914e+00]]), 'covar': array([[ 9.67009538e-03, -2.35881036e-02,  2.73628293e-02,
         9.45127031e-05,  4.06434185e-05,  1.57403449e-04],
       [-2.35881036e-02,  5.87611582e-02, -6.78050845e-02,
        -2.29965472e-04, -9.19620182e-05, -3.91908150e-04],
       [ 2.73628293e-02, -6.78050845e-02,  7.90120237e-02,
         2.66848964e-04,  1.17238495e-04,  4.55727347e-04],
       [ 9.45127031e-05, -2.29965472e-04,  2.66848964e-04,
         9.33587298e-07,  3.94764014e-07,  1.53708740e-06],
       [ 4.06434185e-05, -9.19620182e-05,  1.17238495e-04,
         3.94764014e-07,  5.82917114e-07,  5.59129257e-07],
       [ 1.57403449e-04, -3.91908150e-04,  4.55727347e-04,
         1.53708740e-06,  5.59129257e-07,  2.68123839e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.60116105e-05],
       [-1.05774126e-06],
       [-5.73360668e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.33370981e+03],
       [ 3.09647749e+03],
       [-4.74339749e+03],
       [-4.38790469e+00],
       [-2.35032684e+00],
       [-5.56546483e+00],
       [ 5.04757745e-01],
       [ 1.75190093e-01],
       [-8.16181510e-01],
       [ 2.19944977e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80744642e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.09373043e-02, -2.64203407e-02,  3.06708702e-02,
         1.10069802e-04,  4.53685514e-05,  1.77350964e-04],
       [-2.64203407e-02,  6.51262614e-02, -7.52435425e-02,
        -2.64151579e-04, -1.01930861e-04, -4.37252386e-04],
       [ 3.06708702e-02, -7.52435425e-02,  8.77419425e-02,
         3.06560939e-04,  1.29466873e-04,  5.09661753e-04],
       [ 1.10069802e-04, -2.64151579e-04,  3.06560939e-04,
         1.14863420e-06,  4.47882335e-07,  1.77509600e-06],
       [ 4.53685514e-05, -1.01930861e-04,  1.29466873e-04,
         4.47882335e-07,  6.42555365e-07,  6.24569320e-07],
       [ 1.77350964e-04, -4.37252386e-04,  5.09661753e-04,
         1.77509600e-06,  6.24569320e-07,  3.05891059e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.53599635e-05],
       [-7.71332940e-06],
       [-6.53095914e-02]])}}
Current time:  2018-07-12 20:21:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.33370981e+03],
       [ 3.09647749e+03],
       [-4.74339749e+03],
       [-4.38790469e+00],
       [-2.35032684e+00],
       [-5.56546483e+00],
       [ 5.04757745e-01],
       [ 1.75190093e-01],
       [-8.16181510e-01],
       [ 2.19944977e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80744642e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.09373043e-02, -2.64203407e-02,  3.06708702e-02,
         1.10069802e-04,  4.53685514e-05,  1.77350964e-04],
       [-2.64203407e-02,  6.51262614e-02, -7.52435425e-02,
        -2.64151579e-04, -1.01930861e-04, -4.37252386e-04],
       [ 3.06708702e-02, -7.52435425e-02,  8.77419425e-02,
         3.06560939e-04,  1.29466873e-04,  5.09661753e-04],
       [ 1.10069802e-04, -2.64151579e-04,  3.06560939e-04,
         1.14863420e-06,  4.47882335e-07,  1.77509600e-06],
       [ 4.53685514e-05, -1.01930861e-04,  1.29466873e-04,
         4.47882335e-07,  6.42555365e-07,  6.24569320e-07],
       [ 1.77350964e-04, -4.37252386e-04,  5.09661753e-04,
         1.77509600e-06,  6.24569320e-07,  3.05891059e-06]])}
[[ 4.33370981e+03]
 [ 3.09647749e+03]
 [-4.74339749e+03]
 [-4.38790469e+00]
 [-2.35032684e+00]
 [-5.56546483e+00]
 [ 5.04757745e-01]
 [ 1.75190093e-01]
 [-8.16181510e-01]
 [ 2.19944977e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80744642e-19]]
2018-07-12 20:20:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:21:00
[[ 4.28959397e+03]
 [ 3.07280470e+03]
 [-4.79878999e+03]
 [-4.43519720e+00]
 [-2.38416084e+00]
 [-5.51299648e+00]
 [ 5.00489326e-01]
 [ 1.74039303e-01]
 [-8.18805883e-01]
 [ 2.20856701e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80956929e-19]]
[[ 1.32468798e-02 -2.85561863e-02  3.56791974e-02  1.20878057e-04
   4.97513618e-05  1.95288040e-04]
 [-2.85561863e-02  6.31540153e-02 -7.82629034e-02 -2.58144382e-04
  -9.52729636e-05 -4.31546653e-04]
 [ 3.56791974e-02 -7.82629034e-02  9.82482335e-02  3.22407314e-04
   1.35479518e-04  5.40982238e-04]
 [ 1.20878057e-04 -2.58144382e-04  3.22407314e-04  1.14600836e-06
   4.44573634e-07  1.76671065e-06]
 [ 4.97513618e-05 -9.52729636e-05  1.35479518e-04  4.44573634e-07
   6.51798556e-07  6.24070379e-07]
 [ 1.95288040e-04 -4.31546653e-04  5.40982238e-04  1.76671065e-06
   6.24070379e-07  3.07623293e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.33376819e+03],
       [ 3.09634339e+03],
       [-4.74325343e+03],
       [-4.38712736e+00],
       [-2.35107846e+00],
       [-5.56419914e+00]]), 'covar': array([[ 9.67009538e-03, -2.35881036e-02,  2.73628293e-02,
         9.45127031e-05,  4.06434185e-05,  1.57403449e-04],
       [-2.35881036e-02,  5.87611582e-02, -6.78050845e-02,
        -2.29965472e-04, -9.19620182e-05, -3.91908150e-04],
       [ 2.73628293e-02, -6.78050845e-02,  7.90120237e-02,
         2.66848964e-04,  1.17238495e-04,  4.55727347e-04],
       [ 9.45127031e-05, -2.29965472e-04,  2.66848964e-04,
         9.33587298e-07,  3.94764014e-07,  1.53708740e-06],
       [ 4.06434185e-05, -9.19620182e-05,  1.17238495e-04,
         3.94764014e-07,  5.82917114e-07,  5.59129257e-07],
       [ 1.57403449e-04, -3.91908150e-04,  4.55727347e-04,
         1.53708740e-06,  5.59129257e-07,  2.68123839e-06]])}
[[ 4.33376819e+03]
 [ 3.09634339e+03]
 [-4.74325343e+03]
 [-4.38712736e+00]
 [-2.35107846e+00]
 [-5.56419914e+00]]
2018-07-12 20:20:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:21:00
[[ 4.28966002e+03]
 [ 3.07266299e+03]
 [-4.79863367e+03]
 [-4.43442308e+00]
 [-2.38491274e+00]
 [-5.51172965e+00]]
[[ 1.16475392e-02 -2.54353118e-02  3.17515625e-02  1.03201317e-04
   4.45044877e-05  1.72941451e-04]
 [-2.54353118e-02  5.69820190e-02 -7.04992885e-02 -2.24639740e-04
  -8.59663922e-05 -3.86807551e-04]
 [ 3.17515625e-02 -7.04992885e-02  8.84007261e-02  2.80504479e-04
   1.22617745e-04  4.83157993e-04]
 [ 1.03201317e-04 -2.24639740e-04  2.80504479e-04  9.22695215e-07
   3.91783469e-07  1.52955330e-06]
 [ 4.45044877e-05 -8.59663922e-05  1.22617745e-04  3.91783469e-07
   5.82320700e-07  5.58690446e-07]
 [ 1.72941451e-04 -3.86807551e-04  4.83157993e-04  1.52955330e-06
   5.58690446e-07  2.68793924e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 20, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.28966002e+03],
       [ 3.07266299e+03],
       [-4.79863367e+03],
       [-4.43442308e+00],
       [-2.38491274e+00],
       [-5.51172965e+00]]), 'covar': array([[ 1.16475392e-02, -2.54353118e-02,  3.17515625e-02,
         1.03201317e-04,  4.45044877e-05,  1.72941451e-04],
       [-2.54353118e-02,  5.69820190e-02, -7.04992885e-02,
        -2.24639740e-04, -8.59663922e-05, -3.86807551e-04],
       [ 3.17515625e-02, -7.04992885e-02,  8.84007261e-02,
         2.80504479e-04,  1.22617745e-04,  4.83157993e-04],
       [ 1.03201317e-04, -2.24639740e-04,  2.80504479e-04,
         9.22695215e-07,  3.91783469e-07,  1.52955330e-06],
       [ 4.45044877e-05, -8.59663922e-05,  1.22617745e-04,
         3.91783469e-07,  5.82320700e-07,  5.58690446e-07],
       [ 1.72941451e-04, -3.86807551e-04,  4.83157993e-04,
         1.52955330e-06,  5.58690446e-07,  2.68793924e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.60116105e-05],
       [-1.05774126e-06],
       [-5.73360668e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 20, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.28959397e+03],
       [ 3.07280470e+03],
       [-4.79878999e+03],
       [-4.43519720e+00],
       [-2.38416084e+00],
       [-5.51299648e+00],
       [ 5.00489326e-01],
       [ 1.74039303e-01],
       [-8.18805883e-01],
       [ 2.20856701e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80956929e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.32468798e-02, -2.85561863e-02,  3.56791974e-02,
         1.20878057e-04,  4.97513618e-05,  1.95288040e-04],
       [-2.85561863e-02,  6.31540153e-02, -7.82629034e-02,
        -2.58144382e-04, -9.52729636e-05, -4.31546653e-04],
       [ 3.56791974e-02, -7.82629034e-02,  9.82482335e-02,
         3.22407314e-04,  1.35479518e-04,  5.40982238e-04],
       [ 1.20878057e-04, -2.58144382e-04,  3.22407314e-04,
         1.14600836e-06,  4.44573634e-07,  1.76671065e-06],
       [ 4.97513618e-05, -9.52729636e-05,  1.35479518e-04,
         4.44573634e-07,  6.51798556e-07,  6.24070379e-07],
       [ 1.95288040e-04, -4.31546653e-04,  5.40982238e-04,
         1.76671065e-06,  6.24070379e-07,  3.07623293e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.53599635e-05],
       [-7.71332940e-06],
       [-6.53095914e-02]])}}
Yi [[ 2.02768861]
 [-0.85360434]
 [12.93822288]]
posterior
[[ 4.28959397e+03]
 [ 3.07280470e+03]
 [-4.79878999e+03]
 [-4.43519720e+00]
 [-2.38416084e+00]
 [-5.51299648e+00]
 [ 5.00489326e-01]
 [ 1.74039303e-01]
 [-8.18805883e-01]
 [ 2.20856701e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80956929e-19]]
[[ 4.28957276e+03]
 [ 3.07287117e+03]
 [-4.79886047e+03]
 [-4.43536369e+00]
 [-2.38403648e+00]
 [-5.51342137e+00]
 [ 5.00489326e-01]
 [ 1.74039303e-01]
 [-8.18805883e-01]
 [ 2.20856701e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80956929e-19]]
[[ 1.26741018e-02 -2.67623480e-02  3.37352780e-02  1.16424504e-04
   5.26212766e-05  1.83572378e-04]
 [-2.67623480e-02  5.75326920e-02 -7.21456462e-02 -2.44230823e-04
  -1.03981953e-04 -3.94674463e-04]
 [ 3.37352780e-02 -7.21456462e-02  9.13638862e-02  3.07625835e-04
   1.42420225e-04  4.99452260e-04]
 [ 1.16424504e-04 -2.44230823e-04  3.07625835e-04  1.11099347e-06
   4.70134506e-07  1.67767114e-06]
 [ 5.26212766e-05 -1.03981953e-04  1.42420225e-04  4.70134506e-07
   6.10005991e-07  6.65527798e-07]
 [ 1.83572378e-04 -3.94674463e-04  4.99452260e-04  1.67767114e-06
   6.65527798e-07  2.82569642e-06]]
[[ 2.02771512]
 [-0.85361369]
 [12.96970868]]
[[-2.65097274e-05]
 [ 9.34965420e-06]
 [-3.14857974e-02]]


 Corrector Step
2018-07-12 20:21:00
[[ 4.28957276e+03]
 [ 3.07287117e+03]
 [-4.79886047e+03]
 [-4.43536369e+00]
 [-2.38403648e+00]
 [-5.51342137e+00]
 [ 5.00489326e-01]
 [ 1.74039303e-01]
 [-8.18805883e-01]
 [ 2.20856701e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80956929e-19]]
[[ 1.26741018e-02 -2.67623480e-02  3.37352780e-02  1.16424504e-04
   5.26212766e-05  1.83572378e-04]
 [-2.67623480e-02  5.75326920e-02 -7.21456462e-02 -2.44230823e-04
  -1.03981953e-04 -3.94674463e-04]
 [ 3.37352780e-02 -7.21456462e-02  9.13638862e-02  3.07625835e-04
   1.42420225e-04  4.99452260e-04]
 [ 1.16424504e-04 -2.44230823e-04  3.07625835e-04  1.11099347e-06
   4.70134506e-07  1.67767114e-06]
 [ 5.26212766e-05 -1.03981953e-04  1.42420225e-04  4.70134506e-07
   6.10005991e-07  6.65527798e-07]
 [ 1.83572378e-04 -3.94674463e-04  4.99452260e-04  1.67767114e-06
   6.65527798e-07  2.82569642e-06]]
464734059.90723985
post
cubesat_nadir
Ybar_post [[ 2.02770464]
 [-0.85360989]
 [12.96987186]]
resids [[-1.60377828e-05]
 [ 5.55422991e-06]
 [-3.16489795e-02]]
posterior
[[ 4.28966002e+03]
 [ 3.07266299e+03]
 [-4.79863367e+03]
 [-4.43442308e+00]
 [-2.38491274e+00]
 [-5.51172965e+00]]
[[ 4.28963635e+03]
 [ 3.07273734e+03]
 [-4.79870765e+03]
 [-4.43462363e+00]
 [-2.38472493e+00]
 [-5.51218304e+00]]
[[ 1.09799281e-02 -2.34245409e-02  2.95250835e-02  9.75546803e-05
   4.67289094e-05  1.59703323e-04]
 [-2.34245409e-02  5.09247433e-02 -6.38054667e-02 -2.07629817e-04
  -9.28223664e-05 -3.46990787e-04]
 [ 2.95250835e-02 -6.38054667e-02  8.07923852e-02  2.61717693e-04
   1.27736188e-04  4.38165984e-04]
 [ 9.75546803e-05 -2.07629817e-04  2.61717693e-04  8.74925171e-07
   4.11158101e-07  1.41779167e-06]
 [ 4.67289094e-05 -9.28223664e-05  1.27736188e-04  4.11158101e-07
   5.45934930e-07  5.92218270e-07]
 [ 1.59703323e-04 -3.46990787e-04  4.38165984e-04  1.41779167e-06
   5.92218270e-07  2.42155574e-06]]
[[ 2.02771834]
 [-0.85362376]
 [13.47732258]]
[[-2.97283782e-05]
 [ 1.94228392e-05]
 [-5.39099695e-01]]


 Corrector Step
2018-07-12 20:21:00
[[ 4.28963635e+03]
 [ 3.07273734e+03]
 [-4.79870765e+03]
 [-4.43462363e+00]
 [-2.38472493e+00]
 [-5.51218304e+00]]
[[ 1.09799281e-02 -2.34245409e-02  2.95250835e-02  9.75546803e-05
   4.67289094e-05  1.59703323e-04]
 [-2.34245409e-02  5.09247433e-02 -6.38054667e-02 -2.07629817e-04
  -9.28223664e-05 -3.46990787e-04]
 [ 2.95250835e-02 -6.38054667e-02  8.07923852e-02  2.61717693e-04
   1.27736188e-04  4.38165984e-04]
 [ 9.75546803e-05 -2.07629817e-04  2.61717693e-04  8.74925171e-07
   4.11158101e-07  1.41779167e-06]
 [ 4.67289094e-05 -9.28223664e-05  1.27736188e-04  4.11158101e-07
   5.45934930e-07  5.92218270e-07]
 [ 1.59703323e-04 -3.46990787e-04  4.38165984e-04  1.41779167e-06
   5.92218270e-07  2.42155574e-06]]
186.48896994172605
post
sphere_lamr_small
Ybar_post [[ 2.02770665]
 [-0.8536174 ]
 [13.47749428]]
resids [[-1.80475327e-05]
 [ 1.30632902e-05]
 [-5.39271395e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [464734059.90723985, 186.48896994172605]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.28957276e+03],
       [ 3.07287117e+03],
       [-4.79886047e+03],
       [-4.43536369e+00],
       [-2.38403648e+00],
       [-5.51342137e+00]]), 'est_covars': array([[ 1.26741018e-02, -2.67623480e-02,  3.37352780e-02,
         1.16424504e-04,  5.26212766e-05,  1.83572378e-04],
       [-2.67623480e-02,  5.75326920e-02, -7.21456462e-02,
        -2.44230823e-04, -1.03981953e-04, -3.94674463e-04],
       [ 3.37352780e-02, -7.21456462e-02,  9.13638862e-02,
         3.07625835e-04,  1.42420225e-04,  4.99452260e-04],
       [ 1.16424504e-04, -2.44230823e-04,  3.07625835e-04,
         1.11099347e-06,  4.70134506e-07,  1.67767114e-06],
       [ 5.26212766e-05, -1.03981953e-04,  1.42420225e-04,
         4.70134506e-07,  6.10005991e-07,  6.65527798e-07],
       [ 1.83572378e-04, -3.94674463e-04,  4.99452260e-04,
         1.67767114e-06,  6.65527798e-07,  2.82569642e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.28963635e+03],
       [ 3.07273734e+03],
       [-4.79870765e+03],
       [-4.43462363e+00],
       [-2.38472493e+00],
       [-5.51218304e+00]]), 'covar': array([[ 1.09799281e-02, -2.34245409e-02,  2.95250835e-02,
         9.75546803e-05,  4.67289094e-05,  1.59703323e-04],
       [-2.34245409e-02,  5.09247433e-02, -6.38054667e-02,
        -2.07629817e-04, -9.28223664e-05, -3.46990787e-04],
       [ 2.95250835e-02, -6.38054667e-02,  8.07923852e-02,
         2.61717693e-04,  1.27736188e-04,  4.38165984e-04],
       [ 9.75546803e-05, -2.07629817e-04,  2.61717693e-04,
         8.74925171e-07,  4.11158101e-07,  1.41779167e-06],
       [ 4.67289094e-05, -9.28223664e-05,  1.27736188e-04,
         4.11158101e-07,  5.45934930e-07,  5.92218270e-07],
       [ 1.59703323e-04, -3.46990787e-04,  4.38165984e-04,
         1.41779167e-06,  5.92218270e-07,  2.42155574e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.80475327e-05],
       [ 1.30632902e-05],
       [-5.39271395e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.28957276e+03],
       [ 3.07287117e+03],
       [-4.79886047e+03],
       [-4.43536369e+00],
       [-2.38403648e+00],
       [-5.51342137e+00],
       [ 5.00489326e-01],
       [ 1.74039303e-01],
       [-8.18805883e-01],
       [ 2.20856701e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80956929e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.26741018e-02, -2.67623480e-02,  3.37352780e-02,
         1.16424504e-04,  5.26212766e-05,  1.83572378e-04],
       [-2.67623480e-02,  5.75326920e-02, -7.21456462e-02,
        -2.44230823e-04, -1.03981953e-04, -3.94674463e-04],
       [ 3.37352780e-02, -7.21456462e-02,  9.13638862e-02,
         3.07625835e-04,  1.42420225e-04,  4.99452260e-04],
       [ 1.16424504e-04, -2.44230823e-04,  3.07625835e-04,
         1.11099347e-06,  4.70134506e-07,  1.67767114e-06],
       [ 5.26212766e-05, -1.03981953e-04,  1.42420225e-04,
         4.70134506e-07,  6.10005991e-07,  6.65527798e-07],
       [ 1.83572378e-04, -3.94674463e-04,  4.99452260e-04,
         1.67767114e-06,  6.65527798e-07,  2.82569642e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.60377828e-05],
       [ 5.55422991e-06],
       [-3.16489795e-02]])}}
Current time:  2018-07-12 20:21:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.28957276e+03],
       [ 3.07287117e+03],
       [-4.79886047e+03],
       [-4.43536369e+00],
       [-2.38403648e+00],
       [-5.51342137e+00],
       [ 5.00489326e-01],
       [ 1.74039303e-01],
       [-8.18805883e-01],
       [ 2.20856701e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.80956929e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.26741018e-02, -2.67623480e-02,  3.37352780e-02,
         1.16424504e-04,  5.26212766e-05,  1.83572378e-04],
       [-2.67623480e-02,  5.75326920e-02, -7.21456462e-02,
        -2.44230823e-04, -1.03981953e-04, -3.94674463e-04],
       [ 3.37352780e-02, -7.21456462e-02,  9.13638862e-02,
         3.07625835e-04,  1.42420225e-04,  4.99452260e-04],
       [ 1.16424504e-04, -2.44230823e-04,  3.07625835e-04,
         1.11099347e-06,  4.70134506e-07,  1.67767114e-06],
       [ 5.26212766e-05, -1.03981953e-04,  1.42420225e-04,
         4.70134506e-07,  6.10005991e-07,  6.65527798e-07],
       [ 1.83572378e-04, -3.94674463e-04,  4.99452260e-04,
         1.67767114e-06,  6.65527798e-07,  2.82569642e-06]])}
[[ 4.28957276e+03]
 [ 3.07287117e+03]
 [-4.79886047e+03]
 [-4.43536369e+00]
 [-2.38403648e+00]
 [-5.51342137e+00]
 [ 5.00489326e-01]
 [ 1.74039303e-01]
 [-8.18805883e-01]
 [ 2.20856701e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.80956929e-19]]
2018-07-12 20:21:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:21:10
[[ 4.24498469e+03]
 [ 3.04886256e+03]
 [-4.85372980e+03]
 [-4.48216223e+00]
 [-2.41760446e+00]
 [-5.46035449e+00]
 [ 4.96207261e-01]
 [ 1.72883769e-01]
 [-8.21407933e-01]
 [ 2.21762404e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81169216e-19]]
[[ 1.51066163e-02 -2.86248149e-02  3.88066367e-02  1.26817336e-04
   5.72115310e-05  2.00539983e-04]
 [-2.86248149e-02  5.55162564e-02 -7.46053185e-02 -2.38113976e-04
  -9.76458604e-05 -3.88497644e-04]
 [ 3.88066367e-02 -7.46053185e-02  1.01642123e-01  3.22486470e-04
   1.48817070e-04  5.28411881e-04]
 [ 1.26817336e-04 -2.38113976e-04  3.22486470e-04  1.10871569e-06
   4.66583800e-07  1.66966252e-06]
 [ 5.72115310e-05 -9.76458604e-05  1.48817070e-04  4.66583800e-07
   6.19138388e-07  6.64995332e-07]
 [ 2.00539983e-04 -3.88497644e-04  5.28411881e-04  1.66966252e-06
   6.64995332e-07  2.84233538e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.28963635e+03],
       [ 3.07273734e+03],
       [-4.79870765e+03],
       [-4.43462363e+00],
       [-2.38472493e+00],
       [-5.51218304e+00]]), 'covar': array([[ 1.09799281e-02, -2.34245409e-02,  2.95250835e-02,
         9.75546803e-05,  4.67289094e-05,  1.59703323e-04],
       [-2.34245409e-02,  5.09247433e-02, -6.38054667e-02,
        -2.07629817e-04, -9.28223664e-05, -3.46990787e-04],
       [ 2.95250835e-02, -6.38054667e-02,  8.07923852e-02,
         2.61717693e-04,  1.27736188e-04,  4.38165984e-04],
       [ 9.75546803e-05, -2.07629817e-04,  2.61717693e-04,
         8.74925171e-07,  4.11158101e-07,  1.41779167e-06],
       [ 4.67289094e-05, -9.28223664e-05,  1.27736188e-04,
         4.11158101e-07,  5.45934930e-07,  5.92218270e-07],
       [ 1.59703323e-04, -3.46990787e-04,  4.38165984e-04,
         1.41779167e-06,  5.92218270e-07,  2.42155574e-06]])}
[[ 4.28963635e+03]
 [ 3.07273734e+03]
 [-4.79870765e+03]
 [-4.43462363e+00]
 [-2.38472493e+00]
 [-5.51218304e+00]]
2018-07-12 20:21:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:21:10
[[ 4.24505594e+03]
 [ 3.04872201e+03]
 [-4.85356437e+03]
 [-4.48142511e+00]
 [-2.41829334e+00]
 [-5.45911498e+00]]
[[ 1.30122873e-02 -2.49866248e-02  3.38738738e-02  1.05635511e-04
   5.07419120e-05  1.74049728e-04]
 [-2.49866248e-02  4.91245431e-02 -6.59420683e-02 -2.02266133e-04
  -8.71960317e-05 -3.41495733e-04]
 [ 3.38738738e-02 -6.59420683e-02  8.98037985e-02  2.74201839e-04
   1.33427053e-04  4.62963990e-04]
 [ 1.05635511e-04 -2.02266133e-04  2.74201839e-04  8.64582613e-07
   4.07997964e-07  1.41073112e-06]
 [ 5.07419120e-05 -8.71960317e-05  1.33427053e-04  4.07997964e-07
   5.45244343e-07  5.91762998e-07]
 [ 1.74049728e-04 -3.41495733e-04  4.62963990e-04  1.41073112e-06
   5.91762998e-07  2.42753378e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.24505594e+03],
       [ 3.04872201e+03],
       [-4.85356437e+03],
       [-4.48142511e+00],
       [-2.41829334e+00],
       [-5.45911498e+00]]), 'covar': array([[ 1.30122873e-02, -2.49866248e-02,  3.38738738e-02,
         1.05635511e-04,  5.07419120e-05,  1.74049728e-04],
       [-2.49866248e-02,  4.91245431e-02, -6.59420683e-02,
        -2.02266133e-04, -8.71960317e-05, -3.41495733e-04],
       [ 3.38738738e-02, -6.59420683e-02,  8.98037985e-02,
         2.74201839e-04,  1.33427053e-04,  4.62963990e-04],
       [ 1.05635511e-04, -2.02266133e-04,  2.74201839e-04,
         8.64582613e-07,  4.07997964e-07,  1.41073112e-06],
       [ 5.07419120e-05, -8.71960317e-05,  1.33427053e-04,
         4.07997964e-07,  5.45244343e-07,  5.91762998e-07],
       [ 1.74049728e-04, -3.41495733e-04,  4.62963990e-04,
         1.41073112e-06,  5.91762998e-07,  2.42753378e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.80475327e-05],
       [ 1.30632902e-05],
       [-5.39271395e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.24498469e+03],
       [ 3.04886256e+03],
       [-4.85372980e+03],
       [-4.48216223e+00],
       [-2.41760446e+00],
       [-5.46035449e+00],
       [ 4.96207261e-01],
       [ 1.72883769e-01],
       [-8.21407933e-01],
       [ 2.21762404e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.81169216e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.51066163e-02, -2.86248149e-02,  3.88066367e-02,
         1.26817336e-04,  5.72115310e-05,  2.00539983e-04],
       [-2.86248149e-02,  5.55162564e-02, -7.46053185e-02,
        -2.38113976e-04, -9.76458604e-05, -3.88497644e-04],
       [ 3.88066367e-02, -7.46053185e-02,  1.01642123e-01,
         3.22486470e-04,  1.48817070e-04,  5.28411881e-04],
       [ 1.26817336e-04, -2.38113976e-04,  3.22486470e-04,
         1.10871569e-06,  4.66583800e-07,  1.66966252e-06],
       [ 5.72115310e-05, -9.76458604e-05,  1.48817070e-04,
         4.66583800e-07,  6.19138388e-07,  6.64995332e-07],
       [ 2.00539983e-04, -3.88497644e-04,  5.28411881e-04,
         1.66966252e-06,  6.64995332e-07,  2.84233538e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.60377828e-05],
       [ 5.55422991e-06],
       [-3.16489795e-02]])}}
Yi [[ 2.07962905]
 [-0.8792904 ]
 [12.89999744]]
posterior
[[ 4.24498469e+03]
 [ 3.04886256e+03]
 [-4.85372980e+03]
 [-4.48216223e+00]
 [-2.41760446e+00]
 [-5.46035449e+00]
 [ 4.96207261e-01]
 [ 1.72883769e-01]
 [-8.21407933e-01]
 [ 2.21762404e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81169216e-19]]
[[ 4.24502580e+03]
 [ 3.04875085e+03]
 [-4.85359906e+03]
 [-4.48187050e+00]
 [-2.41776780e+00]
 [-5.45960250e+00]
 [ 4.96207261e-01]
 [ 1.72883769e-01]
 [-8.21407933e-01]
 [ 2.21762404e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81169216e-19]]
[[ 1.44763132e-02 -2.69071015e-02  3.67842238e-02  1.22372167e-04
   5.96144801e-05  1.88897613e-04]
 [-2.69071015e-02  5.08343658e-02 -6.91033346e-02 -2.25987191e-04
  -1.04305835e-04 -3.56823641e-04]
 [ 3.67842238e-02 -6.91033346e-02  9.49247389e-02  3.08532925e-04
   1.54002965e-04  4.89748223e-04]
 [ 1.22372167e-04 -2.25987191e-04  3.08532925e-04  1.07694688e-06
   4.86949433e-07  1.58932856e-06]
 [ 5.96144801e-05 -1.04305835e-04  1.54002965e-04  4.86949433e-07
   5.81951970e-07  6.94927305e-07]
 [ 1.88897613e-04 -3.56823641e-04  4.89748223e-04  1.58932856e-06
   6.94927305e-07  2.61979534e-06]]
[[ 2.07957968]
 [-0.87928128]
 [12.96777463]]
[[ 4.93691492e-05]
 [-9.11495069e-06]
 [-6.77771902e-02]]


 Corrector Step
2018-07-12 20:21:10
[[ 4.24502580e+03]
 [ 3.04875085e+03]
 [-4.85359906e+03]
 [-4.48187050e+00]
 [-2.41776780e+00]
 [-5.45960250e+00]
 [ 4.96207261e-01]
 [ 1.72883769e-01]
 [-8.21407933e-01]
 [ 2.21762404e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81169216e-19]]
[[ 1.44763132e-02 -2.69071015e-02  3.67842238e-02  1.22372167e-04
   5.96144801e-05  1.88897613e-04]
 [-2.69071015e-02  5.08343658e-02 -6.91033346e-02 -2.25987191e-04
  -1.04305835e-04 -3.56823641e-04]
 [ 3.67842238e-02 -6.91033346e-02  9.49247389e-02  3.08532925e-04
   1.54002965e-04  4.89748223e-04]
 [ 1.22372167e-04 -2.25987191e-04  3.08532925e-04  1.07694688e-06
   4.86949433e-07  1.58932856e-06]
 [ 5.96144801e-05 -1.04305835e-04  1.54002965e-04  4.86949433e-07
   5.81951970e-07  6.94927305e-07]
 [ 1.88897613e-04 -3.56823641e-04  4.89748223e-04  1.58932856e-06
   6.94927305e-07  2.61979534e-06]]
158797362.8527336
post
cubesat_nadir
Ybar_post [[ 2.07959869]
 [-0.87928597]
 [12.96749543]]
resids [[ 3.03650455e-05]
 [-4.42509575e-06]
 [-6.74979889e-02]]
posterior
[[ 4.24505594e+03]
 [ 3.04872201e+03]
 [-4.85356437e+03]
 [-4.48142511e+00]
 [-2.41829334e+00]
 [-5.45911498e+00]]
[[ 4.24509761e+03]
 [ 3.04861604e+03]
 [-4.85343337e+03]
 [-4.48110073e+00]
 [-2.41834065e+00]
 [-5.45838260e+00]]
[[ 1.22737100e-02 -2.30589390e-02  3.15511147e-02  9.98976345e-05
   5.24096034e-05  1.60925198e-04]
 [-2.30589390e-02  4.40827173e-02 -5.99162873e-02 -1.87279160e-04
  -9.20995172e-05 -3.07376978e-04]
 [ 3.15511147e-02 -5.99162873e-02  8.23689752e-02  2.56196399e-04
   1.36731978e-04  4.21202468e-04]
 [ 9.98976345e-05 -1.87279160e-04  2.56196399e-04  8.19993943e-07
   4.21545121e-07  1.30891747e-06]
 [ 5.24096034e-05 -9.20995172e-05  1.36731978e-04  4.21545121e-07
   5.12451974e-07  6.14154527e-07]
 [ 1.60925198e-04 -3.07376978e-04  4.21202468e-04  1.30891747e-06
   6.14154527e-07  2.19249076e-06]]
[[ 2.07958612]
 [-0.87929155]
 [13.46657133]]
[[ 4.29318475e-05]
 [ 1.15194937e-06]
 [-5.66573892e-01]]


 Corrector Step
2018-07-12 20:21:10
[[ 4.24509761e+03]
 [ 3.04861604e+03]
 [-4.85343337e+03]
 [-4.48110073e+00]
 [-2.41834065e+00]
 [-5.45838260e+00]]
[[ 1.22737100e-02 -2.30589390e-02  3.15511147e-02  9.98976345e-05
   5.24096034e-05  1.60925198e-04]
 [-2.30589390e-02  4.40827173e-02 -5.99162873e-02 -1.87279160e-04
  -9.20995172e-05 -3.07376978e-04]
 [ 3.15511147e-02 -5.99162873e-02  8.23689752e-02  2.56196399e-04
   1.36731978e-04  4.21202468e-04]
 [ 9.98976345e-05 -1.87279160e-04  2.56196399e-04  8.19993943e-07
   4.21545121e-07  1.30891747e-06]
 [ 5.24096034e-05 -9.20995172e-05  1.36731978e-04  4.21545121e-07
   5.12451974e-07  6.14154527e-07]
 [ 1.60925198e-04 -3.07376978e-04  4.21202468e-04  1.30891747e-06
   6.14154527e-07  2.19249076e-06]]
30.020537882661092
post
sphere_lamr_small
Ybar_post [[ 2.07960171]
 [-0.87929378]
 [13.46631947]]
resids [[ 2.73443335e-05]
 [ 3.38415236e-06]
 [-5.66322026e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [158797362.8527336, 30.020537882661092]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.24502580e+03],
       [ 3.04875085e+03],
       [-4.85359906e+03],
       [-4.48187050e+00],
       [-2.41776780e+00],
       [-5.45960250e+00]]), 'est_covars': array([[ 1.44763132e-02, -2.69071015e-02,  3.67842238e-02,
         1.22372167e-04,  5.96144801e-05,  1.88897613e-04],
       [-2.69071015e-02,  5.08343658e-02, -6.91033346e-02,
        -2.25987191e-04, -1.04305835e-04, -3.56823641e-04],
       [ 3.67842238e-02, -6.91033346e-02,  9.49247389e-02,
         3.08532925e-04,  1.54002965e-04,  4.89748223e-04],
       [ 1.22372167e-04, -2.25987191e-04,  3.08532925e-04,
         1.07694688e-06,  4.86949433e-07,  1.58932856e-06],
       [ 5.96144801e-05, -1.04305835e-04,  1.54002965e-04,
         4.86949433e-07,  5.81951970e-07,  6.94927305e-07],
       [ 1.88897613e-04, -3.56823641e-04,  4.89748223e-04,
         1.58932856e-06,  6.94927305e-07,  2.61979534e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.24509761e+03],
       [ 3.04861604e+03],
       [-4.85343337e+03],
       [-4.48110073e+00],
       [-2.41834065e+00],
       [-5.45838260e+00]]), 'covar': array([[ 1.22737100e-02, -2.30589390e-02,  3.15511147e-02,
         9.98976345e-05,  5.24096034e-05,  1.60925198e-04],
       [-2.30589390e-02,  4.40827173e-02, -5.99162873e-02,
        -1.87279160e-04, -9.20995172e-05, -3.07376978e-04],
       [ 3.15511147e-02, -5.99162873e-02,  8.23689752e-02,
         2.56196399e-04,  1.36731978e-04,  4.21202468e-04],
       [ 9.98976345e-05, -1.87279160e-04,  2.56196399e-04,
         8.19993943e-07,  4.21545121e-07,  1.30891747e-06],
       [ 5.24096034e-05, -9.20995172e-05,  1.36731978e-04,
         4.21545121e-07,  5.12451974e-07,  6.14154527e-07],
       [ 1.60925198e-04, -3.07376978e-04,  4.21202468e-04,
         1.30891747e-06,  6.14154527e-07,  2.19249076e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.73443335e-05],
       [ 3.38415236e-06],
       [-5.66322026e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.24502580e+03],
       [ 3.04875085e+03],
       [-4.85359906e+03],
       [-4.48187050e+00],
       [-2.41776780e+00],
       [-5.45960250e+00],
       [ 4.96207261e-01],
       [ 1.72883769e-01],
       [-8.21407933e-01],
       [ 2.21762404e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.81169216e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.44763132e-02, -2.69071015e-02,  3.67842238e-02,
         1.22372167e-04,  5.96144801e-05,  1.88897613e-04],
       [-2.69071015e-02,  5.08343658e-02, -6.91033346e-02,
        -2.25987191e-04, -1.04305835e-04, -3.56823641e-04],
       [ 3.67842238e-02, -6.91033346e-02,  9.49247389e-02,
         3.08532925e-04,  1.54002965e-04,  4.89748223e-04],
       [ 1.22372167e-04, -2.25987191e-04,  3.08532925e-04,
         1.07694688e-06,  4.86949433e-07,  1.58932856e-06],
       [ 5.96144801e-05, -1.04305835e-04,  1.54002965e-04,
         4.86949433e-07,  5.81951970e-07,  6.94927305e-07],
       [ 1.88897613e-04, -3.56823641e-04,  4.89748223e-04,
         1.58932856e-06,  6.94927305e-07,  2.61979534e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 3.03650455e-05],
       [-4.42509575e-06],
       [-6.74979889e-02]])}}
Current time:  2018-07-12 20:21:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.24502580e+03],
       [ 3.04875085e+03],
       [-4.85359906e+03],
       [-4.48187050e+00],
       [-2.41776780e+00],
       [-5.45960250e+00],
       [ 4.96207261e-01],
       [ 1.72883769e-01],
       [-8.21407933e-01],
       [ 2.21762404e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.81169216e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.44763132e-02, -2.69071015e-02,  3.67842238e-02,
         1.22372167e-04,  5.96144801e-05,  1.88897613e-04],
       [-2.69071015e-02,  5.08343658e-02, -6.91033346e-02,
        -2.25987191e-04, -1.04305835e-04, -3.56823641e-04],
       [ 3.67842238e-02, -6.91033346e-02,  9.49247389e-02,
         3.08532925e-04,  1.54002965e-04,  4.89748223e-04],
       [ 1.22372167e-04, -2.25987191e-04,  3.08532925e-04,
         1.07694688e-06,  4.86949433e-07,  1.58932856e-06],
       [ 5.96144801e-05, -1.04305835e-04,  1.54002965e-04,
         4.86949433e-07,  5.81951970e-07,  6.94927305e-07],
       [ 1.88897613e-04, -3.56823641e-04,  4.89748223e-04,
         1.58932856e-06,  6.94927305e-07,  2.61979534e-06]])}
[[ 4.24502580e+03]
 [ 3.04875085e+03]
 [-4.85359906e+03]
 [-4.48187050e+00]
 [-2.41776780e+00]
 [-5.45960250e+00]
 [ 4.96207261e-01]
 [ 1.72883769e-01]
 [-8.21407933e-01]
 [ 2.21762404e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81169216e-19]]
2018-07-12 20:21:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:21:20
[[ 4.19997490e+03]
 [ 3.02440645e+03]
 [-4.90792700e+03]
 [-4.52817410e+00]
 [-2.45106668e+00]
 [-5.40594094e+00]
 [ 4.91911670e-01]
 [ 1.71723521e-01]
 [-8.23987590e-01]
 [ 2.22662062e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81381503e-19]]
[[ 1.70241248e-02 -2.85161101e-02  4.19088098e-02  1.32386414e-04
   6.43571360e-05  2.04985658e-04]
 [-2.85161101e-02  4.88085678e-02 -7.10655745e-02 -2.19804028e-04
  -9.82477744e-05 -3.50300277e-04]
 [ 4.19088098e-02 -7.10655745e-02  1.04988344e-01  3.22496484e-04
   1.60667951e-04  5.16623834e-04]
 [ 1.32386414e-04 -2.19804028e-04  3.22496484e-04  1.07497636e-06
   4.83189824e-07  1.58165453e-06]
 [ 6.43571360e-05 -9.82477744e-05  1.60667951e-04  4.83189824e-07
   5.90974632e-07  6.94354990e-07]
 [ 2.04985658e-04 -3.50300277e-04  5.16623834e-04  1.58165453e-06
   6.94354990e-07  2.63584959e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.24509761e+03],
       [ 3.04861604e+03],
       [-4.85343337e+03],
       [-4.48110073e+00],
       [-2.41834065e+00],
       [-5.45838260e+00]]), 'covar': array([[ 1.22737100e-02, -2.30589390e-02,  3.15511147e-02,
         9.98976345e-05,  5.24096034e-05,  1.60925198e-04],
       [-2.30589390e-02,  4.40827173e-02, -5.99162873e-02,
        -1.87279160e-04, -9.20995172e-05, -3.07376978e-04],
       [ 3.15511147e-02, -5.99162873e-02,  8.23689752e-02,
         2.56196399e-04,  1.36731978e-04,  4.21202468e-04],
       [ 9.98976345e-05, -1.87279160e-04,  2.56196399e-04,
         8.19993943e-07,  4.21545121e-07,  1.30891747e-06],
       [ 5.24096034e-05, -9.20995172e-05,  1.36731978e-04,
         4.21545121e-07,  5.12451974e-07,  6.14154527e-07],
       [ 1.60925198e-04, -3.07376978e-04,  4.21202468e-04,
         1.30891747e-06,  6.14154527e-07,  2.19249076e-06]])}
[[ 4.24509761e+03]
 [ 3.04861604e+03]
 [-4.85343337e+03]
 [-4.48110073e+00]
 [-2.41834065e+00]
 [-5.45838260e+00]]
2018-07-12 20:21:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:21:20
[[ 4.20005459e+03]
 [ 3.02426592e+03]
 [-4.90774936e+03]
 [-4.52740784e+00]
 [-2.45163994e+00]
 [-5.40472005e+00]]
[[ 1.43470843e-02 -2.43602764e-02  3.58458891e-02  1.07410162e-04
   5.65144908e-05  1.74183035e-04]
 [-2.43602764e-02  4.22936207e-02 -6.15643999e-02 -1.81925100e-04
  -8.68087963e-05 -3.01608602e-04]
 [ 3.58458891e-02 -6.15643999e-02  9.10176387e-02  2.67611923e-04
   1.42623257e-04  4.43677404e-04]
 [ 1.07410162e-04 -1.81925100e-04  2.67611923e-04  8.10161586e-07
   4.18241281e-07  1.30228428e-06]
 [ 5.65144908e-05 -8.68087963e-05  1.42623257e-04  4.18241281e-07
   5.11670252e-07  6.13678920e-07]
 [ 1.74183035e-04 -3.01608602e-04  4.43677404e-04  1.30228428e-06
   6.13678920e-07  2.19785103e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.20005459e+03],
       [ 3.02426592e+03],
       [-4.90774936e+03],
       [-4.52740784e+00],
       [-2.45163994e+00],
       [-5.40472005e+00]]), 'covar': array([[ 1.43470843e-02, -2.43602764e-02,  3.58458891e-02,
         1.07410162e-04,  5.65144908e-05,  1.74183035e-04],
       [-2.43602764e-02,  4.22936207e-02, -6.15643999e-02,
        -1.81925100e-04, -8.68087963e-05, -3.01608602e-04],
       [ 3.58458891e-02, -6.15643999e-02,  9.10176387e-02,
         2.67611923e-04,  1.42623257e-04,  4.43677404e-04],
       [ 1.07410162e-04, -1.81925100e-04,  2.67611923e-04,
         8.10161586e-07,  4.18241281e-07,  1.30228428e-06],
       [ 5.65144908e-05, -8.68087963e-05,  1.42623257e-04,
         4.18241281e-07,  5.11670252e-07,  6.13678920e-07],
       [ 1.74183035e-04, -3.01608602e-04,  4.43677404e-04,
         1.30228428e-06,  6.13678920e-07,  2.19785103e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.73443335e-05],
       [ 3.38415236e-06],
       [-5.66322026e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.19997490e+03],
       [ 3.02440645e+03],
       [-4.90792700e+03],
       [-4.52817410e+00],
       [-2.45106668e+00],
       [-5.40594094e+00],
       [ 4.91911670e-01],
       [ 1.71723521e-01],
       [-8.23987590e-01],
       [ 2.22662062e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.81381503e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.70241248e-02, -2.85161101e-02,  4.19088098e-02,
         1.32386414e-04,  6.43571360e-05,  2.04985658e-04],
       [-2.85161101e-02,  4.88085678e-02, -7.10655745e-02,
        -2.19804028e-04, -9.82477744e-05, -3.50300277e-04],
       [ 4.19088098e-02, -7.10655745e-02,  1.04988344e-01,
         3.22496484e-04,  1.60667951e-04,  5.16623834e-04],
       [ 1.32386414e-04, -2.19804028e-04,  3.22496484e-04,
         1.07497636e-06,  4.83189824e-07,  1.58165453e-06],
       [ 6.43571360e-05, -9.82477744e-05,  1.60667951e-04,
         4.83189824e-07,  5.90974632e-07,  6.94354990e-07],
       [ 2.04985658e-04, -3.50300277e-04,  5.16623834e-04,
         1.58165453e-06,  6.94354990e-07,  2.63584959e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 3.03650455e-05],
       [-4.42509575e-06],
       [-6.74979889e-02]])}}
Yi [[ 2.13233318]
 [-0.90219735]
 [12.97809917]]
posterior
[[ 4.19997490e+03]
 [ 3.02440645e+03]
 [-4.90792700e+03]
 [-4.52817410e+00]
 [-2.45106668e+00]
 [-5.40594094e+00]
 [ 4.91911670e-01]
 [ 1.71723521e-01]
 [-8.23987590e-01]
 [ 2.22662062e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81381503e-19]]
[[ 4.19993087e+03]
 [ 3.02450772e+03]
 [-4.90808446e+03]
 [-4.52842258e+00]
 [-2.45122339e+00]
 [-5.40680278e+00]
 [ 4.91911670e-01]
 [ 1.71723521e-01]
 [-8.23987590e-01]
 [ 2.22662062e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81381503e-19]]
[[ 1.63469291e-02 -2.68978218e-02  3.98386548e-02  1.28026071e-04
   6.62214432e-05  1.93605393e-04]
 [-2.68978218e-02  4.49354296e-02 -6.61509335e-02 -2.09334716e-04
  -1.03102398e-04 -3.23277072e-04]
 [ 3.98386548e-02 -6.61509335e-02  9.84723269e-02  3.09454567e-04
   1.64085536e-04  4.80833959e-04]
 [ 1.28026071e-04 -2.09334716e-04  3.09454567e-04  1.04646047e-06
   4.98685629e-07  1.50991261e-06]
 [ 6.62214432e-05 -1.03102398e-04  1.64085536e-04  4.98685629e-07
   5.58006921e-07  7.13525990e-07]
 [ 1.93605393e-04 -3.23277072e-04  4.80833959e-04  1.50991261e-06
   7.13525990e-07  2.43926399e-06]]
[[ 2.13238484]
 [-0.90215422]
 [12.97834039]]
[[-5.16531513e-05]
 [-4.31254215e-05]
 [-2.41212428e-04]]


 Corrector Step
2018-07-12 20:21:20
[[ 4.19993087e+03]
 [ 3.02450772e+03]
 [-4.90808446e+03]
 [-4.52842258e+00]
 [-2.45122339e+00]
 [-5.40680278e+00]
 [ 4.91911670e-01]
 [ 1.71723521e-01]
 [-8.23987590e-01]
 [ 2.22662062e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81381503e-19]]
[[ 1.63469291e-02 -2.68978218e-02  3.98386548e-02  1.28026071e-04
   6.62214432e-05  1.93605393e-04]
 [-2.68978218e-02  4.49354296e-02 -6.61509335e-02 -2.09334716e-04
  -1.03102398e-04 -3.23277072e-04]
 [ 3.98386548e-02 -6.61509335e-02  9.84723269e-02  3.09454567e-04
   1.64085536e-04  4.80833959e-04]
 [ 1.28026071e-04 -2.09334716e-04  3.09454567e-04  1.04646047e-06
   4.98685629e-07  1.50991261e-06]
 [ 6.62214432e-05 -1.03102398e-04  1.64085536e-04  4.98685629e-07
   5.58006921e-07  7.13525990e-07]
 [ 1.93605393e-04 -3.23277072e-04  4.80833959e-04  1.50991261e-06
   7.13525990e-07  2.43926399e-06]]
44597357.926390246
post
cubesat_nadir
Ybar_post [[ 2.13236777]
 [-0.90216183]
 [12.97863523]]
resids [[-3.45845023e-05]
 [-3.55191278e-05]
 [-5.36058732e-04]]
posterior
[[ 4.20005459e+03]
 [ 3.02426592e+03]
 [-4.90774936e+03]
 [-4.52740784e+00]
 [-2.45163994e+00]
 [-5.40472005e+00]]
[[ 4.19999814e+03]
 [ 3.02439060e+03]
 [-4.90793017e+03]
 [-4.52780851e+00]
 [-2.45174056e+00]
 [-5.40566599e+00]]
[[ 1.35471725e-02 -2.25396919e-02  3.34562304e-02  1.01663767e-04
   5.75173767e-05  1.61374022e-04]
 [-2.25396919e-02  3.81256124e-02 -5.61730488e-02 -1.68829018e-04
  -8.99182678e-05 -2.72590624e-04]
 [ 3.34562304e-02 -5.61730488e-02  8.37854459e-02  2.50479393e-04
   1.44001591e-04  4.05144675e-04]
 [ 1.01663767e-04 -1.68829018e-04  2.50479393e-04  7.68868127e-07
   4.26039180e-07  1.21036524e-06]
 [ 5.75173767e-05 -8.99182678e-05  1.44001591e-04  4.26039180e-07
   4.82303195e-07  6.25121070e-07]
 [ 1.61374022e-04 -2.72590624e-04  4.05144675e-04  1.21036524e-06
   6.25121070e-07  1.99197350e-06]]
[[ 2.13239238]
 [-0.90216471]
 [13.46182537]]
[[-5.91931388e-05]
 [-3.26350040e-05]
 [-4.83726196e-01]]


 Corrector Step
2018-07-12 20:21:20
[[ 4.19999814e+03]
 [ 3.02439060e+03]
 [-4.90793017e+03]
 [-4.52780851e+00]
 [-2.45174056e+00]
 [-5.40566599e+00]]
[[ 1.35471725e-02 -2.25396919e-02  3.34562304e-02  1.01663767e-04
   5.75173767e-05  1.61374022e-04]
 [-2.25396919e-02  3.81256124e-02 -5.61730488e-02 -1.68829018e-04
  -8.99182678e-05 -2.72590624e-04]
 [ 3.34562304e-02 -5.61730488e-02  8.37854459e-02  2.50479393e-04
   1.44001591e-04  4.05144675e-04]
 [ 1.01663767e-04 -1.68829018e-04  2.50479393e-04  7.68868127e-07
   4.26039180e-07  1.21036524e-06]
 [ 5.75173767e-05 -8.99182678e-05  1.44001591e-04  4.26039180e-07
   4.82303195e-07  6.25121070e-07]
 [ 1.61374022e-04 -2.72590624e-04  4.05144675e-04  1.21036524e-06
   6.25121070e-07  1.99197350e-06]]
375.7975126240928
post
sphere_lamr_small
Ybar_post [[ 2.13237334]
 [-0.90216834]
 [13.46213384]]
resids [[-4.01530062e-05]
 [-2.90080852e-05]
 [-4.84034665e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [44597357.926390246, 375.7975126240928]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.19993087e+03],
       [ 3.02450772e+03],
       [-4.90808446e+03],
       [-4.52842258e+00],
       [-2.45122339e+00],
       [-5.40680278e+00]]), 'est_covars': array([[ 1.63469291e-02, -2.68978218e-02,  3.98386548e-02,
         1.28026071e-04,  6.62214432e-05,  1.93605393e-04],
       [-2.68978218e-02,  4.49354296e-02, -6.61509335e-02,
        -2.09334716e-04, -1.03102398e-04, -3.23277072e-04],
       [ 3.98386548e-02, -6.61509335e-02,  9.84723269e-02,
         3.09454567e-04,  1.64085536e-04,  4.80833959e-04],
       [ 1.28026071e-04, -2.09334716e-04,  3.09454567e-04,
         1.04646047e-06,  4.98685629e-07,  1.50991261e-06],
       [ 6.62214432e-05, -1.03102398e-04,  1.64085536e-04,
         4.98685629e-07,  5.58006921e-07,  7.13525990e-07],
       [ 1.93605393e-04, -3.23277072e-04,  4.80833959e-04,
         1.50991261e-06,  7.13525990e-07,  2.43926399e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.19999814e+03],
       [ 3.02439060e+03],
       [-4.90793017e+03],
       [-4.52780851e+00],
       [-2.45174056e+00],
       [-5.40566599e+00]]), 'covar': array([[ 1.35471725e-02, -2.25396919e-02,  3.34562304e-02,
         1.01663767e-04,  5.75173767e-05,  1.61374022e-04],
       [-2.25396919e-02,  3.81256124e-02, -5.61730488e-02,
        -1.68829018e-04, -8.99182678e-05, -2.72590624e-04],
       [ 3.34562304e-02, -5.61730488e-02,  8.37854459e-02,
         2.50479393e-04,  1.44001591e-04,  4.05144675e-04],
       [ 1.01663767e-04, -1.68829018e-04,  2.50479393e-04,
         7.68868127e-07,  4.26039180e-07,  1.21036524e-06],
       [ 5.75173767e-05, -8.99182678e-05,  1.44001591e-04,
         4.26039180e-07,  4.82303195e-07,  6.25121070e-07],
       [ 1.61374022e-04, -2.72590624e-04,  4.05144675e-04,
         1.21036524e-06,  6.25121070e-07,  1.99197350e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-4.01530062e-05],
       [-2.90080852e-05],
       [-4.84034665e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.19993087e+03],
       [ 3.02450772e+03],
       [-4.90808446e+03],
       [-4.52842258e+00],
       [-2.45122339e+00],
       [-5.40680278e+00],
       [ 4.91911670e-01],
       [ 1.71723521e-01],
       [-8.23987590e-01],
       [ 2.22662062e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.81381503e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.63469291e-02, -2.68978218e-02,  3.98386548e-02,
         1.28026071e-04,  6.62214432e-05,  1.93605393e-04],
       [-2.68978218e-02,  4.49354296e-02, -6.61509335e-02,
        -2.09334716e-04, -1.03102398e-04, -3.23277072e-04],
       [ 3.98386548e-02, -6.61509335e-02,  9.84723269e-02,
         3.09454567e-04,  1.64085536e-04,  4.80833959e-04],
       [ 1.28026071e-04, -2.09334716e-04,  3.09454567e-04,
         1.04646047e-06,  4.98685629e-07,  1.50991261e-06],
       [ 6.62214432e-05, -1.03102398e-04,  1.64085536e-04,
         4.98685629e-07,  5.58006921e-07,  7.13525990e-07],
       [ 1.93605393e-04, -3.23277072e-04,  4.80833959e-04,
         1.50991261e-06,  7.13525990e-07,  2.43926399e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.45845023e-05],
       [-3.55191278e-05],
       [-5.36058732e-04]])}}
Current time:  2018-07-12 20:21:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.19993087e+03],
       [ 3.02450772e+03],
       [-4.90808446e+03],
       [-4.52842258e+00],
       [-2.45122339e+00],
       [-5.40680278e+00],
       [ 4.91911670e-01],
       [ 1.71723521e-01],
       [-8.23987590e-01],
       [ 2.22662062e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.81381503e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.63469291e-02, -2.68978218e-02,  3.98386548e-02,
         1.28026071e-04,  6.62214432e-05,  1.93605393e-04],
       [-2.68978218e-02,  4.49354296e-02, -6.61509335e-02,
        -2.09334716e-04, -1.03102398e-04, -3.23277072e-04],
       [ 3.98386548e-02, -6.61509335e-02,  9.84723269e-02,
         3.09454567e-04,  1.64085536e-04,  4.80833959e-04],
       [ 1.28026071e-04, -2.09334716e-04,  3.09454567e-04,
         1.04646047e-06,  4.98685629e-07,  1.50991261e-06],
       [ 6.62214432e-05, -1.03102398e-04,  1.64085536e-04,
         4.98685629e-07,  5.58006921e-07,  7.13525990e-07],
       [ 1.93605393e-04, -3.23277072e-04,  4.80833959e-04,
         1.50991261e-06,  7.13525990e-07,  2.43926399e-06]])}
[[ 4.19993087e+03]
 [ 3.02450772e+03]
 [-4.90808446e+03]
 [-4.52842258e+00]
 [-2.45122339e+00]
 [-5.40680278e+00]
 [ 4.91911670e-01]
 [ 1.71723521e-01]
 [-8.23987590e-01]
 [ 2.22662062e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81381503e-19]]
2018-07-12 20:21:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:21:30
[[ 4.15441700e+03]
 [ 2.99983003e+03]
 [-4.96188151e+03]
 [-4.57422075e+00]
 [-2.48424880e+00]
 [-5.35255490e+00]
 [ 4.87602667e-01]
 [ 1.70558592e-01]
 [-8.26544783e-01]
 [ 2.23555649e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81593790e-19]]
[[ 1.90044198e-02 -2.82735352e-02  4.50115729e-02  1.37697664e-04
   7.10652261e-05  2.08902907e-04]
 [-2.82735352e-02  4.29313601e-02 -6.76749861e-02 -2.03126226e-04
  -9.72822669e-05 -3.16522992e-04]
 [ 4.50115729e-02 -6.76749861e-02  1.08339255e-01  3.22607416e-04
   1.70909612e-04  5.05882912e-04]
 [ 1.37697664e-04 -2.03126226e-04  3.22607416e-04  1.04475756e-06
   4.94749225e-07  1.50253430e-06]
 [ 7.10652261e-05 -9.72822669e-05  1.70909612e-04  4.94749225e-07
   5.66922735e-07  7.12907290e-07]
 [ 2.08902907e-04 -3.16522992e-04  5.05882912e-04  1.50253430e-06
   7.12907290e-07  2.45482343e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.19999814e+03],
       [ 3.02439060e+03],
       [-4.90793017e+03],
       [-4.52780851e+00],
       [-2.45174056e+00],
       [-5.40566599e+00]]), 'covar': array([[ 1.35471725e-02, -2.25396919e-02,  3.34562304e-02,
         1.01663767e-04,  5.75173767e-05,  1.61374022e-04],
       [-2.25396919e-02,  3.81256124e-02, -5.61730488e-02,
        -1.68829018e-04, -8.99182678e-05, -2.72590624e-04],
       [ 3.34562304e-02, -5.61730488e-02,  8.37854459e-02,
         2.50479393e-04,  1.44001591e-04,  4.05144675e-04],
       [ 1.01663767e-04, -1.68829018e-04,  2.50479393e-04,
         7.68868127e-07,  4.26039180e-07,  1.21036524e-06],
       [ 5.75173767e-05, -8.99182678e-05,  1.44001591e-04,
         4.26039180e-07,  4.82303195e-07,  6.25121070e-07],
       [ 1.61374022e-04, -2.72590624e-04,  4.05144675e-04,
         1.21036524e-06,  6.25121070e-07,  1.99197350e-06]])}
[[ 4.19999814e+03]
 [ 3.02439060e+03]
 [-4.90793017e+03]
 [-4.52780851e+00]
 [-2.45174056e+00]
 [-5.40566599e+00]]
2018-07-12 20:21:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-12 20:21:30
[[ 4.15449055e+03]
 [ 2.99970770e+03]
 [-4.96171624e+03]
 [-4.57360991e+00]
 [-2.48476610e+00]
 [-5.35141695e+00]]
[[ 1.56505874e-02 -2.36055184e-02  3.76886097e-02  1.08648349e-04
   6.16550986e-05  1.73646057e-04]
 [-2.36055184e-02  3.63771785e-02 -5.73993056e-02 -1.63532298e-04
  -8.49308725e-05 -2.66667027e-04]
 [ 3.76886097e-02 -5.73993056e-02  9.20926894e-02  2.60928522e-04
   1.49983571e-04  4.25585939e-04]
 [ 1.08648349e-04 -1.63532298e-04  2.60928522e-04  7.59508318e-07
   4.22628650e-07  1.20411685e-06]
 [ 6.16550986e-05 -8.49308725e-05  1.49983571e-04  4.22628650e-07
   4.81435955e-07  6.24620451e-07]
 [ 1.73646057e-04 -2.66667027e-04  4.25585939e-04  1.20411685e-06
   6.24620451e-07  1.99681119e-06]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.15449055e+03],
       [ 2.99970770e+03],
       [-4.96171624e+03],
       [-4.57360991e+00],
       [-2.48476610e+00],
       [-5.35141695e+00]]), 'covar': array([[ 1.56505874e-02, -2.36055184e-02,  3.76886097e-02,
         1.08648349e-04,  6.16550986e-05,  1.73646057e-04],
       [-2.36055184e-02,  3.63771785e-02, -5.73993056e-02,
        -1.63532298e-04, -8.49308725e-05, -2.66667027e-04],
       [ 3.76886097e-02, -5.73993056e-02,  9.20926894e-02,
         2.60928522e-04,  1.49983571e-04,  4.25585939e-04],
       [ 1.08648349e-04, -1.63532298e-04,  2.60928522e-04,
         7.59508318e-07,  4.22628650e-07,  1.20411685e-06],
       [ 6.16550986e-05, -8.49308725e-05,  1.49983571e-04,
         4.22628650e-07,  4.81435955e-07,  6.24620451e-07],
       [ 1.73646057e-04, -2.66667027e-04,  4.25585939e-04,
         1.20411685e-06,  6.24620451e-07,  1.99681119e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-4.01530062e-05],
       [-2.90080852e-05],
       [-4.84034665e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.15441700e+03],
       [ 2.99983003e+03],
       [-4.96188151e+03],
       [-4.57422075e+00],
       [-2.48424880e+00],
       [-5.35255490e+00],
       [ 4.87602667e-01],
       [ 1.70558592e-01],
       [-8.26544783e-01],
       [ 2.23555649e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.81593790e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.90044198e-02, -2.82735352e-02,  4.50115729e-02,
         1.37697664e-04,  7.10652261e-05,  2.08902907e-04],
       [-2.82735352e-02,  4.29313601e-02, -6.76749861e-02,
        -2.03126226e-04, -9.72822669e-05, -3.16522992e-04],
       [ 4.50115729e-02, -6.76749861e-02,  1.08339255e-01,
         3.22607416e-04,  1.70909612e-04,  5.05882912e-04],
       [ 1.37697664e-04, -2.03126226e-04,  3.22607416e-04,
         1.04475756e-06,  4.94749225e-07,  1.50253430e-06],
       [ 7.10652261e-05, -9.72822669e-05,  1.70909612e-04,
         4.94749225e-07,  5.66922735e-07,  7.12907290e-07],
       [ 2.08902907e-04, -3.16522992e-04,  5.05882912e-04,
         1.50253430e-06,  7.12907290e-07,  2.45482343e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.45845023e-05],
       [-3.55191278e-05],
       [-5.36058732e-04]])}}
Yi [[ 2.18578587]
 [-0.922271  ]
 [12.94308416]]
posterior
[[ 4.15441700e+03]
 [ 2.99983003e+03]
 [-4.96188151e+03]
 [-4.57422075e+00]
 [-2.48424880e+00]
 [-5.35255490e+00]
 [ 4.87602667e-01]
 [ 1.70558592e-01]
 [-8.26544783e-01]
 [ 2.23555649e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81593790e-19]]
[[ 4.15443449e+03]
 [ 2.99979890e+03]
 [-4.96181153e+03]
 [-4.57414896e+00]
 [-2.48403179e+00]
 [-5.35219291e+00]
 [ 4.87602667e-01]
 [ 1.70558592e-01]
 [-8.26544783e-01]
 [ 2.23555649e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81593790e-19]]
[[ 1.82913112e-02 -2.67698497e-02  4.29215003e-02  1.33485721e-04
   7.23845417e-05  1.97922762e-04]
 [-2.67698497e-02  3.97470908e-02 -6.33135703e-02 -1.94167426e-04
  -1.00665712e-04 -2.93597596e-04]
 [ 4.29215003e-02 -6.33135703e-02  1.02054794e-01  3.10531013e-04
   1.72711614e-04  4.72909675e-04]
 [ 1.33485721e-04 -1.94167426e-04  3.10531013e-04  1.01942522e-06
   5.06034818e-07  1.43902039e-06]
 [ 7.23845417e-05 -1.00665712e-04  1.72711614e-04  5.06034818e-07
   5.37510374e-07  7.22932261e-07]
 [ 1.97922762e-04 -2.93597596e-04  4.72909675e-04  1.43902039e-06
   7.22932261e-07  2.28180759e-06]]
[[ 2.18577078]
 [-0.92231297]
 [13.00021482]]
[[ 1.50932069e-05]
 [ 4.19733590e-05]
 [-5.71306513e-02]]


 Corrector Step
2018-07-12 20:21:30
[[ 4.15443449e+03]
 [ 2.99979890e+03]
 [-4.96181153e+03]
 [-4.57414896e+00]
 [-2.48403179e+00]
 [-5.35219291e+00]
 [ 4.87602667e-01]
 [ 1.70558592e-01]
 [-8.26544783e-01]
 [ 2.23555649e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81593790e-19]]
[[ 1.82913112e-02 -2.67698497e-02  4.29215003e-02  1.33485721e-04
   7.23845417e-05  1.97922762e-04]
 [-2.67698497e-02  3.97470908e-02 -6.33135703e-02 -1.94167426e-04
  -1.00665712e-04 -2.93597596e-04]
 [ 4.29215003e-02 -6.33135703e-02  1.02054794e-01  3.10531013e-04
   1.72711614e-04  4.72909675e-04]
 [ 1.33485721e-04 -1.94167426e-04  3.10531013e-04  1.01942522e-06
   5.06034818e-07  1.43902039e-06]
 [ 7.23845417e-05 -1.00665712e-04  1.72711614e-04  5.06034818e-07
   5.37510374e-07  7.22932261e-07]
 [ 1.97922762e-04 -2.93597596e-04  4.72909675e-04  1.43902039e-06
   7.22932261e-07  2.28180759e-06]]
169836917.05422544
post
cubesat_nadir
Ybar_post [[ 2.18577457]
 [-0.92230438]
 [13.00009931]]
resids [[ 1.13000637e-05]
 [ 3.33780751e-05]
 [-5.70151413e-02]]
posterior
[[ 4.15449055e+03]
 [ 2.99970770e+03]
 [-4.96171624e+03]
 [-4.57360991e+00]
 [-2.48476610e+00]
 [-5.35141695e+00]]
[[ 4.15450990e+03]
 [ 2.99968168e+03]
 [-4.96164763e+03]
 [-4.57348630e+00]
 [-2.48446793e+00]
 [-5.35111769e+00]]
[[ 1.47979426e-02 -2.19054789e-02  3.52546333e-02  1.02953166e-04
   6.19584575e-05  1.61277838e-04]
 [-2.19054789e-02  3.29497646e-02 -5.25967527e-02 -1.52155000e-04
  -8.65329151e-05 -2.42106207e-04]
 [ 3.52546333e-02 -5.25967527e-02  8.50769459e-02  2.44700494e-04
   1.49516306e-04  3.90144867e-04]
 [ 1.02953166e-04 -1.52155000e-04  2.44700494e-04  7.21454813e-07
   4.25236905e-07  1.12156298e-06]
 [ 6.19584575e-05 -8.65329151e-05  1.49516306e-04  4.25236905e-07
   4.54996754e-07  6.26382626e-07]
 [ 1.61277838e-04 -2.42106207e-04  3.90144867e-04  1.12156298e-06
   6.26382626e-07  1.81713167e-06]]
[[ 2.18578154]
 [-0.92232142]
 [13.46338582]]
[[ 4.33456850e-06]
 [ 5.04223174e-05]
 [-5.20301657e-01]]


 Corrector Step
2018-07-12 20:21:30
[[ 4.15450990e+03]
 [ 2.99968168e+03]
 [-4.96164763e+03]
 [-4.57348630e+00]
 [-2.48446793e+00]
 [-5.35111769e+00]]
[[ 1.47979426e-02 -2.19054789e-02  3.52546333e-02  1.02953166e-04
   6.19584575e-05  1.61277838e-04]
 [-2.19054789e-02  3.29497646e-02 -5.25967527e-02 -1.52155000e-04
  -8.65329151e-05 -2.42106207e-04]
 [ 3.52546333e-02 -5.25967527e-02  8.50769459e-02  2.44700494e-04
   1.49516306e-04  3.90144867e-04]
 [ 1.02953166e-04 -1.52155000e-04  2.44700494e-04  7.21454813e-07
   4.25236905e-07  1.12156298e-06]
 [ 6.19584575e-05 -8.65329151e-05  1.49516306e-04  4.25236905e-07
   4.54996754e-07  6.26382626e-07]
 [ 1.61277838e-04 -2.42106207e-04  3.90144867e-04  1.12156298e-06
   6.26382626e-07  1.81713167e-06]]
176.75235449745063
post
sphere_lamr_small
Ybar_post [[ 2.18578075]
 [-0.92231179]
 [13.46330705]]
resids [[ 5.12104637e-06]
 [ 4.07907834e-05]
 [-5.20222884e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [169836917.05422544, 176.75235449745063]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.15443449e+03],
       [ 2.99979890e+03],
       [-4.96181153e+03],
       [-4.57414896e+00],
       [-2.48403179e+00],
       [-5.35219291e+00]]), 'est_covars': array([[ 1.82913112e-02, -2.67698497e-02,  4.29215003e-02,
         1.33485721e-04,  7.23845417e-05,  1.97922762e-04],
       [-2.67698497e-02,  3.97470908e-02, -6.33135703e-02,
        -1.94167426e-04, -1.00665712e-04, -2.93597596e-04],
       [ 4.29215003e-02, -6.33135703e-02,  1.02054794e-01,
         3.10531013e-04,  1.72711614e-04,  4.72909675e-04],
       [ 1.33485721e-04, -1.94167426e-04,  3.10531013e-04,
         1.01942522e-06,  5.06034818e-07,  1.43902039e-06],
       [ 7.23845417e-05, -1.00665712e-04,  1.72711614e-04,
         5.06034818e-07,  5.37510374e-07,  7.22932261e-07],
       [ 1.97922762e-04, -2.93597596e-04,  4.72909675e-04,
         1.43902039e-06,  7.22932261e-07,  2.28180759e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.15450990e+03],
       [ 2.99968168e+03],
       [-4.96164763e+03],
       [-4.57348630e+00],
       [-2.48446793e+00],
       [-5.35111769e+00]]), 'covar': array([[ 1.47979426e-02, -2.19054789e-02,  3.52546333e-02,
         1.02953166e-04,  6.19584575e-05,  1.61277838e-04],
       [-2.19054789e-02,  3.29497646e-02, -5.25967527e-02,
        -1.52155000e-04, -8.65329151e-05, -2.42106207e-04],
       [ 3.52546333e-02, -5.25967527e-02,  8.50769459e-02,
         2.44700494e-04,  1.49516306e-04,  3.90144867e-04],
       [ 1.02953166e-04, -1.52155000e-04,  2.44700494e-04,
         7.21454813e-07,  4.25236905e-07,  1.12156298e-06],
       [ 6.19584575e-05, -8.65329151e-05,  1.49516306e-04,
         4.25236905e-07,  4.54996754e-07,  6.26382626e-07],
       [ 1.61277838e-04, -2.42106207e-04,  3.90144867e-04,
         1.12156298e-06,  6.26382626e-07,  1.81713167e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 5.12104637e-06],
       [ 4.07907834e-05],
       [-5.20222884e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.15443449e+03],
       [ 2.99979890e+03],
       [-4.96181153e+03],
       [-4.57414896e+00],
       [-2.48403179e+00],
       [-5.35219291e+00],
       [ 4.87602667e-01],
       [ 1.70558592e-01],
       [-8.26544783e-01],
       [ 2.23555649e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.81593790e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.82913112e-02, -2.67698497e-02,  4.29215003e-02,
         1.33485721e-04,  7.23845417e-05,  1.97922762e-04],
       [-2.67698497e-02,  3.97470908e-02, -6.33135703e-02,
        -1.94167426e-04, -1.00665712e-04, -2.93597596e-04],
       [ 4.29215003e-02, -6.33135703e-02,  1.02054794e-01,
         3.10531013e-04,  1.72711614e-04,  4.72909675e-04],
       [ 1.33485721e-04, -1.94167426e-04,  3.10531013e-04,
         1.01942522e-06,  5.06034818e-07,  1.43902039e-06],
       [ 7.23845417e-05, -1.00665712e-04,  1.72711614e-04,
         5.06034818e-07,  5.37510374e-07,  7.22932261e-07],
       [ 1.97922762e-04, -2.93597596e-04,  4.72909675e-04,
         1.43902039e-06,  7.22932261e-07,  2.28180759e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.13000637e-05],
       [ 3.33780751e-05],
       [-5.70151413e-02]])}}
Current time:  2018-07-13 08:21:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.15443449e+03],
       [ 2.99979890e+03],
       [-4.96181153e+03],
       [-4.57414896e+00],
       [-2.48403179e+00],
       [-5.35219291e+00],
       [ 4.87602667e-01],
       [ 1.70558592e-01],
       [-8.26544783e-01],
       [ 2.23555649e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-8.81593790e-19]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.82913112e-02, -2.67698497e-02,  4.29215003e-02,
         1.33485721e-04,  7.23845417e-05,  1.97922762e-04],
       [-2.67698497e-02,  3.97470908e-02, -6.33135703e-02,
        -1.94167426e-04, -1.00665712e-04, -2.93597596e-04],
       [ 4.29215003e-02, -6.33135703e-02,  1.02054794e-01,
         3.10531013e-04,  1.72711614e-04,  4.72909675e-04],
       [ 1.33485721e-04, -1.94167426e-04,  3.10531013e-04,
         1.01942522e-06,  5.06034818e-07,  1.43902039e-06],
       [ 7.23845417e-05, -1.00665712e-04,  1.72711614e-04,
         5.06034818e-07,  5.37510374e-07,  7.22932261e-07],
       [ 1.97922762e-04, -2.93597596e-04,  4.72909675e-04,
         1.43902039e-06,  7.22932261e-07,  2.28180759e-06]])}
[[ 4.15443449e+03]
 [ 2.99979890e+03]
 [-4.96181153e+03]
 [-4.57414896e+00]
 [-2.48403179e+00]
 [-5.35219291e+00]
 [ 4.87602667e-01]
 [ 1.70558592e-01]
 [-8.26544783e-01]
 [ 2.23555649e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-8.81593790e-19]]
2018-07-12 20:21:30
delta_t 43220.0


 Predictor Step
2018-07-13 08:21:50
[[-3.73151217e+03]
 [-1.90077092e+03]
 [-5.77245656e+03]
 [-4.97192924e+00]
 [-3.44301222e+00]
 [ 4.35970242e+00]
 [ 4.07616683e-02]
 [-2.14224539e-02]
 [ 9.58786277e-01]
 [-2.80371967e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79909791e-18]]
[[ 2.98961434e+04  2.07648318e+04 -2.70604231e+04 -2.48945037e+01
  -1.26808503e+01 -3.92814906e+01]
 [ 2.07648318e+04  1.44232934e+04 -1.88015398e+04 -1.72963325e+01
  -8.81099043e+00 -2.72845547e+01]
 [-2.70604231e+04 -1.88015398e+04  2.45758273e+04  2.26057912e+01
   1.15228198e+01  3.55648353e+01]
 [-2.48945037e+01 -1.72963325e+01  2.26057912e+01  2.07939875e-02
   1.05990670e-02  3.27176396e-02]
 [-1.26808503e+01 -8.81099043e+00  1.15228198e+01  1.05990670e-02
   5.40330053e-03  1.66666058e-02]
 [-3.92814906e+01 -2.72845547e+01  3.55648353e+01  3.27176396e-02
   1.66666058e-02  5.16146441e-02]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.15450990e+03],
       [ 2.99968168e+03],
       [-4.96164763e+03],
       [-4.57348630e+00],
       [-2.48446793e+00],
       [-5.35111769e+00]]), 'covar': array([[ 1.47979426e-02, -2.19054789e-02,  3.52546333e-02,
         1.02953166e-04,  6.19584575e-05,  1.61277838e-04],
       [-2.19054789e-02,  3.29497646e-02, -5.25967527e-02,
        -1.52155000e-04, -8.65329151e-05, -2.42106207e-04],
       [ 3.52546333e-02, -5.25967527e-02,  8.50769459e-02,
         2.44700494e-04,  1.49516306e-04,  3.90144867e-04],
       [ 1.02953166e-04, -1.52155000e-04,  2.44700494e-04,
         7.21454813e-07,  4.25236905e-07,  1.12156298e-06],
       [ 6.19584575e-05, -8.65329151e-05,  1.49516306e-04,
         4.25236905e-07,  4.54996754e-07,  6.26382626e-07],
       [ 1.61277838e-04, -2.42106207e-04,  3.90144867e-04,
         1.12156298e-06,  6.26382626e-07,  1.81713167e-06]])}
[[ 4.15450990e+03]
 [ 2.99968168e+03]
 [-4.96164763e+03]
 [-4.57348630e+00]
 [-2.48446793e+00]
 [-5.35111769e+00]]
2018-07-12 20:21:30
delta_t 43220.0


 Predictor Step
2018-07-13 08:21:50
[[-3.82468015e+03]
 [-1.96635697e+03]
 [-5.68676128e+03]
 [-4.89344060e+00]
 [-3.40311372e+00]
 [ 4.48313813e+00]]
[[ 2.30260617e+04  1.60546461e+04 -2.17858242e+04 -2.00078777e+01
  -1.02883935e+01 -3.03552418e+01]
 [ 1.60546461e+04  1.11944210e+04 -1.51940776e+04 -1.39538431e+01
  -7.17563427e+00 -2.11655208e+01]
 [-2.17858242e+04 -1.51940776e+04  2.06660350e+04  1.89778494e+01
   9.76363422e+00  2.87262457e+01]
 [-2.00078777e+01 -1.39538431e+01  1.89778494e+01  1.74277327e-02
   8.96603035e-03  2.63815321e-02]
 [-1.02883935e+01 -7.17563427e+00  9.76363422e+00  8.96603035e-03
   4.61320890e-03  1.35663138e-02]
 [-3.03552418e+01 -2.11655208e+01  2.87262457e+01  2.63815321e-02
   1.35663138e-02  4.00182699e-02]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 12, 20, 21, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.82468015e+03],
       [-1.96635697e+03],
       [-5.68676128e+03],
       [-4.89344060e+00],
       [-3.40311372e+00],
       [ 4.48313813e+00]]), 'covar': array([[ 2.30260617e+04,  1.60546461e+04, -2.17858242e+04,
        -2.00078777e+01, -1.02883935e+01, -3.03552418e+01],
       [ 1.60546461e+04,  1.11944210e+04, -1.51940776e+04,
        -1.39538431e+01, -7.17563427e+00, -2.11655208e+01],
       [-2.17858242e+04, -1.51940776e+04,  2.06660350e+04,
         1.89778494e+01,  9.76363422e+00,  2.87262457e+01],
       [-2.00078777e+01, -1.39538431e+01,  1.89778494e+01,
         1.74277327e-02,  8.96603035e-03,  2.63815321e-02],
       [-1.02883935e+01, -7.17563427e+00,  9.76363422e+00,
         8.96603035e-03,  4.61320890e-03,  1.35663138e-02],
       [-3.03552418e+01, -2.11655208e+01,  2.87262457e+01,
         2.63815321e-02,  1.35663138e-02,  4.00182699e-02]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 5.12104637e-06],
       [ 4.07907834e-05],
       [-5.20222884e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 12, 20, 21, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.73151217e+03],
       [-1.90077092e+03],
       [-5.77245656e+03],
       [-4.97192924e+00],
       [-3.44301222e+00],
       [ 4.35970242e+00],
       [ 4.07616683e-02],
       [-2.14224539e-02],
       [ 9.58786277e-01],
       [-2.80371967e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79909791e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.98961434e+04,  2.07648318e+04, -2.70604231e+04,
        -2.48945037e+01, -1.26808503e+01, -3.92814906e+01],
       [ 2.07648318e+04,  1.44232934e+04, -1.88015398e+04,
        -1.72963325e+01, -8.81099043e+00, -2.72845547e+01],
       [-2.70604231e+04, -1.88015398e+04,  2.45758273e+04,
         2.26057912e+01,  1.15228198e+01,  3.55648353e+01],
       [-2.48945037e+01, -1.72963325e+01,  2.26057912e+01,
         2.07939875e-02,  1.05990670e-02,  3.27176396e-02],
       [-1.26808503e+01, -8.81099043e+00,  1.15228198e+01,
         1.05990670e-02,  5.40330053e-03,  1.66666058e-02],
       [-3.92814906e+01, -2.72845547e+01,  3.55648353e+01,
         3.27176396e-02,  1.66666058e-02,  5.16146441e-02]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.13000637e-05],
       [ 3.33780751e-05],
       [-5.70151413e-02]])}}
Yi [[ 0.32026233]
 [-1.1358653 ]
 [12.96654892]]
posterior
[[-3.73151217e+03]
 [-1.90077092e+03]
 [-5.77245656e+03]
 [-4.97192924e+00]
 [-3.44301222e+00]
 [ 4.35970242e+00]
 [ 4.07616683e-02]
 [-2.14224539e-02]
 [ 9.58786277e-01]
 [-2.80371967e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79909791e-18]]
[[-3.80699589e+03]
 [-1.95311344e+03]
 [-5.70503737e+03]
 [-4.90986733e+00]
 [-3.41148030e+00]
 [ 4.45876420e+00]
 [ 4.07616683e-02]
 [-2.14224539e-02]
 [ 9.58786277e-01]
 [-2.80371967e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79909791e-18]]
[[ 1.14278891e+02  8.62969884e+01 -1.90503796e+02 -1.72003084e-01
  -9.58170305e-02 -1.60240717e-01]
 [ 8.62969884e+01  6.53925296e+01 -1.43576621e+02 -1.29547064e-01
  -7.20876609e-02 -1.21219273e-01]
 [-1.90503796e+02 -1.43576621e+02  3.17940659e+02  2.87171365e-01
   1.60072537e-01  2.66856291e-01]
 [-1.72003084e-01 -1.29547064e-01  2.87171365e-01  2.59578462e-04
   1.44744227e-04  2.40714551e-04]
 [-9.58170305e-02 -7.20876609e-02  1.60072537e-01  1.44744227e-04
   8.07434451e-05  1.33997720e-04]
 [-1.60240717e-01 -1.21219273e-01  2.66856291e-01  2.40714551e-04
   1.33997720e-04  2.25019789e-04]]
[[ 0.33206932]
 [-1.11916424]
 [13.14679861]]
[[-0.01180699]
 [-0.01670106]
 [-0.18024969]]


 Corrector Step
2018-07-13 08:21:50
[[-3.80699589e+03]
 [-1.95311344e+03]
 [-5.70503737e+03]
 [-4.90986733e+00]
 [-3.41148030e+00]
 [ 4.45876420e+00]
 [ 4.07616683e-02]
 [-2.14224539e-02]
 [ 9.58786277e-01]
 [-2.80371967e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79909791e-18]]
[[ 1.14278891e+02  8.62969884e+01 -1.90503796e+02 -1.72003084e-01
  -9.58170305e-02 -1.60240717e-01]
 [ 8.62969884e+01  6.53925296e+01 -1.43576621e+02 -1.29547064e-01
  -7.20876609e-02 -1.21219273e-01]
 [-1.90503796e+02 -1.43576621e+02  3.17940659e+02  2.87171365e-01
   1.60072537e-01  2.66856291e-01]
 [-1.72003084e-01 -1.29547064e-01  2.87171365e-01  2.59578462e-04
   1.44744227e-04  2.40714551e-04]
 [-9.58170305e-02 -7.20876609e-02  1.60072537e-01  1.44744227e-04
   8.07434451e-05  1.33997720e-04]
 [-1.60240717e-01 -1.21219273e-01  2.66856291e-01  2.40714551e-04
   1.33997720e-04  2.25019789e-04]]
803.3089827528065
post
cubesat_nadir
Ybar_post [[ 0.31722014]
 [-1.13702898]
 [13.03052311]]
resids [[ 0.00304219]
 [ 0.00116368]
 [-0.06397418]]
posterior
[[-3.82468015e+03]
 [-1.96635697e+03]
 [-5.68676128e+03]
 [-4.89344060e+00]
 [-3.40311372e+00]
 [ 4.48313813e+00]]
[[-3.80912704e+03]
 [-1.95555458e+03]
 [-5.70077932e+03]
 [-4.90632806e+00]
 [-3.40967353e+00]
 [ 4.46269767e+00]]
[[ 5.99476244e+01  4.60454348e+01 -1.09534627e+02 -9.89085590e-02
  -5.56444793e-02 -8.51123090e-02]
 [ 4.60454348e+01  3.55260676e+01 -8.39678963e+01 -7.57181227e-02
  -4.25472073e-02 -6.55621531e-02]
 [-1.09534627e+02 -8.39678963e+01  2.00328676e+02  1.81003228e-01
   1.01883633e-01  1.55319969e-01]
 [-9.89085590e-02 -7.57181227e-02  1.81003228e-01  1.63652096e-04
   9.21568022e-05  1.40092712e-04]
 [-5.56444793e-02 -4.25472073e-02  1.01883633e-01  9.21568022e-05
   5.19137846e-05  7.87477484e-05]
 [-8.51123090e-02 -6.55621531e-02  1.55319969e-01  1.40092712e-04
   7.87477484e-05  1.21095293e-04]]
[[ 0.29841305]
 [-1.145567  ]
 [13.13084006]]
[[ 0.02184929]
 [ 0.0097017 ]
 [-0.16429114]]


 Corrector Step
2018-07-13 08:21:50
[[-3.80912704e+03]
 [-1.95555458e+03]
 [-5.70077932e+03]
 [-4.90632806e+00]
 [-3.40967353e+00]
 [ 4.46269767e+00]]
[[ 5.99476244e+01  4.60454348e+01 -1.09534627e+02 -9.89085590e-02
  -5.56444793e-02 -8.51123090e-02]
 [ 4.60454348e+01  3.55260676e+01 -8.39678963e+01 -7.57181227e-02
  -4.25472073e-02 -6.55621531e-02]
 [-1.09534627e+02 -8.39678963e+01  2.00328676e+02  1.81003228e-01
   1.01883633e-01  1.55319969e-01]
 [-9.89085590e-02 -7.57181227e-02  1.81003228e-01  1.63652096e-04
   9.21568022e-05  1.40092712e-04]
 [-5.56444793e-02 -4.25472073e-02  1.01883633e-01  9.21568022e-05
   5.19137846e-05  7.87477484e-05]
 [-8.51123090e-02 -6.55621531e-02  1.55319969e-01  1.40092712e-04
   7.87477484e-05  1.21095293e-04]]
116.72059049618493
post
sphere_lamr_small
Ybar_post [[ 0.31547147]
 [-1.13735626]
 [13.16236935]]
resids [[ 0.00479087]
 [ 0.00149095]
 [-0.19582043]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [803.3089827528065, 116.72059049618493]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-3.80699589e+03],
       [-1.95311344e+03],
       [-5.70503737e+03],
       [-4.90986733e+00],
       [-3.41148030e+00],
       [ 4.45876420e+00]]), 'est_covars': array([[ 1.14278891e+02,  8.62969884e+01, -1.90503796e+02,
        -1.72003084e-01, -9.58170305e-02, -1.60240717e-01],
       [ 8.62969884e+01,  6.53925296e+01, -1.43576621e+02,
        -1.29547064e-01, -7.20876609e-02, -1.21219273e-01],
       [-1.90503796e+02, -1.43576621e+02,  3.17940659e+02,
         2.87171365e-01,  1.60072537e-01,  2.66856291e-01],
       [-1.72003084e-01, -1.29547064e-01,  2.87171365e-01,
         2.59578462e-04,  1.44744227e-04,  2.40714551e-04],
       [-9.58170305e-02, -7.20876609e-02,  1.60072537e-01,
         1.44744227e-04,  8.07434451e-05,  1.33997720e-04],
       [-1.60240717e-01, -1.21219273e-01,  2.66856291e-01,
         2.40714551e-04,  1.33997720e-04,  2.25019789e-04]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 21, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.80912704e+03],
       [-1.95555458e+03],
       [-5.70077932e+03],
       [-4.90632806e+00],
       [-3.40967353e+00],
       [ 4.46269767e+00]]), 'covar': array([[ 5.99476244e+01,  4.60454348e+01, -1.09534627e+02,
        -9.89085590e-02, -5.56444793e-02, -8.51123090e-02],
       [ 4.60454348e+01,  3.55260676e+01, -8.39678963e+01,
        -7.57181227e-02, -4.25472073e-02, -6.55621531e-02],
       [-1.09534627e+02, -8.39678963e+01,  2.00328676e+02,
         1.81003228e-01,  1.01883633e-01,  1.55319969e-01],
       [-9.89085590e-02, -7.57181227e-02,  1.81003228e-01,
         1.63652096e-04,  9.21568022e-05,  1.40092712e-04],
       [-5.56444793e-02, -4.25472073e-02,  1.01883633e-01,
         9.21568022e-05,  5.19137846e-05,  7.87477484e-05],
       [-8.51123090e-02, -6.55621531e-02,  1.55319969e-01,
         1.40092712e-04,  7.87477484e-05,  1.21095293e-04]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 0.00479087],
       [ 0.00149095],
       [-0.19582043]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 21, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.80699589e+03],
       [-1.95311344e+03],
       [-5.70503737e+03],
       [-4.90986733e+00],
       [-3.41148030e+00],
       [ 4.45876420e+00],
       [ 4.07616683e-02],
       [-2.14224539e-02],
       [ 9.58786277e-01],
       [-2.80371967e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79909791e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.14278891e+02,  8.62969884e+01, -1.90503796e+02,
        -1.72003084e-01, -9.58170305e-02, -1.60240717e-01],
       [ 8.62969884e+01,  6.53925296e+01, -1.43576621e+02,
        -1.29547064e-01, -7.20876609e-02, -1.21219273e-01],
       [-1.90503796e+02, -1.43576621e+02,  3.17940659e+02,
         2.87171365e-01,  1.60072537e-01,  2.66856291e-01],
       [-1.72003084e-01, -1.29547064e-01,  2.87171365e-01,
         2.59578462e-04,  1.44744227e-04,  2.40714551e-04],
       [-9.58170305e-02, -7.20876609e-02,  1.60072537e-01,
         1.44744227e-04,  8.07434451e-05,  1.33997720e-04],
       [-1.60240717e-01, -1.21219273e-01,  2.66856291e-01,
         2.40714551e-04,  1.33997720e-04,  2.25019789e-04]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 0.00304219],
       [ 0.00116368],
       [-0.06397418]])}}
Current time:  2018-07-13 08:22:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 21, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.80699589e+03],
       [-1.95311344e+03],
       [-5.70503737e+03],
       [-4.90986733e+00],
       [-3.41148030e+00],
       [ 4.45876420e+00],
       [ 4.07616683e-02],
       [-2.14224539e-02],
       [ 9.58786277e-01],
       [-2.80371967e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79909791e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.14278891e+02,  8.62969884e+01, -1.90503796e+02,
        -1.72003084e-01, -9.58170305e-02, -1.60240717e-01],
       [ 8.62969884e+01,  6.53925296e+01, -1.43576621e+02,
        -1.29547064e-01, -7.20876609e-02, -1.21219273e-01],
       [-1.90503796e+02, -1.43576621e+02,  3.17940659e+02,
         2.87171365e-01,  1.60072537e-01,  2.66856291e-01],
       [-1.72003084e-01, -1.29547064e-01,  2.87171365e-01,
         2.59578462e-04,  1.44744227e-04,  2.40714551e-04],
       [-9.58170305e-02, -7.20876609e-02,  1.60072537e-01,
         1.44744227e-04,  8.07434451e-05,  1.33997720e-04],
       [-1.60240717e-01, -1.21219273e-01,  2.66856291e-01,
         2.40714551e-04,  1.33997720e-04,  2.25019789e-04]])}
[[-3.80699589e+03]
 [-1.95311344e+03]
 [-5.70503737e+03]
 [-4.90986733e+00]
 [-3.41148030e+00]
 [ 4.45876420e+00]
 [ 4.07616683e-02]
 [-2.14224539e-02]
 [ 9.58786277e-01]
 [-2.80371967e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79909791e-18]]
2018-07-13 08:21:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:00
[[-3.85588511e+03]
 [-1.98712058e+03]
 [-5.66013704e+03]
 [-4.86787395e+00]
 [-3.38988751e+00]
 [ 4.52120771e+00]
 [ 4.57672362e-02]
 [-1.99582520e-02]
 [ 9.58560378e-01]
 [-2.80479999e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79931019e-18]]
[[ 1.10840686e+02  8.40410311e+01 -1.89188318e+02 -1.71798566e-01
  -9.58952449e-02 -1.57512138e-01]
 [ 8.40410311e+01  6.39472077e+01 -1.43160423e+02 -1.29909891e-01
  -7.24380560e-02 -1.19633184e-01]
 [-1.89188318e+02 -1.43160423e+02  3.23295234e+02  2.93696111e-01
   1.64033243e-01  2.68590806e-01]
 [-1.71798566e-01 -1.29909891e-01  2.93696111e-01  2.67022505e-04
   1.49183054e-04  2.43676300e-04]
 [-9.58952449e-02 -7.24380560e-02  1.64033243e-01  1.49183054e-04
   8.33904255e-05  1.35926660e-04]
 [-1.57512138e-01 -1.19633184e-01  2.68590806e-01  2.43676300e-04
   1.35926660e-04  2.24155933e-04]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 21, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.80912704e+03],
       [-1.95555458e+03],
       [-5.70077932e+03],
       [-4.90632806e+00],
       [-3.40967353e+00],
       [ 4.46269767e+00]]), 'covar': array([[ 5.99476244e+01,  4.60454348e+01, -1.09534627e+02,
        -9.89085590e-02, -5.56444793e-02, -8.51123090e-02],
       [ 4.60454348e+01,  3.55260676e+01, -8.39678963e+01,
        -7.57181227e-02, -4.25472073e-02, -6.55621531e-02],
       [-1.09534627e+02, -8.39678963e+01,  2.00328676e+02,
         1.81003228e-01,  1.01883633e-01,  1.55319969e-01],
       [-9.89085590e-02, -7.57181227e-02,  1.81003228e-01,
         1.63652096e-04,  9.21568022e-05,  1.40092712e-04],
       [-5.56444793e-02, -4.25472073e-02,  1.01883633e-01,
         9.21568022e-05,  5.19137846e-05,  7.87477484e-05],
       [-8.51123090e-02, -6.55621531e-02,  1.55319969e-01,
         1.40092712e-04,  7.87477484e-05,  1.21095293e-04]])}
[[-3.80912704e+03]
 [-1.95555458e+03]
 [-5.70077932e+03]
 [-4.90632806e+00]
 [-3.40967353e+00]
 [ 4.46269767e+00]]
2018-07-13 08:21:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:00
[[-3.85798039e+03]
 [-1.98954337e+03]
 [-5.65583977e+03]
 [-4.86428323e+00]
 [-3.38803920e+00]
 [ 4.52513677e+00]]
[[ 5.79719025e+01  4.47312738e+01 -1.08548312e+02 -9.86518404e-02
  -5.55960191e-02 -8.36285175e-02]
 [ 4.47312738e+01  3.46735272e+01 -8.35882883e+01 -7.58597159e-02
  -4.27028114e-02 -6.47093180e-02]
 [-1.08548312e+02 -8.35882883e+01  2.03445904e+02  1.85012683e-01
   1.04317980e-01  1.56397175e-01]
 [-9.86518404e-02 -7.58597159e-02  1.85012683e-01  1.68365477e-04
   9.49711393e-05  1.41978986e-04]
 [-5.55960191e-02 -4.27028114e-02  1.04317980e-01  9.49711393e-05
   5.35877041e-05  7.99517263e-05]
 [-8.36285175e-02 -6.47093180e-02  1.56397175e-01  1.41978986e-04
   7.99517263e-05  1.20878706e-04]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 21, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.85798039e+03],
       [-1.98954337e+03],
       [-5.65583977e+03],
       [-4.86428323e+00],
       [-3.38803920e+00],
       [ 4.52513677e+00]]), 'covar': array([[ 5.79719025e+01,  4.47312738e+01, -1.08548312e+02,
        -9.86518404e-02, -5.55960191e-02, -8.36285175e-02],
       [ 4.47312738e+01,  3.46735272e+01, -8.35882883e+01,
        -7.58597159e-02, -4.27028114e-02, -6.47093180e-02],
       [-1.08548312e+02, -8.35882883e+01,  2.03445904e+02,
         1.85012683e-01,  1.04317980e-01,  1.56397175e-01],
       [-9.86518404e-02, -7.58597159e-02,  1.85012683e-01,
         1.68365477e-04,  9.49711393e-05,  1.41978986e-04],
       [-5.55960191e-02, -4.27028114e-02,  1.04317980e-01,
         9.49711393e-05,  5.35877041e-05,  7.99517263e-05],
       [-8.36285175e-02, -6.47093180e-02,  1.56397175e-01,
         1.41978986e-04,  7.99517263e-05,  1.20878706e-04]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 0.00479087],
       [ 0.00149095],
       [-0.19582043]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 21, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.85588511e+03],
       [-1.98712058e+03],
       [-5.66013704e+03],
       [-4.86787395e+00],
       [-3.38988751e+00],
       [ 4.52120771e+00],
       [ 4.57672362e-02],
       [-1.99582520e-02],
       [ 9.58560378e-01],
       [-2.80479999e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79931019e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.10840686e+02,  8.40410311e+01, -1.89188318e+02,
        -1.71798566e-01, -9.58952449e-02, -1.57512138e-01],
       [ 8.40410311e+01,  6.39472077e+01, -1.43160423e+02,
        -1.29909891e-01, -7.24380560e-02, -1.19633184e-01],
       [-1.89188318e+02, -1.43160423e+02,  3.23295234e+02,
         2.93696111e-01,  1.64033243e-01,  2.68590806e-01],
       [-1.71798566e-01, -1.29909891e-01,  2.93696111e-01,
         2.67022505e-04,  1.49183054e-04,  2.43676300e-04],
       [-9.58952449e-02, -7.24380560e-02,  1.64033243e-01,
         1.49183054e-04,  8.33904255e-05,  1.35926660e-04],
       [-1.57512138e-01, -1.19633184e-01,  2.68590806e-01,
         2.43676300e-04,  1.35926660e-04,  2.24155933e-04]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 0.00304219],
       [ 0.00116368],
       [-0.06397418]])}}
Yi [[ 0.30568135]
 [-1.15097546]
 [13.03937637]]
posterior
[[-3.85588511e+03]
 [-1.98712058e+03]
 [-5.66013704e+03]
 [-4.86787395e+00]
 [-3.38988751e+00]
 [ 4.52120771e+00]
 [ 4.57672362e-02]
 [-1.99582520e-02]
 [ 9.58560378e-01]
 [-2.80479999e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79931019e-18]]
[[-3.84909106e+03]
 [-1.98181930e+03]
 [-5.67160462e+03]
 [-4.87823277e+00]
 [-3.39562379e+00]
 [ 4.51141694e+00]
 [ 4.57672362e-02]
 [-1.99582520e-02]
 [ 9.58560378e-01]
 [-2.80479999e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79931019e-18]]
[[ 9.24285743e-01  2.87284470e-01 -2.14030370e+00 -2.11521553e-03
  -1.32190823e-03 -9.38090605e-04]
 [ 2.87284470e-01  9.08884176e-02 -6.64232412e-01 -6.55981816e-04
  -4.09592645e-04 -2.93021299e-04]
 [-2.14030370e+00 -6.64232412e-01  4.96618143e+00  4.90845379e-03
   3.06781580e-03  2.17133604e-03]
 [-2.11521553e-03 -6.55981816e-04  4.90845379e-03  5.02988012e-06
   3.14862482e-06  2.00230155e-06]
 [-1.32190823e-03 -4.09592645e-04  3.06781580e-03  3.14862482e-06
   1.98752236e-06  1.23957894e-06]
 [-9.38090605e-04 -2.93021299e-04  2.17133604e-03  2.00230155e-06
   1.23957894e-06  1.08769420e-06]]
[[ 0.3022408 ]
 [-1.15220562]
 [12.95029736]]
[[0.00344055]
 [0.00123015]
 [0.08907901]]


 Corrector Step
2018-07-13 08:22:00
[[-3.84909106e+03]
 [-1.98181930e+03]
 [-5.67160462e+03]
 [-4.87823277e+00]
 [-3.39562379e+00]
 [ 4.51141694e+00]
 [ 4.57672362e-02]
 [-1.99582520e-02]
 [ 9.58560378e-01]
 [-2.80479999e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79931019e-18]]
[[ 9.24285743e-01  2.87284470e-01 -2.14030370e+00 -2.11521553e-03
  -1.32190823e-03 -9.38090605e-04]
 [ 2.87284470e-01  9.08884176e-02 -6.64232412e-01 -6.55981816e-04
  -4.09592645e-04 -2.93021299e-04]
 [-2.14030370e+00 -6.64232412e-01  4.96618143e+00  4.90845379e-03
   3.06781580e-03  2.17133604e-03]
 [-2.11521553e-03 -6.55981816e-04  4.90845379e-03  5.02988012e-06
   3.14862482e-06  2.00230155e-06]
 [-1.32190823e-03 -4.09592645e-04  3.06781580e-03  3.14862482e-06
   1.98752236e-06  1.23957894e-06]
 [-9.38090605e-04 -2.93021299e-04  2.17133604e-03  2.00230155e-06
   1.23957894e-06  1.08769420e-06]]
1362224.80803919
post
cubesat_nadir
Ybar_post [[ 0.30568823]
 [-1.15096389]
 [12.96763086]]
resids [[-6.87674828e-06]
 [-1.15705288e-05]
 [ 7.17455081e-02]]
posterior
[[-3.85798039e+03]
 [-1.98954337e+03]
 [-5.65583977e+03]
 [-4.86428323e+00]
 [-3.38803920e+00]
 [ 4.52513677e+00]]
[[-3.84743916e+03]
 [-1.98134281e+03]
 [-5.67552996e+03]
 [-4.88213433e+00]
 [-3.39808046e+00]
 [ 4.50985337e+00]]
[[ 7.37323462e-01  2.29792492e-01 -1.73817010e+00 -1.80976744e-03
  -1.12349912e-03 -6.76269015e-04]
 [ 2.29792492e-01  7.22111307e-02 -5.41578705e-01 -5.63533336e-04
  -3.49720298e-04 -2.11453810e-04]
 [-1.73817010e+00 -5.41578705e-01  4.10667493e+00  4.27530008e-03
   2.65423581e-03  1.59427285e-03]
 [-1.80976744e-03 -5.63533336e-04  4.27530008e-03  4.49384980e-06
   2.79413900e-06  1.62326373e-06]
 [-1.12349912e-03 -3.49720298e-04  2.65423581e-03  2.79413900e-06
   1.73848093e-06  1.00341093e-06]
 [-6.76269015e-04 -2.11453810e-04  1.59427285e-03  1.62326373e-06
   1.00341093e-06  6.52678450e-07]]
[[ 0.30037224]
 [-1.15253554]
 [13.0900588 ]]
[[ 0.00530911]
 [ 0.00156008]
 [-0.05068244]]


 Corrector Step
2018-07-13 08:22:00
[[-3.84743916e+03]
 [-1.98134281e+03]
 [-5.67552996e+03]
 [-4.88213433e+00]
 [-3.39808046e+00]
 [ 4.50985337e+00]]
[[ 7.37323462e-01  2.29792492e-01 -1.73817010e+00 -1.80976744e-03
  -1.12349912e-03 -6.76269015e-04]
 [ 2.29792492e-01  7.22111307e-02 -5.41578705e-01 -5.63533336e-04
  -3.49720298e-04 -2.11453810e-04]
 [-1.73817010e+00 -5.41578705e-01  4.10667493e+00  4.27530008e-03
   2.65423581e-03  1.59427285e-03]
 [-1.80976744e-03 -5.63533336e-04  4.27530008e-03  4.49384980e-06
   2.79413900e-06  1.62326373e-06]
 [-1.12349912e-03 -3.49720298e-04  2.65423581e-03  2.79413900e-06
   1.73848093e-06  1.00341093e-06]
 [-6.76269015e-04 -2.11453810e-04  1.59427285e-03  1.62326373e-06
   1.00341093e-06  6.52678450e-07]]
1237011.4725632556
post
sphere_lamr_small
Ybar_post [[ 0.30564081]
 [-1.1509777 ]
 [13.1155848 ]]
resids [[ 4.05357981e-05]
 [ 2.23875963e-06]
 [-7.62084358e-02]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [1362224.80803919, 1237011.4725632556]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-3.84909106e+03],
       [-1.98181930e+03],
       [-5.67160462e+03],
       [-4.87823277e+00],
       [-3.39562379e+00],
       [ 4.51141694e+00]]), 'est_covars': array([[ 9.24285743e-01,  2.87284470e-01, -2.14030370e+00,
        -2.11521553e-03, -1.32190823e-03, -9.38090605e-04],
       [ 2.87284470e-01,  9.08884176e-02, -6.64232412e-01,
        -6.55981816e-04, -4.09592645e-04, -2.93021299e-04],
       [-2.14030370e+00, -6.64232412e-01,  4.96618143e+00,
         4.90845379e-03,  3.06781580e-03,  2.17133604e-03],
       [-2.11521553e-03, -6.55981816e-04,  4.90845379e-03,
         5.02988012e-06,  3.14862482e-06,  2.00230155e-06],
       [-1.32190823e-03, -4.09592645e-04,  3.06781580e-03,
         3.14862482e-06,  1.98752236e-06,  1.23957894e-06],
       [-9.38090605e-04, -2.93021299e-04,  2.17133604e-03,
         2.00230155e-06,  1.23957894e-06,  1.08769420e-06]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.84743916e+03],
       [-1.98134281e+03],
       [-5.67552996e+03],
       [-4.88213433e+00],
       [-3.39808046e+00],
       [ 4.50985337e+00]]), 'covar': array([[ 7.37323462e-01,  2.29792492e-01, -1.73817010e+00,
        -1.80976744e-03, -1.12349912e-03, -6.76269015e-04],
       [ 2.29792492e-01,  7.22111307e-02, -5.41578705e-01,
        -5.63533336e-04, -3.49720298e-04, -2.11453810e-04],
       [-1.73817010e+00, -5.41578705e-01,  4.10667493e+00,
         4.27530008e-03,  2.65423581e-03,  1.59427285e-03],
       [-1.80976744e-03, -5.63533336e-04,  4.27530008e-03,
         4.49384980e-06,  2.79413900e-06,  1.62326373e-06],
       [-1.12349912e-03, -3.49720298e-04,  2.65423581e-03,
         2.79413900e-06,  1.73848093e-06,  1.00341093e-06],
       [-6.76269015e-04, -2.11453810e-04,  1.59427285e-03,
         1.62326373e-06,  1.00341093e-06,  6.52678450e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 4.05357981e-05],
       [ 2.23875963e-06],
       [-7.62084358e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.84909106e+03],
       [-1.98181930e+03],
       [-5.67160462e+03],
       [-4.87823277e+00],
       [-3.39562379e+00],
       [ 4.51141694e+00],
       [ 4.57672362e-02],
       [-1.99582520e-02],
       [ 9.58560378e-01],
       [-2.80479999e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79931019e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.24285743e-01,  2.87284470e-01, -2.14030370e+00,
        -2.11521553e-03, -1.32190823e-03, -9.38090605e-04],
       [ 2.87284470e-01,  9.08884176e-02, -6.64232412e-01,
        -6.55981816e-04, -4.09592645e-04, -2.93021299e-04],
       [-2.14030370e+00, -6.64232412e-01,  4.96618143e+00,
         4.90845379e-03,  3.06781580e-03,  2.17133604e-03],
       [-2.11521553e-03, -6.55981816e-04,  4.90845379e-03,
         5.02988012e-06,  3.14862482e-06,  2.00230155e-06],
       [-1.32190823e-03, -4.09592645e-04,  3.06781580e-03,
         3.14862482e-06,  1.98752236e-06,  1.23957894e-06],
       [-9.38090605e-04, -2.93021299e-04,  2.17133604e-03,
         2.00230155e-06,  1.23957894e-06,  1.08769420e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-6.87674828e-06],
       [-1.15705288e-05],
       [ 7.17455081e-02]])}}
Current time:  2018-07-13 08:22:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.84909106e+03],
       [-1.98181930e+03],
       [-5.67160462e+03],
       [-4.87823277e+00],
       [-3.39562379e+00],
       [ 4.51141694e+00],
       [ 4.57672362e-02],
       [-1.99582520e-02],
       [ 9.58560378e-01],
       [-2.80479999e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79931019e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.24285743e-01,  2.87284470e-01, -2.14030370e+00,
        -2.11521553e-03, -1.32190823e-03, -9.38090605e-04],
       [ 2.87284470e-01,  9.08884176e-02, -6.64232412e-01,
        -6.55981816e-04, -4.09592645e-04, -2.93021299e-04],
       [-2.14030370e+00, -6.64232412e-01,  4.96618143e+00,
         4.90845379e-03,  3.06781580e-03,  2.17133604e-03],
       [-2.11521553e-03, -6.55981816e-04,  4.90845379e-03,
         5.02988012e-06,  3.14862482e-06,  2.00230155e-06],
       [-1.32190823e-03, -4.09592645e-04,  3.06781580e-03,
         3.14862482e-06,  1.98752236e-06,  1.23957894e-06],
       [-9.38090605e-04, -2.93021299e-04,  2.17133604e-03,
         2.00230155e-06,  1.23957894e-06,  1.08769420e-06]])}
[[-3.84909106e+03]
 [-1.98181930e+03]
 [-5.67160462e+03]
 [-4.87823277e+00]
 [-3.39562379e+00]
 [ 4.51141694e+00]
 [ 4.57672362e-02]
 [-1.99582520e-02]
 [ 9.58560378e-01]
 [-2.80479999e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79931019e-18]]
2018-07-13 08:22:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:10
[[-3.89766162e+03]
 [-2.01566640e+03]
 [-5.62618018e+03]
 [-4.83584591e+00]
 [-3.37375142e+00]
 [ 4.57339406e+00]
 [ 5.07715563e-02]
 [-1.84935060e-02]
 [ 9.58308347e-01]
 [-2.80580384e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79952248e-18]]
[[ 8.82191351e-01  2.67710546e-01 -2.10007850e+00 -2.09389075e-03
  -1.30332174e-03 -9.23634167e-04]
 [ 2.67710546e-01  8.28557584e-02 -6.36212817e-01 -6.33230627e-04
  -3.93556825e-04 -2.82270783e-04]
 [-2.10007850e+00 -6.36212817e-01  5.00985557e+00  4.99861243e-03
   3.11154306e-03  2.19601587e-03]
 [-2.09389075e-03 -6.33230627e-04  4.99861243e-03  5.17874928e-06
   3.22293548e-06  2.04651477e-06]
 [-1.30332174e-03 -3.93556825e-04  3.11154306e-03  3.22293548e-06
   2.03618654e-06  1.26175721e-06]
 [-9.23634167e-04 -2.82270783e-04  2.19601587e-03  2.04651477e-06
   1.26175721e-06  1.10956362e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.84743916e+03],
       [-1.98134281e+03],
       [-5.67552996e+03],
       [-4.88213433e+00],
       [-3.39808046e+00],
       [ 4.50985337e+00]]), 'covar': array([[ 7.37323462e-01,  2.29792492e-01, -1.73817010e+00,
        -1.80976744e-03, -1.12349912e-03, -6.76269015e-04],
       [ 2.29792492e-01,  7.22111307e-02, -5.41578705e-01,
        -5.63533336e-04, -3.49720298e-04, -2.11453810e-04],
       [-1.73817010e+00, -5.41578705e-01,  4.10667493e+00,
         4.27530008e-03,  2.65423581e-03,  1.59427285e-03],
       [-1.80976744e-03, -5.63533336e-04,  4.27530008e-03,
         4.49384980e-06,  2.79413900e-06,  1.62326373e-06],
       [-1.12349912e-03, -3.49720298e-04,  2.65423581e-03,
         2.79413900e-06,  1.73848093e-06,  1.00341093e-06],
       [-6.76269015e-04, -2.11453810e-04,  1.59427285e-03,
         1.62326373e-06,  1.00341093e-06,  6.52678450e-07]])}
[[-3.84743916e+03]
 [-1.98134281e+03]
 [-5.67552996e+03]
 [-4.88213433e+00]
 [-3.39808046e+00]
 [ 4.50985337e+00]]
2018-07-13 08:22:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:10
[[-3.89604914e+03]
 [-2.01521464e+03]
 [-5.63012088e+03]
 [-4.83980285e+00]
 [-3.37623231e+00]
 [ 4.57181885e+00]]
[[ 7.01339766e-01  2.13112223e-01 -1.70175263e+00 -1.78831582e-03
  -1.10603103e-03 -6.64800283e-04]
 [ 2.13112223e-01  6.53581664e-02 -5.16928331e-01 -5.42680208e-04
  -3.35494348e-04 -2.02845100e-04]
 [-1.70175263e+00 -5.16928331e-01  4.13874619e+00  4.34944882e-03
   2.69024148e-03  1.61274673e-03]
 [-1.78831582e-03 -5.42680208e-04  4.34944882e-03  4.61474887e-06
   2.85863640e-06  1.65816749e-06]
 [-1.10603103e-03 -3.35494348e-04  2.69024148e-03  2.85863640e-06
   1.77212678e-06  1.02119784e-06]
 [-6.64800283e-04 -2.02845100e-04  1.61274673e-03  1.65816749e-06
   1.02119784e-06  6.61972194e-07]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.89604914e+03],
       [-2.01521464e+03],
       [-5.63012088e+03],
       [-4.83980285e+00],
       [-3.37623231e+00],
       [ 4.57181885e+00]]), 'covar': array([[ 7.01339766e-01,  2.13112223e-01, -1.70175263e+00,
        -1.78831582e-03, -1.10603103e-03, -6.64800283e-04],
       [ 2.13112223e-01,  6.53581664e-02, -5.16928331e-01,
        -5.42680208e-04, -3.35494348e-04, -2.02845100e-04],
       [-1.70175263e+00, -5.16928331e-01,  4.13874619e+00,
         4.34944882e-03,  2.69024148e-03,  1.61274673e-03],
       [-1.78831582e-03, -5.42680208e-04,  4.34944882e-03,
         4.61474887e-06,  2.85863640e-06,  1.65816749e-06],
       [-1.10603103e-03, -3.35494348e-04,  2.69024148e-03,
         2.85863640e-06,  1.77212678e-06,  1.02119784e-06],
       [-6.64800283e-04, -2.02845100e-04,  1.61274673e-03,
         1.65816749e-06,  1.02119784e-06,  6.61972194e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 4.05357981e-05],
       [ 2.23875963e-06],
       [-7.62084358e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.89766162e+03],
       [-2.01566640e+03],
       [-5.62618018e+03],
       [-4.83584591e+00],
       [-3.37375142e+00],
       [ 4.57339406e+00],
       [ 5.07715563e-02],
       [-1.84935060e-02],
       [ 9.58308347e-01],
       [-2.80580384e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79952248e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.82191351e-01,  2.67710546e-01, -2.10007850e+00,
        -2.09389075e-03, -1.30332174e-03, -9.23634167e-04],
       [ 2.67710546e-01,  8.28557584e-02, -6.36212817e-01,
        -6.33230627e-04, -3.93556825e-04, -2.82270783e-04],
       [-2.10007850e+00, -6.36212817e-01,  5.00985557e+00,
         4.99861243e-03,  3.11154306e-03,  2.19601587e-03],
       [-2.09389075e-03, -6.33230627e-04,  4.99861243e-03,
         5.17874928e-06,  3.22293548e-06,  2.04651477e-06],
       [-1.30332174e-03, -3.93556825e-04,  3.11154306e-03,
         3.22293548e-06,  2.03618654e-06,  1.26175721e-06],
       [-9.23634167e-04, -2.82270783e-04,  2.19601587e-03,
         2.04651477e-06,  1.26175721e-06,  1.10956362e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-6.87674828e-06],
       [-1.15705288e-05],
       [ 7.17455081e-02]])}}
Yi [[ 0.28919454]
 [-1.16660549]
 [12.92621982]]
posterior
[[-3.89766162e+03]
 [-2.01566640e+03]
 [-5.62618018e+03]
 [-4.83584591e+00]
 [-3.37375142e+00]
 [ 4.57339406e+00]
 [ 5.07715563e-02]
 [-1.84935060e-02]
 [ 9.58308347e-01]
 [-2.80580384e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79952248e-18]]
[[-3.89783752e+03]
 [-2.01572098e+03]
 [-5.62579942e+03]
 [-4.83547759e+00]
 [-3.37352189e+00]
 [ 4.57358497e+00]
 [ 5.07715563e-02]
 [-1.84935060e-02]
 [ 9.58308347e-01]
 [-2.80580384e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79952248e-18]]
[[ 7.90781139e-01  2.35559946e-01 -1.90110834e+00 -1.90295790e-03
  -1.18579054e-03 -8.20293319e-04]
 [ 2.35559946e-01  7.05157429e-02 -5.66242620e-01 -5.66603342e-04
  -3.52937825e-04 -2.44752907e-04]
 [-1.90110834e+00 -5.66242620e-01  4.57673898e+00  4.58297834e-03
   2.85569006e-03  1.97109258e-03]
 [-1.90295790e-03 -5.66603342e-04  4.58297834e-03  4.77963115e-06
   2.97705201e-06  1.83126427e-06]
 [-1.18579054e-03 -3.52937825e-04  2.85569006e-03  2.97705201e-06
   1.88455534e-06  1.12970431e-06]
 [-8.20293319e-04 -2.44752907e-04  1.97109258e-03  1.83126427e-06
   1.12970431e-06  9.91405748e-07]]
[[ 0.28919487]
 [-1.16658427]
 [12.88589406]]
[[-3.32039386e-07]
 [-2.12175763e-05]
 [ 4.03257564e-02]]


 Corrector Step
2018-07-13 08:22:10
[[-3.89783752e+03]
 [-2.01572098e+03]
 [-5.62579942e+03]
 [-4.83547759e+00]
 [-3.37352189e+00]
 [ 4.57358497e+00]
 [ 5.07715563e-02]
 [-1.84935060e-02]
 [ 9.58308347e-01]
 [-2.80580384e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79952248e-18]]
[[ 7.90781139e-01  2.35559946e-01 -1.90110834e+00 -1.90295790e-03
  -1.18579054e-03 -8.20293319e-04]
 [ 2.35559946e-01  7.05157429e-02 -5.66242620e-01 -5.66603342e-04
  -3.52937825e-04 -2.44752907e-04]
 [-1.90110834e+00 -5.66242620e-01  4.57673898e+00  4.58297834e-03
   2.85569006e-03  1.97109258e-03]
 [-1.90295790e-03 -5.66603342e-04  4.58297834e-03  4.77963115e-06
   2.97705201e-06  1.83126427e-06]
 [-1.18579054e-03 -3.52937825e-04  2.85569006e-03  2.97705201e-06
   1.88455534e-06  1.12970431e-06]
 [-8.20293319e-04 -2.44752907e-04  1.97109258e-03  1.83126427e-06
   1.12970431e-06  9.91405748e-07]]
280662479.1987655
post
cubesat_nadir
Ybar_post [[ 0.28919233]
 [-1.16659339]
 [12.88546276]]
resids [[ 2.20702069e-06]
 [-1.20943590e-05]
 [ 4.07570540e-02]]
posterior
[[-3.89604914e+03]
 [-2.01521464e+03]
 [-5.63012088e+03]
 [-4.83980285e+00]
 [-3.37623231e+00]
 [ 4.57181885e+00]]
[[-3.89599172e+03]
 [-2.01518260e+03]
 [-5.63029269e+03]
 [-4.83997030e+00]
 [-3.37633312e+00]
 [ 4.57174453e+00]]
[[ 6.79615917e-01  2.03969827e-01 -1.65294451e+00 -1.73932680e-03
  -1.07638325e-03 -6.40638694e-04]
 [ 2.03969827e-01  6.14734840e-02 -4.96102350e-01 -5.21796516e-04
  -3.22855557e-04 -1.92628351e-04]
 [-1.65294451e+00 -4.96102350e-01  4.02641302e+00  4.23682516e-03
   2.62206609e-03  1.55809480e-03]
 [-1.73932680e-03 -5.21796516e-04  4.23682516e-03  4.50182274e-06
   2.79027720e-06  1.60333866e-06]
 [-1.07638325e-03 -3.22855557e-04  2.62206609e-03  2.79027720e-06
   1.73074544e-06  9.88015841e-07]
 [-6.40638694e-04 -1.92628351e-04  1.55809480e-03  1.60333866e-06
   9.88015841e-07  6.35036082e-07]]
[[ 0.28916308]
 [-1.16658908]
 [13.04217267]]
[[ 3.14633133e-05]
 [-1.64045012e-05]
 [-1.15952854e-01]]


 Corrector Step
2018-07-13 08:22:10
[[-3.89599172e+03]
 [-2.01518260e+03]
 [-5.63029269e+03]
 [-4.83997030e+00]
 [-3.37633312e+00]
 [ 4.57174453e+00]]
[[ 6.79615917e-01  2.03969827e-01 -1.65294451e+00 -1.73932680e-03
  -1.07638325e-03 -6.40638694e-04]
 [ 2.03969827e-01  6.14734840e-02 -4.96102350e-01 -5.21796516e-04
  -3.22855557e-04 -1.92628351e-04]
 [-1.65294451e+00 -4.96102350e-01  4.02641302e+00  4.23682516e-03
   2.62206609e-03  1.55809480e-03]
 [-1.73932680e-03 -5.21796516e-04  4.23682516e-03  4.50182274e-06
   2.79027720e-06  1.60333866e-06]
 [-1.07638325e-03 -3.22855557e-04  2.62206609e-03  2.79027720e-06
   1.73074544e-06  9.88015841e-07]
 [-6.40638694e-04 -1.92628351e-04  1.55809480e-03  1.60333866e-06
   9.88015841e-07  6.35036082e-07]]
162949452.47194895
post
sphere_lamr_small
Ybar_post [[ 0.28918006]
 [-1.16659311]
 [13.04236666]]
resids [[ 1.44750294e-05]
 [-1.23794730e-05]
 [-1.16146847e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [280662479.1987655, 162949452.47194895]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-3.89783752e+03],
       [-2.01572098e+03],
       [-5.62579942e+03],
       [-4.83547759e+00],
       [-3.37352189e+00],
       [ 4.57358497e+00]]), 'est_covars': array([[ 7.90781139e-01,  2.35559946e-01, -1.90110834e+00,
        -1.90295790e-03, -1.18579054e-03, -8.20293319e-04],
       [ 2.35559946e-01,  7.05157429e-02, -5.66242620e-01,
        -5.66603342e-04, -3.52937825e-04, -2.44752907e-04],
       [-1.90110834e+00, -5.66242620e-01,  4.57673898e+00,
         4.58297834e-03,  2.85569006e-03,  1.97109258e-03],
       [-1.90295790e-03, -5.66603342e-04,  4.58297834e-03,
         4.77963115e-06,  2.97705201e-06,  1.83126427e-06],
       [-1.18579054e-03, -3.52937825e-04,  2.85569006e-03,
         2.97705201e-06,  1.88455534e-06,  1.12970431e-06],
       [-8.20293319e-04, -2.44752907e-04,  1.97109258e-03,
         1.83126427e-06,  1.12970431e-06,  9.91405748e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.89599172e+03],
       [-2.01518260e+03],
       [-5.63029269e+03],
       [-4.83997030e+00],
       [-3.37633312e+00],
       [ 4.57174453e+00]]), 'covar': array([[ 6.79615917e-01,  2.03969827e-01, -1.65294451e+00,
        -1.73932680e-03, -1.07638325e-03, -6.40638694e-04],
       [ 2.03969827e-01,  6.14734840e-02, -4.96102350e-01,
        -5.21796516e-04, -3.22855557e-04, -1.92628351e-04],
       [-1.65294451e+00, -4.96102350e-01,  4.02641302e+00,
         4.23682516e-03,  2.62206609e-03,  1.55809480e-03],
       [-1.73932680e-03, -5.21796516e-04,  4.23682516e-03,
         4.50182274e-06,  2.79027720e-06,  1.60333866e-06],
       [-1.07638325e-03, -3.22855557e-04,  2.62206609e-03,
         2.79027720e-06,  1.73074544e-06,  9.88015841e-07],
       [-6.40638694e-04, -1.92628351e-04,  1.55809480e-03,
         1.60333866e-06,  9.88015841e-07,  6.35036082e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.44750294e-05],
       [-1.23794730e-05],
       [-1.16146847e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.89783752e+03],
       [-2.01572098e+03],
       [-5.62579942e+03],
       [-4.83547759e+00],
       [-3.37352189e+00],
       [ 4.57358497e+00],
       [ 5.07715563e-02],
       [-1.84935060e-02],
       [ 9.58308347e-01],
       [-2.80580384e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79952248e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.90781139e-01,  2.35559946e-01, -1.90110834e+00,
        -1.90295790e-03, -1.18579054e-03, -8.20293319e-04],
       [ 2.35559946e-01,  7.05157429e-02, -5.66242620e-01,
        -5.66603342e-04, -3.52937825e-04, -2.44752907e-04],
       [-1.90110834e+00, -5.66242620e-01,  4.57673898e+00,
         4.58297834e-03,  2.85569006e-03,  1.97109258e-03],
       [-1.90295790e-03, -5.66603342e-04,  4.58297834e-03,
         4.77963115e-06,  2.97705201e-06,  1.83126427e-06],
       [-1.18579054e-03, -3.52937825e-04,  2.85569006e-03,
         2.97705201e-06,  1.88455534e-06,  1.12970431e-06],
       [-8.20293319e-04, -2.44752907e-04,  1.97109258e-03,
         1.83126427e-06,  1.12970431e-06,  9.91405748e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.20702069e-06],
       [-1.20943590e-05],
       [ 4.07570540e-02]])}}
Current time:  2018-07-13 08:22:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.89783752e+03],
       [-2.01572098e+03],
       [-5.62579942e+03],
       [-4.83547759e+00],
       [-3.37352189e+00],
       [ 4.57358497e+00],
       [ 5.07715563e-02],
       [-1.84935060e-02],
       [ 9.58308347e-01],
       [-2.80580384e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79952248e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.90781139e-01,  2.35559946e-01, -1.90110834e+00,
        -1.90295790e-03, -1.18579054e-03, -8.20293319e-04],
       [ 2.35559946e-01,  7.05157429e-02, -5.66242620e-01,
        -5.66603342e-04, -3.52937825e-04, -2.44752907e-04],
       [-1.90110834e+00, -5.66242620e-01,  4.57673898e+00,
         4.58297834e-03,  2.85569006e-03,  1.97109258e-03],
       [-1.90295790e-03, -5.66603342e-04,  4.58297834e-03,
         4.77963115e-06,  2.97705201e-06,  1.83126427e-06],
       [-1.18579054e-03, -3.52937825e-04,  2.85569006e-03,
         2.97705201e-06,  1.88455534e-06,  1.12970431e-06],
       [-8.20293319e-04, -2.44752907e-04,  1.97109258e-03,
         1.83126427e-06,  1.12970431e-06,  9.91405748e-07]])}
[[-3.89783752e+03]
 [-2.01572098e+03]
 [-5.62579942e+03]
 [-4.83547759e+00]
 [-3.37352189e+00]
 [ 4.57358497e+00]
 [ 5.07715563e-02]
 [-1.84935060e-02]
 [ 9.58308347e-01]
 [-2.80580384e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79952248e-18]]
2018-07-13 08:22:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:20
[[-3.94597807e+03]
 [-2.04934519e+03]
 [-5.57975567e+03]
 [-4.79255143e+00]
 [-3.35127537e+00]
 [ 4.63506804e+00]
 [ 5.57744922e-02]
 [-1.70282559e-02]
 [ 9.58030190e-01]
 [-2.80673119e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79973477e-18]]
[[ 7.52940138e-01  2.18238042e-01 -1.86300112e+00 -1.88080294e-03
  -1.16742922e-03 -8.06793792e-04]
 [ 2.18238042e-01  6.36120659e-02 -5.39883700e-01 -5.44225843e-04
  -3.37320054e-04 -2.34825836e-04]
 [-1.86300112e+00 -5.39883700e-01  4.61638441e+00  4.66581234e-03
   2.89579968e-03  1.99339697e-03]
 [-1.88080294e-03 -5.44225843e-04  4.66581234e-03  4.91905674e-06
   3.04618136e-06  1.87138602e-06]
 [-1.16742922e-03 -3.37320054e-04  2.89579968e-03  3.04618136e-06
   1.93047589e-06  1.14979191e-06]
 [-8.06793792e-04 -2.34825836e-04  1.99339697e-03  1.87138602e-06
   1.14979191e-06  1.01192960e-06]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.89599172e+03],
       [-2.01518260e+03],
       [-5.63029269e+03],
       [-4.83997030e+00],
       [-3.37633312e+00],
       [ 4.57174453e+00]]), 'covar': array([[ 6.79615917e-01,  2.03969827e-01, -1.65294451e+00,
        -1.73932680e-03, -1.07638325e-03, -6.40638694e-04],
       [ 2.03969827e-01,  6.14734840e-02, -4.96102350e-01,
        -5.21796516e-04, -3.22855557e-04, -1.92628351e-04],
       [-1.65294451e+00, -4.96102350e-01,  4.02641302e+00,
         4.23682516e-03,  2.62206609e-03,  1.55809480e-03],
       [-1.73932680e-03, -5.21796516e-04,  4.23682516e-03,
         4.50182274e-06,  2.79027720e-06,  1.60333866e-06],
       [-1.07638325e-03, -3.22855557e-04,  2.62206609e-03,
         2.79027720e-06,  1.73074544e-06,  9.88015841e-07],
       [-6.40638694e-04, -1.92628351e-04,  1.55809480e-03,
         1.60333866e-06,  9.88015841e-07,  6.35036082e-07]])}
[[-3.89599172e+03]
 [-2.01518260e+03]
 [-5.63029269e+03]
 [-4.83997030e+00]
 [-3.37633312e+00]
 [ 4.57174453e+00]]
2018-07-13 08:22:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:20
[[-3.94417739e+03]
 [-2.04883514e+03]
 [-5.58426737e+03]
 [-4.79710716e+00]
 [-3.35411445e+00]
 [ 4.63321504e+00]]
[[ 6.45054148e-01  1.88183695e-01 -1.61656167e+00 -1.71656593e-03
  -1.05839893e-03 -6.28943872e-04]
 [ 1.88183695e-01  5.51599712e-02 -4.71588939e-01 -5.00339217e-04
  -3.08414533e-04 -1.83994799e-04]
 [-1.61656167e+00 -4.71588939e-01  4.05775137e+00  4.30953351e-03
   2.65734752e-03  1.57567358e-03]
 [-1.71656593e-03 -5.00339217e-04  4.30953351e-03  4.62139887e-06
   2.85394055e-06  1.63706902e-06]
 [-1.05839893e-03 -3.08414533e-04  2.65734752e-03  2.85394055e-06
   1.76390661e-06  1.00513832e-06]
 [-6.28943872e-04 -1.83994799e-04  1.57567358e-03  1.63706902e-06
   1.00513832e-06  6.43765035e-07]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.94417739e+03],
       [-2.04883514e+03],
       [-5.58426737e+03],
       [-4.79710716e+00],
       [-3.35411445e+00],
       [ 4.63321504e+00]]), 'covar': array([[ 6.45054148e-01,  1.88183695e-01, -1.61656167e+00,
        -1.71656593e-03, -1.05839893e-03, -6.28943872e-04],
       [ 1.88183695e-01,  5.51599712e-02, -4.71588939e-01,
        -5.00339217e-04, -3.08414533e-04, -1.83994799e-04],
       [-1.61656167e+00, -4.71588939e-01,  4.05775137e+00,
         4.30953351e-03,  2.65734752e-03,  1.57567358e-03],
       [-1.71656593e-03, -5.00339217e-04,  4.30953351e-03,
         4.62139887e-06,  2.85394055e-06,  1.63706902e-06],
       [-1.05839893e-03, -3.08414533e-04,  2.65734752e-03,
         2.85394055e-06,  1.76390661e-06,  1.00513832e-06],
       [-6.28943872e-04, -1.83994799e-04,  1.57567358e-03,
         1.63706902e-06,  1.00513832e-06,  6.43765035e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.44750294e-05],
       [-1.23794730e-05],
       [-1.16146847e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.94597807e+03],
       [-2.04934519e+03],
       [-5.57975567e+03],
       [-4.79255143e+00],
       [-3.35127537e+00],
       [ 4.63506804e+00],
       [ 5.57744922e-02],
       [-1.70282559e-02],
       [ 9.58030190e-01],
       [-2.80673119e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79973477e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.52940138e-01,  2.18238042e-01, -1.86300112e+00,
        -1.88080294e-03, -1.16742922e-03, -8.06793792e-04],
       [ 2.18238042e-01,  6.36120659e-02, -5.39883700e-01,
        -5.44225843e-04, -3.37320054e-04, -2.34825836e-04],
       [-1.86300112e+00, -5.39883700e-01,  4.61638441e+00,
         4.66581234e-03,  2.89579968e-03,  1.99339697e-03],
       [-1.88080294e-03, -5.44225843e-04,  4.66581234e-03,
         4.91905674e-06,  3.04618136e-06,  1.87138602e-06],
       [-1.16742922e-03, -3.37320054e-04,  2.89579968e-03,
         3.04618136e-06,  1.93047589e-06,  1.14979191e-06],
       [-8.06793792e-04, -2.34825836e-04,  1.99339697e-03,
         1.87138602e-06,  1.14979191e-06,  1.01192960e-06]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.20702069e-06],
       [-1.20943590e-05],
       [ 4.07570540e-02]])}}
Yi [[ 0.27037158]
 [-1.18274476]
 [12.76344537]]
posterior
[[-3.94597807e+03]
 [-2.04934519e+03]
 [-5.57975567e+03]
 [-4.79255143e+00]
 [-3.35127537e+00]
 [ 4.63506804e+00]
 [ 5.57744922e-02]
 [-1.70282559e-02]
 [ 9.58030190e-01]
 [-2.80673119e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79973477e-18]]
[[-3.94649351e+03]
 [-2.04951663e+03]
 [-5.57847484e+03]
 [-4.79129995e+00]
 [-3.35052938e+00]
 [ 4.63567636e+00]
 [ 5.57744922e-02]
 [-1.70282559e-02]
 [ 9.58030190e-01]
 [-2.80673119e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79973477e-18]]
[[ 5.80242519e-01  1.64415202e-01 -1.44738269e+00 -1.47785066e-03
  -9.21739555e-04 -6.07348224e-04]
 [ 1.64415202e-01  4.67732354e-02 -4.10119040e-01 -4.18363987e-04
  -2.60680516e-04 -1.72586052e-04]
 [-1.44738269e+00 -4.10119040e-01  3.61529217e+00  3.69503318e-03
   2.30426010e-03  1.51311799e-03]
 [-1.47785066e-03 -4.18363987e-04  3.69503318e-03  3.97762477e-06
   2.47260624e-06  1.40568190e-06]
 [-9.21739555e-04 -2.60680516e-04  2.30426010e-03  2.47260624e-06
   1.58086100e-06  8.65967808e-07]
 [-6.07348224e-04 -1.72586052e-04  1.51311799e-03  1.40568190e-06
   8.65967808e-07  7.81490751e-07]]
[[ 0.27043703]
 [-1.182742  ]
 [12.80144501]]
[[-6.54491849e-05]
 [-2.75933032e-06]
 [-3.79996379e-02]]


 Corrector Step
2018-07-13 08:22:20
[[-3.94649351e+03]
 [-2.04951663e+03]
 [-5.57847484e+03]
 [-4.79129995e+00]
 [-3.35052938e+00]
 [ 4.63567636e+00]
 [ 5.57744922e-02]
 [-1.70282559e-02]
 [ 9.58030190e-01]
 [-2.80673119e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79973477e-18]]
[[ 5.80242519e-01  1.64415202e-01 -1.44738269e+00 -1.47785066e-03
  -9.21739555e-04 -6.07348224e-04]
 [ 1.64415202e-01  4.67732354e-02 -4.10119040e-01 -4.18363987e-04
  -2.60680516e-04 -1.72586052e-04]
 [-1.44738269e+00 -4.10119040e-01  3.61529217e+00  3.69503318e-03
   2.30426010e-03  1.51311799e-03]
 [-1.47785066e-03 -4.18363987e-04  3.69503318e-03  3.97762477e-06
   2.47260624e-06  1.40568190e-06]
 [-9.21739555e-04 -2.60680516e-04  2.30426010e-03  2.47260624e-06
   1.58086100e-06  8.65967808e-07]
 [-6.07348224e-04 -1.72586052e-04  1.51311799e-03  1.40568190e-06
   8.65967808e-07  7.81490751e-07]]
100935906.28340343
post
cubesat_nadir
Ybar_post [[ 0.27040203]
 [-1.18275046]
 [12.79996029]]
resids [[-3.04513950e-05]
 [ 5.70584392e-06]
 [-3.65149239e-02]]
posterior
[[-3.94417739e+03]
 [-2.04883514e+03]
 [-5.58426737e+03]
 [-4.79710716e+00]
 [-3.35411445e+00]
 [ 4.63321504e+00]]
[[-3.94499707e+03]
 [-2.04909534e+03]
 [-5.58222295e+03]
 [-4.79497146e+00]
 [-3.35280467e+00]
 [ 4.63405621e+00]]
[[ 5.17950439e-01  1.48021976e-01 -1.30342835e+00 -1.38965643e-03
  -8.57968673e-04 -4.98583727e-04]
 [ 1.48021976e-01  4.24584945e-02 -3.72519450e-01 -3.96912954e-04
  -2.45003055e-04 -1.42791365e-04]
 [-1.30342835e+00 -3.72519450e-01  3.28486054e+00  3.50265477e-03
   2.16264195e-03  1.25437745e-03]
 [-1.38965643e-03 -3.96912954e-04  3.50265477e-03  3.77903675e-06
   2.33747965e-06  1.30163989e-06]
 [-8.57968673e-04 -2.45003055e-04  2.16264195e-03  2.33747965e-06
   1.44725907e-06  7.99484488e-07]
 [-4.98583727e-04 -1.42791365e-04  1.25437745e-03  1.30163989e-06
   7.99484488e-07  5.10050477e-07]]
[[ 0.27045028]
 [-1.18272996]
 [12.96697569]]
[[-7.87000425e-05]
 [-1.47994686e-05]
 [-2.03530319e-01]]


 Corrector Step
2018-07-13 08:22:20
[[-3.94499707e+03]
 [-2.04909534e+03]
 [-5.58222295e+03]
 [-4.79497146e+00]
 [-3.35280467e+00]
 [ 4.63405621e+00]]
[[ 5.17950439e-01  1.48021976e-01 -1.30342835e+00 -1.38965643e-03
  -8.57968673e-04 -4.98583727e-04]
 [ 1.48021976e-01  4.24584945e-02 -3.72519450e-01 -3.96912954e-04
  -2.45003055e-04 -1.42791365e-04]
 [-1.30342835e+00 -3.72519450e-01  3.28486054e+00  3.50265477e-03
   2.16264195e-03  1.25437745e-03]
 [-1.38965643e-03 -3.96912954e-04  3.50265477e-03  3.77903675e-06
   2.33747965e-06  1.30163989e-06]
 [-8.57968673e-04 -2.45003055e-04  2.16264195e-03  2.33747965e-06
   1.44725907e-06  7.99484488e-07]
 [-4.98583727e-04 -1.42791365e-04  1.25437745e-03  1.30163989e-06
   7.99484488e-07  5.10050477e-07]]
5989556.476695885
post
sphere_lamr_small
Ybar_post [[ 0.27040998]
 [-1.18274046]
 [12.96464572]]
resids [[-3.83925155e-05]
 [-4.29500421e-06]
 [-2.01200355e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [100935906.28340343, 5989556.476695885]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-3.94649351e+03],
       [-2.04951663e+03],
       [-5.57847484e+03],
       [-4.79129995e+00],
       [-3.35052938e+00],
       [ 4.63567636e+00]]), 'est_covars': array([[ 5.80242519e-01,  1.64415202e-01, -1.44738269e+00,
        -1.47785066e-03, -9.21739555e-04, -6.07348224e-04],
       [ 1.64415202e-01,  4.67732354e-02, -4.10119040e-01,
        -4.18363987e-04, -2.60680516e-04, -1.72586052e-04],
       [-1.44738269e+00, -4.10119040e-01,  3.61529217e+00,
         3.69503318e-03,  2.30426010e-03,  1.51311799e-03],
       [-1.47785066e-03, -4.18363987e-04,  3.69503318e-03,
         3.97762477e-06,  2.47260624e-06,  1.40568190e-06],
       [-9.21739555e-04, -2.60680516e-04,  2.30426010e-03,
         2.47260624e-06,  1.58086100e-06,  8.65967808e-07],
       [-6.07348224e-04, -1.72586052e-04,  1.51311799e-03,
         1.40568190e-06,  8.65967808e-07,  7.81490751e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.94499707e+03],
       [-2.04909534e+03],
       [-5.58222295e+03],
       [-4.79497146e+00],
       [-3.35280467e+00],
       [ 4.63405621e+00]]), 'covar': array([[ 5.17950439e-01,  1.48021976e-01, -1.30342835e+00,
        -1.38965643e-03, -8.57968673e-04, -4.98583727e-04],
       [ 1.48021976e-01,  4.24584945e-02, -3.72519450e-01,
        -3.96912954e-04, -2.45003055e-04, -1.42791365e-04],
       [-1.30342835e+00, -3.72519450e-01,  3.28486054e+00,
         3.50265477e-03,  2.16264195e-03,  1.25437745e-03],
       [-1.38965643e-03, -3.96912954e-04,  3.50265477e-03,
         3.77903675e-06,  2.33747965e-06,  1.30163989e-06],
       [-8.57968673e-04, -2.45003055e-04,  2.16264195e-03,
         2.33747965e-06,  1.44725907e-06,  7.99484488e-07],
       [-4.98583727e-04, -1.42791365e-04,  1.25437745e-03,
         1.30163989e-06,  7.99484488e-07,  5.10050477e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.83925155e-05],
       [-4.29500421e-06],
       [-2.01200355e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.94649351e+03],
       [-2.04951663e+03],
       [-5.57847484e+03],
       [-4.79129995e+00],
       [-3.35052938e+00],
       [ 4.63567636e+00],
       [ 5.57744922e-02],
       [-1.70282559e-02],
       [ 9.58030190e-01],
       [-2.80673119e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79973477e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.80242519e-01,  1.64415202e-01, -1.44738269e+00,
        -1.47785066e-03, -9.21739555e-04, -6.07348224e-04],
       [ 1.64415202e-01,  4.67732354e-02, -4.10119040e-01,
        -4.18363987e-04, -2.60680516e-04, -1.72586052e-04],
       [-1.44738269e+00, -4.10119040e-01,  3.61529217e+00,
         3.69503318e-03,  2.30426010e-03,  1.51311799e-03],
       [-1.47785066e-03, -4.18363987e-04,  3.69503318e-03,
         3.97762477e-06,  2.47260624e-06,  1.40568190e-06],
       [-9.21739555e-04, -2.60680516e-04,  2.30426010e-03,
         2.47260624e-06,  1.58086100e-06,  8.65967808e-07],
       [-6.07348224e-04, -1.72586052e-04,  1.51311799e-03,
         1.40568190e-06,  8.65967808e-07,  7.81490751e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.04513950e-05],
       [ 5.70584392e-06],
       [-3.65149239e-02]])}}
Current time:  2018-07-13 08:22:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.94649351e+03],
       [-2.04951663e+03],
       [-5.57847484e+03],
       [-4.79129995e+00],
       [-3.35052938e+00],
       [ 4.63567636e+00],
       [ 5.57744922e-02],
       [-1.70282559e-02],
       [ 9.58030190e-01],
       [-2.80673119e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79973477e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.80242519e-01,  1.64415202e-01, -1.44738269e+00,
        -1.47785066e-03, -9.21739555e-04, -6.07348224e-04],
       [ 1.64415202e-01,  4.67732354e-02, -4.10119040e-01,
        -4.18363987e-04, -2.60680516e-04, -1.72586052e-04],
       [-1.44738269e+00, -4.10119040e-01,  3.61529217e+00,
         3.69503318e-03,  2.30426010e-03,  1.51311799e-03],
       [-1.47785066e-03, -4.18363987e-04,  3.69503318e-03,
         3.97762477e-06,  2.47260624e-06,  1.40568190e-06],
       [-9.21739555e-04, -2.60680516e-04,  2.30426010e-03,
         2.47260624e-06,  1.58086100e-06,  8.65967808e-07],
       [-6.07348224e-04, -1.72586052e-04,  1.51311799e-03,
         1.40568190e-06,  8.65967808e-07,  7.81490751e-07]])}
[[-3.94649351e+03]
 [-2.04951663e+03]
 [-5.57847484e+03]
 [-4.79129995e+00]
 [-3.35052938e+00]
 [ 4.63567636e+00]
 [ 5.57744922e-02]
 [-1.70282559e-02]
 [ 9.58030190e-01]
 [-2.80673119e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79973477e-18]]
2018-07-13 08:22:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:30
[[-3.99418961e+03]
 [-2.08290903e+03]
 [-5.53181272e+03]
 [-4.74782656e+00]
 [-3.32790518e+00]
 [ 4.69666069e+00]
 [ 6.07759076e-02]
 [-1.55625415e-02]
 [ 9.57725915e-01]
 [-2.80758203e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79994705e-18]]
[[ 5.50886034e-01  1.51190335e-01 -1.41612952e+00 -1.45751873e-03
  -9.05656332e-04 -5.96841307e-04]
 [ 1.51190335e-01  4.16938239e-02 -3.88607460e-01 -3.98942086e-04
  -2.47167515e-04 -1.64880754e-04]
 [-1.41612952e+00 -3.88607460e-01  3.64572818e+00  3.75999334e-03
   2.33562196e-03  1.53044823e-03]
 [-1.45751873e-03 -3.98942086e-04  3.75999334e-03  4.09184292e-06
   2.52826991e-06  1.43666706e-06]
 [-9.05656332e-04 -2.47167515e-04  2.33562196e-03  2.52826991e-06
   1.61976774e-06  8.81500694e-07]
 [-5.96841307e-04 -1.64880754e-04  1.53044823e-03  1.43666706e-06
   8.81500694e-07  7.99317047e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.94499707e+03],
       [-2.04909534e+03],
       [-5.58222295e+03],
       [-4.79497146e+00],
       [-3.35280467e+00],
       [ 4.63405621e+00]]), 'covar': array([[ 5.17950439e-01,  1.48021976e-01, -1.30342835e+00,
        -1.38965643e-03, -8.57968673e-04, -4.98583727e-04],
       [ 1.48021976e-01,  4.24584945e-02, -3.72519450e-01,
        -3.96912954e-04, -2.45003055e-04, -1.42791365e-04],
       [-1.30342835e+00, -3.72519450e-01,  3.28486054e+00,
         3.50265477e-03,  2.16264195e-03,  1.25437745e-03],
       [-1.38965643e-03, -3.96912954e-04,  3.50265477e-03,
         3.77903675e-06,  2.33747965e-06,  1.30163989e-06],
       [-8.57968673e-04, -2.45003055e-04,  2.16264195e-03,
         2.33747965e-06,  1.44725907e-06,  7.99484488e-07],
       [-4.98583727e-04, -1.42791365e-04,  1.25437745e-03,
         1.30163989e-06,  7.99484488e-07,  5.10050477e-07]])}
[[-3.94499707e+03]
 [-2.04909534e+03]
 [-5.58222295e+03]
 [-4.79497146e+00]
 [-3.35280467e+00]
 [ 4.63405621e+00]]
2018-07-13 08:22:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:30
[[-3.99273019e+03]
 [-2.08251067e+03]
 [-5.53557712e+03]
 [-4.75155038e+00]
 [-3.33020391e+00]
 [ 4.69503073e+00]]
[[ 4.90357805e-01  1.35642707e-01 -1.27304383e+00 -1.36936599e-03
  -8.42377913e-04 -4.88853391e-04]
 [ 1.35642707e-01  3.76812119e-02 -3.52142561e-01 -3.78336377e-04
  -2.32658629e-04 -1.35689386e-04]
 [-1.27304383e+00 -3.52142561e-01  3.31008782e+00  3.56186023e-03
   2.19130467e-03  1.26829959e-03]
 [-1.36936599e-03 -3.78336377e-04  3.56186023e-03  3.87780591e-06
   2.38994967e-06  1.32867494e-06]
 [-8.42377913e-04 -2.32658629e-04  2.19130467e-03  2.38994967e-06
   1.47455515e-06  8.13172328e-07]
 [-4.88853391e-04 -1.35689386e-04  1.26829959e-03  1.32867494e-06
   8.13172328e-07  5.16836763e-07]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.99273019e+03],
       [-2.08251067e+03],
       [-5.53557712e+03],
       [-4.75155038e+00],
       [-3.33020391e+00],
       [ 4.69503073e+00]]), 'covar': array([[ 4.90357805e-01,  1.35642707e-01, -1.27304383e+00,
        -1.36936599e-03, -8.42377913e-04, -4.88853391e-04],
       [ 1.35642707e-01,  3.76812119e-02, -3.52142561e-01,
        -3.78336377e-04, -2.32658629e-04, -1.35689386e-04],
       [-1.27304383e+00, -3.52142561e-01,  3.31008782e+00,
         3.56186023e-03,  2.19130467e-03,  1.26829959e-03],
       [-1.36936599e-03, -3.78336377e-04,  3.56186023e-03,
         3.87780591e-06,  2.38994967e-06,  1.32867494e-06],
       [-8.42377913e-04, -2.32658629e-04,  2.19130467e-03,
         2.38994967e-06,  1.47455515e-06,  8.13172328e-07],
       [-4.88853391e-04, -1.35689386e-04,  1.26829959e-03,
         1.32867494e-06,  8.13172328e-07,  5.16836763e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.83925155e-05],
       [-4.29500421e-06],
       [-2.01200355e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.99418961e+03],
       [-2.08290903e+03],
       [-5.53181272e+03],
       [-4.74782656e+00],
       [-3.32790518e+00],
       [ 4.69666069e+00],
       [ 6.07759076e-02],
       [-1.55625415e-02],
       [ 9.57725915e-01],
       [-2.80758203e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79994705e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.50886034e-01,  1.51190335e-01, -1.41612952e+00,
        -1.45751873e-03, -9.05656332e-04, -5.96841307e-04],
       [ 1.51190335e-01,  4.16938239e-02, -3.88607460e-01,
        -3.98942086e-04, -2.47167515e-04, -1.64880754e-04],
       [-1.41612952e+00, -3.88607460e-01,  3.64572818e+00,
         3.75999334e-03,  2.33562196e-03,  1.53044823e-03],
       [-1.45751873e-03, -3.98942086e-04,  3.75999334e-03,
         4.09184292e-06,  2.52826991e-06,  1.43666706e-06],
       [-9.05656332e-04, -2.47167515e-04,  2.33562196e-03,
         2.52826991e-06,  1.61976774e-06,  8.81500694e-07],
       [-5.96841307e-04, -1.64880754e-04,  1.53044823e-03,
         1.43666706e-06,  8.81500694e-07,  7.99317047e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.04513950e-05],
       [ 5.70584392e-06],
       [-3.65149239e-02]])}}
Yi [[ 0.24887404]
 [-1.19941602]
 [12.71781411]]
posterior
[[-3.99418961e+03]
 [-2.08290903e+03]
 [-5.53181272e+03]
 [-4.74782656e+00]
 [-3.32790518e+00]
 [ 4.69666069e+00]
 [ 6.07759076e-02]
 [-1.55625415e-02]
 [ 9.57725915e-01]
 [-2.80758203e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79994705e-18]]
[[-3.99425976e+03]
 [-2.08293607e+03]
 [-5.53158638e+03]
 [-4.74756681e+00]
 [-3.32777998e+00]
 [ 4.69674698e+00]
 [ 6.07759076e-02]
 [-1.55625415e-02]
 [ 9.57725915e-01]
 [-2.80758203e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79994705e-18]]
[[ 3.45441265e-01  9.20474681e-02 -8.95372555e-01 -9.45005786e-04
  -5.96058066e-04 -3.54924359e-04]
 [ 9.20474681e-02  2.46517218e-02 -2.38578777e-01 -2.51201255e-04
  -1.57995409e-04 -9.52294902e-05]
 [-8.95372555e-01 -2.38578777e-01  2.32490971e+00  2.45946101e-03
   1.55052857e-03  9.17182821e-04]
 [-9.45005786e-04 -2.51201255e-04  2.45946101e-03  2.81080618e-06
   1.75534935e-06  8.33067048e-07]
 [-5.96058066e-04 -1.57995409e-04  1.55052857e-03  1.75534935e-06
   1.15307547e-06  5.16919342e-07]
 [-3.54924359e-04 -9.52294902e-05  9.17182821e-04  8.33067048e-07
   5.16919342e-07  5.14446061e-07]]
[[ 0.24890701]
 [-1.19945142]
 [12.71352005]]
[[-3.29783393e-05]
 [ 3.53918826e-05]
 [ 4.29406136e-03]]


 Corrector Step
2018-07-13 08:22:30
[[-3.99425976e+03]
 [-2.08293607e+03]
 [-5.53158638e+03]
 [-4.74756681e+00]
 [-3.32777998e+00]
 [ 4.69674698e+00]
 [ 6.07759076e-02]
 [-1.55625415e-02]
 [ 9.57725915e-01]
 [-2.80758203e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79994705e-18]]
[[ 3.45441265e-01  9.20474681e-02 -8.95372555e-01 -9.45005786e-04
  -5.96058066e-04 -3.54924359e-04]
 [ 9.20474681e-02  2.46517218e-02 -2.38578777e-01 -2.51201255e-04
  -1.57995409e-04 -9.52294902e-05]
 [-8.95372555e-01 -2.38578777e-01  2.32490971e+00  2.45946101e-03
   1.55052857e-03  9.17182821e-04]
 [-9.45005786e-04 -2.51201255e-04  2.45946101e-03  2.81080618e-06
   1.75534935e-06  8.33067048e-07]
 [-5.96058066e-04 -1.57995409e-04  1.55052857e-03  1.75534935e-06
   1.15307547e-06  5.16919342e-07]
 [-3.54924359e-04 -9.52294902e-05  9.17182821e-04  8.33067048e-07
   5.16919342e-07  5.14446061e-07]]
137633744.88948566
post
cubesat_nadir
Ybar_post [[ 0.24889481]
 [-1.19944515]
 [12.71325471]]
resids [[-2.07759046e-05]
 [ 2.91257595e-05]
 [ 4.55940365e-03]]
posterior
[[-3.99273019e+03]
 [-2.08251067e+03]
 [-5.53557712e+03]
 [-4.75155038e+00]
 [-3.33020391e+00]
 [ 4.69503073e+00]]
[[-3.99340752e+03]
 [-2.08270962e+03]
 [-5.53379069e+03]
 [-4.74965412e+00]
 [-3.32904202e+00]
 [ 4.69573495e+00]]
[[ 3.10257041e-01  8.35184407e-02 -8.09805191e-01 -8.78662385e-04
  -5.41807971e-04 -3.01943278e-04]
 [ 8.35184407e-02  2.25903690e-02 -2.18003772e-01 -2.36240176e-04
  -1.45620371e-04 -8.15906339e-05]
 [-8.09805191e-01 -2.18003772e-01  2.11764595e+00  2.29865749e-03
   1.41755280e-03  7.87497744e-04]
 [-8.78662385e-04 -2.36240176e-04  2.29865749e-03  2.53963879e-06
   1.57027938e-06  8.19364000e-07]
 [-5.41807971e-04 -1.45620371e-04  1.41755280e-03  1.57027938e-06
   9.72480776e-07  5.01204712e-07]
 [-3.01943278e-04 -8.15906339e-05  7.87497744e-04  8.19364000e-07
   5.01204712e-07  3.22856918e-07]]
[[ 0.2489433 ]
 [-1.19942977]
 [12.88711405]]
[[-6.92626668e-05]
 [ 1.37404954e-05]
 [-1.69299937e-01]]


 Corrector Step
2018-07-13 08:22:30
[[-3.99340752e+03]
 [-2.08270962e+03]
 [-5.53379069e+03]
 [-4.74965412e+00]
 [-3.32904202e+00]
 [ 4.69573495e+00]]
[[ 3.10257041e-01  8.35184407e-02 -8.09805191e-01 -8.78662385e-04
  -5.41807971e-04 -3.01943278e-04]
 [ 8.35184407e-02  2.25903690e-02 -2.18003772e-01 -2.36240176e-04
  -1.45620371e-04 -8.15906339e-05]
 [-8.09805191e-01 -2.18003772e-01  2.11764595e+00  2.29865749e-03
   1.41755280e-03  7.87497744e-04]
 [-8.78662385e-04 -2.36240176e-04  2.29865749e-03  2.53963879e-06
   1.57027938e-06  8.19364000e-07]
 [-5.41807971e-04 -1.45620371e-04  1.41755280e-03  1.57027938e-06
   9.72480776e-07  5.01204712e-07]
 [-3.01943278e-04 -8.15906339e-05  7.87497744e-04  8.19364000e-07
   5.01204712e-07  3.22856918e-07]]
16680208.284149997
post
sphere_lamr_small
Ybar_post [[ 0.24890787]
 [-1.19943435]
 [12.88503131]]
resids [[-3.38313987e-05]
 [ 1.83240705e-05]
 [-1.67217196e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [137633744.88948566, 16680208.284149997]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-3.99425976e+03],
       [-2.08293607e+03],
       [-5.53158638e+03],
       [-4.74756681e+00],
       [-3.32777998e+00],
       [ 4.69674698e+00]]), 'est_covars': array([[ 3.45441265e-01,  9.20474681e-02, -8.95372555e-01,
        -9.45005786e-04, -5.96058066e-04, -3.54924359e-04],
       [ 9.20474681e-02,  2.46517218e-02, -2.38578777e-01,
        -2.51201255e-04, -1.57995409e-04, -9.52294902e-05],
       [-8.95372555e-01, -2.38578777e-01,  2.32490971e+00,
         2.45946101e-03,  1.55052857e-03,  9.17182821e-04],
       [-9.45005786e-04, -2.51201255e-04,  2.45946101e-03,
         2.81080618e-06,  1.75534935e-06,  8.33067048e-07],
       [-5.96058066e-04, -1.57995409e-04,  1.55052857e-03,
         1.75534935e-06,  1.15307547e-06,  5.16919342e-07],
       [-3.54924359e-04, -9.52294902e-05,  9.17182821e-04,
         8.33067048e-07,  5.16919342e-07,  5.14446061e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.99340752e+03],
       [-2.08270962e+03],
       [-5.53379069e+03],
       [-4.74965412e+00],
       [-3.32904202e+00],
       [ 4.69573495e+00]]), 'covar': array([[ 3.10257041e-01,  8.35184407e-02, -8.09805191e-01,
        -8.78662385e-04, -5.41807971e-04, -3.01943278e-04],
       [ 8.35184407e-02,  2.25903690e-02, -2.18003772e-01,
        -2.36240176e-04, -1.45620371e-04, -8.15906339e-05],
       [-8.09805191e-01, -2.18003772e-01,  2.11764595e+00,
         2.29865749e-03,  1.41755280e-03,  7.87497744e-04],
       [-8.78662385e-04, -2.36240176e-04,  2.29865749e-03,
         2.53963879e-06,  1.57027938e-06,  8.19364000e-07],
       [-5.41807971e-04, -1.45620371e-04,  1.41755280e-03,
         1.57027938e-06,  9.72480776e-07,  5.01204712e-07],
       [-3.01943278e-04, -8.15906339e-05,  7.87497744e-04,
         8.19364000e-07,  5.01204712e-07,  3.22856918e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.38313987e-05],
       [ 1.83240705e-05],
       [-1.67217196e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.99425976e+03],
       [-2.08293607e+03],
       [-5.53158638e+03],
       [-4.74756681e+00],
       [-3.32777998e+00],
       [ 4.69674698e+00],
       [ 6.07759076e-02],
       [-1.55625415e-02],
       [ 9.57725915e-01],
       [-2.80758203e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79994705e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.45441265e-01,  9.20474681e-02, -8.95372555e-01,
        -9.45005786e-04, -5.96058066e-04, -3.54924359e-04],
       [ 9.20474681e-02,  2.46517218e-02, -2.38578777e-01,
        -2.51201255e-04, -1.57995409e-04, -9.52294902e-05],
       [-8.95372555e-01, -2.38578777e-01,  2.32490971e+00,
         2.45946101e-03,  1.55052857e-03,  9.17182821e-04],
       [-9.45005786e-04, -2.51201255e-04,  2.45946101e-03,
         2.81080618e-06,  1.75534935e-06,  8.33067048e-07],
       [-5.96058066e-04, -1.57995409e-04,  1.55052857e-03,
         1.75534935e-06,  1.15307547e-06,  5.16919342e-07],
       [-3.54924359e-04, -9.52294902e-05,  9.17182821e-04,
         8.33067048e-07,  5.16919342e-07,  5.14446061e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.07759046e-05],
       [ 2.91257595e-05],
       [ 4.55940365e-03]])}}
Current time:  2018-07-13 08:22:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-3.99425976e+03],
       [-2.08293607e+03],
       [-5.53158638e+03],
       [-4.74756681e+00],
       [-3.32777998e+00],
       [ 4.69674698e+00],
       [ 6.07759076e-02],
       [-1.55625415e-02],
       [ 9.57725915e-01],
       [-2.80758203e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.79994705e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.45441265e-01,  9.20474681e-02, -8.95372555e-01,
        -9.45005786e-04, -5.96058066e-04, -3.54924359e-04],
       [ 9.20474681e-02,  2.46517218e-02, -2.38578777e-01,
        -2.51201255e-04, -1.57995409e-04, -9.52294902e-05],
       [-8.95372555e-01, -2.38578777e-01,  2.32490971e+00,
         2.45946101e-03,  1.55052857e-03,  9.17182821e-04],
       [-9.45005786e-04, -2.51201255e-04,  2.45946101e-03,
         2.81080618e-06,  1.75534935e-06,  8.33067048e-07],
       [-5.96058066e-04, -1.57995409e-04,  1.55052857e-03,
         1.75534935e-06,  1.15307547e-06,  5.16919342e-07],
       [-3.54924359e-04, -9.52294902e-05,  9.17182821e-04,
         8.33067048e-07,  5.16919342e-07,  5.14446061e-07]])}
[[-3.99425976e+03]
 [-2.08293607e+03]
 [-5.53158638e+03]
 [-4.74756681e+00]
 [-3.32777998e+00]
 [ 4.69674698e+00]
 [ 6.07759076e-02]
 [-1.55625415e-02]
 [ 9.57725915e-01]
 [-2.80758203e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.79994705e-18]]
2018-07-13 08:22:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:40
[[-4.04151575e+03]
 [-2.11609920e+03]
 [-5.48431581e+03]
 [-4.70356506e+00]
 [-3.30478736e+00]
 [ 4.75722380e+00]
 [ 6.57756661e-02]
 [-1.40964029e-02]
 [ 9.57395530e-01]
 [-2.80835633e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80015934e-18]]
[[ 3.26700697e-01  8.37077337e-02 -8.74091589e-01 -9.28860218e-04
  -5.83815659e-04 -3.48731211e-04]
 [ 8.37077337e-02  2.15934861e-02 -2.23904281e-01 -2.36691535e-04
  -1.47755723e-04 -9.05943803e-05]
 [-8.74091589e-01 -2.23904281e-01  2.34336519e+00  2.50049146e-03
   1.57025255e-03  9.28319488e-04]
 [-9.28860218e-04 -2.36691535e-04  2.50049146e-03  2.89010203e-06
   1.79256805e-06  8.52293207e-07]
 [-5.83815659e-04 -1.47755723e-04  1.57025255e-03  1.79256805e-06
   1.18245957e-06  5.26645691e-07]
 [-3.48731211e-04 -9.05943803e-05  9.28319488e-04  8.52293207e-07
   5.26645691e-07  5.29044007e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-3.99340752e+03],
       [-2.08270962e+03],
       [-5.53379069e+03],
       [-4.74965412e+00],
       [-3.32904202e+00],
       [ 4.69573495e+00]]), 'covar': array([[ 3.10257041e-01,  8.35184407e-02, -8.09805191e-01,
        -8.78662385e-04, -5.41807971e-04, -3.01943278e-04],
       [ 8.35184407e-02,  2.25903690e-02, -2.18003772e-01,
        -2.36240176e-04, -1.45620371e-04, -8.15906339e-05],
       [-8.09805191e-01, -2.18003772e-01,  2.11764595e+00,
         2.29865749e-03,  1.41755280e-03,  7.87497744e-04],
       [-8.78662385e-04, -2.36240176e-04,  2.29865749e-03,
         2.53963879e-06,  1.57027938e-06,  8.19364000e-07],
       [-5.41807971e-04, -1.45620371e-04,  1.41755280e-03,
         1.57027938e-06,  9.72480776e-07,  5.01204712e-07],
       [-3.01943278e-04, -8.15906339e-05,  7.87497744e-04,
         8.19364000e-07,  5.01204712e-07,  3.22856918e-07]])}
[[-3.99340752e+03]
 [-2.08270962e+03]
 [-5.53379069e+03]
 [-4.74965412e+00]
 [-3.32904202e+00]
 [ 4.69573495e+00]]
2018-07-13 08:22:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:40
[[-4.04068475e+03]
 [-2.11588543e+03]
 [-5.48653030e+03]
 [-4.70568310e+00]
 [-3.30606302e+00]
 [ 4.75620616e+00]]
[[ 2.92827804e-01  7.58561982e-02 -7.89617819e-01 -8.64106275e-04
  -5.30914978e-04 -2.95720358e-04]
 [ 7.58561982e-02  1.97624973e-02 -2.04530332e-01 -2.23314647e-04
  -1.37123248e-04 -7.70778620e-05]
 [-7.89617819e-01 -2.04530332e-01  2.13348381e+00  2.33660777e-03
   1.43585201e-03  7.96236144e-04]
 [-8.64106275e-04 -2.23314647e-04  2.33660777e-03  2.60444831e-06
   1.60463600e-06  8.36411398e-07]
 [-5.30914978e-04 -1.37123248e-04  1.43585201e-03  1.60463600e-06
   9.90357148e-07  5.09831902e-07]
 [-2.95720358e-04 -7.70778620e-05  7.96236144e-04  8.36411398e-07
   5.09831902e-07  3.27011364e-07]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.04068475e+03],
       [-2.11588543e+03],
       [-5.48653030e+03],
       [-4.70568310e+00],
       [-3.30606302e+00],
       [ 4.75620616e+00]]), 'covar': array([[ 2.92827804e-01,  7.58561982e-02, -7.89617819e-01,
        -8.64106275e-04, -5.30914978e-04, -2.95720358e-04],
       [ 7.58561982e-02,  1.97624973e-02, -2.04530332e-01,
        -2.23314647e-04, -1.37123248e-04, -7.70778620e-05],
       [-7.89617819e-01, -2.04530332e-01,  2.13348381e+00,
         2.33660777e-03,  1.43585201e-03,  7.96236144e-04],
       [-8.64106275e-04, -2.23314647e-04,  2.33660777e-03,
         2.60444831e-06,  1.60463600e-06,  8.36411398e-07],
       [-5.30914978e-04, -1.37123248e-04,  1.43585201e-03,
         1.60463600e-06,  9.90357148e-07,  5.09831902e-07],
       [-2.95720358e-04, -7.70778620e-05,  7.96236144e-04,
         8.36411398e-07,  5.09831902e-07,  3.27011364e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.38313987e-05],
       [ 1.83240705e-05],
       [-1.67217196e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.04151575e+03],
       [-2.11609920e+03],
       [-5.48431581e+03],
       [-4.70356506e+00],
       [-3.30478736e+00],
       [ 4.75722380e+00],
       [ 6.57756661e-02],
       [-1.40964029e-02],
       [ 9.57395530e-01],
       [-2.80835633e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80015934e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.26700697e-01,  8.37077337e-02, -8.74091589e-01,
        -9.28860218e-04, -5.83815659e-04, -3.48731211e-04],
       [ 8.37077337e-02,  2.15934861e-02, -2.23904281e-01,
        -2.36691535e-04, -1.47755723e-04, -9.05943803e-05],
       [-8.74091589e-01, -2.23904281e-01,  2.34336519e+00,
         2.50049146e-03,  1.57025255e-03,  9.28319488e-04],
       [-9.28860218e-04, -2.36691535e-04,  2.50049146e-03,
         2.89010203e-06,  1.79256805e-06,  8.52293207e-07],
       [-5.83815659e-04, -1.47755723e-04,  1.57025255e-03,
         1.79256805e-06,  1.18245957e-06,  5.26645691e-07],
       [-3.48731211e-04, -9.05943803e-05,  9.28319488e-04,
         8.52293207e-07,  5.26645691e-07,  5.29044007e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.07759046e-05],
       [ 2.91257595e-05],
       [ 4.55940365e-03]])}}
Yi [[ 0.22410889]
 [-1.21670696]
 [12.62070529]]
posterior
[[-4.04151575e+03]
 [-2.11609920e+03]
 [-5.48431581e+03]
 [-4.70356506e+00]
 [-3.30478736e+00]
 [ 4.75722380e+00]
 [ 6.57756661e-02]
 [-1.40964029e-02]
 [ 9.57395530e-01]
 [-2.80835633e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80015934e-18]]
[[-4.04115712e+03]
 [-2.11600110e+03]
 [-5.48527866e+03]
 [-4.70454731e+00]
 [-3.30535946e+00]
 [ 4.75679325e+00]
 [ 6.57756661e-02]
 [-1.40964029e-02]
 [ 9.57395530e-01]
 [-2.80835633e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80015934e-18]]
[[ 1.84439102e-01  4.53979906e-02 -4.98143992e-01 -5.53447362e-04
  -3.59272938e-04 -1.77478548e-04]
 [ 4.53979906e-02  1.12700373e-02 -1.22595450e-01 -1.35430928e-04
  -8.72602548e-05 -4.44831765e-05]
 [-4.98143992e-01 -1.22595450e-01  1.34917101e+00  1.50674973e-03
   9.76579166e-04  4.75816894e-04]
 [-5.53447362e-04 -1.35430928e-04  1.50674973e-03  1.89548342e-06
   1.19934182e-06  4.00516649e-07]
 [-3.59272938e-04 -8.72602548e-05  9.76579166e-04  1.19934182e-06
   8.27924502e-07  2.56370990e-07]
 [-1.77478548e-04 -4.44831765e-05  4.75816894e-04  4.00516649e-07
   2.56370990e-07  3.22885328e-07]]
[[ 0.22406743]
 [-1.2167104 ]
 [12.62433124]]
[[ 4.14596094e-05]
 [ 3.44031874e-06]
 [-3.62594584e-03]]


 Corrector Step
2018-07-13 08:22:40
[[-4.04115712e+03]
 [-2.11600110e+03]
 [-5.48527866e+03]
 [-4.70454731e+00]
 [-3.30535946e+00]
 [ 4.75679325e+00]
 [ 6.57756661e-02]
 [-1.40964029e-02]
 [ 9.57395530e-01]
 [-2.80835633e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80015934e-18]]
[[ 1.84439102e-01  4.53979906e-02 -4.98143992e-01 -5.53447362e-04
  -3.59272938e-04 -1.77478548e-04]
 [ 4.53979906e-02  1.12700373e-02 -1.22595450e-01 -1.35430928e-04
  -8.72602548e-05 -4.44831765e-05]
 [-4.98143992e-01 -1.22595450e-01  1.34917101e+00  1.50674973e-03
   9.76579166e-04  4.75816894e-04]
 [-5.53447362e-04 -1.35430928e-04  1.50674973e-03  1.89548342e-06
   1.19934182e-06  4.00516649e-07]
 [-3.59272938e-04 -8.72602548e-05  9.76579166e-04  1.19934182e-06
   8.27924502e-07  2.56370990e-07]
 [-1.77478548e-04 -4.44831765e-05  4.75816894e-04  4.00516649e-07
   2.56370990e-07  3.22885328e-07]]
316651582.3071141
post
cubesat_nadir
Ybar_post [[ 0.22409105]
 [-1.21670295]
 [12.62550123]]
resids [[ 1.78368939e-05]
 [-4.01821972e-06]
 [-4.79594038e-03]]
posterior
[[-4.04068475e+03]
 [-2.11588543e+03]
 [-5.48653030e+03]
 [-4.70568310e+00]
 [-3.30606302e+00]
 [ 4.75620616e+00]]
[[-4.04069381e+03]
 [-2.11588668e+03]
 [-5.48652169e+03]
 [-4.70567539e+00]
 [-3.30605824e+00]
 [ 4.75621486e+00]]
[[ 1.60814415e-01  4.01996182e-02 -4.36556077e-01 -4.85494701e-04
  -2.99505973e-04 -1.55561912e-04]
 [ 4.01996182e-02  1.01290742e-02 -1.09126766e-01 -1.21000315e-04
  -7.45880369e-05 -3.92212634e-05]
 [-4.36556077e-01 -1.09126766e-01  1.18856402e+00  1.32319816e-03
   8.16447468e-04  4.21391049e-04]
 [-4.85494701e-04 -1.21000315e-04  1.32319816e-03  1.51756668e-06
   9.40323997e-07  4.34440370e-07]
 [-2.99505973e-04 -7.45880369e-05  8.16447468e-04  9.40323997e-07
   5.84323535e-07  2.64145545e-07]
 [-1.55561912e-04 -3.92212634e-05  4.21391049e-04  4.34440370e-07
   2.64145545e-07  1.78205072e-07]]
[[ 0.22410256]
 [-1.21669161]
 [12.80527997]]
[[ 6.33012185e-06]
 [-1.53500455e-05]
 [-1.84574680e-01]]


 Corrector Step
2018-07-13 08:22:40
[[-4.04069381e+03]
 [-2.11588668e+03]
 [-5.48652169e+03]
 [-4.70567539e+00]
 [-3.30605824e+00]
 [ 4.75621486e+00]]
[[ 1.60814415e-01  4.01996182e-02 -4.36556077e-01 -4.85494701e-04
  -2.99505973e-04 -1.55561912e-04]
 [ 4.01996182e-02  1.01290742e-02 -1.09126766e-01 -1.21000315e-04
  -7.45880369e-05 -3.92212634e-05]
 [-4.36556077e-01 -1.09126766e-01  1.18856402e+00  1.32319816e-03
   8.16447468e-04  4.21391049e-04]
 [-4.85494701e-04 -1.21000315e-04  1.32319816e-03  1.51756668e-06
   9.40323997e-07  4.34440370e-07]
 [-2.99505973e-04 -7.45880369e-05  8.16447468e-04  9.40323997e-07
   5.84323535e-07  2.64145545e-07]
 [-1.55561912e-04 -3.92212634e-05  4.21391049e-04  4.34440370e-07
   2.64145545e-07  1.78205072e-07]]
91863538.58858062
post
sphere_lamr_small
Ybar_post [[ 0.22410376]
 [-1.21669447]
 [12.8052692 ]]
resids [[ 5.12390817e-06]
 [-1.24930021e-05]
 [-1.84563906e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [316651582.3071141, 91863538.58858062]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.04115712e+03],
       [-2.11600110e+03],
       [-5.48527866e+03],
       [-4.70454731e+00],
       [-3.30535946e+00],
       [ 4.75679325e+00]]), 'est_covars': array([[ 1.84439102e-01,  4.53979906e-02, -4.98143992e-01,
        -5.53447362e-04, -3.59272938e-04, -1.77478548e-04],
       [ 4.53979906e-02,  1.12700373e-02, -1.22595450e-01,
        -1.35430928e-04, -8.72602548e-05, -4.44831765e-05],
       [-4.98143992e-01, -1.22595450e-01,  1.34917101e+00,
         1.50674973e-03,  9.76579166e-04,  4.75816894e-04],
       [-5.53447362e-04, -1.35430928e-04,  1.50674973e-03,
         1.89548342e-06,  1.19934182e-06,  4.00516649e-07],
       [-3.59272938e-04, -8.72602548e-05,  9.76579166e-04,
         1.19934182e-06,  8.27924502e-07,  2.56370990e-07],
       [-1.77478548e-04, -4.44831765e-05,  4.75816894e-04,
         4.00516649e-07,  2.56370990e-07,  3.22885328e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.04069381e+03],
       [-2.11588668e+03],
       [-5.48652169e+03],
       [-4.70567539e+00],
       [-3.30605824e+00],
       [ 4.75621486e+00]]), 'covar': array([[ 1.60814415e-01,  4.01996182e-02, -4.36556077e-01,
        -4.85494701e-04, -2.99505973e-04, -1.55561912e-04],
       [ 4.01996182e-02,  1.01290742e-02, -1.09126766e-01,
        -1.21000315e-04, -7.45880369e-05, -3.92212634e-05],
       [-4.36556077e-01, -1.09126766e-01,  1.18856402e+00,
         1.32319816e-03,  8.16447468e-04,  4.21391049e-04],
       [-4.85494701e-04, -1.21000315e-04,  1.32319816e-03,
         1.51756668e-06,  9.40323997e-07,  4.34440370e-07],
       [-2.99505973e-04, -7.45880369e-05,  8.16447468e-04,
         9.40323997e-07,  5.84323535e-07,  2.64145545e-07],
       [-1.55561912e-04, -3.92212634e-05,  4.21391049e-04,
         4.34440370e-07,  2.64145545e-07,  1.78205072e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 5.12390817e-06],
       [-1.24930021e-05],
       [-1.84563906e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.04115712e+03],
       [-2.11600110e+03],
       [-5.48527866e+03],
       [-4.70454731e+00],
       [-3.30535946e+00],
       [ 4.75679325e+00],
       [ 6.57756661e-02],
       [-1.40964029e-02],
       [ 9.57395530e-01],
       [-2.80835633e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80015934e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.84439102e-01,  4.53979906e-02, -4.98143992e-01,
        -5.53447362e-04, -3.59272938e-04, -1.77478548e-04],
       [ 4.53979906e-02,  1.12700373e-02, -1.22595450e-01,
        -1.35430928e-04, -8.72602548e-05, -4.44831765e-05],
       [-4.98143992e-01, -1.22595450e-01,  1.34917101e+00,
         1.50674973e-03,  9.76579166e-04,  4.75816894e-04],
       [-5.53447362e-04, -1.35430928e-04,  1.50674973e-03,
         1.89548342e-06,  1.19934182e-06,  4.00516649e-07],
       [-3.59272938e-04, -8.72602548e-05,  9.76579166e-04,
         1.19934182e-06,  8.27924502e-07,  2.56370990e-07],
       [-1.77478548e-04, -4.44831765e-05,  4.75816894e-04,
         4.00516649e-07,  2.56370990e-07,  3.22885328e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.78368939e-05],
       [-4.01821972e-06],
       [-4.79594038e-03]])}}
Current time:  2018-07-13 08:22:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.04115712e+03],
       [-2.11600110e+03],
       [-5.48527866e+03],
       [-4.70454731e+00],
       [-3.30535946e+00],
       [ 4.75679325e+00],
       [ 6.57756661e-02],
       [-1.40964029e-02],
       [ 9.57395530e-01],
       [-2.80835633e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80015934e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.84439102e-01,  4.53979906e-02, -4.98143992e-01,
        -5.53447362e-04, -3.59272938e-04, -1.77478548e-04],
       [ 4.53979906e-02,  1.12700373e-02, -1.22595450e-01,
        -1.35430928e-04, -8.72602548e-05, -4.44831765e-05],
       [-4.98143992e-01, -1.22595450e-01,  1.34917101e+00,
         1.50674973e-03,  9.76579166e-04,  4.75816894e-04],
       [-5.53447362e-04, -1.35430928e-04,  1.50674973e-03,
         1.89548342e-06,  1.19934182e-06,  4.00516649e-07],
       [-3.59272938e-04, -8.72602548e-05,  9.76579166e-04,
         1.19934182e-06,  8.27924502e-07,  2.56370990e-07],
       [-1.77478548e-04, -4.44831765e-05,  4.75816894e-04,
         4.00516649e-07,  2.56370990e-07,  3.22885328e-07]])}
[[-4.04115712e+03]
 [-2.11600110e+03]
 [-5.48527866e+03]
 [-4.70454731e+00]
 [-3.30535946e+00]
 [ 4.75679325e+00]
 [ 6.57756661e-02]
 [-1.40964029e-02]
 [ 9.57395530e-01]
 [-2.80835633e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80015934e-18]]
2018-07-13 08:22:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:50
[[-4.08798054e+03]
 [-2.14893808e+03]
 [-5.43741010e+03]
 [-4.66003857e+00]
 [-3.28200803e+00]
 [ 4.81675277e+00]
 [ 7.07736314e-02]
 [-1.26298799e-02]
 [ 9.57039044e-01]
 [-2.80905407e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80037163e-18]]
[[ 1.73492421e-01  4.05480003e-02 -4.84722689e-01 -5.41093579e-04
  -3.50206879e-04 -1.74641948e-04]
 [ 4.05480003e-02  9.60093471e-03 -1.13208105e-01 -1.24967887e-04
  -7.96011655e-05 -4.21840805e-05]
 [-4.84722689e-01 -1.13208105e-01  1.35875453e+00  1.52971605e-03
   9.87558209e-04  4.82496088e-04]
 [-5.41093579e-04 -1.24967887e-04  1.52971605e-03  1.94790742e-06
   1.22247774e-06  4.11067449e-07]
 [-3.50206879e-04 -7.96011655e-05  9.87558209e-04  1.22247774e-06
   8.50078446e-07  2.61837795e-07]
 [-1.74641948e-04 -4.21840805e-05  4.82496088e-04  4.11067449e-07
   2.61837795e-07  3.35197326e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.04069381e+03],
       [-2.11588668e+03],
       [-5.48652169e+03],
       [-4.70567539e+00],
       [-3.30605824e+00],
       [ 4.75621486e+00]]), 'covar': array([[ 1.60814415e-01,  4.01996182e-02, -4.36556077e-01,
        -4.85494701e-04, -2.99505973e-04, -1.55561912e-04],
       [ 4.01996182e-02,  1.01290742e-02, -1.09126766e-01,
        -1.21000315e-04, -7.45880369e-05, -3.92212634e-05],
       [-4.36556077e-01, -1.09126766e-01,  1.18856402e+00,
         1.32319816e-03,  8.16447468e-04,  4.21391049e-04],
       [-4.85494701e-04, -1.21000315e-04,  1.32319816e-03,
         1.51756668e-06,  9.40323997e-07,  4.34440370e-07],
       [-2.99505973e-04, -7.45880369e-05,  8.16447468e-04,
         9.40323997e-07,  5.84323535e-07,  2.64145545e-07],
       [-1.55561912e-04, -3.92212634e-05,  4.21391049e-04,
         4.34440370e-07,  2.64145545e-07,  1.78205072e-07]])}
[[-4.04069381e+03]
 [-2.11588668e+03]
 [-5.48652169e+03]
 [-4.70567539e+00]
 [-3.30605824e+00]
 [ 4.75621486e+00]]
2018-07-13 08:22:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:22:50
[[-4.08752857e+03]
 [-2.14883085e+03]
 [-5.43865948e+03]
 [-4.66118422e+00]
 [-3.28271463e+00]
 [ 4.81617110e+00]]
[[ 1.51197135e-01  3.60683798e-02 -4.24758268e-01 -4.76142476e-04
  -2.92678654e-04 -1.52251598e-04]
 [ 3.60683798e-02  8.68946618e-03 -1.01292261e-01 -1.12966304e-04
  -6.93474206e-05 -3.68195176e-05]
 [-4.24758268e-01 -1.01292261e-01  1.19704012e+00  1.34423462e-03
   8.26524307e-04  4.26197968e-04]
 [-4.76142476e-04 -1.12966304e-04  1.34423462e-03  1.55489708e-06
   9.60076298e-07  4.43735352e-07]
 [-2.92678654e-04 -6.93474206e-05  8.26524307e-04  9.60076298e-07
   5.94630184e-07  2.68865220e-07]
 [-1.52251598e-04 -3.68195176e-05  4.26197968e-04  4.43735352e-07
   2.68865220e-07  1.80411154e-07]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.08752857e+03],
       [-2.14883085e+03],
       [-5.43865948e+03],
       [-4.66118422e+00],
       [-3.28271463e+00],
       [ 4.81617110e+00]]), 'covar': array([[ 1.51197135e-01,  3.60683798e-02, -4.24758268e-01,
        -4.76142476e-04, -2.92678654e-04, -1.52251598e-04],
       [ 3.60683798e-02,  8.68946618e-03, -1.01292261e-01,
        -1.12966304e-04, -6.93474206e-05, -3.68195176e-05],
       [-4.24758268e-01, -1.01292261e-01,  1.19704012e+00,
         1.34423462e-03,  8.26524307e-04,  4.26197968e-04],
       [-4.76142476e-04, -1.12966304e-04,  1.34423462e-03,
         1.55489708e-06,  9.60076298e-07,  4.43735352e-07],
       [-2.92678654e-04, -6.93474206e-05,  8.26524307e-04,
         9.60076298e-07,  5.94630184e-07,  2.68865220e-07],
       [-1.52251598e-04, -3.68195176e-05,  4.26197968e-04,
         4.43735352e-07,  2.68865220e-07,  1.80411154e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 5.12390817e-06],
       [-1.24930021e-05],
       [-1.84563906e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.08798054e+03],
       [-2.14893808e+03],
       [-5.43741010e+03],
       [-4.66003857e+00],
       [-3.28200803e+00],
       [ 4.81675277e+00],
       [ 7.07736314e-02],
       [-1.26298799e-02],
       [ 9.57039044e-01],
       [-2.80905407e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80037163e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.73492421e-01,  4.05480003e-02, -4.84722689e-01,
        -5.41093579e-04, -3.50206879e-04, -1.74641948e-04],
       [ 4.05480003e-02,  9.60093471e-03, -1.13208105e-01,
        -1.24967887e-04, -7.96011655e-05, -4.21840805e-05],
       [-4.84722689e-01, -1.13208105e-01,  1.35875453e+00,
         1.52971605e-03,  9.87558209e-04,  4.82496088e-04],
       [-5.41093579e-04, -1.24967887e-04,  1.52971605e-03,
         1.94790742e-06,  1.22247774e-06,  4.11067449e-07],
       [-3.50206879e-04, -7.96011655e-05,  9.87558209e-04,
         1.22247774e-06,  8.50078446e-07,  2.61837795e-07],
       [-1.74641948e-04, -4.21840805e-05,  4.82496088e-04,
         4.11067449e-07,  2.61837795e-07,  3.35197326e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.78368939e-05],
       [-4.01821972e-06],
       [-4.79594038e-03]])}}
Yi [[ 0.19521263]
 [-1.23450926]
 [12.5871053 ]]
posterior
[[-4.08798054e+03]
 [-2.14893808e+03]
 [-5.43741010e+03]
 [-4.66003857e+00]
 [-3.28200803e+00]
 [ 4.81675277e+00]
 [ 7.07736314e-02]
 [-1.26298799e-02]
 [ 9.57039044e-01]
 [-2.80905407e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80037163e-18]]
[[-4.08762927e+03]
 [-2.14885027e+03]
 [-5.43837230e+03]
 [-4.66100569e+00]
 [-3.28258675e+00]
 [ 4.81632024e+00]
 [ 7.07736314e-02]
 [-1.26298799e-02]
 [ 9.57039044e-01]
 [-2.80905407e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80037163e-18]]
[[ 9.95262369e-02  2.19745881e-02 -2.81257742e-01 -3.34960227e-04
  -2.28279156e-04 -8.35865624e-05]
 [ 2.19745881e-02  4.93286880e-03 -6.20657179e-02 -7.30508023e-05
  -4.89666555e-05 -1.93289200e-05]
 [-2.81257742e-01 -6.20657179e-02  7.98439281e-01  9.60770432e-04
   6.51940964e-04  2.32141103e-04]
 [-3.34960227e-04 -7.30508023e-05  9.60770432e-04  1.36758000e-06
   8.82005615e-07  1.57673245e-07]
 [-2.28279156e-04 -4.89666555e-05  6.51940964e-04  8.82005615e-07
   6.49007407e-07  1.11784432e-07]
 [-8.35865624e-05 -1.93289200e-05  2.32141103e-04  1.57673245e-07
   1.11784432e-07  2.23080213e-07]]
[[ 0.1951681 ]
 [-1.23453374]
 [12.5340538 ]]
[[4.45295924e-05]
 [2.44860843e-05]
 [5.30514967e-02]]


 Corrector Step
2018-07-13 08:22:50
[[-4.08762927e+03]
 [-2.14885027e+03]
 [-5.43837230e+03]
 [-4.66100569e+00]
 [-3.28258675e+00]
 [ 4.81632024e+00]
 [ 7.07736314e-02]
 [-1.26298799e-02]
 [ 9.57039044e-01]
 [-2.80905407e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80037163e-18]]
[[ 9.95262369e-02  2.19745881e-02 -2.81257742e-01 -3.34960227e-04
  -2.28279156e-04 -8.35865624e-05]
 [ 2.19745881e-02  4.93286880e-03 -6.20657179e-02 -7.30508023e-05
  -4.89666555e-05 -1.93289200e-05]
 [-2.81257742e-01 -6.20657179e-02  7.98439281e-01  9.60770432e-04
   6.51940964e-04  2.32141103e-04]
 [-3.34960227e-04 -7.30508023e-05  9.60770432e-04  1.36758000e-06
   8.82005615e-07  1.57673245e-07]
 [-2.28279156e-04 -4.89666555e-05  6.51940964e-04  8.82005615e-07
   6.49007407e-07  1.11784432e-07]
 [-8.35865624e-05 -1.93289200e-05  2.32141103e-04  1.57673245e-07
   1.11784432e-07  2.23080213e-07]]
224942722.16131452
post
cubesat_nadir
Ybar_post [[ 0.19519705]
 [-1.23452113]
 [12.53525793]]
resids [[1.55787527e-05]
 [1.18758788e-05]
 [5.18473646e-02]]
posterior
[[-4.08752857e+03]
 [-2.14883085e+03]
 [-5.43865948e+03]
 [-4.66118422e+00]
 [-3.28271463e+00]
 [ 4.81617110e+00]]
[[-4.08740184e+03]
 [-2.14879912e+03]
 [-5.43900775e+03]
 [-4.66156039e+00]
 [-3.28294386e+00]
 [ 4.81603223e+00]]
[[ 8.06085008e-02  1.83331257e-02 -2.28381283e-01 -2.62995266e-04
  -1.62706217e-04 -7.53708812e-05]
 [ 1.83331257e-02  4.23213664e-03 -5.19260825e-02 -5.93770806e-05
  -3.66697206e-05 -1.75049329e-05]
 [-2.28381283e-01 -5.19260825e-02  6.50197209e-01  7.50549875e-04
   4.64504873e-04  2.12347195e-04]
 [-2.62995266e-04 -5.93770806e-05  7.50549875e-04  9.10319137e-07
   5.67021971e-07  2.11630701e-07]
 [-1.62706217e-04 -3.66697206e-05  4.64504873e-04  5.67021971e-07
   3.54951294e-07  1.27333206e-07]
 [-7.53708812e-05 -1.75049329e-05  2.12347195e-04  2.11630701e-07
   1.27333206e-07  9.66755036e-08]]
[[ 0.19519628]
 [-1.23451999]
 [12.72328854]]
[[ 1.63514966e-05]
 [ 1.07323125e-05]
 [-1.36183237e-01]]


 Corrector Step
2018-07-13 08:22:50
[[-4.08740184e+03]
 [-2.14879912e+03]
 [-5.43900775e+03]
 [-4.66156039e+00]
 [-3.28294386e+00]
 [ 4.81603223e+00]]
[[ 8.06085008e-02  1.83331257e-02 -2.28381283e-01 -2.62995266e-04
  -1.62706217e-04 -7.53708812e-05]
 [ 1.83331257e-02  4.23213664e-03 -5.19260825e-02 -5.93770806e-05
  -3.66697206e-05 -1.75049329e-05]
 [-2.28381283e-01 -5.19260825e-02  6.50197209e-01  7.50549875e-04
   4.64504873e-04  2.12347195e-04]
 [-2.62995266e-04 -5.93770806e-05  7.50549875e-04  9.10319137e-07
   5.67021971e-07  2.11630701e-07]
 [-1.62706217e-04 -3.66697206e-05  4.64504873e-04  5.67021971e-07
   3.54951294e-07  1.27333206e-07]
 [-7.53708812e-05 -1.75049329e-05  2.12347195e-04  2.11630701e-07
   1.27333206e-07  9.66755036e-08]]
212075674.42658162
post
sphere_lamr_small
Ybar_post [[ 0.19520679]
 [-1.23451568]
 [12.72371993]]
resids [[ 5.83948102e-06]
 [ 6.42096014e-06]
 [-1.36614633e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [224942722.16131452, 212075674.42658162]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.08762927e+03],
       [-2.14885027e+03],
       [-5.43837230e+03],
       [-4.66100569e+00],
       [-3.28258675e+00],
       [ 4.81632024e+00]]), 'est_covars': array([[ 9.95262369e-02,  2.19745881e-02, -2.81257742e-01,
        -3.34960227e-04, -2.28279156e-04, -8.35865624e-05],
       [ 2.19745881e-02,  4.93286880e-03, -6.20657179e-02,
        -7.30508023e-05, -4.89666555e-05, -1.93289200e-05],
       [-2.81257742e-01, -6.20657179e-02,  7.98439281e-01,
         9.60770432e-04,  6.51940964e-04,  2.32141103e-04],
       [-3.34960227e-04, -7.30508023e-05,  9.60770432e-04,
         1.36758000e-06,  8.82005615e-07,  1.57673245e-07],
       [-2.28279156e-04, -4.89666555e-05,  6.51940964e-04,
         8.82005615e-07,  6.49007407e-07,  1.11784432e-07],
       [-8.35865624e-05, -1.93289200e-05,  2.32141103e-04,
         1.57673245e-07,  1.11784432e-07,  2.23080213e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.08740184e+03],
       [-2.14879912e+03],
       [-5.43900775e+03],
       [-4.66156039e+00],
       [-3.28294386e+00],
       [ 4.81603223e+00]]), 'covar': array([[ 8.06085008e-02,  1.83331257e-02, -2.28381283e-01,
        -2.62995266e-04, -1.62706217e-04, -7.53708812e-05],
       [ 1.83331257e-02,  4.23213664e-03, -5.19260825e-02,
        -5.93770806e-05, -3.66697206e-05, -1.75049329e-05],
       [-2.28381283e-01, -5.19260825e-02,  6.50197209e-01,
         7.50549875e-04,  4.64504873e-04,  2.12347195e-04],
       [-2.62995266e-04, -5.93770806e-05,  7.50549875e-04,
         9.10319137e-07,  5.67021971e-07,  2.11630701e-07],
       [-1.62706217e-04, -3.66697206e-05,  4.64504873e-04,
         5.67021971e-07,  3.54951294e-07,  1.27333206e-07],
       [-7.53708812e-05, -1.75049329e-05,  2.12347195e-04,
         2.11630701e-07,  1.27333206e-07,  9.66755036e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 5.83948102e-06],
       [ 6.42096014e-06],
       [-1.36614633e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.08762927e+03],
       [-2.14885027e+03],
       [-5.43837230e+03],
       [-4.66100569e+00],
       [-3.28258675e+00],
       [ 4.81632024e+00],
       [ 7.07736314e-02],
       [-1.26298799e-02],
       [ 9.57039044e-01],
       [-2.80905407e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80037163e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.95262369e-02,  2.19745881e-02, -2.81257742e-01,
        -3.34960227e-04, -2.28279156e-04, -8.35865624e-05],
       [ 2.19745881e-02,  4.93286880e-03, -6.20657179e-02,
        -7.30508023e-05, -4.89666555e-05, -1.93289200e-05],
       [-2.81257742e-01, -6.20657179e-02,  7.98439281e-01,
         9.60770432e-04,  6.51940964e-04,  2.32141103e-04],
       [-3.34960227e-04, -7.30508023e-05,  9.60770432e-04,
         1.36758000e-06,  8.82005615e-07,  1.57673245e-07],
       [-2.28279156e-04, -4.89666555e-05,  6.51940964e-04,
         8.82005615e-07,  6.49007407e-07,  1.11784432e-07],
       [-8.35865624e-05, -1.93289200e-05,  2.32141103e-04,
         1.57673245e-07,  1.11784432e-07,  2.23080213e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.55787527e-05],
       [1.18758788e-05],
       [5.18473646e-02]])}}
Current time:  2018-07-13 08:23:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.08762927e+03],
       [-2.14885027e+03],
       [-5.43837230e+03],
       [-4.66100569e+00],
       [-3.28258675e+00],
       [ 4.81632024e+00],
       [ 7.07736314e-02],
       [-1.26298799e-02],
       [ 9.57039044e-01],
       [-2.80905407e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80037163e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.95262369e-02,  2.19745881e-02, -2.81257742e-01,
        -3.34960227e-04, -2.28279156e-04, -8.35865624e-05],
       [ 2.19745881e-02,  4.93286880e-03, -6.20657179e-02,
        -7.30508023e-05, -4.89666555e-05, -1.93289200e-05],
       [-2.81257742e-01, -6.20657179e-02,  7.98439281e-01,
         9.60770432e-04,  6.51940964e-04,  2.32141103e-04],
       [-3.34960227e-04, -7.30508023e-05,  9.60770432e-04,
         1.36758000e-06,  8.82005615e-07,  1.57673245e-07],
       [-2.28279156e-04, -4.89666555e-05,  6.51940964e-04,
         8.82005615e-07,  6.49007407e-07,  1.11784432e-07],
       [-8.35865624e-05, -1.93289200e-05,  2.32141103e-04,
         1.57673245e-07,  1.11784432e-07,  2.23080213e-07]])}
[[-4.08762927e+03]
 [-2.14885027e+03]
 [-5.43837230e+03]
 [-4.66100569e+00]
 [-3.28258675e+00]
 [ 4.81632024e+00]
 [ 7.07736314e-02]
 [-1.26298799e-02]
 [ 9.57039044e-01]
 [-2.80905407e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80037163e-18]]
2018-07-13 08:22:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:00
[[-4.13401463e+03]
 [-2.18155787e+03]
 [-5.38991147e+03]
 [-4.61599494e+00]
 [-3.25887898e+00]
 [ 4.87575572e+00]
 [ 7.57696673e-02]
 [-1.11630127e-02]
 [ 9.56656467e-01]
 [-2.80967522e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80058392e-18]]
[[ 9.29260648e-02  1.90372378e-02 -2.72417494e-01 -3.24968059e-04
  -2.21090601e-04 -8.26658392e-05]
 [ 1.90372378e-02  4.01525886e-03 -5.57043623e-02 -6.49775187e-05
  -4.27500655e-05 -1.83400540e-05]
 [-2.72417494e-01 -5.57043623e-02  8.03124852e-01  9.73567713e-04
   6.58017468e-04  2.36430745e-04]
 [-3.24968059e-04 -6.49775187e-05  9.73567713e-04  1.40463754e-06
   8.97150831e-07  1.63436084e-07]
 [-2.21090601e-04 -4.27500655e-05  6.58017468e-04  8.97150831e-07
   6.67077430e-07  1.14911734e-07]
 [-8.26658392e-05 -1.83400540e-05  2.36430745e-04  1.63436084e-07
   1.14911734e-07  2.34166245e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.08740184e+03],
       [-2.14879912e+03],
       [-5.43900775e+03],
       [-4.66156039e+00],
       [-3.28294386e+00],
       [ 4.81603223e+00]]), 'covar': array([[ 8.06085008e-02,  1.83331257e-02, -2.28381283e-01,
        -2.62995266e-04, -1.62706217e-04, -7.53708812e-05],
       [ 1.83331257e-02,  4.23213664e-03, -5.19260825e-02,
        -5.93770806e-05, -3.66697206e-05, -1.75049329e-05],
       [-2.28381283e-01, -5.19260825e-02,  6.50197209e-01,
         7.50549875e-04,  4.64504873e-04,  2.12347195e-04],
       [-2.62995266e-04, -5.93770806e-05,  7.50549875e-04,
         9.10319137e-07,  5.67021971e-07,  2.11630701e-07],
       [-1.62706217e-04, -3.66697206e-05,  4.64504873e-04,
         5.67021971e-07,  3.54951294e-07,  1.27333206e-07],
       [-7.53708812e-05, -1.75049329e-05,  2.12347195e-04,
         2.11630701e-07,  1.27333206e-07,  9.66755036e-08]])}
[[-4.08740184e+03]
 [-2.14879912e+03]
 [-5.43900775e+03]
 [-4.66156039e+00]
 [-3.28294386e+00]
 [ 4.81603223e+00]]
2018-07-13 08:22:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:00
[[-4.13379280e+03]
 [-2.18151031e+03]
 [-5.39054976e+03]
 [-4.61655815e+00]
 [-3.25924002e+00]
 [ 4.87546590e+00]]
[[ 7.54087747e-02  1.61588567e-02 -2.21565477e-01 -2.56926299e-04
  -1.58372949e-04 -7.37855225e-05]
 [ 1.61588567e-02  3.53131011e-03 -4.74236899e-02 -5.43438958e-05
  -3.33988448e-05 -1.63410876e-05]
 [-2.21565477e-01 -4.74236899e-02  6.54470263e-01  7.61796846e-04
   4.69833766e-04  2.14948044e-04]
 [-2.56926299e-04 -5.43438958e-05  7.61796846e-04  9.31538762e-07
   5.78232095e-07  2.16513647e-07]
 [-1.58372949e-04 -3.33988448e-05  4.69833766e-04  5.78232095e-07
   3.60840213e-07  1.29835586e-07]
 [-7.37855225e-05 -1.63410876e-05  2.14948044e-04  2.16513647e-07
   1.29835586e-07  9.78067964e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 22, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.13379280e+03],
       [-2.18151031e+03],
       [-5.39054976e+03],
       [-4.61655815e+00],
       [-3.25924002e+00],
       [ 4.87546590e+00]]), 'covar': array([[ 7.54087747e-02,  1.61588567e-02, -2.21565477e-01,
        -2.56926299e-04, -1.58372949e-04, -7.37855225e-05],
       [ 1.61588567e-02,  3.53131011e-03, -4.74236899e-02,
        -5.43438958e-05, -3.33988448e-05, -1.63410876e-05],
       [-2.21565477e-01, -4.74236899e-02,  6.54470263e-01,
         7.61796846e-04,  4.69833766e-04,  2.14948044e-04],
       [-2.56926299e-04, -5.43438958e-05,  7.61796846e-04,
         9.31538762e-07,  5.78232095e-07,  2.16513647e-07],
       [-1.58372949e-04, -3.33988448e-05,  4.69833766e-04,
         5.78232095e-07,  3.60840213e-07,  1.29835586e-07],
       [-7.37855225e-05, -1.63410876e-05,  2.14948044e-04,
         2.16513647e-07,  1.29835586e-07,  9.78067964e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 5.83948102e-06],
       [ 6.42096014e-06],
       [-1.36614633e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 22, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.13401463e+03],
       [-2.18155787e+03],
       [-5.38991147e+03],
       [-4.61599494e+00],
       [-3.25887898e+00],
       [ 4.87575572e+00],
       [ 7.57696673e-02],
       [-1.11630127e-02],
       [ 9.56656467e-01],
       [-2.80967522e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80058392e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.29260648e-02,  1.90372378e-02, -2.72417494e-01,
        -3.24968059e-04, -2.21090601e-04, -8.26658392e-05],
       [ 1.90372378e-02,  4.01525886e-03, -5.57043623e-02,
        -6.49775187e-05, -4.27500655e-05, -1.83400540e-05],
       [-2.72417494e-01, -5.57043623e-02,  8.03124852e-01,
         9.73567713e-04,  6.58017468e-04,  2.36430745e-04],
       [-3.24968059e-04, -6.49775187e-05,  9.73567713e-04,
         1.40463754e-06,  8.97150831e-07,  1.63436084e-07],
       [-2.21090601e-04, -4.27500655e-05,  6.58017468e-04,
         8.97150831e-07,  6.67077430e-07,  1.14911734e-07],
       [-8.26658392e-05, -1.83400540e-05,  2.36430745e-04,
         1.63436084e-07,  1.14911734e-07,  2.34166245e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.55787527e-05],
       [1.18758788e-05],
       [5.18473646e-02]])}}
Yi [[ 0.16117173]
 [-1.25289667]
 [12.33370786]]
posterior
[[-4.13401463e+03]
 [-2.18155787e+03]
 [-5.38991147e+03]
 [-4.61599494e+00]
 [-3.25887898e+00]
 [ 4.87575572e+00]
 [ 7.57696673e-02]
 [-1.11630127e-02]
 [ 9.56656467e-01]
 [-2.80967522e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80058392e-18]]
[[-4.13395553e+03]
 [-2.18154430e+03]
 [-5.39007773e+03]
 [-4.61615641e+00]
 [-3.25897754e+00]
 [ 4.87567935e+00]
 [ 7.57696673e-02]
 [-1.11630127e-02]
 [ 9.56656467e-01]
 [-2.80967522e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80058392e-18]]
[[ 5.75558915e-02  1.08562127e-02 -1.71087859e-01 -2.20893038e-04
  -1.60170840e-04 -3.82146644e-05]
 [ 1.08562127e-02  2.11988286e-03 -3.22235108e-02 -4.07444490e-05
  -2.86490510e-05 -8.06912656e-06]
 [-1.71087859e-01 -3.22235108e-02  5.12222547e-01  6.73158394e-04
   4.83342870e-04  1.09234573e-04]
 [-2.20893038e-04 -4.07444490e-05  6.73158394e-04  1.09008608e-06
   7.17342224e-07  3.31922709e-08]
 [-1.60170840e-04 -2.86490510e-05  4.83342870e-04  7.17342224e-07
   5.62110378e-07  3.83907824e-08]
 [-3.82146644e-05 -8.06912656e-06  1.09234573e-04  3.31922709e-08
   3.83907824e-08  1.78264603e-07]]
[[ 0.16116115]
 [-1.25290403]
 [12.44119978]]
[[ 1.05837331e-05]
 [ 7.35893871e-06]
 [-1.07491915e-01]]


 Corrector Step
2018-07-13 08:23:00
[[-4.13395553e+03]
 [-2.18154430e+03]
 [-5.39007773e+03]
 [-4.61615641e+00]
 [-3.25897754e+00]
 [ 4.87567935e+00]
 [ 7.57696673e-02]
 [-1.11630127e-02]
 [ 9.56656467e-01]
 [-2.80967522e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80058392e-18]]
[[ 5.75558915e-02  1.08562127e-02 -1.71087859e-01 -2.20893038e-04
  -1.60170840e-04 -3.82146644e-05]
 [ 1.08562127e-02  2.11988286e-03 -3.22235108e-02 -4.07444490e-05
  -2.86490510e-05 -8.06912656e-06]
 [-1.71087859e-01 -3.22235108e-02  5.12222547e-01  6.73158394e-04
   4.83342870e-04  1.09234573e-04]
 [-2.20893038e-04 -4.07444490e-05  6.73158394e-04  1.09008608e-06
   7.17342224e-07  3.31922709e-08]
 [-1.60170840e-04 -2.86490510e-05  4.83342870e-04  7.17342224e-07
   5.62110378e-07  3.83907824e-08]
 [-3.82146644e-05 -8.06912656e-06  1.09234573e-04  3.31922709e-08
   3.83907824e-08  1.78264603e-07]]
321352993.9297714
post
cubesat_nadir
Ybar_post [[ 0.16116802]
 [-1.252901  ]
 [12.44141528]]
resids [[ 3.70671104e-06]
 [ 4.33573768e-06]
 [-1.07707414e-01]]
posterior
[[-4.13379280e+03]
 [-2.18151031e+03]
 [-5.39054976e+03]
 [-4.61655815e+00]
 [-3.25924002e+00]
 [ 4.87546590e+00]]
[[-4.13384221e+03]
 [-2.18152163e+03]
 [-5.39040483e+03]
 [-4.61639671e+00]
 [-3.25914154e+00]
 [ 4.87551972e+00]]
[[ 4.11875454e-02  8.25704074e-03 -1.22356015e-01 -1.47864256e-04
  -9.20139214e-05 -3.55425234e-05]
 [ 8.25704074e-03  1.70606184e-03 -2.44987058e-02 -2.91354653e-05
  -1.80606211e-05 -7.51270326e-06]
 [-1.22356015e-01 -2.44987058e-02  3.66427619e-01  4.44979163e-04
   2.77062746e-04  1.04131589e-04]
 [-1.47864256e-04 -2.91354653e-05  4.44979163e-04  5.83004436e-07
   3.66161678e-07  9.47127887e-08]
 [-9.20139214e-05 -1.80606211e-05  2.77062746e-04  3.66161678e-07
   2.31803081e-07  5.57259525e-08]
 [-3.55425234e-05 -7.51270326e-06  1.04131589e-04  9.47127887e-08
   5.57259525e-08  5.50628232e-08]]
[[ 0.16118103]
 [-1.25289539]
 [12.63944912]]
[[-9.30372915e-06]
 [-1.28373479e-06]
 [-3.05741255e-01]]


 Corrector Step
2018-07-13 08:23:00
[[-4.13384221e+03]
 [-2.18152163e+03]
 [-5.39040483e+03]
 [-4.61639671e+00]
 [-3.25914154e+00]
 [ 4.87551972e+00]]
[[ 4.11875454e-02  8.25704074e-03 -1.22356015e-01 -1.47864256e-04
  -9.20139214e-05 -3.55425234e-05]
 [ 8.25704074e-03  1.70606184e-03 -2.44987058e-02 -2.91354653e-05
  -1.80606211e-05 -7.51270326e-06]
 [-1.22356015e-01 -2.44987058e-02  3.66427619e-01  4.44979163e-04
   2.77062746e-04  1.04131589e-04]
 [-1.47864256e-04 -2.91354653e-05  4.44979163e-04  5.83004436e-07
   3.66161678e-07  9.47127887e-08]
 [-9.20139214e-05 -1.80606211e-05  2.77062746e-04  3.66161678e-07
   2.31803081e-07  5.57259525e-08]
 [-3.55425234e-05 -7.51270326e-06  1.04131589e-04  9.47127887e-08
   5.57259525e-08  5.50628232e-08]]
5769699.187770858
post
sphere_lamr_small
Ybar_post [[ 0.16117538]
 [-1.25289692]
 [12.63926461]]
resids [[-3.64497862e-06]
 [ 2.47868375e-07]
 [-3.05556741e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [321352993.9297714, 5769699.187770858]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.13395553e+03],
       [-2.18154430e+03],
       [-5.39007773e+03],
       [-4.61615641e+00],
       [-3.25897754e+00],
       [ 4.87567935e+00]]), 'est_covars': array([[ 5.75558915e-02,  1.08562127e-02, -1.71087859e-01,
        -2.20893038e-04, -1.60170840e-04, -3.82146644e-05],
       [ 1.08562127e-02,  2.11988286e-03, -3.22235108e-02,
        -4.07444490e-05, -2.86490510e-05, -8.06912656e-06],
       [-1.71087859e-01, -3.22235108e-02,  5.12222547e-01,
         6.73158394e-04,  4.83342870e-04,  1.09234573e-04],
       [-2.20893038e-04, -4.07444490e-05,  6.73158394e-04,
         1.09008608e-06,  7.17342224e-07,  3.31922709e-08],
       [-1.60170840e-04, -2.86490510e-05,  4.83342870e-04,
         7.17342224e-07,  5.62110378e-07,  3.83907824e-08],
       [-3.82146644e-05, -8.06912656e-06,  1.09234573e-04,
         3.31922709e-08,  3.83907824e-08,  1.78264603e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.13384221e+03],
       [-2.18152163e+03],
       [-5.39040483e+03],
       [-4.61639671e+00],
       [-3.25914154e+00],
       [ 4.87551972e+00]]), 'covar': array([[ 4.11875454e-02,  8.25704074e-03, -1.22356015e-01,
        -1.47864256e-04, -9.20139214e-05, -3.55425234e-05],
       [ 8.25704074e-03,  1.70606184e-03, -2.44987058e-02,
        -2.91354653e-05, -1.80606211e-05, -7.51270326e-06],
       [-1.22356015e-01, -2.44987058e-02,  3.66427619e-01,
         4.44979163e-04,  2.77062746e-04,  1.04131589e-04],
       [-1.47864256e-04, -2.91354653e-05,  4.44979163e-04,
         5.83004436e-07,  3.66161678e-07,  9.47127887e-08],
       [-9.20139214e-05, -1.80606211e-05,  2.77062746e-04,
         3.66161678e-07,  2.31803081e-07,  5.57259525e-08],
       [-3.55425234e-05, -7.51270326e-06,  1.04131589e-04,
         9.47127887e-08,  5.57259525e-08,  5.50628232e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.64497862e-06],
       [ 2.47868375e-07],
       [-3.05556741e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.13395553e+03],
       [-2.18154430e+03],
       [-5.39007773e+03],
       [-4.61615641e+00],
       [-3.25897754e+00],
       [ 4.87567935e+00],
       [ 7.57696673e-02],
       [-1.11630127e-02],
       [ 9.56656467e-01],
       [-2.80967522e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80058392e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.75558915e-02,  1.08562127e-02, -1.71087859e-01,
        -2.20893038e-04, -1.60170840e-04, -3.82146644e-05],
       [ 1.08562127e-02,  2.11988286e-03, -3.22235108e-02,
        -4.07444490e-05, -2.86490510e-05, -8.06912656e-06],
       [-1.71087859e-01, -3.22235108e-02,  5.12222547e-01,
         6.73158394e-04,  4.83342870e-04,  1.09234573e-04],
       [-2.20893038e-04, -4.07444490e-05,  6.73158394e-04,
         1.09008608e-06,  7.17342224e-07,  3.31922709e-08],
       [-1.60170840e-04, -2.86490510e-05,  4.83342870e-04,
         7.17342224e-07,  5.62110378e-07,  3.83907824e-08],
       [-3.82146644e-05, -8.06912656e-06,  1.09234573e-04,
         3.31922709e-08,  3.83907824e-08,  1.78264603e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 3.70671104e-06],
       [ 4.33573768e-06],
       [-1.07707414e-01]])}}
Current time:  2018-07-13 08:23:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.13395553e+03],
       [-2.18154430e+03],
       [-5.39007773e+03],
       [-4.61615641e+00],
       [-3.25897754e+00],
       [ 4.87567935e+00],
       [ 7.57696673e-02],
       [-1.11630127e-02],
       [ 9.56656467e-01],
       [-2.80967522e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80058392e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.75558915e-02,  1.08562127e-02, -1.71087859e-01,
        -2.20893038e-04, -1.60170840e-04, -3.82146644e-05],
       [ 1.08562127e-02,  2.11988286e-03, -3.22235108e-02,
        -4.07444490e-05, -2.86490510e-05, -8.06912656e-06],
       [-1.71087859e-01, -3.22235108e-02,  5.12222547e-01,
         6.73158394e-04,  4.83342870e-04,  1.09234573e-04],
       [-2.20893038e-04, -4.07444490e-05,  6.73158394e-04,
         1.09008608e-06,  7.17342224e-07,  3.31922709e-08],
       [-1.60170840e-04, -2.86490510e-05,  4.83342870e-04,
         7.17342224e-07,  5.62110378e-07,  3.83907824e-08],
       [-3.82146644e-05, -8.06912656e-06,  1.09234573e-04,
         3.31922709e-08,  3.83907824e-08,  1.78264603e-07]])}
[[-4.13395553e+03]
 [-2.18154430e+03]
 [-5.39007773e+03]
 [-4.61615641e+00]
 [-3.25897754e+00]
 [ 4.87567935e+00]
 [ 7.57696673e-02]
 [-1.11630127e-02]
 [ 9.56656467e-01]
 [-2.80967522e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80058392e-18]]
2018-07-13 08:23:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:10
[[-4.17988966e+03]
 [-2.21401393e+03]
 [-5.34102590e+03]
 [-4.57063675e+00]
 [-3.23491140e+00]
 [ 4.93458625e+00]
 [ 8.07636375e-02]
 [-9.69584106e-03]
 [ 9.56247810e-01]
 [-2.81021978e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80079620e-18]]
[[ 5.32244818e-02  8.91190802e-03 -1.64701137e-01 -2.12198150e-04
  -1.53973158e-04 -3.82845334e-05]
 [ 8.91190802e-03  1.60170045e-03 -2.74514628e-02 -3.39333837e-05
  -2.31319825e-05 -7.74876216e-06]
 [-1.64701137e-01 -2.74514628e-02  5.14438417e-01  6.80697057e-04
   4.86892612e-04  1.12371220e-04]
 [-2.12198150e-04 -3.39333837e-05  6.80697057e-04  1.11907441e-06
   7.28325242e-07  3.65357628e-08]
 [-1.53973158e-04 -2.31319825e-05  4.86892612e-04  7.28325242e-07
   5.78058652e-07  4.03417954e-08]
 [-3.82845334e-05 -7.74876216e-06  1.12371220e-04  3.65357628e-08
   4.03417954e-08  1.88745632e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.13384221e+03],
       [-2.18152163e+03],
       [-5.39040483e+03],
       [-4.61639671e+00],
       [-3.25914154e+00],
       [ 4.87551972e+00]]), 'covar': array([[ 4.11875454e-02,  8.25704074e-03, -1.22356015e-01,
        -1.47864256e-04, -9.20139214e-05, -3.55425234e-05],
       [ 8.25704074e-03,  1.70606184e-03, -2.44987058e-02,
        -2.91354653e-05, -1.80606211e-05, -7.51270326e-06],
       [-1.22356015e-01, -2.44987058e-02,  3.66427619e-01,
         4.44979163e-04,  2.77062746e-04,  1.04131589e-04],
       [-1.47864256e-04, -2.91354653e-05,  4.44979163e-04,
         5.83004436e-07,  3.66161678e-07,  9.47127887e-08],
       [-9.20139214e-05, -1.80606211e-05,  2.77062746e-04,
         3.66161678e-07,  2.31803081e-07,  5.57259525e-08],
       [-3.55425234e-05, -7.51270326e-06,  1.04131589e-04,
         9.47127887e-08,  5.57259525e-08,  5.50628232e-08]])}
[[-4.13384221e+03]
 [-2.18152163e+03]
 [-5.39040483e+03]
 [-4.61639671e+00]
 [-3.25914154e+00]
 [ 4.87551972e+00]]
2018-07-13 08:23:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:10
[[-4.17977901e+03]
 [-2.21399287e+03]
 [-5.34135431e+03]
 [-4.57088170e+00]
 [-3.23507734e+00]
 [ 4.93442590e+00]]
[[ 3.82720716e-02  7.07700472e-03 -1.18227922e-01 -1.43652082e-04
  -8.90616806e-05 -3.48772149e-05]
 [ 7.07700472e-03  1.36677378e-03 -2.17863381e-02 -2.57634923e-05
  -1.58681325e-05 -7.00472083e-06]
 [-1.18227922e-01 -2.17863381e-02  3.68525394e-01  4.51075904e-04
   2.79899448e-04  1.05602304e-04]
 [-1.43652082e-04 -2.57634923e-05  4.51075904e-04  5.95638194e-07
   3.72827582e-07  9.73112785e-08]
 [-8.90616806e-05 -1.58681325e-05  2.79899448e-04  3.72827582e-07
   2.35345881e-07  5.70827074e-08]
 [-3.48772149e-05 -7.00472083e-06  1.05602304e-04  9.73112785e-08
   5.70827074e-08  5.56508120e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.17977901e+03],
       [-2.21399287e+03],
       [-5.34135431e+03],
       [-4.57088170e+00],
       [-3.23507734e+00],
       [ 4.93442590e+00]]), 'covar': array([[ 3.82720716e-02,  7.07700472e-03, -1.18227922e-01,
        -1.43652082e-04, -8.90616806e-05, -3.48772149e-05],
       [ 7.07700472e-03,  1.36677378e-03, -2.17863381e-02,
        -2.57634923e-05, -1.58681325e-05, -7.00472083e-06],
       [-1.18227922e-01, -2.17863381e-02,  3.68525394e-01,
         4.51075904e-04,  2.79899448e-04,  1.05602304e-04],
       [-1.43652082e-04, -2.57634923e-05,  4.51075904e-04,
         5.95638194e-07,  3.72827582e-07,  9.73112785e-08],
       [-8.90616806e-05, -1.58681325e-05,  2.79899448e-04,
         3.72827582e-07,  2.35345881e-07,  5.70827074e-08],
       [-3.48772149e-05, -7.00472083e-06,  1.05602304e-04,
         9.73112785e-08,  5.70827074e-08,  5.56508120e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.64497862e-06],
       [ 2.47868375e-07],
       [-3.05556741e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.17988966e+03],
       [-2.21401393e+03],
       [-5.34102590e+03],
       [-4.57063675e+00],
       [-3.23491140e+00],
       [ 4.93458625e+00],
       [ 8.07636375e-02],
       [-9.69584106e-03],
       [ 9.56247810e-01],
       [-2.81021978e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80079620e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.32244818e-02,  8.91190802e-03, -1.64701137e-01,
        -2.12198150e-04, -1.53973158e-04, -3.82845334e-05],
       [ 8.91190802e-03,  1.60170045e-03, -2.74514628e-02,
        -3.39333837e-05, -2.31319825e-05, -7.74876216e-06],
       [-1.64701137e-01, -2.74514628e-02,  5.14438417e-01,
         6.80697057e-04,  4.86892612e-04,  1.12371220e-04],
       [-2.12198150e-04, -3.39333837e-05,  6.80697057e-04,
         1.11907441e-06,  7.28325242e-07,  3.65357628e-08],
       [-1.53973158e-04, -2.31319825e-05,  4.86892612e-04,
         7.28325242e-07,  5.78058652e-07,  4.03417954e-08],
       [-3.82845334e-05, -7.74876216e-06,  1.12371220e-04,
         3.65357628e-08,  4.03417954e-08,  1.88745632e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 3.70671104e-06],
       [ 4.33573768e-06],
       [-1.07707414e-01]])}}
Yi [[ 0.12061374]
 [-1.27179366]
 [12.32580686]]
posterior
[[-4.17988966e+03]
 [-2.21401393e+03]
 [-5.34102590e+03]
 [-4.57063675e+00]
 [-3.23491140e+00]
 [ 4.93458625e+00]
 [ 8.07636375e-02]
 [-9.69584106e-03]
 [ 9.56247810e-01]
 [-2.81021978e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80079620e-18]]
[[-4.17999468e+03]
 [-2.21403678e+03]
 [-5.34069720e+03]
 [-4.57024788e+00]
 [-3.23471928e+00]
 [ 4.93471647e+00]
 [ 8.07636375e-02]
 [-9.69584106e-03]
 [ 9.56247810e-01]
 [-2.81021978e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80079620e-18]]
[[ 3.60847528e-02  5.34383192e-03 -1.13519535e-01 -1.59097841e-04
  -1.22960057e-04 -1.63855238e-05]
 [ 5.34383192e-03  8.56120171e-04 -1.67546786e-02 -2.27029527e-05
  -1.66713506e-05 -3.20027971e-06]
 [-1.13519535e-01 -1.67546786e-02  3.60968487e-01  5.19468837e-04
   3.94212001e-04  4.71361607e-05]
 [-1.59097841e-04 -2.27029527e-05  5.19468837e-04  9.43386163e-07
   6.31942911e-07 -3.06431693e-08]
 [-1.22960057e-04 -1.66713506e-05  3.94212001e-04  6.31942911e-07
   5.21928927e-07  7.37754669e-10]
 [-1.63855238e-05 -3.20027971e-06  4.71361607e-05 -3.06431693e-08
   7.37754669e-10  1.60724841e-07]]
[[ 0.12064883]
 [-1.27179798]
 [12.34462643]]
[[-3.50935443e-05]
 [ 4.32785118e-06]
 [-1.88195666e-02]]


 Corrector Step
2018-07-13 08:23:10
[[-4.17999468e+03]
 [-2.21403678e+03]
 [-5.34069720e+03]
 [-4.57024788e+00]
 [-3.23471928e+00]
 [ 4.93471647e+00]
 [ 8.07636375e-02]
 [-9.69584106e-03]
 [ 9.56247810e-01]
 [-2.81021978e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80079620e-18]]
[[ 3.60847528e-02  5.34383192e-03 -1.13519535e-01 -1.59097841e-04
  -1.22960057e-04 -1.63855238e-05]
 [ 5.34383192e-03  8.56120171e-04 -1.67546786e-02 -2.27029527e-05
  -1.66713506e-05 -3.20027971e-06]
 [-1.13519535e-01 -1.67546786e-02  3.60968487e-01  5.19468837e-04
   3.94212001e-04  4.71361607e-05]
 [-1.59097841e-04 -2.27029527e-05  5.19468837e-04  9.43386163e-07
   6.31942911e-07 -3.06431693e-08]
 [-1.22960057e-04 -1.66713506e-05  3.94212001e-04  6.31942911e-07
   5.21928927e-07  7.37754669e-10]
 [-1.63855238e-05 -3.20027971e-06  4.71361607e-05 -3.06431693e-08
   7.37754669e-10  1.60724841e-07]]
369977475.6954969
post
cubesat_nadir
Ybar_post [[ 0.12062951]
 [-1.27180107]
 [12.34418953]]
resids [[-1.57714001e-05]
 [ 7.40832001e-06]
 [-1.83826733e-02]]
posterior
[[-4.17977901e+03]
 [-2.21399287e+03]
 [-5.34135431e+03]
 [-4.57088170e+00]
 [-3.23507734e+00]
 [ 4.93442590e+00]]
[[-4.17994568e+03]
 [-2.21402769e+03]
 [-5.34084063e+03]
 [-4.57030328e+00]
 [-3.23472581e+00]
 [ 4.93461424e+00]]
[[ 2.17901577e-02  3.64971802e-03 -6.83074301e-02 -8.79901386e-05
  -5.52525456e-05 -1.60094781e-05]
 [ 3.64971802e-03  6.53798990e-04 -1.13953488e-02 -1.41719660e-05
  -8.82739341e-06 -3.08325606e-06]
 [-6.83074301e-02 -1.13953488e-02  2.16959237e-01  2.81885190e-04
   1.77131583e-04  4.85243202e-05]
 [-8.79901386e-05 -1.41719660e-05  2.81885190e-04  4.06672350e-07
   2.58047469e-07  3.37048892e-08]
 [-5.52525456e-05 -8.82739341e-06  1.77131583e-04  2.58047469e-07
   1.65627057e-07  1.84483603e-08]
 [-1.60094781e-05 -3.08325606e-06  4.85243202e-05  3.37048892e-08
   1.84483603e-08  3.40388984e-08]]
[[ 0.12066346]
 [-1.27179183]
 [12.55261064]]
[[-4.97190341e-05]
 [-1.82632839e-06]
 [-2.26803776e-01]]


 Corrector Step
2018-07-13 08:23:10
[[-4.17994568e+03]
 [-2.21402769e+03]
 [-5.34084063e+03]
 [-4.57030328e+00]
 [-3.23472581e+00]
 [ 4.93461424e+00]]
[[ 2.17901577e-02  3.64971802e-03 -6.83074301e-02 -8.79901386e-05
  -5.52525456e-05 -1.60094781e-05]
 [ 3.64971802e-03  6.53798990e-04 -1.13953488e-02 -1.41719660e-05
  -8.82739341e-06 -3.08325606e-06]
 [-6.83074301e-02 -1.13953488e-02  2.16959237e-01  2.81885190e-04
   1.77131583e-04  4.85243202e-05]
 [-8.79901386e-05 -1.41719660e-05  2.81885190e-04  4.06672350e-07
   2.58047469e-07  3.37048892e-08]
 [-5.52525456e-05 -8.82739341e-06  1.77131583e-04  2.58047469e-07
   1.65627057e-07  1.84483603e-08]
 [-1.60094781e-05 -3.08325606e-06  4.85243202e-05  3.37048892e-08
   1.84483603e-08  3.40388984e-08]]
20010239.61609134
post
sphere_lamr_small
Ybar_post [[ 0.12063554]
 [-1.27179807]
 [12.55193688]]
resids [[-2.17960029e-05]
 [ 4.41510467e-06]
 [-2.26130020e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [369977475.6954969, 20010239.61609134]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.17999468e+03],
       [-2.21403678e+03],
       [-5.34069720e+03],
       [-4.57024788e+00],
       [-3.23471928e+00],
       [ 4.93471647e+00]]), 'est_covars': array([[ 3.60847528e-02,  5.34383192e-03, -1.13519535e-01,
        -1.59097841e-04, -1.22960057e-04, -1.63855238e-05],
       [ 5.34383192e-03,  8.56120171e-04, -1.67546786e-02,
        -2.27029527e-05, -1.66713506e-05, -3.20027971e-06],
       [-1.13519535e-01, -1.67546786e-02,  3.60968487e-01,
         5.19468837e-04,  3.94212001e-04,  4.71361607e-05],
       [-1.59097841e-04, -2.27029527e-05,  5.19468837e-04,
         9.43386163e-07,  6.31942911e-07, -3.06431693e-08],
       [-1.22960057e-04, -1.66713506e-05,  3.94212001e-04,
         6.31942911e-07,  5.21928927e-07,  7.37754669e-10],
       [-1.63855238e-05, -3.20027971e-06,  4.71361607e-05,
        -3.06431693e-08,  7.37754669e-10,  1.60724841e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.17994568e+03],
       [-2.21402769e+03],
       [-5.34084063e+03],
       [-4.57030328e+00],
       [-3.23472581e+00],
       [ 4.93461424e+00]]), 'covar': array([[ 2.17901577e-02,  3.64971802e-03, -6.83074301e-02,
        -8.79901386e-05, -5.52525456e-05, -1.60094781e-05],
       [ 3.64971802e-03,  6.53798990e-04, -1.13953488e-02,
        -1.41719660e-05, -8.82739341e-06, -3.08325606e-06],
       [-6.83074301e-02, -1.13953488e-02,  2.16959237e-01,
         2.81885190e-04,  1.77131583e-04,  4.85243202e-05],
       [-8.79901386e-05, -1.41719660e-05,  2.81885190e-04,
         4.06672350e-07,  2.58047469e-07,  3.37048892e-08],
       [-5.52525456e-05, -8.82739341e-06,  1.77131583e-04,
         2.58047469e-07,  1.65627057e-07,  1.84483603e-08],
       [-1.60094781e-05, -3.08325606e-06,  4.85243202e-05,
         3.37048892e-08,  1.84483603e-08,  3.40388984e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.17960029e-05],
       [ 4.41510467e-06],
       [-2.26130020e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.17999468e+03],
       [-2.21403678e+03],
       [-5.34069720e+03],
       [-4.57024788e+00],
       [-3.23471928e+00],
       [ 4.93471647e+00],
       [ 8.07636375e-02],
       [-9.69584106e-03],
       [ 9.56247810e-01],
       [-2.81021978e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80079620e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.60847528e-02,  5.34383192e-03, -1.13519535e-01,
        -1.59097841e-04, -1.22960057e-04, -1.63855238e-05],
       [ 5.34383192e-03,  8.56120171e-04, -1.67546786e-02,
        -2.27029527e-05, -1.66713506e-05, -3.20027971e-06],
       [-1.13519535e-01, -1.67546786e-02,  3.60968487e-01,
         5.19468837e-04,  3.94212001e-04,  4.71361607e-05],
       [-1.59097841e-04, -2.27029527e-05,  5.19468837e-04,
         9.43386163e-07,  6.31942911e-07, -3.06431693e-08],
       [-1.22960057e-04, -1.66713506e-05,  3.94212001e-04,
         6.31942911e-07,  5.21928927e-07,  7.37754669e-10],
       [-1.63855238e-05, -3.20027971e-06,  4.71361607e-05,
        -3.06431693e-08,  7.37754669e-10,  1.60724841e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.57714001e-05],
       [ 7.40832001e-06],
       [-1.83826733e-02]])}}
Current time:  2018-07-13 08:23:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.17999468e+03],
       [-2.21403678e+03],
       [-5.34069720e+03],
       [-4.57024788e+00],
       [-3.23471928e+00],
       [ 4.93471647e+00],
       [ 8.07636375e-02],
       [-9.69584106e-03],
       [ 9.56247810e-01],
       [-2.81021978e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80079620e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.60847528e-02,  5.34383192e-03, -1.13519535e-01,
        -1.59097841e-04, -1.22960057e-04, -1.63855238e-05],
       [ 5.34383192e-03,  8.56120171e-04, -1.67546786e-02,
        -2.27029527e-05, -1.66713506e-05, -3.20027971e-06],
       [-1.13519535e-01, -1.67546786e-02,  3.60968487e-01,
         5.19468837e-04,  3.94212001e-04,  4.71361607e-05],
       [-1.59097841e-04, -2.27029527e-05,  5.19468837e-04,
         9.43386163e-07,  6.31942911e-07, -3.06431693e-08],
       [-1.22960057e-04, -1.66713506e-05,  3.94212001e-04,
         6.31942911e-07,  5.21928927e-07,  7.37754669e-10],
       [-1.63855238e-05, -3.20027971e-06,  4.71361607e-05,
        -3.06431693e-08,  7.37754669e-10,  1.60724841e-07]])}
[[-4.17999468e+03]
 [-2.21403678e+03]
 [-5.34069720e+03]
 [-4.57024788e+00]
 [-3.23471928e+00]
 [ 4.93471647e+00]
 [ 8.07636375e-02]
 [-9.69584106e-03]
 [ 9.56247810e-01]
 [-2.81021978e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80079620e-18]]
2018-07-13 08:23:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:20
[[-4.22546733e+03]
 [-2.24626208e+03]
 [-5.29105741e+03]
 [-4.52421777e+00]
 [-3.21029365e+00]
 [ 4.99308910e+00]
 [ 8.57554059e-02]
 [-8.22840513e-03]
 [ 9.55813083e-01]
 [-2.81068772e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80100849e-18]]
[[ 3.29821983e-02  3.94621189e-03 -1.08467626e-01 -1.51100184e-04
  -1.17274443e-04 -1.69637711e-05]
 [ 3.94621189e-03  5.74361355e-04 -1.28335071e-02 -1.65469843e-05
  -1.14687353e-05 -3.22273988e-06]
 [-1.08467626e-01 -1.28335071e-02  3.61937312e-01  5.24254314e-04
   3.96439619e-04  4.97353146e-05]
 [-1.51100184e-04 -1.65469843e-05  5.24254314e-04  9.68083494e-07
   6.40726385e-07 -2.85250846e-08]
 [-1.17274443e-04 -1.14687353e-05  3.96439619e-04  6.40726385e-07
   5.36753467e-07  2.09637823e-09]
 [-1.69637711e-05 -3.22273988e-06  4.97353146e-05 -2.85250846e-08
   2.09637823e-09  1.70906033e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.17994568e+03],
       [-2.21402769e+03],
       [-5.34084063e+03],
       [-4.57030328e+00],
       [-3.23472581e+00],
       [ 4.93461424e+00]]), 'covar': array([[ 2.17901577e-02,  3.64971802e-03, -6.83074301e-02,
        -8.79901386e-05, -5.52525456e-05, -1.60094781e-05],
       [ 3.64971802e-03,  6.53798990e-04, -1.13953488e-02,
        -1.41719660e-05, -8.82739341e-06, -3.08325606e-06],
       [-6.83074301e-02, -1.13953488e-02,  2.16959237e-01,
         2.81885190e-04,  1.77131583e-04,  4.85243202e-05],
       [-8.79901386e-05, -1.41719660e-05,  2.81885190e-04,
         4.06672350e-07,  2.58047469e-07,  3.37048892e-08],
       [-5.52525456e-05, -8.82739341e-06,  1.77131583e-04,
         2.58047469e-07,  1.65627057e-07,  1.84483603e-08],
       [-1.60094781e-05, -3.08325606e-06,  4.85243202e-05,
         3.37048892e-08,  1.84483603e-08,  3.40388984e-08]])}
[[-4.17994568e+03]
 [-2.21402769e+03]
 [-5.34084063e+03]
 [-4.57030328e+00]
 [-3.23472581e+00]
 [ 4.93461424e+00]]
2018-07-13 08:23:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:20
[[-4.22541878e+03]
 [-2.24625302e+03]
 [-5.29120211e+03]
 [-4.52427521e+00]
 [-3.21030116e+00]
 [ 4.99298682e+00]]
[[ 2.00619921e-02  2.97866735e-03 -6.56308103e-02 -8.48209236e-05
  -5.30631326e-05 -1.58304323e-05]
 [ 2.97866735e-03  4.93263375e-04 -9.64638909e-03 -1.17172527e-05
  -7.22465620e-06 -2.92020468e-06]
 [-6.56308103e-02 -9.64638909e-03  2.17938698e-01  2.85276235e-04
   1.78662753e-04  4.94174376e-05]
 [-8.48209236e-05 -1.17172527e-05  2.85276235e-04  4.14729488e-07
   2.62294750e-07  3.51248351e-08]
 [-5.30631326e-05 -7.22465620e-06  1.78662753e-04  2.62294750e-07
   1.67922844e-07  1.92149861e-08]
 [-1.58304323e-05 -2.92020468e-06  4.94174376e-05  3.51248351e-08
   1.92149861e-08  3.43532101e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.22541878e+03],
       [-2.24625302e+03],
       [-5.29120211e+03],
       [-4.52427521e+00],
       [-3.21030116e+00],
       [ 4.99298682e+00]]), 'covar': array([[ 2.00619921e-02,  2.97866735e-03, -6.56308103e-02,
        -8.48209236e-05, -5.30631326e-05, -1.58304323e-05],
       [ 2.97866735e-03,  4.93263375e-04, -9.64638909e-03,
        -1.17172527e-05, -7.22465620e-06, -2.92020468e-06],
       [-6.56308103e-02, -9.64638909e-03,  2.17938698e-01,
         2.85276235e-04,  1.78662753e-04,  4.94174376e-05],
       [-8.48209236e-05, -1.17172527e-05,  2.85276235e-04,
         4.14729488e-07,  2.62294750e-07,  3.51248351e-08],
       [-5.30631326e-05, -7.22465620e-06,  1.78662753e-04,
         2.62294750e-07,  1.67922844e-07,  1.92149861e-08],
       [-1.58304323e-05, -2.92020468e-06,  4.94174376e-05,
         3.51248351e-08,  1.92149861e-08,  3.43532101e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.17960029e-05],
       [ 4.41510467e-06],
       [-2.26130020e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.22546733e+03],
       [-2.24626208e+03],
       [-5.29105741e+03],
       [-4.52421777e+00],
       [-3.21029365e+00],
       [ 4.99308910e+00],
       [ 8.57554059e-02],
       [-8.22840513e-03],
       [ 9.55813083e-01],
       [-2.81068772e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80100849e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.29821983e-02,  3.94621189e-03, -1.08467626e-01,
        -1.51100184e-04, -1.17274443e-04, -1.69637711e-05],
       [ 3.94621189e-03,  5.74361355e-04, -1.28335071e-02,
        -1.65469843e-05, -1.14687353e-05, -3.22273988e-06],
       [-1.08467626e-01, -1.28335071e-02,  3.61937312e-01,
         5.24254314e-04,  3.96439619e-04,  4.97353146e-05],
       [-1.51100184e-04, -1.65469843e-05,  5.24254314e-04,
         9.68083494e-07,  6.40726385e-07, -2.85250846e-08],
       [-1.17274443e-04, -1.14687353e-05,  3.96439619e-04,
         6.40726385e-07,  5.36753467e-07,  2.09637823e-09],
       [-1.69637711e-05, -3.22273988e-06,  4.97353146e-05,
        -2.85250846e-08,  2.09637823e-09,  1.70906033e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.57714001e-05],
       [ 7.40832001e-06],
       [-1.83826733e-02]])}}
Yi [[ 0.07179515]
 [-1.29118762]
 [12.23480303]]
posterior
[[-4.22546733e+03]
 [-2.24626208e+03]
 [-5.29105741e+03]
 [-4.52421777e+00]
 [-3.21029365e+00]
 [ 4.99308910e+00]
 [ 8.57554059e-02]
 [-8.22840513e-03]
 [ 9.55813083e-01]
 [-2.81068772e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80100849e-18]]
[[-4.22549247e+03]
 [-2.24626284e+03]
 [-5.29103885e+03]
 [-4.52440644e+00]
 [-3.21024365e+00]
 [ 4.99313436e+00]
 [ 8.57554059e-02]
 [-8.22840513e-03]
 [ 9.55813083e-01]
 [-2.81068772e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80100849e-18]]
[[ 2.42138499e-02  2.37367095e-03 -8.11630909e-02 -1.22749935e-04
  -1.00349795e-04 -5.65393393e-06]
 [ 2.37367095e-03  2.89619557e-04 -7.89337917e-03 -1.12671191e-05
  -8.43453237e-06 -1.20366447e-06]
 [-8.11630909e-02 -7.89337917e-03  2.76219947e-01  4.32846457e-04
   3.43749940e-04  1.46666276e-05]
 [-1.22749935e-04 -1.12671191e-05  4.32846457e-04  8.62289551e-07
   5.86063604e-07 -6.44134513e-08]
 [-1.00349795e-04 -8.43453237e-06  3.43749940e-04  5.86063604e-07
   5.04079072e-07 -1.97339610e-08]
 [-5.65393393e-06 -1.20366447e-06  1.46666276e-05 -6.44134513e-08
  -1.97339610e-08  1.56284238e-07]]
[[ 0.07178067]
 [-1.29112786]
 [12.24457359]]
[[ 1.44799422e-05]
 [-5.97546401e-05]
 [-9.77056290e-03]]


 Corrector Step
2018-07-13 08:23:20
[[-4.22549247e+03]
 [-2.24626284e+03]
 [-5.29103885e+03]
 [-4.52440644e+00]
 [-3.21024365e+00]
 [ 4.99313436e+00]
 [ 8.57554059e-02]
 [-8.22840513e-03]
 [ 9.55813083e-01]
 [-2.81068772e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80100849e-18]]
[[ 2.42138499e-02  2.37367095e-03 -8.11630909e-02 -1.22749935e-04
  -1.00349795e-04 -5.65393393e-06]
 [ 2.37367095e-03  2.89619557e-04 -7.89337917e-03 -1.12671191e-05
  -8.43453237e-06 -1.20366447e-06]
 [-8.11630909e-02 -7.89337917e-03  2.76219947e-01  4.32846457e-04
   3.43749940e-04  1.46666276e-05]
 [-1.22749935e-04 -1.12671191e-05  4.32846457e-04  8.62289551e-07
   5.86063604e-07 -6.44134513e-08]
 [-1.00349795e-04 -8.43453237e-06  3.43749940e-04  5.86063604e-07
   5.04079072e-07 -1.97339610e-08]
 [-5.65393393e-06 -1.20366447e-06  1.46666276e-05 -6.44134513e-08
  -1.97339610e-08  1.56284238e-07]]
45231732.7168821
post
cubesat_nadir
Ybar_post [[ 0.07178291]
 [-1.29113914]
 [12.24454862]]
resids [[ 1.22413567e-05]
 [-4.84797766e-05]
 [-9.74559146e-03]]
posterior
[[-4.22541878e+03]
 [-2.24625302e+03]
 [-5.29120211e+03]
 [-4.52427521e+00]
 [-3.21030116e+00]
 [ 4.99298682e+00]]
[[-4.22544918e+03]
 [-2.24625774e+03]
 [-5.29114936e+03]
 [-4.52424311e+00]
 [-3.21028141e+00]
 [ 4.99303250e+00]]
[[ 1.19577522e-02  1.51058867e-03 -3.99010780e-02 -5.56550364e-05
  -3.53645987e-05 -6.36293065e-06]
 [ 1.51058867e-03  2.27233626e-04 -4.98012601e-03 -6.42433896e-06
  -4.01280832e-06 -1.20649305e-06]
 [-3.99010780e-02 -4.98012601e-03  1.35923709e-01  1.92094197e-04
   1.22118477e-04  1.94411632e-05]
 [-5.56550364e-05 -6.42433896e-06  1.92094197e-04  3.08720096e-07
   1.97967088e-07  1.19886352e-09]
 [-3.53645987e-05 -4.01280832e-06  1.22118477e-04  1.97967088e-07
   1.28888106e-07 -1.37223620e-09]
 [-6.36293065e-06 -1.20649305e-06  1.94411632e-05  1.19886352e-09
  -1.37223620e-09  2.32726488e-08]]
[[ 0.07179251]
 [-1.29112367]
 [12.46281981]]
[[ 2.64283228e-06]
 [-6.39418664e-05]
 [-2.28016784e-01]]


 Corrector Step
2018-07-13 08:23:20
[[-4.22544918e+03]
 [-2.24625774e+03]
 [-5.29114936e+03]
 [-4.52424311e+00]
 [-3.21028141e+00]
 [ 4.99303250e+00]]
[[ 1.19577522e-02  1.51058867e-03 -3.99010780e-02 -5.56550364e-05
  -3.53645987e-05 -6.36293065e-06]
 [ 1.51058867e-03  2.27233626e-04 -4.98012601e-03 -6.42433896e-06
  -4.01280832e-06 -1.20649305e-06]
 [-3.99010780e-02 -4.98012601e-03  1.35923709e-01  1.92094197e-04
   1.22118477e-04  1.94411632e-05]
 [-5.56550364e-05 -6.42433896e-06  1.92094197e-04  3.08720096e-07
   1.97967088e-07  1.19886352e-09]
 [-3.53645987e-05 -4.01280832e-06  1.22118477e-04  1.97967088e-07
   1.28888106e-07 -1.37223620e-09]
 [-6.36293065e-06 -1.20649305e-06  1.94411632e-05  1.19886352e-09
  -1.37223620e-09  2.32726488e-08]]
2399132.480722255
post
sphere_lamr_small
Ybar_post [[ 0.07178714]
 [-1.29113246]
 [12.46274491]]
resids [[ 8.01574013e-06]
 [-5.51508375e-05]
 [-2.27941879e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [45231732.7168821, 2399132.480722255]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.22549247e+03],
       [-2.24626284e+03],
       [-5.29103885e+03],
       [-4.52440644e+00],
       [-3.21024365e+00],
       [ 4.99313436e+00]]), 'est_covars': array([[ 2.42138499e-02,  2.37367095e-03, -8.11630909e-02,
        -1.22749935e-04, -1.00349795e-04, -5.65393393e-06],
       [ 2.37367095e-03,  2.89619557e-04, -7.89337917e-03,
        -1.12671191e-05, -8.43453237e-06, -1.20366447e-06],
       [-8.11630909e-02, -7.89337917e-03,  2.76219947e-01,
         4.32846457e-04,  3.43749940e-04,  1.46666276e-05],
       [-1.22749935e-04, -1.12671191e-05,  4.32846457e-04,
         8.62289551e-07,  5.86063604e-07, -6.44134513e-08],
       [-1.00349795e-04, -8.43453237e-06,  3.43749940e-04,
         5.86063604e-07,  5.04079072e-07, -1.97339610e-08],
       [-5.65393393e-06, -1.20366447e-06,  1.46666276e-05,
        -6.44134513e-08, -1.97339610e-08,  1.56284238e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.22544918e+03],
       [-2.24625774e+03],
       [-5.29114936e+03],
       [-4.52424311e+00],
       [-3.21028141e+00],
       [ 4.99303250e+00]]), 'covar': array([[ 1.19577522e-02,  1.51058867e-03, -3.99010780e-02,
        -5.56550364e-05, -3.53645987e-05, -6.36293065e-06],
       [ 1.51058867e-03,  2.27233626e-04, -4.98012601e-03,
        -6.42433896e-06, -4.01280832e-06, -1.20649305e-06],
       [-3.99010780e-02, -4.98012601e-03,  1.35923709e-01,
         1.92094197e-04,  1.22118477e-04,  1.94411632e-05],
       [-5.56550364e-05, -6.42433896e-06,  1.92094197e-04,
         3.08720096e-07,  1.97967088e-07,  1.19886352e-09],
       [-3.53645987e-05, -4.01280832e-06,  1.22118477e-04,
         1.97967088e-07,  1.28888106e-07, -1.37223620e-09],
       [-6.36293065e-06, -1.20649305e-06,  1.94411632e-05,
         1.19886352e-09, -1.37223620e-09,  2.32726488e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 8.01574013e-06],
       [-5.51508375e-05],
       [-2.27941879e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.22549247e+03],
       [-2.24626284e+03],
       [-5.29103885e+03],
       [-4.52440644e+00],
       [-3.21024365e+00],
       [ 4.99313436e+00],
       [ 8.57554059e-02],
       [-8.22840513e-03],
       [ 9.55813083e-01],
       [-2.81068772e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80100849e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.42138499e-02,  2.37367095e-03, -8.11630909e-02,
        -1.22749935e-04, -1.00349795e-04, -5.65393393e-06],
       [ 2.37367095e-03,  2.89619557e-04, -7.89337917e-03,
        -1.12671191e-05, -8.43453237e-06, -1.20366447e-06],
       [-8.11630909e-02, -7.89337917e-03,  2.76219947e-01,
         4.32846457e-04,  3.43749940e-04,  1.46666276e-05],
       [-1.22749935e-04, -1.12671191e-05,  4.32846457e-04,
         8.62289551e-07,  5.86063604e-07, -6.44134513e-08],
       [-1.00349795e-04, -8.43453237e-06,  3.43749940e-04,
         5.86063604e-07,  5.04079072e-07, -1.97339610e-08],
       [-5.65393393e-06, -1.20366447e-06,  1.46666276e-05,
        -6.44134513e-08, -1.97339610e-08,  1.56284238e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.22413567e-05],
       [-4.84797766e-05],
       [-9.74559146e-03]])}}
Current time:  2018-07-13 08:23:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.22549247e+03],
       [-2.24626284e+03],
       [-5.29103885e+03],
       [-4.52440644e+00],
       [-3.21024365e+00],
       [ 4.99313436e+00],
       [ 8.57554059e-02],
       [-8.22840513e-03],
       [ 9.55813083e-01],
       [-2.81068772e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80100849e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.42138499e-02,  2.37367095e-03, -8.11630909e-02,
        -1.22749935e-04, -1.00349795e-04, -5.65393393e-06],
       [ 2.37367095e-03,  2.89619557e-04, -7.89337917e-03,
        -1.12671191e-05, -8.43453237e-06, -1.20366447e-06],
       [-8.11630909e-02, -7.89337917e-03,  2.76219947e-01,
         4.32846457e-04,  3.43749940e-04,  1.46666276e-05],
       [-1.22749935e-04, -1.12671191e-05,  4.32846457e-04,
         8.62289551e-07,  5.86063604e-07, -6.44134513e-08],
       [-1.00349795e-04, -8.43453237e-06,  3.43749940e-04,
         5.86063604e-07,  5.04079072e-07, -1.97339610e-08],
       [-5.65393393e-06, -1.20366447e-06,  1.46666276e-05,
        -6.44134513e-08, -1.97339610e-08,  1.56284238e-07]])}
[[-4.22549247e+03]
 [-2.24626284e+03]
 [-5.29103885e+03]
 [-4.52440644e+00]
 [-3.21024365e+00]
 [ 4.99313436e+00]
 [ 8.57554059e-02]
 [-8.22840513e-03]
 [ 9.55813083e-01]
 [-2.81068772e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80100849e-18]]
2018-07-13 08:23:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:30
[[-4.27050415e+03]
 [-2.27824149e+03]
 [-5.24081786e+03]
 [-4.47787509e+00]
 [-3.18546357e+00]
 [ 5.05096529e+00]
 [ 9.07448365e-02]
 [-6.76074487e-03]
 [ 9.55352298e-01]
 [-2.81107904e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80122078e-18]]
[[ 2.18345510e-02  1.31355187e-03 -7.68790716e-02 -1.15131205e-04
  -9.49313801e-05 -6.49828570e-06]
 [ 1.31355187e-03  1.71430664e-04 -4.46147861e-03 -5.45544826e-06
  -3.36068358e-06 -1.41123563e-06]
 [-7.68790716e-02 -4.46147861e-03  2.76536652e-01  4.36113713e-04
   3.45243646e-04  1.70271240e-05]
 [-1.15131205e-04 -5.45544826e-06  4.36113713e-04  8.84587830e-07
   5.93613822e-07 -6.29356857e-08]
 [-9.49313801e-05 -3.36068358e-06  3.45243646e-04  5.93613822e-07
   5.18265081e-07 -1.86820695e-08]
 [-6.49828570e-06 -1.41123563e-06  1.70271240e-05 -6.29356857e-08
  -1.86820695e-08  1.66310750e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.22544918e+03],
       [-2.24625774e+03],
       [-5.29114936e+03],
       [-4.52424311e+00],
       [-3.21028141e+00],
       [ 4.99303250e+00]]), 'covar': array([[ 1.19577522e-02,  1.51058867e-03, -3.99010780e-02,
        -5.56550364e-05, -3.53645987e-05, -6.36293065e-06],
       [ 1.51058867e-03,  2.27233626e-04, -4.98012601e-03,
        -6.42433896e-06, -4.01280832e-06, -1.20649305e-06],
       [-3.99010780e-02, -4.98012601e-03,  1.35923709e-01,
         1.92094197e-04,  1.22118477e-04,  1.94411632e-05],
       [-5.56550364e-05, -6.42433896e-06,  1.92094197e-04,
         3.08720096e-07,  1.97967088e-07,  1.19886352e-09],
       [-3.53645987e-05, -4.01280832e-06,  1.22118477e-04,
         1.97967088e-07,  1.28888106e-07, -1.37223620e-09],
       [-6.36293065e-06, -1.20649305e-06,  1.94411632e-05,
         1.19886352e-09, -1.37223620e-09,  2.32726488e-08]])}
[[-4.22544918e+03]
 [-2.24625774e+03]
 [-5.29114936e+03]
 [-4.52424311e+00]
 [-3.21028141e+00]
 [ 4.99303250e+00]]
2018-07-13 08:23:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:30
[[-4.27045935e+03]
 [-2.27823692e+03]
 [-5.24092949e+03]
 [-4.47771312e+00]
 [-3.18550192e+00]
 [ 5.05086370e+00]]
[[ 1.08701936e-02  1.11107184e-03 -3.80345609e-02 -5.30877284e-05
  -3.36097263e-05 -6.44523058e-06]
 [ 1.11107184e-03  1.59640192e-04 -3.76699402e-03 -4.49123965e-06
  -2.74291135e-06 -1.22827307e-06]
 [-3.80345609e-02 -3.76699402e-03  1.36318471e-01  1.94024603e-04
   1.22947169e-04  2.00320959e-05]
 [-5.30877284e-05 -4.49123965e-06  1.94024603e-04  3.14261358e-07
   2.00885861e-07  1.99759175e-09]
 [-3.36097263e-05 -2.74291135e-06  1.22947169e-04  2.00885861e-07
   1.30499495e-07 -9.16219702e-10]
 [-6.44523058e-06 -1.22827307e-06  2.00320959e-05  1.99759175e-09
  -9.16219702e-10  2.34454578e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.27045935e+03],
       [-2.27823692e+03],
       [-5.24092949e+03],
       [-4.47771312e+00],
       [-3.18550192e+00],
       [ 5.05086370e+00]]), 'covar': array([[ 1.08701936e-02,  1.11107184e-03, -3.80345609e-02,
        -5.30877284e-05, -3.36097263e-05, -6.44523058e-06],
       [ 1.11107184e-03,  1.59640192e-04, -3.76699402e-03,
        -4.49123965e-06, -2.74291135e-06, -1.22827307e-06],
       [-3.80345609e-02, -3.76699402e-03,  1.36318471e-01,
         1.94024603e-04,  1.22947169e-04,  2.00320959e-05],
       [-5.30877284e-05, -4.49123965e-06,  1.94024603e-04,
         3.14261358e-07,  2.00885861e-07,  1.99759175e-09],
       [-3.36097263e-05, -2.74291135e-06,  1.22947169e-04,
         2.00885861e-07,  1.30499495e-07, -9.16219702e-10],
       [-6.44523058e-06, -1.22827307e-06,  2.00320959e-05,
         1.99759175e-09, -9.16219702e-10,  2.34454578e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 8.01574013e-06],
       [-5.51508375e-05],
       [-2.27941879e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.27050415e+03],
       [-2.27824149e+03],
       [-5.24081786e+03],
       [-4.47787509e+00],
       [-3.18546357e+00],
       [ 5.05096529e+00],
       [ 9.07448365e-02],
       [-6.76074487e-03],
       [ 9.55352298e-01],
       [-2.81107904e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80122078e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.18345510e-02,  1.31355187e-03, -7.68790716e-02,
        -1.15131205e-04, -9.49313801e-05, -6.49828570e-06],
       [ 1.31355187e-03,  1.71430664e-04, -4.46147861e-03,
        -5.45544826e-06, -3.36068358e-06, -1.41123563e-06],
       [-7.68790716e-02, -4.46147861e-03,  2.76536652e-01,
         4.36113713e-04,  3.45243646e-04,  1.70271240e-05],
       [-1.15131205e-04, -5.45544826e-06,  4.36113713e-04,
         8.84587830e-07,  5.93613822e-07, -6.29356857e-08],
       [-9.49313801e-05, -3.36068358e-06,  3.45243646e-04,
         5.93613822e-07,  5.18265081e-07, -1.86820695e-08],
       [-6.49828570e-06, -1.41123563e-06,  1.70271240e-05,
        -6.29356857e-08, -1.86820695e-08,  1.66310750e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.22413567e-05],
       [-4.84797766e-05],
       [-9.74559146e-03]])}}
Yi [[ 1.20897764e-02]
 [-1.31075527e+00]
 [ 1.21697013e+01]]
posterior
[[-4.27050415e+03]
 [-2.27824149e+03]
 [-5.24081786e+03]
 [-4.47787509e+00]
 [-3.18546357e+00]
 [ 5.05096529e+00]
 [ 9.07448365e-02]
 [-6.76074487e-03]
 [ 9.55352298e-01]
 [-2.81107904e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80122078e-18]]
[[-4.27056957e+03]
 [-2.27825028e+03]
 [-5.24061384e+03]
 [-4.47769719e+00]
 [-3.18532443e+00]
 [ 5.05105129e+00]
 [ 9.07448365e-02]
 [-6.76074487e-03]
 [ 9.55352298e-01]
 [-2.81107904e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80122078e-18]]
[[ 1.69904124e-02  6.28891075e-04 -6.11524767e-02 -9.90557002e-05
  -8.46511221e-05 -2.53166055e-07]
 [ 6.28891075e-04  7.20456737e-05 -2.19393641e-03 -2.97487573e-06
  -1.91349169e-06 -5.35660295e-07]
 [-6.11524767e-02 -2.19393641e-03  2.24710121e-01  3.80338350e-04
   3.11963504e-04 -3.12376364e-06]
 [-9.90557002e-05 -2.97487573e-06  3.80338350e-04  8.14536343e-07
   5.59938540e-07 -8.30818985e-08]
 [-8.46511221e-05 -1.91349169e-06  3.11963504e-04  5.59938540e-07
   4.96430096e-07 -3.19480823e-08]
 [-2.53166055e-07 -5.35660295e-07 -3.12376364e-06 -8.30818985e-08
  -3.19480823e-08  1.58238354e-07]]
[[ 1.21203293e-02]
 [-1.31073670e+00]
 [ 1.21420751e+01]]
[[-3.05528960e-05]
 [-1.85642973e-05]
 [ 2.76262305e-02]]


 Corrector Step
2018-07-13 08:23:30
[[-4.27056957e+03]
 [-2.27825028e+03]
 [-5.24061384e+03]
 [-4.47769719e+00]
 [-3.18532443e+00]
 [ 5.05105129e+00]
 [ 9.07448365e-02]
 [-6.76074487e-03]
 [ 9.55352298e-01]
 [-2.81107904e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80122078e-18]]
[[ 1.69904124e-02  6.28891075e-04 -6.11524767e-02 -9.90557002e-05
  -8.46511221e-05 -2.53166055e-07]
 [ 6.28891075e-04  7.20456737e-05 -2.19393641e-03 -2.97487573e-06
  -1.91349169e-06 -5.35660295e-07]
 [-6.11524767e-02 -2.19393641e-03  2.24710121e-01  3.80338350e-04
   3.11963504e-04 -3.12376364e-06]
 [-9.90557002e-05 -2.97487573e-06  3.80338350e-04  8.14536343e-07
   5.59938540e-07 -8.30818985e-08]
 [-8.46511221e-05 -1.91349169e-06  3.11963504e-04  5.59938540e-07
   4.96430096e-07 -3.19480823e-08]
 [-2.53166055e-07 -5.35660295e-07 -3.12376364e-06 -8.30818985e-08
  -3.19480823e-08  1.58238354e-07]]
367707340.00940925
post
cubesat_nadir
Ybar_post [[ 1.21013637e-02]
 [-1.31074330e+00]
 [ 1.21417854e+01]]
resids [[-1.15872897e-05]
 [-1.19674734e-05]
 [ 2.79158666e-02]]
posterior
[[-4.27045935e+03]
 [-2.27823692e+03]
 [-5.24092949e+03]
 [-4.47771312e+00]
 [-3.18550192e+00]
 [ 5.05086370e+00]]
[[-4.27053647e+03]
 [-2.27824832e+03]
 [-5.24068468e+03]
 [-4.47743931e+00]
 [-3.18533539e+00]
 [ 5.05095840e+00]]
[[ 6.79221939e-03  5.02954495e-04 -2.44060258e-02 -3.73317616e-05
  -2.40445754e-05 -1.61373393e-06]
 [ 5.02954495e-04  6.89503630e-05 -1.73342279e-03 -2.13926580e-06
  -1.31508870e-06 -5.08161819e-07]
 [-2.44060258e-02 -1.73342279e-03  9.04708714e-02  1.40786570e-04
   9.06308465e-05  3.97708461e-06]
 [-3.73317616e-05 -2.13926580e-06  1.40786570e-04  2.52261508e-07
   1.63253623e-07 -1.64923347e-08]
 [-2.40445754e-05 -1.31508870e-06  9.06308465e-05  1.63253623e-07
   1.07657696e-07 -1.21421463e-08]
 [-1.61373393e-06 -5.08161819e-07  3.97708461e-06 -1.64923347e-08
  -1.21421463e-08  1.76931430e-08]]
[[ 1.21298723e-02]
 [-1.31072772e+00]
 [ 1.23711367e+01]]
[[-4.00959256e-05]
 [-2.75496975e-05]
 [-2.01435373e-01]]


 Corrector Step
2018-07-13 08:23:30
[[-4.27053647e+03]
 [-2.27824832e+03]
 [-5.24068468e+03]
 [-4.47743931e+00]
 [-3.18533539e+00]
 [ 5.05095840e+00]]
[[ 6.79221939e-03  5.02954495e-04 -2.44060258e-02 -3.73317616e-05
  -2.40445754e-05 -1.61373393e-06]
 [ 5.02954495e-04  6.89503630e-05 -1.73342279e-03 -2.13926580e-06
  -1.31508870e-06 -5.08161819e-07]
 [-2.44060258e-02 -1.73342279e-03  9.04708714e-02  1.40786570e-04
   9.06308465e-05  3.97708461e-06]
 [-3.73317616e-05 -2.13926580e-06  1.40786570e-04  2.52261508e-07
   1.63253623e-07 -1.64923347e-08]
 [-2.40445754e-05 -1.31508870e-06  9.06308465e-05  1.63253623e-07
   1.07657696e-07 -1.21421463e-08]
 [-1.61373393e-06 -5.08161819e-07  3.97708461e-06 -1.64923347e-08
  -1.21421463e-08  1.76931430e-08]]
32451845.890972514
post
sphere_lamr_small
Ybar_post [[ 1.21050753e-02]
 [-1.31073489e+00]
 [ 1.23707928e+01]]
resids [[-1.52988634e-05]
 [-2.03784230e-05]
 [-2.01091539e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [367707340.00940925, 32451845.890972514]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.27056957e+03],
       [-2.27825028e+03],
       [-5.24061384e+03],
       [-4.47769719e+00],
       [-3.18532443e+00],
       [ 5.05105129e+00]]), 'est_covars': array([[ 1.69904124e-02,  6.28891075e-04, -6.11524767e-02,
        -9.90557002e-05, -8.46511221e-05, -2.53166055e-07],
       [ 6.28891075e-04,  7.20456737e-05, -2.19393641e-03,
        -2.97487573e-06, -1.91349169e-06, -5.35660295e-07],
       [-6.11524767e-02, -2.19393641e-03,  2.24710121e-01,
         3.80338350e-04,  3.11963504e-04, -3.12376364e-06],
       [-9.90557002e-05, -2.97487573e-06,  3.80338350e-04,
         8.14536343e-07,  5.59938540e-07, -8.30818985e-08],
       [-8.46511221e-05, -1.91349169e-06,  3.11963504e-04,
         5.59938540e-07,  4.96430096e-07, -3.19480823e-08],
       [-2.53166055e-07, -5.35660295e-07, -3.12376364e-06,
        -8.30818985e-08, -3.19480823e-08,  1.58238354e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.27053647e+03],
       [-2.27824832e+03],
       [-5.24068468e+03],
       [-4.47743931e+00],
       [-3.18533539e+00],
       [ 5.05095840e+00]]), 'covar': array([[ 6.79221939e-03,  5.02954495e-04, -2.44060258e-02,
        -3.73317616e-05, -2.40445754e-05, -1.61373393e-06],
       [ 5.02954495e-04,  6.89503630e-05, -1.73342279e-03,
        -2.13926580e-06, -1.31508870e-06, -5.08161819e-07],
       [-2.44060258e-02, -1.73342279e-03,  9.04708714e-02,
         1.40786570e-04,  9.06308465e-05,  3.97708461e-06],
       [-3.73317616e-05, -2.13926580e-06,  1.40786570e-04,
         2.52261508e-07,  1.63253623e-07, -1.64923347e-08],
       [-2.40445754e-05, -1.31508870e-06,  9.06308465e-05,
         1.63253623e-07,  1.07657696e-07, -1.21421463e-08],
       [-1.61373393e-06, -5.08161819e-07,  3.97708461e-06,
        -1.64923347e-08, -1.21421463e-08,  1.76931430e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.52988634e-05],
       [-2.03784230e-05],
       [-2.01091539e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.27056957e+03],
       [-2.27825028e+03],
       [-5.24061384e+03],
       [-4.47769719e+00],
       [-3.18532443e+00],
       [ 5.05105129e+00],
       [ 9.07448365e-02],
       [-6.76074487e-03],
       [ 9.55352298e-01],
       [-2.81107904e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80122078e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.69904124e-02,  6.28891075e-04, -6.11524767e-02,
        -9.90557002e-05, -8.46511221e-05, -2.53166055e-07],
       [ 6.28891075e-04,  7.20456737e-05, -2.19393641e-03,
        -2.97487573e-06, -1.91349169e-06, -5.35660295e-07],
       [-6.11524767e-02, -2.19393641e-03,  2.24710121e-01,
         3.80338350e-04,  3.11963504e-04, -3.12376364e-06],
       [-9.90557002e-05, -2.97487573e-06,  3.80338350e-04,
         8.14536343e-07,  5.59938540e-07, -8.30818985e-08],
       [-8.46511221e-05, -1.91349169e-06,  3.11963504e-04,
         5.59938540e-07,  4.96430096e-07, -3.19480823e-08],
       [-2.53166055e-07, -5.35660295e-07, -3.12376364e-06,
        -8.30818985e-08, -3.19480823e-08,  1.58238354e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.15872897e-05],
       [-1.19674734e-05],
       [ 2.79158666e-02]])}}
Current time:  2018-07-13 08:23:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.27056957e+03],
       [-2.27825028e+03],
       [-5.24061384e+03],
       [-4.47769719e+00],
       [-3.18532443e+00],
       [ 5.05105129e+00],
       [ 9.07448365e-02],
       [-6.76074487e-03],
       [ 9.55352298e-01],
       [-2.81107904e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80122078e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.69904124e-02,  6.28891075e-04, -6.11524767e-02,
        -9.90557002e-05, -8.46511221e-05, -2.53166055e-07],
       [ 6.28891075e-04,  7.20456737e-05, -2.19393641e-03,
        -2.97487573e-06, -1.91349169e-06, -5.35660295e-07],
       [-6.11524767e-02, -2.19393641e-03,  2.24710121e-01,
         3.80338350e-04,  3.11963504e-04, -3.12376364e-06],
       [-9.90557002e-05, -2.97487573e-06,  3.80338350e-04,
         8.14536343e-07,  5.59938540e-07, -8.30818985e-08],
       [-8.46511221e-05, -1.91349169e-06,  3.11963504e-04,
         5.59938540e-07,  4.96430096e-07, -3.19480823e-08],
       [-2.53166055e-07, -5.35660295e-07, -3.12376364e-06,
        -8.30818985e-08, -3.19480823e-08,  1.58238354e-07]])}
[[-4.27056957e+03]
 [-2.27825028e+03]
 [-5.24061384e+03]
 [-4.47769719e+00]
 [-3.18532443e+00]
 [ 5.05105129e+00]
 [ 9.07448365e-02]
 [-6.76074487e-03]
 [ 9.55352298e-01]
 [-2.81107904e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80122078e-18]]
2018-07-13 08:23:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:40
[[-4.31511164e+03]
 [-2.30997810e+03]
 [-5.18981642e+03]
 [-4.43066711e+00]
 [-3.16019107e+00]
 [ 5.10833476e+00]
 [ 9.57317931e-02]
 [-5.29290030e-03]
 [ 9.54865468e-01]
 [-2.81139372e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80143306e-18]]
[[ 1.50829538e-02 -1.93006686e-04 -5.73447433e-02 -9.16476220e-05
  -7.93758381e-05 -1.24039611e-06]
 [-1.93006686e-04  8.37338190e-05  9.24003515e-04  2.64983826e-06
   3.11564096e-06 -8.51595958e-07]
 [-5.73447433e-02  9.24003515e-04  2.24670072e-01  3.82706294e-04
   3.13014984e-04 -8.55617430e-07]
 [-9.16476220e-05  2.64983826e-06  3.82706294e-04  8.35401516e-07
   5.66735664e-07 -8.19534055e-08]
 [-7.93758381e-05  3.11564096e-06  3.13014984e-04  5.66735664e-07
   5.10214131e-07 -3.10620051e-08]
 [-1.24039611e-06 -8.51595958e-07 -8.55617430e-07 -8.19534055e-08
  -3.10620051e-08  1.68179688e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.27053647e+03],
       [-2.27824832e+03],
       [-5.24068468e+03],
       [-4.47743931e+00],
       [-3.18533539e+00],
       [ 5.05095840e+00]]), 'covar': array([[ 6.79221939e-03,  5.02954495e-04, -2.44060258e-02,
        -3.73317616e-05, -2.40445754e-05, -1.61373393e-06],
       [ 5.02954495e-04,  6.89503630e-05, -1.73342279e-03,
        -2.13926580e-06, -1.31508870e-06, -5.08161819e-07],
       [-2.44060258e-02, -1.73342279e-03,  9.04708714e-02,
         1.40786570e-04,  9.06308465e-05,  3.97708461e-06],
       [-3.73317616e-05, -2.13926580e-06,  1.40786570e-04,
         2.52261508e-07,  1.63253623e-07, -1.64923347e-08],
       [-2.40445754e-05, -1.31508870e-06,  9.06308465e-05,
         1.63253623e-07,  1.07657696e-07, -1.21421463e-08],
       [-1.61373393e-06, -5.08161819e-07,  3.97708461e-06,
        -1.64923347e-08, -1.21421463e-08,  1.76931430e-08]])}
[[-4.27053647e+03]
 [-2.27824832e+03]
 [-5.24068468e+03]
 [-4.47743931e+00]
 [-3.18533539e+00]
 [ 5.05095840e+00]]
2018-07-13 08:23:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:40
[[-4.31507606e+03]
 [-2.30997620e+03]
 [-5.18988804e+03]
 [-4.43040990e+00]
 [-3.16020258e+00]
 [ 5.10824211e+00]]
[[ 6.06759951e-03  2.56716932e-04 -2.30097820e-02 -3.51234205e-05
  -2.25466945e-05 -1.83870428e-06]
 [ 2.56716932e-04  5.34040684e-05 -8.30553570e-04 -5.13734355e-07
  -2.40395768e-07 -6.30911809e-07]
 [-2.30097820e-02 -8.30553570e-04  9.05548127e-02  1.41903984e-04
   9.10701094e-05  4.40496447e-06]
 [-3.51234205e-05 -5.13734355e-07  1.41903984e-04  2.56369103e-07
   1.65415296e-07 -1.60289619e-08]
 [-2.25466945e-05 -2.40395768e-07  9.10701094e-05  1.65415296e-07
   1.08879051e-07 -1.18536328e-08]
 [-1.83870428e-06 -6.30911809e-07  4.40496447e-06 -1.60289619e-08
  -1.18536328e-08  1.77905218e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.31507606e+03],
       [-2.30997620e+03],
       [-5.18988804e+03],
       [-4.43040990e+00],
       [-3.16020258e+00],
       [ 5.10824211e+00]]), 'covar': array([[ 6.06759951e-03,  2.56716932e-04, -2.30097820e-02,
        -3.51234205e-05, -2.25466945e-05, -1.83870428e-06],
       [ 2.56716932e-04,  5.34040684e-05, -8.30553570e-04,
        -5.13734355e-07, -2.40395768e-07, -6.30911809e-07],
       [-2.30097820e-02, -8.30553570e-04,  9.05548127e-02,
         1.41903984e-04,  9.10701094e-05,  4.40496447e-06],
       [-3.51234205e-05, -5.13734355e-07,  1.41903984e-04,
         2.56369103e-07,  1.65415296e-07, -1.60289619e-08],
       [-2.25466945e-05, -2.40395768e-07,  9.10701094e-05,
         1.65415296e-07,  1.08879051e-07, -1.18536328e-08],
       [-1.83870428e-06, -6.30911809e-07,  4.40496447e-06,
        -1.60289619e-08, -1.18536328e-08,  1.77905218e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.52988634e-05],
       [-2.03784230e-05],
       [-2.01091539e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.31511164e+03],
       [-2.30997810e+03],
       [-5.18981642e+03],
       [-4.43066711e+00],
       [-3.16019107e+00],
       [ 5.10833476e+00],
       [ 9.57317931e-02],
       [-5.29290030e-03],
       [ 9.54865468e-01],
       [-2.81139372e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80143306e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.50829538e-02, -1.93006686e-04, -5.73447433e-02,
        -9.16476220e-05, -7.93758381e-05, -1.24039611e-06],
       [-1.93006686e-04,  8.37338190e-05,  9.24003515e-04,
         2.64983826e-06,  3.11564096e-06, -8.51595958e-07],
       [-5.73447433e-02,  9.24003515e-04,  2.24670072e-01,
         3.82706294e-04,  3.13014984e-04, -8.55617430e-07],
       [-9.16476220e-05,  2.64983826e-06,  3.82706294e-04,
         8.35401516e-07,  5.66735664e-07, -8.19534055e-08],
       [-7.93758381e-05,  3.11564096e-06,  3.13014984e-04,
         5.66735664e-07,  5.10214131e-07, -3.10620051e-08],
       [-1.24039611e-06, -8.51595958e-07, -8.55617430e-07,
        -8.19534055e-08, -3.10620051e-08,  1.68179688e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.15872897e-05],
       [-1.19674734e-05],
       [ 2.79158666e-02]])}}
Yi [[-0.06176032]
 [-1.33034746]
 [12.07071228]]
posterior
[[-4.31511164e+03]
 [-2.30997810e+03]
 [-5.18981642e+03]
 [-4.43066711e+00]
 [-3.16019107e+00]
 [ 5.10833476e+00]
 [ 9.57317931e-02]
 [-5.29290030e-03]
 [ 9.54865468e-01]
 [-2.81139372e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80143306e-18]]
[[-4.31511513e+03]
 [-2.30997763e+03]
 [-5.18982084e+03]
 [-4.43073111e+00]
 [-3.16018064e+00]
 [ 5.10834116e+00]
 [ 9.57317931e-02]
 [-5.29290030e-03]
 [ 9.54865468e-01]
 [-2.81139372e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80143306e-18]]
[[ 1.21316949e-02 -4.56034980e-04 -4.73446568e-02 -8.17476719e-05
  -7.21431477e-05  2.50804555e-06]
 [-4.56034980e-04  5.80736382e-05  1.85894829e-03  3.73467256e-06
   3.75271781e-06 -5.21753597e-07]
 [-4.73446568e-02  1.85894829e-03  1.89920326e-01  3.45149359e-04
   2.88651420e-04 -1.34709159e-05]
 [-8.17476719e-05  3.73467256e-06  3.45149359e-04  7.83592099e-07
   5.43138573e-07 -9.41281973e-08]
 [-7.21431477e-05  3.75271781e-06  2.88651420e-04  5.43138573e-07
   4.92458665e-07 -4.02601313e-08]
 [ 2.50804555e-06 -5.21753597e-07 -1.34709159e-05 -9.41281973e-08
  -4.02601313e-08  1.63409187e-07]]
[[-0.06176357]
 [-1.33033288]
 [12.03642106]]
[[ 3.25165866e-06]
 [-1.45833362e-05]
 [ 3.42912212e-02]]


 Corrector Step
2018-07-13 08:23:40
[[-4.31511513e+03]
 [-2.30997763e+03]
 [-5.18982084e+03]
 [-4.43073111e+00]
 [-3.16018064e+00]
 [ 5.10834116e+00]
 [ 9.57317931e-02]
 [-5.29290030e-03]
 [ 9.54865468e-01]
 [-2.81139372e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80143306e-18]]
[[ 1.21316949e-02 -4.56034980e-04 -4.73446568e-02 -8.17476719e-05
  -7.21431477e-05  2.50804555e-06]
 [-4.56034980e-04  5.80736382e-05  1.85894829e-03  3.73467256e-06
   3.75271781e-06 -5.21753597e-07]
 [-4.73446568e-02  1.85894829e-03  1.89920326e-01  3.45149359e-04
   2.88651420e-04 -1.34709159e-05]
 [-8.17476719e-05  3.73467256e-06  3.45149359e-04  7.83592099e-07
   5.43138573e-07 -9.41281973e-08]
 [-7.21431477e-05  3.75271781e-06  2.88651420e-04  5.43138573e-07
   4.92458665e-07 -4.02601313e-08]
 [ 2.50804555e-06 -5.21753597e-07 -1.34709159e-05 -9.41281973e-08
  -4.02601313e-08  1.63409187e-07]]
499764709.9039719
post
cubesat_nadir
Ybar_post [[-0.06176288]
 [-1.33033579]
 [12.03642838]]
resids [[ 2.56072417e-06]
 [-1.16725690e-05]
 [ 3.42839041e-02]]
posterior
[[-4.31507606e+03]
 [-2.30997620e+03]
 [-5.18988804e+03]
 [-4.43040990e+00]
 [-3.16020258e+00]
 [ 5.10824211e+00]]
[[-4.31508958e+03]
 [-2.30997776e+03]
 [-5.18985599e+03]
 [-4.43038502e+00]
 [-3.16018687e+00]
 [ 5.10826311e+00]]
[[ 3.97181578e-03  2.64486950e-05 -1.55990358e-02 -2.63458237e-05
  -1.72026226e-05  6.52746066e-07]
 [ 2.64486950e-05  2.80852090e-05 -1.86072179e-05  4.45950807e-07
   3.43948959e-07 -3.56366275e-07]
 [-1.55990358e-02 -1.86072179e-05  6.40636074e-02  1.10275012e-04
   7.18209768e-05 -4.30489580e-06]
 [-2.63458237e-05  4.45950807e-07  1.10275012e-04  2.18387171e-07
   1.42306295e-07 -2.62573886e-08]
 [-1.72026226e-05  3.43948959e-07  7.18209768e-05  1.42306295e-07
   9.48188533e-08 -1.80836332e-08]
 [ 6.52746066e-07 -3.56366275e-07 -4.30489580e-06 -2.62573886e-08
  -1.80836332e-08  1.47937564e-08]]
[[-0.06175267]
 [-1.33032192]
 [12.27665138]]
[[-7.64574679e-06]
 [-2.55356897e-05]
 [-2.05939101e-01]]


 Corrector Step
2018-07-13 08:23:40
[[-4.31508958e+03]
 [-2.30997776e+03]
 [-5.18985599e+03]
 [-4.43038502e+00]
 [-3.16018687e+00]
 [ 5.10826311e+00]]
[[ 3.97181578e-03  2.64486950e-05 -1.55990358e-02 -2.63458237e-05
  -1.72026226e-05  6.52746066e-07]
 [ 2.64486950e-05  2.80852090e-05 -1.86072179e-05  4.45950807e-07
   3.43948959e-07 -3.56366275e-07]
 [-1.55990358e-02 -1.86072179e-05  6.40636074e-02  1.10275012e-04
   7.18209768e-05 -4.30489580e-06]
 [-2.63458237e-05  4.45950807e-07  1.10275012e-04  2.18387171e-07
   1.42306295e-07 -2.62573886e-08]
 [-1.72026226e-05  3.43948959e-07  7.18209768e-05  1.42306295e-07
   9.48188533e-08 -1.80836332e-08]
 [ 6.52746066e-07 -3.56366275e-07 -4.30489580e-06 -2.62573886e-08
  -1.80836332e-08  1.47937564e-08]]
49488845.64511002
post
sphere_lamr_small
Ybar_post [[-0.06175904]
 [-1.33032539]
 [12.27660434]]
resids [[-1.27631842e-06]
 [-2.20644482e-05]
 [-2.05892054e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [499764709.9039719, 49488845.64511002]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.31511513e+03],
       [-2.30997763e+03],
       [-5.18982084e+03],
       [-4.43073111e+00],
       [-3.16018064e+00],
       [ 5.10834116e+00]]), 'est_covars': array([[ 1.21316949e-02, -4.56034980e-04, -4.73446568e-02,
        -8.17476719e-05, -7.21431477e-05,  2.50804555e-06],
       [-4.56034980e-04,  5.80736382e-05,  1.85894829e-03,
         3.73467256e-06,  3.75271781e-06, -5.21753597e-07],
       [-4.73446568e-02,  1.85894829e-03,  1.89920326e-01,
         3.45149359e-04,  2.88651420e-04, -1.34709159e-05],
       [-8.17476719e-05,  3.73467256e-06,  3.45149359e-04,
         7.83592099e-07,  5.43138573e-07, -9.41281973e-08],
       [-7.21431477e-05,  3.75271781e-06,  2.88651420e-04,
         5.43138573e-07,  4.92458665e-07, -4.02601313e-08],
       [ 2.50804555e-06, -5.21753597e-07, -1.34709159e-05,
        -9.41281973e-08, -4.02601313e-08,  1.63409187e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.31508958e+03],
       [-2.30997776e+03],
       [-5.18985599e+03],
       [-4.43038502e+00],
       [-3.16018687e+00],
       [ 5.10826311e+00]]), 'covar': array([[ 3.97181578e-03,  2.64486950e-05, -1.55990358e-02,
        -2.63458237e-05, -1.72026226e-05,  6.52746066e-07],
       [ 2.64486950e-05,  2.80852090e-05, -1.86072179e-05,
         4.45950807e-07,  3.43948959e-07, -3.56366275e-07],
       [-1.55990358e-02, -1.86072179e-05,  6.40636074e-02,
         1.10275012e-04,  7.18209768e-05, -4.30489580e-06],
       [-2.63458237e-05,  4.45950807e-07,  1.10275012e-04,
         2.18387171e-07,  1.42306295e-07, -2.62573886e-08],
       [-1.72026226e-05,  3.43948959e-07,  7.18209768e-05,
         1.42306295e-07,  9.48188533e-08, -1.80836332e-08],
       [ 6.52746066e-07, -3.56366275e-07, -4.30489580e-06,
        -2.62573886e-08, -1.80836332e-08,  1.47937564e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.27631842e-06],
       [-2.20644482e-05],
       [-2.05892054e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.31511513e+03],
       [-2.30997763e+03],
       [-5.18982084e+03],
       [-4.43073111e+00],
       [-3.16018064e+00],
       [ 5.10834116e+00],
       [ 9.57317931e-02],
       [-5.29290030e-03],
       [ 9.54865468e-01],
       [-2.81139372e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80143306e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.21316949e-02, -4.56034980e-04, -4.73446568e-02,
        -8.17476719e-05, -7.21431477e-05,  2.50804555e-06],
       [-4.56034980e-04,  5.80736382e-05,  1.85894829e-03,
         3.73467256e-06,  3.75271781e-06, -5.21753597e-07],
       [-4.73446568e-02,  1.85894829e-03,  1.89920326e-01,
         3.45149359e-04,  2.88651420e-04, -1.34709159e-05],
       [-8.17476719e-05,  3.73467256e-06,  3.45149359e-04,
         7.83592099e-07,  5.43138573e-07, -9.41281973e-08],
       [-7.21431477e-05,  3.75271781e-06,  2.88651420e-04,
         5.43138573e-07,  4.92458665e-07, -4.02601313e-08],
       [ 2.50804555e-06, -5.21753597e-07, -1.34709159e-05,
        -9.41281973e-08, -4.02601313e-08,  1.63409187e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.56072417e-06],
       [-1.16725690e-05],
       [ 3.42839041e-02]])}}
Current time:  2018-07-13 08:23:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.31511513e+03],
       [-2.30997763e+03],
       [-5.18982084e+03],
       [-4.43073111e+00],
       [-3.16018064e+00],
       [ 5.10834116e+00],
       [ 9.57317931e-02],
       [-5.29290030e-03],
       [ 9.54865468e-01],
       [-2.81139372e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80143306e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.21316949e-02, -4.56034980e-04, -4.73446568e-02,
        -8.17476719e-05, -7.21431477e-05,  2.50804555e-06],
       [-4.56034980e-04,  5.80736382e-05,  1.85894829e-03,
         3.73467256e-06,  3.75271781e-06, -5.21753597e-07],
       [-4.73446568e-02,  1.85894829e-03,  1.89920326e-01,
         3.45149359e-04,  2.88651420e-04, -1.34709159e-05],
       [-8.17476719e-05,  3.73467256e-06,  3.45149359e-04,
         7.83592099e-07,  5.43138573e-07, -9.41281973e-08],
       [-7.21431477e-05,  3.75271781e-06,  2.88651420e-04,
         5.43138573e-07,  4.92458665e-07, -4.02601313e-08],
       [ 2.50804555e-06, -5.21753597e-07, -1.34709159e-05,
        -9.41281973e-08, -4.02601313e-08,  1.63409187e-07]])}
[[-4.31511513e+03]
 [-2.30997763e+03]
 [-5.18982084e+03]
 [-4.43073111e+00]
 [-3.16018064e+00]
 [ 5.10834116e+00]
 [ 9.57317931e-02]
 [-5.29290030e-03]
 [ 9.54865468e-01]
 [-2.81139372e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80143306e-18]]
2018-07-13 08:23:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:50
[[-4.35918518e+03]
 [-2.34145229e+03]
 [-5.13845314e+03]
 [-4.38320970e+00]
 [-3.13469814e+00]
 [ 5.16507069e+00]
 [ 1.00716140e-01]
 [-3.82491144e-03]
 [ 9.54352607e-01]
 [-2.81163176e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80164535e-18]]
[[ 1.05690878e-02 -1.08678013e-03 -4.38645065e-02 -7.44644878e-05
  -6.69550130e-05  1.44076048e-06]
 [-1.08678013e-03  1.82910468e-04  4.74207140e-03  9.24499031e-06
   8.76447941e-06 -9.10065234e-07]
 [-4.38645065e-02  4.74207140e-03  1.89673296e-01  3.46929365e-04
   2.89405467e-04 -1.12213311e-05]
 [-7.44644878e-05  9.24499031e-06  3.46929365e-04  8.03516001e-07
   5.49414036e-07 -9.32014536e-08]
 [-6.69550130e-05  8.76447941e-06  2.89405467e-04  5.49414036e-07
   5.05950022e-07 -3.94680664e-08]
 [ 1.44076048e-06 -9.10065234e-07 -1.12213311e-05 -9.32014536e-08
  -3.94680664e-08  1.73298607e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.31508958e+03],
       [-2.30997776e+03],
       [-5.18985599e+03],
       [-4.43038502e+00],
       [-3.16018687e+00],
       [ 5.10826311e+00]]), 'covar': array([[ 3.97181578e-03,  2.64486950e-05, -1.55990358e-02,
        -2.63458237e-05, -1.72026226e-05,  6.52746066e-07],
       [ 2.64486950e-05,  2.80852090e-05, -1.86072179e-05,
         4.45950807e-07,  3.43948959e-07, -3.56366275e-07],
       [-1.55990358e-02, -1.86072179e-05,  6.40636074e-02,
         1.10275012e-04,  7.18209768e-05, -4.30489580e-06],
       [-2.63458237e-05,  4.45950807e-07,  1.10275012e-04,
         2.18387171e-07,  1.42306295e-07, -2.62573886e-08],
       [-1.72026226e-05,  3.43948959e-07,  7.18209768e-05,
         1.42306295e-07,  9.48188533e-08, -1.80836332e-08],
       [ 6.52746066e-07, -3.56366275e-07, -4.30489580e-06,
        -2.62573886e-08, -1.80836332e-08,  1.47937564e-08]])}
[[-4.31508958e+03]
 [-2.30997776e+03]
 [-5.18985599e+03]
 [-4.43038502e+00]
 [-3.16018687e+00]
 [ 5.10826311e+00]]
2018-07-13 08:23:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:23:50
[[-4.35915621e+03]
 [-2.34145240e+03]
 [-5.13848889e+03]
 [-4.38286375e+00]
 [-3.13470438e+00]
 [ 5.16499280e+00]]
[[ 3.46468027e-03 -1.27277050e-04 -1.44880200e-02 -2.43595389e-05
  -1.58632803e-05  3.49714803e-07]
 [-1.27277050e-04  4.45367707e-05  6.96353749e-04  1.88277005e-06
   1.29915776e-06 -5.34675924e-07]
 [-1.44880200e-02  6.96353749e-04  6.39812337e-02  1.10925956e-04
   7.20380615e-05 -3.96699030e-06]
 [-2.43595389e-05  1.88277005e-06  1.10925956e-04  2.21646712e-07
   1.44019395e-07 -2.59781515e-08]
 [-1.58632803e-05  1.29915776e-06  7.20380615e-05  1.44019395e-07
   9.58087582e-08 -1.78871616e-08]
 [ 3.49714803e-07 -5.34675924e-07 -3.96699030e-06 -2.59781515e-08
  -1.78871616e-08  1.48491136e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.35915621e+03],
       [-2.34145240e+03],
       [-5.13848889e+03],
       [-4.38286375e+00],
       [-3.13470438e+00],
       [ 5.16499280e+00]]), 'covar': array([[ 3.46468027e-03, -1.27277050e-04, -1.44880200e-02,
        -2.43595389e-05, -1.58632803e-05,  3.49714803e-07],
       [-1.27277050e-04,  4.45367707e-05,  6.96353749e-04,
         1.88277005e-06,  1.29915776e-06, -5.34675924e-07],
       [-1.44880200e-02,  6.96353749e-04,  6.39812337e-02,
         1.10925956e-04,  7.20380615e-05, -3.96699030e-06],
       [-2.43595389e-05,  1.88277005e-06,  1.10925956e-04,
         2.21646712e-07,  1.44019395e-07, -2.59781515e-08],
       [-1.58632803e-05,  1.29915776e-06,  7.20380615e-05,
         1.44019395e-07,  9.58087582e-08, -1.78871616e-08],
       [ 3.49714803e-07, -5.34675924e-07, -3.96699030e-06,
        -2.59781515e-08, -1.78871616e-08,  1.48491136e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.27631842e-06],
       [-2.20644482e-05],
       [-2.05892054e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.35918518e+03],
       [-2.34145229e+03],
       [-5.13845314e+03],
       [-4.38320970e+00],
       [-3.13469814e+00],
       [ 5.16507069e+00],
       [ 1.00716140e-01],
       [-3.82491144e-03],
       [ 9.54352607e-01],
       [-2.81163176e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80164535e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.05690878e-02, -1.08678013e-03, -4.38645065e-02,
        -7.44644878e-05, -6.69550130e-05,  1.44076048e-06],
       [-1.08678013e-03,  1.82910468e-04,  4.74207140e-03,
         9.24499031e-06,  8.76447941e-06, -9.10065234e-07],
       [-4.38645065e-02,  4.74207140e-03,  1.89673296e-01,
         3.46929365e-04,  2.89405467e-04, -1.12213311e-05],
       [-7.44644878e-05,  9.24499031e-06,  3.46929365e-04,
         8.03516001e-07,  5.49414036e-07, -9.32014536e-08],
       [-6.69550130e-05,  8.76447941e-06,  2.89405467e-04,
         5.49414036e-07,  5.05950022e-07, -3.94680664e-08],
       [ 1.44076048e-06, -9.10065234e-07, -1.12213311e-05,
        -9.32014536e-08, -3.94680664e-08,  1.73298607e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.56072417e-06],
       [-1.16725690e-05],
       [ 3.42839041e-02]])}}
Yi [[-0.15435354]
 [-1.34948195]
 [12.07186755]]
posterior
[[-4.35918518e+03]
 [-2.34145229e+03]
 [-5.13845314e+03]
 [-4.38320970e+00]
 [-3.13469814e+00]
 [ 5.16507069e+00]
 [ 1.00716140e-01]
 [-3.82491144e-03]
 [ 9.54352607e-01]
 [-2.81163176e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80164535e-18]]
[[-4.35922707e+03]
 [-2.34145207e+03]
 [-5.13833289e+03]
 [-4.38319775e+00]
 [-3.13457247e+00]
 [ 5.16512496e+00]
 [ 1.00716140e-01]
 [-3.82491144e-03]
 [ 9.54352607e-01]
 [-2.81163176e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80164535e-18]]
[[ 8.59066106e-03 -1.12198623e-03 -3.68340066e-02 -6.77732687e-05
  -6.10430992e-05  3.88844049e-06]
 [-1.12198623e-03  1.80810100e-04  4.90498455e-03  9.53403154e-06
   8.86427019e-06 -8.67853601e-07]
 [-3.68340066e-02  4.90498455e-03  1.63713484e-01  3.18760149e-04
   2.68530591e-04 -1.98821967e-05]
 [-6.77732687e-05  9.53403154e-06  3.18760149e-04  7.61133691e-07
   5.30018630e-07 -1.01311935e-07]
 [-6.10430992e-05  8.86427019e-06  2.68530591e-04  5.30018630e-07
   4.88260125e-07 -4.67850359e-08]
 [ 3.88844049e-06 -8.67853601e-07 -1.98821967e-05 -1.01311935e-07
  -4.67850359e-08  1.70268074e-07]]
[[-0.15432648]
 [-1.34944895]
 [11.92820358]]
[[-2.70607444e-05]
 [-3.29995172e-05]
 [ 1.43663971e-01]]


 Corrector Step
2018-07-13 08:23:50
[[-4.35922707e+03]
 [-2.34145207e+03]
 [-5.13833289e+03]
 [-4.38319775e+00]
 [-3.13457247e+00]
 [ 5.16512496e+00]
 [ 1.00716140e-01]
 [-3.82491144e-03]
 [ 9.54352607e-01]
 [-2.81163176e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80164535e-18]]
[[ 8.59066106e-03 -1.12198623e-03 -3.68340066e-02 -6.77732687e-05
  -6.10430992e-05  3.88844049e-06]
 [-1.12198623e-03  1.80810100e-04  4.90498455e-03  9.53403154e-06
   8.86427019e-06 -8.67853601e-07]
 [-3.68340066e-02  4.90498455e-03  1.63713484e-01  3.18760149e-04
   2.68530591e-04 -1.98821967e-05]
 [-6.77732687e-05  9.53403154e-06  3.18760149e-04  7.61133691e-07
   5.30018630e-07 -1.01311935e-07]
 [-6.10430992e-05  8.86427019e-06  2.68530591e-04  5.30018630e-07
   4.88260125e-07 -4.67850359e-08]
 [ 3.88844049e-06 -8.67853601e-07 -1.98821967e-05 -1.01311935e-07
  -4.67850359e-08  1.70268074e-07]]
91178930.88076065
post
cubesat_nadir
Ybar_post [[-0.15434514]
 [-1.34945813]
 [11.92802422]]
resids [[-8.39961802e-06]
 [-2.38140731e-05]
 [ 1.43843330e-01]]
posterior
[[-4.35915621e+03]
 [-2.34145240e+03]
 [-5.13848889e+03]
 [-4.38286375e+00]
 [-3.13470438e+00]
 [ 5.16499280e+00]]
[[-4.35919403e+03]
 [-2.34145521e+03]
 [-5.13837416e+03]
 [-4.38274989e+00]
 [-3.13463313e+00]
 [ 5.16504737e+00]]
[[ 2.37531514e-03 -1.93104353e-04 -1.03855000e-02 -1.93548379e-05
  -1.27950609e-05  1.62762283e-06]
 [-1.93104353e-04  4.04493644e-05  9.38715261e-04  2.17312912e-06
   1.47744040e-06 -4.55354281e-07]
 [-1.03855000e-02  9.38715261e-04  4.82500407e-02  9.14667824e-05
   6.01221911e-05 -8.67320752e-06]
 [-1.93548379e-05  2.17312912e-06  9.14667824e-05  1.97324106e-07
   1.29138239e-07 -3.16176570e-08]
 [-1.27950609e-05  1.47744040e-06  6.01221911e-05  1.29138239e-07
   8.67034529e-08 -2.13498052e-08]
 [ 1.62762283e-06 -4.55354281e-07 -8.67320752e-06 -3.16176570e-08
  -2.13498052e-08  1.33097452e-08]]
[[-0.15431344]
 [-1.34943569]
 [12.17993593]]
[[-4.01029857e-05]
 [-4.62615507e-05]
 [-1.08068378e-01]]


 Corrector Step
2018-07-13 08:23:50
[[-4.35919403e+03]
 [-2.34145521e+03]
 [-5.13837416e+03]
 [-4.38274989e+00]
 [-3.13463313e+00]
 [ 5.16504737e+00]]
[[ 2.37531514e-03 -1.93104353e-04 -1.03855000e-02 -1.93548379e-05
  -1.27950609e-05  1.62762283e-06]
 [-1.93104353e-04  4.04493644e-05  9.38715261e-04  2.17312912e-06
   1.47744040e-06 -4.55354281e-07]
 [-1.03855000e-02  9.38715261e-04  4.82500407e-02  9.14667824e-05
   6.01221911e-05 -8.67320752e-06]
 [-1.93548379e-05  2.17312912e-06  9.14667824e-05  1.97324106e-07
   1.29138239e-07 -3.16176570e-08]
 [-1.27950609e-05  1.47744040e-06  6.01221911e-05  1.29138239e-07
   8.67034529e-08 -2.13498052e-08]
 [ 1.62762283e-06 -4.55354281e-07 -8.67320752e-06 -3.16176570e-08
  -2.13498052e-08  1.33097452e-08]]
49370579.50189785
post
sphere_lamr_small
Ybar_post [[-0.15433919]
 [-1.34944282]
 [12.17976288]]
resids [[-1.43497849e-05]
 [-3.91263058e-05]
 [-1.07895330e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [91178930.88076065, 49370579.50189785]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.35922707e+03],
       [-2.34145207e+03],
       [-5.13833289e+03],
       [-4.38319775e+00],
       [-3.13457247e+00],
       [ 5.16512496e+00]]), 'est_covars': array([[ 8.59066106e-03, -1.12198623e-03, -3.68340066e-02,
        -6.77732687e-05, -6.10430992e-05,  3.88844049e-06],
       [-1.12198623e-03,  1.80810100e-04,  4.90498455e-03,
         9.53403154e-06,  8.86427019e-06, -8.67853601e-07],
       [-3.68340066e-02,  4.90498455e-03,  1.63713484e-01,
         3.18760149e-04,  2.68530591e-04, -1.98821967e-05],
       [-6.77732687e-05,  9.53403154e-06,  3.18760149e-04,
         7.61133691e-07,  5.30018630e-07, -1.01311935e-07],
       [-6.10430992e-05,  8.86427019e-06,  2.68530591e-04,
         5.30018630e-07,  4.88260125e-07, -4.67850359e-08],
       [ 3.88844049e-06, -8.67853601e-07, -1.98821967e-05,
        -1.01311935e-07, -4.67850359e-08,  1.70268074e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.35919403e+03],
       [-2.34145521e+03],
       [-5.13837416e+03],
       [-4.38274989e+00],
       [-3.13463313e+00],
       [ 5.16504737e+00]]), 'covar': array([[ 2.37531514e-03, -1.93104353e-04, -1.03855000e-02,
        -1.93548379e-05, -1.27950609e-05,  1.62762283e-06],
       [-1.93104353e-04,  4.04493644e-05,  9.38715261e-04,
         2.17312912e-06,  1.47744040e-06, -4.55354281e-07],
       [-1.03855000e-02,  9.38715261e-04,  4.82500407e-02,
         9.14667824e-05,  6.01221911e-05, -8.67320752e-06],
       [-1.93548379e-05,  2.17312912e-06,  9.14667824e-05,
         1.97324106e-07,  1.29138239e-07, -3.16176570e-08],
       [-1.27950609e-05,  1.47744040e-06,  6.01221911e-05,
         1.29138239e-07,  8.67034529e-08, -2.13498052e-08],
       [ 1.62762283e-06, -4.55354281e-07, -8.67320752e-06,
        -3.16176570e-08, -2.13498052e-08,  1.33097452e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.43497849e-05],
       [-3.91263058e-05],
       [-1.07895330e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.35922707e+03],
       [-2.34145207e+03],
       [-5.13833289e+03],
       [-4.38319775e+00],
       [-3.13457247e+00],
       [ 5.16512496e+00],
       [ 1.00716140e-01],
       [-3.82491144e-03],
       [ 9.54352607e-01],
       [-2.81163176e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80164535e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.59066106e-03, -1.12198623e-03, -3.68340066e-02,
        -6.77732687e-05, -6.10430992e-05,  3.88844049e-06],
       [-1.12198623e-03,  1.80810100e-04,  4.90498455e-03,
         9.53403154e-06,  8.86427019e-06, -8.67853601e-07],
       [-3.68340066e-02,  4.90498455e-03,  1.63713484e-01,
         3.18760149e-04,  2.68530591e-04, -1.98821967e-05],
       [-6.77732687e-05,  9.53403154e-06,  3.18760149e-04,
         7.61133691e-07,  5.30018630e-07, -1.01311935e-07],
       [-6.10430992e-05,  8.86427019e-06,  2.68530591e-04,
         5.30018630e-07,  4.88260125e-07, -4.67850359e-08],
       [ 3.88844049e-06, -8.67853601e-07, -1.98821967e-05,
        -1.01311935e-07, -4.67850359e-08,  1.70268074e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.39961802e-06],
       [-2.38140731e-05],
       [ 1.43843330e-01]])}}
Current time:  2018-07-13 08:24:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.35922707e+03],
       [-2.34145207e+03],
       [-5.13833289e+03],
       [-4.38319775e+00],
       [-3.13457247e+00],
       [ 5.16512496e+00],
       [ 1.00716140e-01],
       [-3.82491144e-03],
       [ 9.54352607e-01],
       [-2.81163176e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80164535e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.59066106e-03, -1.12198623e-03, -3.68340066e-02,
        -6.77732687e-05, -6.10430992e-05,  3.88844049e-06],
       [-1.12198623e-03,  1.80810100e-04,  4.90498455e-03,
         9.53403154e-06,  8.86427019e-06, -8.67853601e-07],
       [-3.68340066e-02,  4.90498455e-03,  1.63713484e-01,
         3.18760149e-04,  2.68530591e-04, -1.98821967e-05],
       [-6.77732687e-05,  9.53403154e-06,  3.18760149e-04,
         7.61133691e-07,  5.30018630e-07, -1.01311935e-07],
       [-6.10430992e-05,  8.86427019e-06,  2.68530591e-04,
         5.30018630e-07,  4.88260125e-07, -4.67850359e-08],
       [ 3.88844049e-06, -8.67853601e-07, -1.98821967e-05,
        -1.01311935e-07, -4.67850359e-08,  1.70268074e-07]])}
[[-4.35922707e+03]
 [-2.34145207e+03]
 [-5.13833289e+03]
 [-4.38319775e+00]
 [-3.13457247e+00]
 [ 5.16512496e+00]
 [ 1.00716140e-01]
 [-3.82491144e-03]
 [ 9.54352607e-01]
 [-2.81163176e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80164535e-18]]
2018-07-13 08:23:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:00
[[-4.40281925e+03]
 [-2.37266891e+03]
 [-5.08640004e+03]
 [-4.33518828e+00]
 [-3.10874256e+00]
 [ 5.22129402e+00]
 [ 1.05697741e-01]
 [-2.35681830e-03]
 [ 9.53813727e-01]
 [-2.81179314e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80185764e-18]]
[[ 7.30682589e-03 -1.58451052e-03 -3.36061948e-02 -6.05737234e-05
  -5.59251509e-05  2.77254127e-06]
 [-1.58451052e-03  4.07633000e-04  7.58206166e-03  1.49538937e-05
   1.38505926e-05 -1.31231547e-06]
 [-3.36061948e-02  7.58206166e-03  1.63338548e-01  3.20111494e-04
   2.69060376e-04 -1.76132586e-05]
 [-6.05737234e-05  1.49538937e-05  3.20111494e-04  7.80368769e-07
   5.35876479e-07 -1.00509432e-07]
 [-5.59251509e-05  1.38505926e-05  2.69060376e-04  5.35876479e-07
   5.01503828e-07 -4.60513982e-08]
 [ 2.77254127e-06 -1.31231547e-06 -1.76132586e-05 -1.00509432e-07
  -4.60513982e-08  1.80122920e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.35919403e+03],
       [-2.34145521e+03],
       [-5.13837416e+03],
       [-4.38274989e+00],
       [-3.13463313e+00],
       [ 5.16504737e+00]]), 'covar': array([[ 2.37531514e-03, -1.93104353e-04, -1.03855000e-02,
        -1.93548379e-05, -1.27950609e-05,  1.62762283e-06],
       [-1.93104353e-04,  4.04493644e-05,  9.38715261e-04,
         2.17312912e-06,  1.47744040e-06, -4.55354281e-07],
       [-1.03855000e-02,  9.38715261e-04,  4.82500407e-02,
         9.14667824e-05,  6.01221911e-05, -8.67320752e-06],
       [-1.93548379e-05,  2.17312912e-06,  9.14667824e-05,
         1.97324106e-07,  1.29138239e-07, -3.16176570e-08],
       [-1.27950609e-05,  1.47744040e-06,  6.01221911e-05,
         1.29138239e-07,  8.67034529e-08, -2.13498052e-08],
       [ 1.62762283e-06, -4.55354281e-07, -8.67320752e-06,
        -3.16176570e-08, -2.13498052e-08,  1.33097452e-08]])}
[[-4.35919403e+03]
 [-2.34145521e+03]
 [-5.13837416e+03]
 [-4.38274989e+00]
 [-3.13463313e+00]
 [ 5.16504737e+00]]
2018-07-13 08:23:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:00
[[-4.40278179e+03]
 [-2.37267269e+03]
 [-5.08644209e+03]
 [-4.33474124e+00]
 [-3.10880344e+00]
 [ 5.22121695e+00]]
[[ 2.00663884e-03 -2.86591268e-04 -9.45429624e-03 -1.75101196e-05
  -1.15574424e-05  1.28270855e-06]
 [-2.86591268e-04  7.87655606e-05  1.53476826e-03  3.48964685e-06
   2.35630503e-06 -6.63791027e-07]
 [-9.45429624e-03  1.53476826e-03  4.80797191e-02  9.18433269e-05
   6.02096384e-05 -8.38575438e-06]
 [-1.75101196e-05  3.48964685e-06  9.18433269e-05  2.00064749e-07
   1.30575894e-07 -3.14392584e-08]
 [-1.15574424e-05  2.35630503e-06  6.02096384e-05  1.30575894e-07
   8.75507984e-08 -2.12038031e-08]
 [ 1.28270855e-06 -6.63791027e-07 -8.38575438e-06 -3.14392584e-08
  -2.12038031e-08  1.33410478e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 23, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.40278179e+03],
       [-2.37267269e+03],
       [-5.08644209e+03],
       [-4.33474124e+00],
       [-3.10880344e+00],
       [ 5.22121695e+00]]), 'covar': array([[ 2.00663884e-03, -2.86591268e-04, -9.45429624e-03,
        -1.75101196e-05, -1.15574424e-05,  1.28270855e-06],
       [-2.86591268e-04,  7.87655606e-05,  1.53476826e-03,
         3.48964685e-06,  2.35630503e-06, -6.63791027e-07],
       [-9.45429624e-03,  1.53476826e-03,  4.80797191e-02,
         9.18433269e-05,  6.02096384e-05, -8.38575438e-06],
       [-1.75101196e-05,  3.48964685e-06,  9.18433269e-05,
         2.00064749e-07,  1.30575894e-07, -3.14392584e-08],
       [-1.15574424e-05,  2.35630503e-06,  6.02096384e-05,
         1.30575894e-07,  8.75507984e-08, -2.12038031e-08],
       [ 1.28270855e-06, -6.63791027e-07, -8.38575438e-06,
        -3.14392584e-08, -2.12038031e-08,  1.33410478e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.43497849e-05],
       [-3.91263058e-05],
       [-1.07895330e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 23, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.40281925e+03],
       [-2.37266891e+03],
       [-5.08640004e+03],
       [-4.33518828e+00],
       [-3.10874256e+00],
       [ 5.22129402e+00],
       [ 1.05697741e-01],
       [-2.35681830e-03],
       [ 9.53813727e-01],
       [-2.81179314e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80185764e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.30682589e-03, -1.58451052e-03, -3.36061948e-02,
        -6.05737234e-05, -5.59251509e-05,  2.77254127e-06],
       [-1.58451052e-03,  4.07633000e-04,  7.58206166e-03,
         1.49538937e-05,  1.38505926e-05, -1.31231547e-06],
       [-3.36061948e-02,  7.58206166e-03,  1.63338548e-01,
         3.20111494e-04,  2.69060376e-04, -1.76132586e-05],
       [-6.05737234e-05,  1.49538937e-05,  3.20111494e-04,
         7.80368769e-07,  5.35876479e-07, -1.00509432e-07],
       [-5.59251509e-05,  1.38505926e-05,  2.69060376e-04,
         5.35876479e-07,  5.01503828e-07, -4.60513982e-08],
       [ 2.77254127e-06, -1.31231547e-06, -1.76132586e-05,
        -1.00509432e-07, -4.60513982e-08,  1.80122920e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.39961802e-06],
       [-2.38140731e-05],
       [ 1.43843330e-01]])}}
Yi [[-0.27127639]
 [-1.3673442 ]
 [11.76677405]]
posterior
[[-4.40281925e+03]
 [-2.37266891e+03]
 [-5.08640004e+03]
 [-4.33518828e+00]
 [-3.10874256e+00]
 [ 5.22129402e+00]
 [ 1.05697741e-01]
 [-2.35681830e-03]
 [ 9.53813727e-01]
 [-2.81179314e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80185764e-18]]
[[-4.40279901e+03]
 [-2.37266988e+03]
 [-5.08650053e+03]
 [-4.33536225e+00]
 [-3.10881766e+00]
 [ 5.22126867e+00]
 [ 1.05697741e-01]
 [-2.35681830e-03]
 [ 9.53813727e-01]
 [-2.81179314e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80185764e-18]]
[[ 5.88406816e-03 -1.47347924e-03 -2.82470209e-02 -5.56220981e-05
  -5.04965213e-05  4.48536354e-06]
 [-1.47347924e-03  3.98356829e-04  7.18977097e-03  1.46785614e-05
   1.34256835e-05 -1.44535956e-06]
 [-2.82470209e-02  7.18977097e-03  1.42037302e-01  2.96683429e-04
   2.48658092e-04 -2.40884434e-05]
 [-5.56220981e-05  1.46785614e-05  2.96683429e-04  7.42665257e-07
   5.17178896e-07 -1.06570274e-07]
 [-5.04965213e-05  1.34256835e-05  2.48658092e-04  5.17178896e-07
   4.80783947e-07 -5.25838905e-08]
 [ 4.48536354e-06 -1.44535956e-06 -2.40884434e-05 -1.06570274e-07
  -5.25838905e-08  1.78059606e-07]]
[[-0.27130308]
 [-1.36733028]
 [11.8170011 ]]
[[ 2.66812980e-05]
 [-1.39175286e-05]
 [-5.02270543e-02]]


 Corrector Step
2018-07-13 08:24:00
[[-4.40279901e+03]
 [-2.37266988e+03]
 [-5.08650053e+03]
 [-4.33536225e+00]
 [-3.10881766e+00]
 [ 5.22126867e+00]
 [ 1.05697741e-01]
 [-2.35681830e-03]
 [ 9.53813727e-01]
 [-2.81179314e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80185764e-18]]
[[ 5.88406816e-03 -1.47347924e-03 -2.82470209e-02 -5.56220981e-05
  -5.04965213e-05  4.48536354e-06]
 [-1.47347924e-03  3.98356829e-04  7.18977097e-03  1.46785614e-05
   1.34256835e-05 -1.44535956e-06]
 [-2.82470209e-02  7.18977097e-03  1.42037302e-01  2.96683429e-04
   2.48658092e-04 -2.40884434e-05]
 [-5.56220981e-05  1.46785614e-05  2.96683429e-04  7.42665257e-07
   5.17178896e-07 -1.06570274e-07]
 [-5.04965213e-05  1.34256835e-05  2.48658092e-04  5.17178896e-07
   4.80783947e-07 -5.25838905e-08]
 [ 4.48536354e-06 -1.44535956e-06 -2.40884434e-05 -1.06570274e-07
  -5.25838905e-08  1.78059606e-07]]
342109866.44138867
post
cubesat_nadir
Ybar_post [[-0.27128786]
 [-1.36733094]
 [11.81716059]]
resids [[ 1.14623717e-05]
 [-1.32605798e-05]
 [-5.03865357e-02]]
posterior
[[-4.40278179e+03]
 [-2.37267269e+03]
 [-5.08644209e+03]
 [-4.33474124e+00]
 [-3.10880344e+00]
 [ 5.22121695e+00]]
[[-4.40277837e+03]
 [-2.37267331e+03]
 [-5.08647761e+03]
 [-4.33480678e+00]
 [-3.10884213e+00]
 [ 5.22122084e+00]]
[[ 1.43801365e-03 -2.84386749e-04 -7.15438900e-03 -1.46027150e-05
  -9.75062303e-06  1.92282853e-06]
 [-2.84386749e-04  7.84860651e-05  1.51705334e-03  3.45846596e-06
   2.33767833e-06 -6.62834532e-07]
 [-7.15438900e-03  1.51705334e-03  3.84912781e-02  7.94367121e-05
   5.25239389e-05 -1.08631891e-05]
 [-1.46027150e-05  3.45846596e-06  7.94367121e-05  1.83735139e-07
   1.20483066e-07 -3.44595834e-08]
 [-9.75062303e-06  2.33767833e-06  5.25239389e-05  1.20483066e-07
   8.13108282e-08 -2.30903247e-08]
 [ 1.92282853e-06 -6.62834532e-07 -1.08631891e-05 -3.44595834e-08
  -2.30903247e-08  1.25768149e-08]]
[[-0.27128139]
 [-1.36731118]
 [12.08059263]]
[[ 4.99638315e-06]
 [-3.30208173e-05]
 [-3.13818582e-01]]


 Corrector Step
2018-07-13 08:24:00
[[-4.40277837e+03]
 [-2.37267331e+03]
 [-5.08647761e+03]
 [-4.33480678e+00]
 [-3.10884213e+00]
 [ 5.22122084e+00]]
[[ 1.43801365e-03 -2.84386749e-04 -7.15438900e-03 -1.46027150e-05
  -9.75062303e-06  1.92282853e-06]
 [-2.84386749e-04  7.84860651e-05  1.51705334e-03  3.45846596e-06
   2.33767833e-06 -6.62834532e-07]
 [-7.15438900e-03  1.51705334e-03  3.84912781e-02  7.94367121e-05
   5.25239389e-05 -1.08631891e-05]
 [-1.46027150e-05  3.45846596e-06  7.94367121e-05  1.83735139e-07
   1.20483066e-07 -3.44595834e-08]
 [-9.75062303e-06  2.33767833e-06  5.25239389e-05  1.20483066e-07
   8.13108282e-08 -2.30903247e-08]
 [ 1.92282853e-06 -6.62834532e-07 -1.08631891e-05 -3.44595834e-08
  -2.30903247e-08  1.25768149e-08]]
2044842.8389314825
post
sphere_lamr_small
Ybar_post [[-0.27128033]
 [-1.36731382]
 [12.08064806]]
resids [[ 3.93379804e-06]
 [-3.03825687e-05]
 [-3.13874008e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [342109866.44138867, 2044842.8389314825]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.40279901e+03],
       [-2.37266988e+03],
       [-5.08650053e+03],
       [-4.33536225e+00],
       [-3.10881766e+00],
       [ 5.22126867e+00]]), 'est_covars': array([[ 5.88406816e-03, -1.47347924e-03, -2.82470209e-02,
        -5.56220981e-05, -5.04965213e-05,  4.48536354e-06],
       [-1.47347924e-03,  3.98356829e-04,  7.18977097e-03,
         1.46785614e-05,  1.34256835e-05, -1.44535956e-06],
       [-2.82470209e-02,  7.18977097e-03,  1.42037302e-01,
         2.96683429e-04,  2.48658092e-04, -2.40884434e-05],
       [-5.56220981e-05,  1.46785614e-05,  2.96683429e-04,
         7.42665257e-07,  5.17178896e-07, -1.06570274e-07],
       [-5.04965213e-05,  1.34256835e-05,  2.48658092e-04,
         5.17178896e-07,  4.80783947e-07, -5.25838905e-08],
       [ 4.48536354e-06, -1.44535956e-06, -2.40884434e-05,
        -1.06570274e-07, -5.25838905e-08,  1.78059606e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.40277837e+03],
       [-2.37267331e+03],
       [-5.08647761e+03],
       [-4.33480678e+00],
       [-3.10884213e+00],
       [ 5.22122084e+00]]), 'covar': array([[ 1.43801365e-03, -2.84386749e-04, -7.15438900e-03,
        -1.46027150e-05, -9.75062303e-06,  1.92282853e-06],
       [-2.84386749e-04,  7.84860651e-05,  1.51705334e-03,
         3.45846596e-06,  2.33767833e-06, -6.62834532e-07],
       [-7.15438900e-03,  1.51705334e-03,  3.84912781e-02,
         7.94367121e-05,  5.25239389e-05, -1.08631891e-05],
       [-1.46027150e-05,  3.45846596e-06,  7.94367121e-05,
         1.83735139e-07,  1.20483066e-07, -3.44595834e-08],
       [-9.75062303e-06,  2.33767833e-06,  5.25239389e-05,
         1.20483066e-07,  8.13108282e-08, -2.30903247e-08],
       [ 1.92282853e-06, -6.62834532e-07, -1.08631891e-05,
        -3.44595834e-08, -2.30903247e-08,  1.25768149e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 3.93379804e-06],
       [-3.03825687e-05],
       [-3.13874008e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.40279901e+03],
       [-2.37266988e+03],
       [-5.08650053e+03],
       [-4.33536225e+00],
       [-3.10881766e+00],
       [ 5.22126867e+00],
       [ 1.05697741e-01],
       [-2.35681830e-03],
       [ 9.53813727e-01],
       [-2.81179314e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80185764e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.88406816e-03, -1.47347924e-03, -2.82470209e-02,
        -5.56220981e-05, -5.04965213e-05,  4.48536354e-06],
       [-1.47347924e-03,  3.98356829e-04,  7.18977097e-03,
         1.46785614e-05,  1.34256835e-05, -1.44535956e-06],
       [-2.82470209e-02,  7.18977097e-03,  1.42037302e-01,
         2.96683429e-04,  2.48658092e-04, -2.40884434e-05],
       [-5.56220981e-05,  1.46785614e-05,  2.96683429e-04,
         7.42665257e-07,  5.17178896e-07, -1.06570274e-07],
       [-5.04965213e-05,  1.34256835e-05,  2.48658092e-04,
         5.17178896e-07,  4.80783947e-07, -5.25838905e-08],
       [ 4.48536354e-06, -1.44535956e-06, -2.40884434e-05,
        -1.06570274e-07, -5.25838905e-08,  1.78059606e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.14623717e-05],
       [-1.32605798e-05],
       [-5.03865357e-02]])}}
Current time:  2018-07-13 08:24:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.40279901e+03],
       [-2.37266988e+03],
       [-5.08650053e+03],
       [-4.33536225e+00],
       [-3.10881766e+00],
       [ 5.22126867e+00],
       [ 1.05697741e-01],
       [-2.35681830e-03],
       [ 9.53813727e-01],
       [-2.81179314e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80185764e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.88406816e-03, -1.47347924e-03, -2.82470209e-02,
        -5.56220981e-05, -5.04965213e-05,  4.48536354e-06],
       [-1.47347924e-03,  3.98356829e-04,  7.18977097e-03,
         1.46785614e-05,  1.34256835e-05, -1.44535956e-06],
       [-2.82470209e-02,  7.18977097e-03,  1.42037302e-01,
         2.96683429e-04,  2.48658092e-04, -2.40884434e-05],
       [-5.56220981e-05,  1.46785614e-05,  2.96683429e-04,
         7.42665257e-07,  5.17178896e-07, -1.06570274e-07],
       [-5.04965213e-05,  1.34256835e-05,  2.48658092e-04,
         5.17178896e-07,  4.80783947e-07, -5.25838905e-08],
       [ 4.48536354e-06, -1.44535956e-06, -2.40884434e-05,
        -1.06570274e-07, -5.25838905e-08,  1.78059606e-07]])}
[[-4.40279901e+03]
 [-2.37266988e+03]
 [-5.08650053e+03]
 [-4.33536225e+00]
 [-3.10881766e+00]
 [ 5.22126867e+00]
 [ 1.05697741e-01]
 [-2.35681830e-03]
 [ 9.53813727e-01]
 [-2.81179314e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80185764e-18]]
2018-07-13 08:24:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:10
[[-4.44591040e+03]
 [-2.40362758e+03]
 [-5.03400881e+03]
 [-4.28687326e+00]
 [-3.08264468e+00]
 [ 5.27687095e+00]
 [ 1.10676460e-01]
 [-8.88660909e-04]
 [ 9.53248845e-01]
 [-2.81187787e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80206992e-18]]
[[ 4.84261166e-03 -1.78005126e-03 -2.52357224e-02 -4.84915944e-05
  -4.54580850e-05  3.33688688e-06]
 [-1.78005126e-03  7.15802101e-04  9.66098638e-03  2.00006629e-05
   1.83492751e-05 -1.93966881e-06]
 [-2.52357224e-02  9.66098638e-03  1.41579216e-01  2.97687961e-04
   2.49000544e-04 -2.17799228e-05]
 [-4.84915944e-05  2.00006629e-05  2.97687961e-04  7.61335439e-07
   5.22652405e-07 -1.05849653e-07]
 [-4.54580850e-05  1.83492751e-05  2.49000544e-04  5.22652405e-07
   4.93789209e-07 -5.18910694e-08]
 [ 3.33688688e-06 -1.93966881e-06 -2.17799228e-05 -1.05849653e-07
  -5.18910694e-08  1.87887099e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.40277837e+03],
       [-2.37267331e+03],
       [-5.08647761e+03],
       [-4.33480678e+00],
       [-3.10884213e+00],
       [ 5.22122084e+00]]), 'covar': array([[ 1.43801365e-03, -2.84386749e-04, -7.15438900e-03,
        -1.46027150e-05, -9.75062303e-06,  1.92282853e-06],
       [-2.84386749e-04,  7.84860651e-05,  1.51705334e-03,
         3.45846596e-06,  2.33767833e-06, -6.62834532e-07],
       [-7.15438900e-03,  1.51705334e-03,  3.84912781e-02,
         7.94367121e-05,  5.25239389e-05, -1.08631891e-05],
       [-1.46027150e-05,  3.45846596e-06,  7.94367121e-05,
         1.83735139e-07,  1.20483066e-07, -3.44595834e-08],
       [-9.75062303e-06,  2.33767833e-06,  5.25239389e-05,
         1.20483066e-07,  8.13108282e-08, -2.30903247e-08],
       [ 1.92282853e-06, -6.62834532e-07, -1.08631891e-05,
        -3.44595834e-08, -2.30903247e-08,  1.25768149e-08]])}
[[-4.40277837e+03]
 [-2.37267331e+03]
 [-5.08647761e+03]
 [-4.33480678e+00]
 [-3.10884213e+00]
 [ 5.22122084e+00]]
2018-07-13 08:24:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:10
[[-4.44588409e+03]
 [-2.40363109e+03]
 [-5.03398651e+03]
 [-4.28631741e+00]
 [-3.08266864e+00]
 [ 5.27682349e+00]]
[[ 1.16373920e-03 -3.35208937e-04 -6.34117307e-03 -1.28508220e-05
  -8.58096745e-06  1.55702431e-06]
 [-3.35208937e-04  1.33527090e-04  2.03471679e-03  4.69556888e-06
   3.16560635e-06 -8.86862304e-07]
 [-6.34117307e-03  2.03471679e-03  3.82770603e-02  7.96496719e-05
   5.25349366e-05 -1.06046370e-05]
 [-1.28508220e-05  4.69556888e-06  7.96496719e-05  1.86148888e-07
   1.21745888e-07 -3.43355502e-08]
 [-8.58096745e-06  3.16560635e-06  5.25349366e-05  1.21745888e-07
   8.20671378e-08 -2.29715842e-08]
 [ 1.55702431e-06 -8.86862304e-07 -1.06046370e-05 -3.43355502e-08
  -2.29715842e-08  1.25939336e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.44588409e+03],
       [-2.40363109e+03],
       [-5.03398651e+03],
       [-4.28631741e+00],
       [-3.08266864e+00],
       [ 5.27682349e+00]]), 'covar': array([[ 1.16373920e-03, -3.35208937e-04, -6.34117307e-03,
        -1.28508220e-05, -8.58096745e-06,  1.55702431e-06],
       [-3.35208937e-04,  1.33527090e-04,  2.03471679e-03,
         4.69556888e-06,  3.16560635e-06, -8.86862304e-07],
       [-6.34117307e-03,  2.03471679e-03,  3.82770603e-02,
         7.96496719e-05,  5.25349366e-05, -1.06046370e-05],
       [-1.28508220e-05,  4.69556888e-06,  7.96496719e-05,
         1.86148888e-07,  1.21745888e-07, -3.43355502e-08],
       [-8.58096745e-06,  3.16560635e-06,  5.25349366e-05,
         1.21745888e-07,  8.20671378e-08, -2.29715842e-08],
       [ 1.55702431e-06, -8.86862304e-07, -1.06046370e-05,
        -3.43355502e-08, -2.29715842e-08,  1.25939336e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 3.93379804e-06],
       [-3.03825687e-05],
       [-3.13874008e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.44591040e+03],
       [-2.40362758e+03],
       [-5.03400881e+03],
       [-4.28687326e+00],
       [-3.08264468e+00],
       [ 5.27687095e+00],
       [ 1.10676460e-01],
       [-8.88660909e-04],
       [ 9.53248845e-01],
       [-2.81187787e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80206992e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.84261166e-03, -1.78005126e-03, -2.52357224e-02,
        -4.84915944e-05, -4.54580850e-05,  3.33688688e-06],
       [-1.78005126e-03,  7.15802101e-04,  9.66098638e-03,
         2.00006629e-05,  1.83492751e-05, -1.93966881e-06],
       [-2.52357224e-02,  9.66098638e-03,  1.41579216e-01,
         2.97687961e-04,  2.49000544e-04, -2.17799228e-05],
       [-4.84915944e-05,  2.00006629e-05,  2.97687961e-04,
         7.61335439e-07,  5.22652405e-07, -1.05849653e-07],
       [-4.54580850e-05,  1.83492751e-05,  2.49000544e-04,
         5.22652405e-07,  4.93789209e-07, -5.18910694e-08],
       [ 3.33688688e-06, -1.93966881e-06, -2.17799228e-05,
        -1.05849653e-07, -5.18910694e-08,  1.87887099e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.14623717e-05],
       [-1.32605798e-05],
       [-5.03865357e-02]])}}
Yi [[-0.41886411]
 [-1.38273964]
 [11.74970826]]
posterior
[[-4.44591040e+03]
 [-2.40362758e+03]
 [-5.03400881e+03]
 [-4.28687326e+00]
 [-3.08264468e+00]
 [ 5.27687095e+00]
 [ 1.10676460e-01]
 [-8.88660909e-04]
 [ 9.53248845e-01]
 [-2.81187787e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80206992e-18]]
[[-4.44593667e+03]
 [-2.40362241e+03]
 [-5.03387206e+03]
 [-4.28665468e+00]
 [-3.08251118e+00]
 [ 5.27690522e+00]
 [ 1.10676460e-01]
 [-8.88660909e-04]
 [ 9.53248845e-01]
 [-2.81187787e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80206992e-18]]
[[ 3.81349129e-03 -1.56936678e-03 -2.10609995e-02 -4.46881191e-05
  -4.03006768e-05  4.57011047e-06]
 [-1.56936678e-03  6.72618728e-04  8.81405633e-03  1.92531524e-05
   1.72940062e-05 -2.19146577e-06]
 [-2.10609995e-02  8.81405633e-03  1.23341359e-01  2.77001310e-04
   2.27959344e-04 -2.68849531e-05]
 [-4.46881191e-05  1.92531524e-05  2.77001310e-04  7.26059418e-07
   5.03106973e-07 -1.10819873e-07]
 [-4.03006768e-05  1.72940062e-05  2.27959344e-04  5.03106973e-07
   4.67928488e-07 -5.80791099e-08]
 [ 4.57011047e-06 -2.19146577e-06 -2.68849531e-05 -1.10819873e-07
  -5.80791099e-08  1.86400498e-07]]
[[-0.41882649]
 [-1.38275573]
 [11.70349455]]
[[-3.76184768e-05]
 [ 1.60815936e-05]
 [ 4.62137064e-02]]


 Corrector Step
2018-07-13 08:24:10
[[-4.44593667e+03]
 [-2.40362241e+03]
 [-5.03387206e+03]
 [-4.28665468e+00]
 [-3.08251118e+00]
 [ 5.27690522e+00]
 [ 1.10676460e-01]
 [-8.88660909e-04]
 [ 9.53248845e-01]
 [-2.81187787e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80206992e-18]]
[[ 3.81349129e-03 -1.56936678e-03 -2.10609995e-02 -4.46881191e-05
  -4.03006768e-05  4.57011047e-06]
 [-1.56936678e-03  6.72618728e-04  8.81405633e-03  1.92531524e-05
   1.72940062e-05 -2.19146577e-06]
 [-2.10609995e-02  8.81405633e-03  1.23341359e-01  2.77001310e-04
   2.27959344e-04 -2.68849531e-05]
 [-4.46881191e-05  1.92531524e-05  2.77001310e-04  7.26059418e-07
   5.03106973e-07 -1.10819873e-07]
 [-4.03006768e-05  1.72940062e-05  2.27959344e-04  5.03106973e-07
   4.67928488e-07 -5.80791099e-08]
 [ 4.57011047e-06 -2.19146577e-06 -2.68849531e-05 -1.10819873e-07
  -5.80791099e-08  1.86400498e-07]]
255242609.65801322
post
cubesat_nadir
Ybar_post [[-0.41884926]
 [-1.38275583]
 [11.70327299]]
resids [[-1.48462892e-05]
 [ 1.61838221e-05]
 [ 4.64352611e-02]]
posterior
[[-4.44588409e+03]
 [-2.40363109e+03]
 [-5.03398651e+03]
 [-4.28631741e+00]
 [-3.08266864e+00]
 [ 5.27682349e+00]]
[[-4.44591461e+03]
 [-2.40362847e+03]
 [-5.03385594e+03]
 [-4.28614792e+00]
 [-3.08256020e+00]
 [ 5.27685575e+00]]
[[ 8.69261088e-04 -3.09042636e-04 -5.05010390e-03 -1.11494846e-05
  -7.49821791e-06  1.86078978e-06]
 [-3.09042636e-04  1.30682455e-04  1.90739690e-03  4.51515074e-06
   3.05255475e-06 -9.09011730e-07]
 [-5.05010390e-03  1.90739690e-03  3.23109688e-02  7.14811684e-05
   4.73793404e-05 -1.18190250e-05]
 [-1.11494846e-05  4.51515074e-06  7.14811684e-05  1.74673222e-07
   1.14542249e-07 -3.58180575e-08]
 [-7.49821791e-06  3.05255475e-06  4.73793404e-05  1.14542249e-07
   7.75400193e-08 -2.39315425e-08]
 [ 1.86078978e-06 -9.09011730e-07 -1.18190250e-05 -3.58180575e-08
  -2.39315425e-08  1.22354606e-08]]
[[-0.41879793]
 [-1.38273495]
 [11.9790647 ]]
[[-6.61765522e-05]
 [-4.69062510e-06]
 [-2.29356448e-01]]


 Corrector Step
2018-07-13 08:24:10
[[-4.44591461e+03]
 [-2.40362847e+03]
 [-5.03385594e+03]
 [-4.28614792e+00]
 [-3.08256020e+00]
 [ 5.27685575e+00]]
[[ 8.69261088e-04 -3.09042636e-04 -5.05010390e-03 -1.11494846e-05
  -7.49821791e-06  1.86078978e-06]
 [-3.09042636e-04  1.30682455e-04  1.90739690e-03  4.51515074e-06
   3.05255475e-06 -9.09011730e-07]
 [-5.05010390e-03  1.90739690e-03  3.23109688e-02  7.14811684e-05
   4.73793404e-05 -1.18190250e-05]
 [-1.11494846e-05  4.51515074e-06  7.14811684e-05  1.74673222e-07
   1.14542249e-07 -3.58180575e-08]
 [-7.49821791e-06  3.05255475e-06  4.73793404e-05  1.14542249e-07
   7.75400193e-08 -2.39315425e-08]
 [ 1.86078978e-06 -9.09011730e-07 -1.18190250e-05 -3.58180575e-08
  -2.39315425e-08  1.22354606e-08]]
10030102.773693861
post
sphere_lamr_small
Ybar_post [[-0.41883616]
 [-1.38273784]
 [11.97885451]]
resids [[-2.79488130e-05]
 [-1.80699943e-06]
 [-2.29146253e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [255242609.65801322, 10030102.773693861]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.44593667e+03],
       [-2.40362241e+03],
       [-5.03387206e+03],
       [-4.28665468e+00],
       [-3.08251118e+00],
       [ 5.27690522e+00]]), 'est_covars': array([[ 3.81349129e-03, -1.56936678e-03, -2.10609995e-02,
        -4.46881191e-05, -4.03006768e-05,  4.57011047e-06],
       [-1.56936678e-03,  6.72618728e-04,  8.81405633e-03,
         1.92531524e-05,  1.72940062e-05, -2.19146577e-06],
       [-2.10609995e-02,  8.81405633e-03,  1.23341359e-01,
         2.77001310e-04,  2.27959344e-04, -2.68849531e-05],
       [-4.46881191e-05,  1.92531524e-05,  2.77001310e-04,
         7.26059418e-07,  5.03106973e-07, -1.10819873e-07],
       [-4.03006768e-05,  1.72940062e-05,  2.27959344e-04,
         5.03106973e-07,  4.67928488e-07, -5.80791099e-08],
       [ 4.57011047e-06, -2.19146577e-06, -2.68849531e-05,
        -1.10819873e-07, -5.80791099e-08,  1.86400498e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.44591461e+03],
       [-2.40362847e+03],
       [-5.03385594e+03],
       [-4.28614792e+00],
       [-3.08256020e+00],
       [ 5.27685575e+00]]), 'covar': array([[ 8.69261088e-04, -3.09042636e-04, -5.05010390e-03,
        -1.11494846e-05, -7.49821791e-06,  1.86078978e-06],
       [-3.09042636e-04,  1.30682455e-04,  1.90739690e-03,
         4.51515074e-06,  3.05255475e-06, -9.09011730e-07],
       [-5.05010390e-03,  1.90739690e-03,  3.23109688e-02,
         7.14811684e-05,  4.73793404e-05, -1.18190250e-05],
       [-1.11494846e-05,  4.51515074e-06,  7.14811684e-05,
         1.74673222e-07,  1.14542249e-07, -3.58180575e-08],
       [-7.49821791e-06,  3.05255475e-06,  4.73793404e-05,
         1.14542249e-07,  7.75400193e-08, -2.39315425e-08],
       [ 1.86078978e-06, -9.09011730e-07, -1.18190250e-05,
        -3.58180575e-08, -2.39315425e-08,  1.22354606e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.79488130e-05],
       [-1.80699943e-06],
       [-2.29146253e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.44593667e+03],
       [-2.40362241e+03],
       [-5.03387206e+03],
       [-4.28665468e+00],
       [-3.08251118e+00],
       [ 5.27690522e+00],
       [ 1.10676460e-01],
       [-8.88660909e-04],
       [ 9.53248845e-01],
       [-2.81187787e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80206992e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.81349129e-03, -1.56936678e-03, -2.10609995e-02,
        -4.46881191e-05, -4.03006768e-05,  4.57011047e-06],
       [-1.56936678e-03,  6.72618728e-04,  8.81405633e-03,
         1.92531524e-05,  1.72940062e-05, -2.19146577e-06],
       [-2.10609995e-02,  8.81405633e-03,  1.23341359e-01,
         2.77001310e-04,  2.27959344e-04, -2.68849531e-05],
       [-4.46881191e-05,  1.92531524e-05,  2.77001310e-04,
         7.26059418e-07,  5.03106973e-07, -1.10819873e-07],
       [-4.03006768e-05,  1.72940062e-05,  2.27959344e-04,
         5.03106973e-07,  4.67928488e-07, -5.80791099e-08],
       [ 4.57011047e-06, -2.19146577e-06, -2.68849531e-05,
        -1.10819873e-07, -5.80791099e-08,  1.86400498e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.48462892e-05],
       [ 1.61838221e-05],
       [ 4.64352611e-02]])}}
Current time:  2018-07-13 08:24:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.44593667e+03],
       [-2.40362241e+03],
       [-5.03387206e+03],
       [-4.28665468e+00],
       [-3.08251118e+00],
       [ 5.27690522e+00],
       [ 1.10676460e-01],
       [-8.88660909e-04],
       [ 9.53248845e-01],
       [-2.81187787e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80206992e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.81349129e-03, -1.56936678e-03, -2.10609995e-02,
        -4.46881191e-05, -4.03006768e-05,  4.57011047e-06],
       [-1.56936678e-03,  6.72618728e-04,  8.81405633e-03,
         1.92531524e-05,  1.72940062e-05, -2.19146577e-06],
       [-2.10609995e-02,  8.81405633e-03,  1.23341359e-01,
         2.77001310e-04,  2.27959344e-04, -2.68849531e-05],
       [-4.46881191e-05,  1.92531524e-05,  2.77001310e-04,
         7.26059418e-07,  5.03106973e-07, -1.10819873e-07],
       [-4.03006768e-05,  1.72940062e-05,  2.27959344e-04,
         5.03106973e-07,  4.67928488e-07, -5.80791099e-08],
       [ 4.57011047e-06, -2.19146577e-06, -2.68849531e-05,
        -1.10819873e-07, -5.80791099e-08,  1.86400498e-07]])}
[[-4.44593667e+03]
 [-2.40362241e+03]
 [-5.03387206e+03]
 [-4.28665468e+00]
 [-3.08251118e+00]
 [ 5.27690522e+00]
 [ 1.10676460e-01]
 [-8.88660909e-04]
 [ 9.53248845e-01]
 [-2.81187787e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80206992e-18]]
2018-07-13 08:24:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:20
[[-4.48855895e+03]
 [-2.43431510e+03]
 [-4.98082710e+03]
 [-4.23768817e+00]
 [-3.05599619e+00]
 [ 5.33193473e+00]
 [ 1.15652162e-01]
 [ 5.79520711e-04]
 [ 9.52657974e-01]
 [-2.81188594e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80228221e-18]]
[[ 2.98990786e-03 -1.72930786e-03 -1.82477038e-02 -3.76262290e-05
  -3.53626774e-05  3.39702888e-06]
 [-1.72930786e-03  1.06627461e-03  1.10700078e-02  2.44562986e-05
   2.20972948e-05 -2.73368061e-06]
 [-1.82477038e-02  1.10700078e-02  1.22827165e-01  2.77709287e-04
   2.28137955e-04 -2.45261927e-05]
 [-3.76262290e-05  2.44562986e-05  2.77709287e-04  7.44234700e-07
   5.08201674e-07 -1.10156633e-07]
 [-3.53626774e-05  2.20972948e-05  2.28137955e-04  5.08201674e-07
   4.80692728e-07 -5.74200374e-08]
 [ 3.39702888e-06 -2.73368061e-06 -2.45261927e-05 -1.10156633e-07
  -5.74200374e-08  1.96204330e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.44591461e+03],
       [-2.40362847e+03],
       [-5.03385594e+03],
       [-4.28614792e+00],
       [-3.08256020e+00],
       [ 5.27685575e+00]]), 'covar': array([[ 8.69261088e-04, -3.09042636e-04, -5.05010390e-03,
        -1.11494846e-05, -7.49821791e-06,  1.86078978e-06],
       [-3.09042636e-04,  1.30682455e-04,  1.90739690e-03,
         4.51515074e-06,  3.05255475e-06, -9.09011730e-07],
       [-5.05010390e-03,  1.90739690e-03,  3.23109688e-02,
         7.14811684e-05,  4.73793404e-05, -1.18190250e-05],
       [-1.11494846e-05,  4.51515074e-06,  7.14811684e-05,
         1.74673222e-07,  1.14542249e-07, -3.58180575e-08],
       [-7.49821791e-06,  3.05255475e-06,  4.73793404e-05,
         1.14542249e-07,  7.75400193e-08, -2.39315425e-08],
       [ 1.86078978e-06, -9.09011730e-07, -1.18190250e-05,
        -3.58180575e-08, -2.39315425e-08,  1.22354606e-08]])}
[[-4.44591461e+03]
 [-2.40362847e+03]
 [-5.03385594e+03]
 [-4.28614792e+00]
 [-3.08256020e+00]
 [ 5.27685575e+00]]
2018-07-13 08:24:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:20
[[-4.48853149e+03]
 [-2.43432168e+03]
 [-4.98081182e+03]
 [-4.23718098e+00]
 [-3.05604492e+00]
 [ 5.33188549e+00]]
[[ 6.63173652e-04 -3.27335266e-04 -4.31802055e-03 -9.46031823e-06
  -6.37615559e-06  1.48663032e-06]
 [-3.27335266e-04  1.99667028e-04  2.37074831e-03  5.69780003e-06
   3.84478397e-06 -1.13992726e-06]
 [-4.31802055e-03  2.37074831e-03  3.20770206e-02  7.15953493e-05
   4.73448230e-05 -1.15769267e-05]
 [-9.46031823e-06  5.69780003e-06  7.15953493e-05  1.76875689e-07
   1.15690578e-07 -3.57213111e-08]
 [-6.37615559e-06  3.84478397e-06  4.73448230e-05  1.15690578e-07
   7.82360813e-08 -2.38265344e-08]
 [ 1.48663032e-06 -1.13992726e-06 -1.15769267e-05 -3.57213111e-08
  -2.38265344e-08  1.22441361e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.48853149e+03],
       [-2.43432168e+03],
       [-4.98081182e+03],
       [-4.23718098e+00],
       [-3.05604492e+00],
       [ 5.33188549e+00]]), 'covar': array([[ 6.63173652e-04, -3.27335266e-04, -4.31802055e-03,
        -9.46031823e-06, -6.37615559e-06,  1.48663032e-06],
       [-3.27335266e-04,  1.99667028e-04,  2.37074831e-03,
         5.69780003e-06,  3.84478397e-06, -1.13992726e-06],
       [-4.31802055e-03,  2.37074831e-03,  3.20770206e-02,
         7.15953493e-05,  4.73448230e-05, -1.15769267e-05],
       [-9.46031823e-06,  5.69780003e-06,  7.15953493e-05,
         1.76875689e-07,  1.15690578e-07, -3.57213111e-08],
       [-6.37615559e-06,  3.84478397e-06,  4.73448230e-05,
         1.15690578e-07,  7.82360813e-08, -2.38265344e-08],
       [ 1.48663032e-06, -1.13992726e-06, -1.15769267e-05,
        -3.57213111e-08, -2.38265344e-08,  1.22441361e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.79488130e-05],
       [-1.80699943e-06],
       [-2.29146253e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.48855895e+03],
       [-2.43431510e+03],
       [-4.98082710e+03],
       [-4.23768817e+00],
       [-3.05599619e+00],
       [ 5.33193473e+00],
       [ 1.15652162e-01],
       [ 5.79520711e-04],
       [ 9.52657974e-01],
       [-2.81188594e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80228221e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.98990786e-03, -1.72930786e-03, -1.82477038e-02,
        -3.76262290e-05, -3.53626774e-05,  3.39702888e-06],
       [-1.72930786e-03,  1.06627461e-03,  1.10700078e-02,
         2.44562986e-05,  2.20972948e-05, -2.73368061e-06],
       [-1.82477038e-02,  1.10700078e-02,  1.22827165e-01,
         2.77709287e-04,  2.28137955e-04, -2.45261927e-05],
       [-3.76262290e-05,  2.44562986e-05,  2.77709287e-04,
         7.44234700e-07,  5.08201674e-07, -1.10156633e-07],
       [-3.53626774e-05,  2.20972948e-05,  2.28137955e-04,
         5.08201674e-07,  4.80692728e-07, -5.74200374e-08],
       [ 3.39702888e-06, -2.73368061e-06, -2.45261927e-05,
        -1.10156633e-07, -5.74200374e-08,  1.96204330e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.48462892e-05],
       [ 1.61838221e-05],
       [ 4.64352611e-02]])}}
Yi [[-0.60121783]
 [-1.39395522]
 [11.60596658]]
posterior
[[-4.48855895e+03]
 [-2.43431510e+03]
 [-4.98082710e+03]
 [-4.23768817e+00]
 [-3.05599619e+00]
 [ 5.33193473e+00]
 [ 1.15652162e-01]
 [ 5.79520711e-04]
 [ 9.52657974e-01]
 [-2.81188594e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80228221e-18]]
[[-4.48852229e+03]
 [-2.43432873e+03]
 [-4.98098752e+03]
 [-4.23782550e+00]
 [-3.05624173e+00]
 [ 5.33188956e+00]
 [ 1.15652162e-01]
 [ 5.79520711e-04]
 [ 9.52657974e-01]
 [-2.81188594e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80228221e-18]]
[[ 2.29502106e-03 -1.47033979e-03 -1.51444634e-02 -3.47884946e-05
  -3.06993820e-05  4.26445769e-06]
 [-1.47033979e-03  9.69538989e-04  9.89484567e-03  2.33280886e-05
   2.03549973e-05 -3.05936695e-06]
 [-1.51444634e-02  9.89484567e-03  1.07389505e-01  2.59060394e-04
   2.06948682e-04 -2.86089987e-05]
 [-3.47884946e-05  2.33280886e-05  2.59060394e-04  7.10029801e-07
   4.87779930e-07 -1.14489345e-07]
 [-3.06993820e-05  2.03549973e-05  2.06948682e-04  4.87779930e-07
   4.49311645e-07 -6.32880338e-08]
 [ 4.26445769e-06 -3.05936695e-06 -2.86089987e-05 -1.14489345e-07
  -6.32880338e-08  1.95093100e-07]]
[[-0.60127682]
 [-1.39396459]
 [11.58717728]]
[[5.89971768e-05]
 [9.36452394e-06]
 [1.87893070e-02]]


 Corrector Step
2018-07-13 08:24:20
[[-4.48852229e+03]
 [-2.43432873e+03]
 [-4.98098752e+03]
 [-4.23782550e+00]
 [-3.05624173e+00]
 [ 5.33188956e+00]
 [ 1.15652162e-01]
 [ 5.79520711e-04]
 [ 9.52657974e-01]
 [-2.81188594e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80228221e-18]]
[[ 2.29502106e-03 -1.47033979e-03 -1.51444634e-02 -3.47884946e-05
  -3.06993820e-05  4.26445769e-06]
 [-1.47033979e-03  9.69538989e-04  9.89484567e-03  2.33280886e-05
   2.03549973e-05 -3.05936695e-06]
 [-1.51444634e-02  9.89484567e-03  1.07389505e-01  2.59060394e-04
   2.06948682e-04 -2.86089987e-05]
 [-3.47884946e-05  2.33280886e-05  2.59060394e-04  7.10029801e-07
   4.87779930e-07 -1.14489345e-07]
 [-3.06993820e-05  2.03549973e-05  2.06948682e-04  4.87779930e-07
   4.49311645e-07 -6.32880338e-08]
 [ 4.26445769e-06 -3.05936695e-06 -2.86089987e-05 -1.14489345e-07
  -6.32880338e-08  1.95093100e-07]]
206847893.1531555
post
cubesat_nadir
Ybar_post [[-0.60123672]
 [-1.39395776]
 [11.5874402 ]]
resids [[1.88937653e-05]
 [2.53569710e-06]
 [1.85263788e-02]]
posterior
[[-4.48853149e+03]
 [-2.43432168e+03]
 [-4.98081182e+03]
 [-4.23718098e+00]
 [-3.05604492e+00]
 [ 5.33188549e+00]]
[[-4.48852548e+03]
 [-2.43432326e+03]
 [-4.98084840e+03]
 [-4.23723809e+00]
 [-3.05608090e+00]
 [ 5.33188250e+00]]
[[ 5.14060931e-04 -2.96725862e-04 -3.59686338e-03 -8.46414914e-06
  -5.71765697e-06  1.61611878e-06]
 [-2.96725862e-04  1.92477951e-04  2.20500704e-03  5.45157906e-06
   3.68596237e-06 -1.16005597e-06]
 [-3.59686338e-03  2.20500704e-03  2.82430976e-02  6.59616741e-05
   4.36978032e-05 -1.20770662e-05]
 [-8.46414914e-06  5.45157906e-06  6.59616741e-05  1.68297660e-07
   1.10201734e-07 -3.62891099e-08]
 [-5.71765697e-06  3.68596237e-06  4.36978032e-05  1.10201734e-07
   7.47106267e-08 -2.42299149e-08]
 [ 1.61611878e-06 -1.16005597e-06 -1.20770662e-05 -3.62891099e-08
  -2.42299149e-08  1.20857150e-08]]
[[-0.60123416]
 [-1.39394325]
 [11.87498903]]
[[ 1.63351523e-05]
 [-1.19739389e-05]
 [-2.69022449e-01]]


 Corrector Step
2018-07-13 08:24:20
[[-4.48852548e+03]
 [-2.43432326e+03]
 [-4.98084840e+03]
 [-4.23723809e+00]
 [-3.05608090e+00]
 [ 5.33188250e+00]]
[[ 5.14060931e-04 -2.96725862e-04 -3.59686338e-03 -8.46414914e-06
  -5.71765697e-06  1.61611878e-06]
 [-2.96725862e-04  1.92477951e-04  2.20500704e-03  5.45157906e-06
   3.68596237e-06 -1.16005597e-06]
 [-3.59686338e-03  2.20500704e-03  2.82430976e-02  6.59616741e-05
   4.36978032e-05 -1.20770662e-05]
 [-8.46414914e-06  5.45157906e-06  6.59616741e-05  1.68297660e-07
   1.10201734e-07 -3.62891099e-08]
 [-5.71765697e-06  3.68596237e-06  4.36978032e-05  1.10201734e-07
   7.47106267e-08 -2.42299149e-08]
 [ 1.61611878e-06 -1.16005597e-06 -1.20770662e-05 -3.62891099e-08
  -2.42299149e-08  1.20857150e-08]]
14735911.147661075
post
sphere_lamr_small
Ybar_post [[-0.6012253 ]
 [-1.39394376]
 [11.87505044]]
resids [[ 7.47083172e-06]
 [-1.14641404e-05]
 [-2.69083853e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [206847893.1531555, 14735911.147661075]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.48852229e+03],
       [-2.43432873e+03],
       [-4.98098752e+03],
       [-4.23782550e+00],
       [-3.05624173e+00],
       [ 5.33188956e+00]]), 'est_covars': array([[ 2.29502106e-03, -1.47033979e-03, -1.51444634e-02,
        -3.47884946e-05, -3.06993820e-05,  4.26445769e-06],
       [-1.47033979e-03,  9.69538989e-04,  9.89484567e-03,
         2.33280886e-05,  2.03549973e-05, -3.05936695e-06],
       [-1.51444634e-02,  9.89484567e-03,  1.07389505e-01,
         2.59060394e-04,  2.06948682e-04, -2.86089987e-05],
       [-3.47884946e-05,  2.33280886e-05,  2.59060394e-04,
         7.10029801e-07,  4.87779930e-07, -1.14489345e-07],
       [-3.06993820e-05,  2.03549973e-05,  2.06948682e-04,
         4.87779930e-07,  4.49311645e-07, -6.32880338e-08],
       [ 4.26445769e-06, -3.05936695e-06, -2.86089987e-05,
        -1.14489345e-07, -6.32880338e-08,  1.95093100e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.48852548e+03],
       [-2.43432326e+03],
       [-4.98084840e+03],
       [-4.23723809e+00],
       [-3.05608090e+00],
       [ 5.33188250e+00]]), 'covar': array([[ 5.14060931e-04, -2.96725862e-04, -3.59686338e-03,
        -8.46414914e-06, -5.71765697e-06,  1.61611878e-06],
       [-2.96725862e-04,  1.92477951e-04,  2.20500704e-03,
         5.45157906e-06,  3.68596237e-06, -1.16005597e-06],
       [-3.59686338e-03,  2.20500704e-03,  2.82430976e-02,
         6.59616741e-05,  4.36978032e-05, -1.20770662e-05],
       [-8.46414914e-06,  5.45157906e-06,  6.59616741e-05,
         1.68297660e-07,  1.10201734e-07, -3.62891099e-08],
       [-5.71765697e-06,  3.68596237e-06,  4.36978032e-05,
         1.10201734e-07,  7.47106267e-08, -2.42299149e-08],
       [ 1.61611878e-06, -1.16005597e-06, -1.20770662e-05,
        -3.62891099e-08, -2.42299149e-08,  1.20857150e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 7.47083172e-06],
       [-1.14641404e-05],
       [-2.69083853e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.48852229e+03],
       [-2.43432873e+03],
       [-4.98098752e+03],
       [-4.23782550e+00],
       [-3.05624173e+00],
       [ 5.33188956e+00],
       [ 1.15652162e-01],
       [ 5.79520711e-04],
       [ 9.52657974e-01],
       [-2.81188594e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80228221e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.29502106e-03, -1.47033979e-03, -1.51444634e-02,
        -3.47884946e-05, -3.06993820e-05,  4.26445769e-06],
       [-1.47033979e-03,  9.69538989e-04,  9.89484567e-03,
         2.33280886e-05,  2.03549973e-05, -3.05936695e-06],
       [-1.51444634e-02,  9.89484567e-03,  1.07389505e-01,
         2.59060394e-04,  2.06948682e-04, -2.86089987e-05],
       [-3.47884946e-05,  2.33280886e-05,  2.59060394e-04,
         7.10029801e-07,  4.87779930e-07, -1.14489345e-07],
       [-3.06993820e-05,  2.03549973e-05,  2.06948682e-04,
         4.87779930e-07,  4.49311645e-07, -6.32880338e-08],
       [ 4.26445769e-06, -3.05936695e-06, -2.86089987e-05,
        -1.14489345e-07, -6.32880338e-08,  1.95093100e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.88937653e-05],
       [2.53569710e-06],
       [1.85263788e-02]])}}
Current time:  2018-07-13 08:24:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.48852229e+03],
       [-2.43432873e+03],
       [-4.98098752e+03],
       [-4.23782550e+00],
       [-3.05624173e+00],
       [ 5.33188956e+00],
       [ 1.15652162e-01],
       [ 5.79520711e-04],
       [ 9.52657974e-01],
       [-2.81188594e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80228221e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.29502106e-03, -1.47033979e-03, -1.51444634e-02,
        -3.47884946e-05, -3.06993820e-05,  4.26445769e-06],
       [-1.47033979e-03,  9.69538989e-04,  9.89484567e-03,
         2.33280886e-05,  2.03549973e-05, -3.05936695e-06],
       [-1.51444634e-02,  9.89484567e-03,  1.07389505e-01,
         2.59060394e-04,  2.06948682e-04, -2.86089987e-05],
       [-3.47884946e-05,  2.33280886e-05,  2.59060394e-04,
         7.10029801e-07,  4.87779930e-07, -1.14489345e-07],
       [-3.06993820e-05,  2.03549973e-05,  2.06948682e-04,
         4.87779930e-07,  4.49311645e-07, -6.32880338e-08],
       [ 4.26445769e-06, -3.05936695e-06, -2.86089987e-05,
        -1.14489345e-07, -6.32880338e-08,  1.95093100e-07]])}
[[-4.48852229e+03]
 [-2.43432873e+03]
 [-4.98098752e+03]
 [-4.23782550e+00]
 [-3.05624173e+00]
 [ 5.33188956e+00]
 [ 1.15652162e-01]
 [ 5.79520711e-04]
 [ 9.52657974e-01]
 [-2.81188594e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80228221e-18]]
2018-07-13 08:24:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:30
[[-4.53065353e+03]
 [-2.46475707e+03]
 [-4.92739586e+03]
 [-4.18839039e+00]
 [-3.02938927e+00]
 [ 5.38633971e+00]
 [ 1.20624712e-01]
 [ 2.04768653e-03]
 [ 9.52041132e-01]
 [-2.81181736e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80249450e-18]]
[[ 1.66877152e-03 -1.49468135e-03 -1.25149223e-02 -2.78059010e-05
  -2.58819762e-05  3.07075264e-06]
 [-1.49468135e-03  1.42259521e-03  1.19309646e-02  2.83924917e-05
   2.49774084e-05 -3.64730238e-06]
 [-1.25149223e-02  1.19309646e-02  1.06841219e-01  2.59514970e-04
   2.06984087e-04 -2.61922784e-05]
 [-2.78059010e-05  2.83924917e-05  2.59514970e-04  7.27759958e-07
   4.92501788e-07 -1.13866189e-07]
 [-2.58819762e-05  2.49774084e-05  2.06984087e-04  4.92501788e-07
   4.61837823e-07 -6.26585958e-08]
 [ 3.07075264e-06 -3.64730238e-06 -2.61922784e-05 -1.13866189e-07
  -6.26585958e-08  2.04874307e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.48852548e+03],
       [-2.43432326e+03],
       [-4.98084840e+03],
       [-4.23723809e+00],
       [-3.05608090e+00],
       [ 5.33188250e+00]]), 'covar': array([[ 5.14060931e-04, -2.96725862e-04, -3.59686338e-03,
        -8.46414914e-06, -5.71765697e-06,  1.61611878e-06],
       [-2.96725862e-04,  1.92477951e-04,  2.20500704e-03,
         5.45157906e-06,  3.68596237e-06, -1.16005597e-06],
       [-3.59686338e-03,  2.20500704e-03,  2.82430976e-02,
         6.59616741e-05,  4.36978032e-05, -1.20770662e-05],
       [-8.46414914e-06,  5.45157906e-06,  6.59616741e-05,
         1.68297660e-07,  1.10201734e-07, -3.62891099e-08],
       [-5.71765697e-06,  3.68596237e-06,  4.36978032e-05,
         1.10201734e-07,  7.47106267e-08, -2.42299149e-08],
       [ 1.61611878e-06, -1.16005597e-06, -1.20770662e-05,
        -3.62891099e-08, -2.42299149e-08,  1.20857150e-08]])}
[[-4.48852548e+03]
 [-2.43432326e+03]
 [-4.98084840e+03]
 [-4.23723809e+00]
 [-3.05608090e+00]
 [ 5.33188250e+00]]
2018-07-13 08:24:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:30
[[-4.53065103e+03]
 [-2.46475009e+03]
 [-4.92725695e+03]
 [-4.18780105e+00]
 [-3.02922743e+00]
 [ 5.38633306e+00]]
[[ 3.61177588e-04 -2.88262517e-04 -2.92269684e-03 -6.81917482e-06
  -4.63070542e-06  1.24141475e-06]
 [-2.88262517e-04  2.73837045e-04  2.62891519e-03  6.59490291e-06
   4.45157727e-06 -1.39232221e-06]
 [-2.92269684e-03  2.62891519e-03  2.80039051e-02  6.60159928e-05
   4.36364629e-05 -1.18447804e-05]
 [-6.81917482e-06  6.59490291e-06  6.60159928e-05  1.70358541e-07
   1.11271883e-07 -3.62040452e-08]
 [-4.63070542e-06  4.45157727e-06  4.36364629e-05  1.11271883e-07
   7.53650015e-08 -2.41310146e-08]
 [ 1.24141475e-06 -1.39232221e-06 -1.18447804e-05 -3.62040452e-08
  -2.41310146e-08  1.20887198e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.53065103e+03],
       [-2.46475009e+03],
       [-4.92725695e+03],
       [-4.18780105e+00],
       [-3.02922743e+00],
       [ 5.38633306e+00]]), 'covar': array([[ 3.61177588e-04, -2.88262517e-04, -2.92269684e-03,
        -6.81917482e-06, -4.63070542e-06,  1.24141475e-06],
       [-2.88262517e-04,  2.73837045e-04,  2.62891519e-03,
         6.59490291e-06,  4.45157727e-06, -1.39232221e-06],
       [-2.92269684e-03,  2.62891519e-03,  2.80039051e-02,
         6.60159928e-05,  4.36364629e-05, -1.18447804e-05],
       [-6.81917482e-06,  6.59490291e-06,  6.60159928e-05,
         1.70358541e-07,  1.11271883e-07, -3.62040452e-08],
       [-4.63070542e-06,  4.45157727e-06,  4.36364629e-05,
         1.11271883e-07,  7.53650015e-08, -2.41310146e-08],
       [ 1.24141475e-06, -1.39232221e-06, -1.18447804e-05,
        -3.62040452e-08, -2.41310146e-08,  1.20887198e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 7.47083172e-06],
       [-1.14641404e-05],
       [-2.69083853e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.53065353e+03],
       [-2.46475707e+03],
       [-4.92739586e+03],
       [-4.18839039e+00],
       [-3.02938927e+00],
       [ 5.38633971e+00],
       [ 1.20624712e-01],
       [ 2.04768653e-03],
       [ 9.52041132e-01],
       [-2.81181736e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80249450e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.66877152e-03, -1.49468135e-03, -1.25149223e-02,
        -2.78059010e-05, -2.58819762e-05,  3.07075264e-06],
       [-1.49468135e-03,  1.42259521e-03,  1.19309646e-02,
         2.83924917e-05,  2.49774084e-05, -3.64730238e-06],
       [-1.25149223e-02,  1.19309646e-02,  1.06841219e-01,
         2.59514970e-04,  2.06984087e-04, -2.61922784e-05],
       [-2.78059010e-05,  2.83924917e-05,  2.59514970e-04,
         7.27759958e-07,  4.92501788e-07, -1.13866189e-07],
       [-2.58819762e-05,  2.49774084e-05,  2.06984087e-04,
         4.92501788e-07,  4.61837823e-07, -6.26585958e-08],
       [ 3.07075264e-06, -3.64730238e-06, -2.61922784e-05,
        -1.13866189e-07, -6.26585958e-08,  2.04874307e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.88937653e-05],
       [2.53569710e-06],
       [1.85263788e-02]])}}
Yi [[-0.81582605]
 [-1.39864859]
 [11.55949742]]
posterior
[[-4.53065353e+03]
 [-2.46475707e+03]
 [-4.92739586e+03]
 [-4.18839039e+00]
 [-3.02938927e+00]
 [ 5.38633971e+00]
 [ 1.20624712e-01]
 [ 2.04768653e-03]
 [ 9.52041132e-01]
 [-2.81181736e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80249450e-18]]
[[-4.53063212e+03]
 [-2.46476825e+03]
 [-4.92744724e+03]
 [-4.18828966e+00]
 [-3.02956549e+00]
 [ 5.38632077e+00]
 [ 1.20624712e-01]
 [ 2.04768653e-03]
 [ 9.52041132e-01]
 [-2.81181736e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80249450e-18]]
[[ 1.26025528e-03 -1.24956327e-03 -1.04422582e-02 -2.58724887e-05
  -2.21510209e-05  3.64372938e-06]
 [-1.24956327e-03  1.27370729e-03  1.06268016e-02  2.70179767e-05
   2.27170033e-05 -4.00193025e-06]
 [-1.04422582e-02  1.06268016e-02  9.43006720e-02  2.42533889e-04
   1.87329142e-04 -2.94632198e-05]
 [-2.58724887e-05  2.70179767e-05  2.42533889e-04  6.93205121e-07
   4.72273352e-07 -1.17866151e-07]
 [-2.21510209e-05  2.27170033e-05  1.87329142e-04  4.72273352e-07
   4.27501562e-07 -6.80207729e-08]
 [ 3.64372938e-06 -4.00193025e-06 -2.94632198e-05 -1.17866151e-07
  -6.80207729e-08  2.04004491e-07]]
[[-0.81587502]
 [-1.39868566]
 [11.46928549]]
[[4.89713844e-05]
 [3.70727961e-05]
 [9.02119363e-02]]


 Corrector Step
2018-07-13 08:24:30
[[-4.53063212e+03]
 [-2.46476825e+03]
 [-4.92744724e+03]
 [-4.18828966e+00]
 [-3.02956549e+00]
 [ 5.38632077e+00]
 [ 1.20624712e-01]
 [ 2.04768653e-03]
 [ 9.52041132e-01]
 [-2.81181736e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80249450e-18]]
[[ 1.26025528e-03 -1.24956327e-03 -1.04422582e-02 -2.58724887e-05
  -2.21510209e-05  3.64372938e-06]
 [-1.24956327e-03  1.27370729e-03  1.06268016e-02  2.70179767e-05
   2.27170033e-05 -4.00193025e-06]
 [-1.04422582e-02  1.06268016e-02  9.43006720e-02  2.42533889e-04
   1.87329142e-04 -2.94632198e-05]
 [-2.58724887e-05  2.70179767e-05  2.42533889e-04  6.93205121e-07
   4.72273352e-07 -1.17866151e-07]
 [-2.21510209e-05  2.27170033e-05  1.87329142e-04  4.72273352e-07
   4.27501562e-07 -6.80207729e-08]
 [ 3.64372938e-06 -4.00193025e-06 -2.94632198e-05 -1.17866151e-07
  -6.80207729e-08  2.04004491e-07]]
92311077.11907995
post
cubesat_nadir
Ybar_post [[-0.81583915]
 [-1.39867509]
 [11.46936154]]
resids [[1.31005444e-05]
 [2.65003477e-05]
 [9.01358816e-02]]
posterior
[[-4.53065103e+03]
 [-2.46475009e+03]
 [-4.92725695e+03]
 [-4.18780105e+00]
 [-3.02922743e+00]
 [ 5.38633306e+00]]
[[-4.53064800e+03]
 [-2.46474999e+03]
 [-4.92725414e+03]
 [-4.18777866e+00]
 [-3.02921822e+00]
 [ 5.38632439e+00]]
[[ 2.88166455e-04 -2.61253316e-04 -2.52287683e-03 -6.23716343e-06
  -4.22519123e-06  1.28531923e-06]
 [-2.61253316e-04  2.62232858e-04  2.45472772e-03  6.31728151e-06
   4.26685560e-06 -1.39978295e-06]
 [-2.52287683e-03  2.45472772e-03  2.53860709e-02  6.18131582e-05
   4.08501257e-05 -1.19421224e-05]
 [-6.23716343e-06  6.31728151e-06  6.18131582e-05  1.63310812e-07
   1.06698018e-07 -3.62147317e-08]
 [-4.22519123e-06  4.26685560e-06  4.08501257e-05  1.06698018e-07
   7.23656568e-08 -2.41858789e-08]
 [ 1.28531923e-06 -1.39978295e-06 -1.19421224e-05 -3.62147317e-08
  -2.41858789e-08  1.20144963e-08]]
[[-0.81584512]
 [-1.39866978]
 [11.76914024]]
[[ 1.90647539e-05]
 [ 2.11881582e-05]
 [-2.09642819e-01]]


 Corrector Step
2018-07-13 08:24:30
[[-4.53064800e+03]
 [-2.46474999e+03]
 [-4.92725414e+03]
 [-4.18777866e+00]
 [-3.02921822e+00]
 [ 5.38632439e+00]]
[[ 2.88166455e-04 -2.61253316e-04 -2.52287683e-03 -6.23716343e-06
  -4.22519123e-06  1.28531923e-06]
 [-2.61253316e-04  2.62232858e-04  2.45472772e-03  6.31728151e-06
   4.26685560e-06 -1.39978295e-06]
 [-2.52287683e-03  2.45472772e-03  2.53860709e-02  6.18131582e-05
   4.08501257e-05 -1.19421224e-05]
 [-6.23716343e-06  6.31728151e-06  6.18131582e-05  1.63310812e-07
   1.06698018e-07 -3.62147317e-08]
 [-4.22519123e-06  4.26685560e-06  4.08501257e-05  1.06698018e-07
   7.23656568e-08 -2.41858789e-08]
 [ 1.28531923e-06 -1.39978295e-06 -1.19421224e-05 -3.62147317e-08
  -2.41858789e-08  1.20144963e-08]]
48367575.9079268
post
sphere_lamr_small
Ybar_post [[-0.81583484]
 [-1.39866792]
 [11.76913501]]
resids [[ 8.78597628e-06]
 [ 1.93264714e-05]
 [-2.09637586e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [92311077.11907995, 48367575.9079268]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.53063212e+03],
       [-2.46476825e+03],
       [-4.92744724e+03],
       [-4.18828966e+00],
       [-3.02956549e+00],
       [ 5.38632077e+00]]), 'est_covars': array([[ 1.26025528e-03, -1.24956327e-03, -1.04422582e-02,
        -2.58724887e-05, -2.21510209e-05,  3.64372938e-06],
       [-1.24956327e-03,  1.27370729e-03,  1.06268016e-02,
         2.70179767e-05,  2.27170033e-05, -4.00193025e-06],
       [-1.04422582e-02,  1.06268016e-02,  9.43006720e-02,
         2.42533889e-04,  1.87329142e-04, -2.94632198e-05],
       [-2.58724887e-05,  2.70179767e-05,  2.42533889e-04,
         6.93205121e-07,  4.72273352e-07, -1.17866151e-07],
       [-2.21510209e-05,  2.27170033e-05,  1.87329142e-04,
         4.72273352e-07,  4.27501562e-07, -6.80207729e-08],
       [ 3.64372938e-06, -4.00193025e-06, -2.94632198e-05,
        -1.17866151e-07, -6.80207729e-08,  2.04004491e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.53064800e+03],
       [-2.46474999e+03],
       [-4.92725414e+03],
       [-4.18777866e+00],
       [-3.02921822e+00],
       [ 5.38632439e+00]]), 'covar': array([[ 2.88166455e-04, -2.61253316e-04, -2.52287683e-03,
        -6.23716343e-06, -4.22519123e-06,  1.28531923e-06],
       [-2.61253316e-04,  2.62232858e-04,  2.45472772e-03,
         6.31728151e-06,  4.26685560e-06, -1.39978295e-06],
       [-2.52287683e-03,  2.45472772e-03,  2.53860709e-02,
         6.18131582e-05,  4.08501257e-05, -1.19421224e-05],
       [-6.23716343e-06,  6.31728151e-06,  6.18131582e-05,
         1.63310812e-07,  1.06698018e-07, -3.62147317e-08],
       [-4.22519123e-06,  4.26685560e-06,  4.08501257e-05,
         1.06698018e-07,  7.23656568e-08, -2.41858789e-08],
       [ 1.28531923e-06, -1.39978295e-06, -1.19421224e-05,
        -3.62147317e-08, -2.41858789e-08,  1.20144963e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 8.78597628e-06],
       [ 1.93264714e-05],
       [-2.09637586e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.53063212e+03],
       [-2.46476825e+03],
       [-4.92744724e+03],
       [-4.18828966e+00],
       [-3.02956549e+00],
       [ 5.38632077e+00],
       [ 1.20624712e-01],
       [ 2.04768653e-03],
       [ 9.52041132e-01],
       [-2.81181736e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80249450e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.26025528e-03, -1.24956327e-03, -1.04422582e-02,
        -2.58724887e-05, -2.21510209e-05,  3.64372938e-06],
       [-1.24956327e-03,  1.27370729e-03,  1.06268016e-02,
         2.70179767e-05,  2.27170033e-05, -4.00193025e-06],
       [-1.04422582e-02,  1.06268016e-02,  9.43006720e-02,
         2.42533889e-04,  1.87329142e-04, -2.94632198e-05],
       [-2.58724887e-05,  2.70179767e-05,  2.42533889e-04,
         6.93205121e-07,  4.72273352e-07, -1.17866151e-07],
       [-2.21510209e-05,  2.27170033e-05,  1.87329142e-04,
         4.72273352e-07,  4.27501562e-07, -6.80207729e-08],
       [ 3.64372938e-06, -4.00193025e-06, -2.94632198e-05,
        -1.17866151e-07, -6.80207729e-08,  2.04004491e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.31005444e-05],
       [2.65003477e-05],
       [9.01358816e-02]])}}
Current time:  2018-07-13 08:24:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.53063212e+03],
       [-2.46476825e+03],
       [-4.92744724e+03],
       [-4.18828966e+00],
       [-3.02956549e+00],
       [ 5.38632077e+00],
       [ 1.20624712e-01],
       [ 2.04768653e-03],
       [ 9.52041132e-01],
       [-2.81181736e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80249450e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.26025528e-03, -1.24956327e-03, -1.04422582e-02,
        -2.58724887e-05, -2.21510209e-05,  3.64372938e-06],
       [-1.24956327e-03,  1.27370729e-03,  1.06268016e-02,
         2.70179767e-05,  2.27170033e-05, -4.00193025e-06],
       [-1.04422582e-02,  1.06268016e-02,  9.43006720e-02,
         2.42533889e-04,  1.87329142e-04, -2.94632198e-05],
       [-2.58724887e-05,  2.70179767e-05,  2.42533889e-04,
         6.93205121e-07,  4.72273352e-07, -1.17866151e-07],
       [-2.21510209e-05,  2.27170033e-05,  1.87329142e-04,
         4.72273352e-07,  4.27501562e-07, -6.80207729e-08],
       [ 3.64372938e-06, -4.00193025e-06, -2.94632198e-05,
        -1.17866151e-07, -6.80207729e-08,  2.04004491e-07]])}
[[-4.53063212e+03]
 [-2.46476825e+03]
 [-4.92744724e+03]
 [-4.18828966e+00]
 [-3.02956549e+00]
 [ 5.38632077e+00]
 [ 1.20624712e-01]
 [ 2.04768653e-03]
 [ 9.52041132e-01]
 [-2.81181736e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80249450e-18]]
2018-07-13 08:24:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:40
[[-4.57226595e+03]
 [-2.49492805e+03]
 [-4.87331419e+03]
 [-4.13838996e+00]
 [-3.00237760e+00]
 [ 5.44018548e+00]
 [ 1.25593972e-01]
 [ 3.51579653e-03]
 [ 9.51398335e-01]
 [-2.81167211e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80270678e-18]]
[[ 8.11157848e-04 -1.15295529e-03 -7.98535967e-03 -1.89932289e-05
  -1.74629868e-05  2.43064275e-06]
 [-1.15295529e-03  1.77194076e-03  1.24565269e-02  3.19373227e-05
   2.71250380e-05 -4.63158111e-06]
 [-7.98535967e-03  1.24565269e-02  9.37359521e-02  2.42777174e-04
   1.87243535e-04 -2.69826509e-05]
 [-1.89932289e-05  3.19373227e-05  2.42777174e-04  7.10531893e-07
   4.76649263e-07 -1.17270571e-07]
 [-1.74629868e-05  2.71250380e-05  1.87243535e-04  4.76649263e-07
   4.39810833e-07 -6.74164278e-08]
 [ 2.43064275e-06 -4.63158111e-06 -2.69826509e-05 -1.17270571e-07
  -6.74164278e-08  2.13763388e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.53064800e+03],
       [-2.46474999e+03],
       [-4.92725414e+03],
       [-4.18777866e+00],
       [-3.02921822e+00],
       [ 5.38632439e+00]]), 'covar': array([[ 2.88166455e-04, -2.61253316e-04, -2.52287683e-03,
        -6.23716343e-06, -4.22519123e-06,  1.28531923e-06],
       [-2.61253316e-04,  2.62232858e-04,  2.45472772e-03,
         6.31728151e-06,  4.26685560e-06, -1.39978295e-06],
       [-2.52287683e-03,  2.45472772e-03,  2.53860709e-02,
         6.18131582e-05,  4.08501257e-05, -1.19421224e-05],
       [-6.23716343e-06,  6.31728151e-06,  6.18131582e-05,
         1.63310812e-07,  1.06698018e-07, -3.62147317e-08],
       [-4.22519123e-06,  4.26685560e-06,  4.08501257e-05,
         1.06698018e-07,  7.23656568e-08, -2.41858789e-08],
       [ 1.28531923e-06, -1.39978295e-06, -1.19421224e-05,
        -3.62147317e-08, -2.41858789e-08,  1.20144963e-08]])}
[[-4.53064800e+03]
 [-2.46474999e+03]
 [-4.92725414e+03]
 [-4.18777866e+00]
 [-3.02921822e+00]
 [ 5.38632439e+00]]
2018-07-13 08:24:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:40
[[-4.57227623e+03]
 [-2.49490657e+03]
 [-4.87312103e+03]
 [-4.13787588e+00]
 [-3.00202925e+00]
 [ 5.44018987e+00]]
[[ 1.80112148e-04 -2.29581444e-04 -1.89352076e-03 -4.62705076e-06
  -3.16716693e-06  9.14327871e-07]
 [-2.29581444e-04  3.54999277e-04  2.84767216e-03  7.42919725e-06
   5.01053600e-06 -1.63003703e-06]
 [-1.89352076e-03  2.84767216e-03  2.51495052e-02  6.18302492e-05
   4.07728376e-05 -1.17164596e-05]
 [-4.62705076e-06  7.42919725e-06  6.18302492e-05  1.65269870e-07
   1.07710614e-07 -3.61331909e-08]
 [-3.16716693e-06  5.01053600e-06  4.07728376e-05  1.07710614e-07
   7.29889029e-08 -2.40887990e-08]
 [ 9.14327871e-07 -1.63003703e-06 -1.17164596e-05 -3.61331909e-08
  -2.40887990e-08  1.20134816e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.57227623e+03],
       [-2.49490657e+03],
       [-4.87312103e+03],
       [-4.13787588e+00],
       [-3.00202925e+00],
       [ 5.44018987e+00]]), 'covar': array([[ 1.80112148e-04, -2.29581444e-04, -1.89352076e-03,
        -4.62705076e-06, -3.16716693e-06,  9.14327871e-07],
       [-2.29581444e-04,  3.54999277e-04,  2.84767216e-03,
         7.42919725e-06,  5.01053600e-06, -1.63003703e-06],
       [-1.89352076e-03,  2.84767216e-03,  2.51495052e-02,
         6.18302492e-05,  4.07728376e-05, -1.17164596e-05],
       [-4.62705076e-06,  7.42919725e-06,  6.18302492e-05,
         1.65269870e-07,  1.07710614e-07, -3.61331909e-08],
       [-3.16716693e-06,  5.01053600e-06,  4.07728376e-05,
         1.07710614e-07,  7.29889029e-08, -2.40887990e-08],
       [ 9.14327871e-07, -1.63003703e-06, -1.17164596e-05,
        -3.61331909e-08, -2.40887990e-08,  1.20134816e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 8.78597628e-06],
       [ 1.93264714e-05],
       [-2.09637586e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.57226595e+03],
       [-2.49492805e+03],
       [-4.87331419e+03],
       [-4.13838996e+00],
       [-3.00237760e+00],
       [ 5.44018548e+00],
       [ 1.25593972e-01],
       [ 3.51579653e-03],
       [ 9.51398335e-01],
       [-2.81167211e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80270678e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.11157848e-04, -1.15295529e-03, -7.98535967e-03,
        -1.89932289e-05, -1.74629868e-05,  2.43064275e-06],
       [-1.15295529e-03,  1.77194076e-03,  1.24565269e-02,
         3.19373227e-05,  2.71250380e-05, -4.63158111e-06],
       [-7.98535967e-03,  1.24565269e-02,  9.37359521e-02,
         2.42777174e-04,  1.87243535e-04, -2.69826509e-05],
       [-1.89932289e-05,  3.19373227e-05,  2.42777174e-04,
         7.10531893e-07,  4.76649263e-07, -1.17270571e-07],
       [-1.74629868e-05,  2.71250380e-05,  1.87243535e-04,
         4.76649263e-07,  4.39810833e-07, -6.74164278e-08],
       [ 2.43064275e-06, -4.63158111e-06, -2.69826509e-05,
        -1.17270571e-07, -6.74164278e-08,  2.13763388e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.31005444e-05],
       [2.65003477e-05],
       [9.01358816e-02]])}}
Yi [[-1.04821896]
 [-1.39468381]
 [11.579084  ]]
posterior
[[-4.57226595e+03]
 [-2.49492805e+03]
 [-4.87331419e+03]
 [-4.13838996e+00]
 [-3.00237760e+00]
 [ 5.44018548e+00]
 [ 1.25593972e-01]
 [ 3.51579653e-03]
 [ 9.51398335e-01]
 [-2.81167211e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80270678e-18]]
[[-4.57227013e+03]
 [-2.49492634e+03]
 [-4.87332987e+03]
 [-4.13850309e+00]
 [-3.00234686e+00]
 [ 5.44018581e+00]
 [ 1.25593972e-01]
 [ 3.51579653e-03]
 [ 9.51398335e-01]
 [-2.81167211e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80270678e-18]]
[[ 6.04918738e-04 -9.61294145e-04 -6.72711156e-03 -1.77527478e-05
  -1.48241711e-05  2.78994757e-06]
 [-9.61294145e-04  1.58685243e-03  1.11480052e-02  3.03237042e-05
   2.46042583e-05 -4.99593436e-06]
 [-6.72711156e-03  1.11480052e-02  8.32798677e-02  2.26008846e-04
   1.69777969e-04 -2.97835398e-05]
 [-1.77527478e-05  3.03237042e-05  2.26008846e-04  6.72618080e-07
   4.56253937e-07 -1.21446034e-07]
 [-1.48241711e-05  2.46042583e-05  1.69777969e-04  4.56253937e-07
   4.05374440e-07 -7.23119572e-08]
 [ 2.78994757e-06 -4.99593436e-06 -2.97835398e-05 -1.21446034e-07
  -7.23119572e-08  2.13003255e-07]]
[[-1.04820129]
 [-1.39466378]
 [11.34963751]]
[[-1.76624318e-05]
 [-2.00280964e-05]
 [ 2.29446487e-01]]


 Corrector Step
2018-07-13 08:24:40
[[-4.57227013e+03]
 [-2.49492634e+03]
 [-4.87332987e+03]
 [-4.13850309e+00]
 [-3.00234686e+00]
 [ 5.44018581e+00]
 [ 1.25593972e-01]
 [ 3.51579653e-03]
 [ 9.51398335e-01]
 [-2.81167211e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80270678e-18]]
[[ 6.04918738e-04 -9.61294145e-04 -6.72711156e-03 -1.77527478e-05
  -1.48241711e-05  2.78994757e-06]
 [-9.61294145e-04  1.58685243e-03  1.11480052e-02  3.03237042e-05
   2.46042583e-05 -4.99593436e-06]
 [-6.72711156e-03  1.11480052e-02  8.32798677e-02  2.26008846e-04
   1.69777969e-04 -2.97835398e-05]
 [-1.77527478e-05  3.03237042e-05  2.26008846e-04  6.72618080e-07
   4.56253937e-07 -1.21446034e-07]
 [-1.48241711e-05  2.46042583e-05  1.69777969e-04  4.56253937e-07
   4.05374440e-07 -7.23119572e-08]
 [ 2.78994757e-06 -4.99593436e-06 -2.97835398e-05 -1.21446034e-07
  -7.23119572e-08  2.13003255e-07]]
29407978.488039814
post
cubesat_nadir
Ybar_post [[-1.04821413]
 [-1.39466883]
 [11.34967392]]
resids [[-4.82475890e-06]
 [-1.49798812e-05]
 [ 2.29410078e-01]]
posterior
[[-4.57227623e+03]
 [-2.49490657e+03]
 [-4.87312103e+03]
 [-4.13787588e+00]
 [-3.00202925e+00]
 [ 5.44018987e+00]]
[[-4.57227898e+03]
 [-2.49490719e+03]
 [-4.87313477e+03]
 [-4.13792245e+00]
 [-3.00204974e+00]
 [ 5.44019960e+00]]
[[ 1.45116540e-04 -2.08401644e-04 -1.66981825e-03 -4.28182357e-06
  -2.91155491e-06  9.20801448e-07]
 [-2.08401644e-04  3.38945722e-04  2.66822816e-03  7.11631826e-06
   4.79854380e-06 -1.62080531e-06]
 [-1.66981825e-03  2.66822816e-03  2.31195600e-02  5.82079681e-05
   3.83586957e-05 -1.15787919e-05]
 [-4.28182357e-06  7.11631826e-06  5.82079681e-05  1.58524710e-07
   1.03348322e-07 -3.57745980e-08]
 [-2.91155491e-06  4.79854380e-06  3.83586957e-05  1.03348322e-07
   7.01073015e-08 -2.39032247e-08]
 [ 9.20801448e-07 -1.62080531e-06 -1.15787919e-05 -3.57745980e-08
  -2.39032247e-08  1.19588294e-08]]
[[-1.04819296]
 [-1.3946552 ]
 [11.66151237]]
[[-2.59921809e-05]
 [-2.86111652e-05]
 [-8.24283797e-02]]


 Corrector Step
2018-07-13 08:24:40
[[-4.57227898e+03]
 [-2.49490719e+03]
 [-4.87313477e+03]
 [-4.13792245e+00]
 [-3.00204974e+00]
 [ 5.44019960e+00]]
[[ 1.45116540e-04 -2.08401644e-04 -1.66981825e-03 -4.28182357e-06
  -2.91155491e-06  9.20801448e-07]
 [-2.08401644e-04  3.38945722e-04  2.66822816e-03  7.11631826e-06
   4.79854380e-06 -1.62080531e-06]
 [-1.66981825e-03  2.66822816e-03  2.31195600e-02  5.82079681e-05
   3.83586957e-05 -1.15787919e-05]
 [-4.28182357e-06  7.11631826e-06  5.82079681e-05  1.58524710e-07
   1.03348322e-07 -3.57745980e-08]
 [-2.91155491e-06  4.79854380e-06  3.83586957e-05  1.03348322e-07
   7.01073015e-08 -2.39032247e-08]
 [ 9.20801448e-07 -1.62080531e-06 -1.15787919e-05 -3.57745980e-08
  -2.39032247e-08  1.19588294e-08]]
208851131.9666402
post
sphere_lamr_small
Ybar_post [[-1.04820541]
 [-1.3946579 ]
 [11.66153787]]
resids [[-1.35499933e-05]
 [-2.59044228e-05]
 [-8.24538770e-02]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [29407978.488039814, 208851131.9666402]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.57227013e+03],
       [-2.49492634e+03],
       [-4.87332987e+03],
       [-4.13850309e+00],
       [-3.00234686e+00],
       [ 5.44018581e+00]]), 'est_covars': array([[ 6.04918738e-04, -9.61294145e-04, -6.72711156e-03,
        -1.77527478e-05, -1.48241711e-05,  2.78994757e-06],
       [-9.61294145e-04,  1.58685243e-03,  1.11480052e-02,
         3.03237042e-05,  2.46042583e-05, -4.99593436e-06],
       [-6.72711156e-03,  1.11480052e-02,  8.32798677e-02,
         2.26008846e-04,  1.69777969e-04, -2.97835398e-05],
       [-1.77527478e-05,  3.03237042e-05,  2.26008846e-04,
         6.72618080e-07,  4.56253937e-07, -1.21446034e-07],
       [-1.48241711e-05,  2.46042583e-05,  1.69777969e-04,
         4.56253937e-07,  4.05374440e-07, -7.23119572e-08],
       [ 2.78994757e-06, -4.99593436e-06, -2.97835398e-05,
        -1.21446034e-07, -7.23119572e-08,  2.13003255e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.57227898e+03],
       [-2.49490719e+03],
       [-4.87313477e+03],
       [-4.13792245e+00],
       [-3.00204974e+00],
       [ 5.44019960e+00]]), 'covar': array([[ 1.45116540e-04, -2.08401644e-04, -1.66981825e-03,
        -4.28182357e-06, -2.91155491e-06,  9.20801448e-07],
       [-2.08401644e-04,  3.38945722e-04,  2.66822816e-03,
         7.11631826e-06,  4.79854380e-06, -1.62080531e-06],
       [-1.66981825e-03,  2.66822816e-03,  2.31195600e-02,
         5.82079681e-05,  3.83586957e-05, -1.15787919e-05],
       [-4.28182357e-06,  7.11631826e-06,  5.82079681e-05,
         1.58524710e-07,  1.03348322e-07, -3.57745980e-08],
       [-2.91155491e-06,  4.79854380e-06,  3.83586957e-05,
         1.03348322e-07,  7.01073015e-08, -2.39032247e-08],
       [ 9.20801448e-07, -1.62080531e-06, -1.15787919e-05,
        -3.57745980e-08, -2.39032247e-08,  1.19588294e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.35499933e-05],
       [-2.59044228e-05],
       [-8.24538770e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.57227013e+03],
       [-2.49492634e+03],
       [-4.87332987e+03],
       [-4.13850309e+00],
       [-3.00234686e+00],
       [ 5.44018581e+00],
       [ 1.25593972e-01],
       [ 3.51579653e-03],
       [ 9.51398335e-01],
       [-2.81167211e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80270678e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.04918738e-04, -9.61294145e-04, -6.72711156e-03,
        -1.77527478e-05, -1.48241711e-05,  2.78994757e-06],
       [-9.61294145e-04,  1.58685243e-03,  1.11480052e-02,
         3.03237042e-05,  2.46042583e-05, -4.99593436e-06],
       [-6.72711156e-03,  1.11480052e-02,  8.32798677e-02,
         2.26008846e-04,  1.69777969e-04, -2.97835398e-05],
       [-1.77527478e-05,  3.03237042e-05,  2.26008846e-04,
         6.72618080e-07,  4.56253937e-07, -1.21446034e-07],
       [-1.48241711e-05,  2.46042583e-05,  1.69777969e-04,
         4.56253937e-07,  4.05374440e-07, -7.23119572e-08],
       [ 2.78994757e-06, -4.99593436e-06, -2.97835398e-05,
        -1.21446034e-07, -7.23119572e-08,  2.13003255e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-4.82475890e-06],
       [-1.49798812e-05],
       [ 2.29410078e-01]])}}
Current time:  2018-07-13 08:24:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.57227013e+03],
       [-2.49492634e+03],
       [-4.87332987e+03],
       [-4.13850309e+00],
       [-3.00234686e+00],
       [ 5.44018581e+00],
       [ 1.25593972e-01],
       [ 3.51579653e-03],
       [ 9.51398335e-01],
       [-2.81167211e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80270678e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.04918738e-04, -9.61294145e-04, -6.72711156e-03,
        -1.77527478e-05, -1.48241711e-05,  2.78994757e-06],
       [-9.61294145e-04,  1.58685243e-03,  1.11480052e-02,
         3.03237042e-05,  2.46042583e-05, -4.99593436e-06],
       [-6.72711156e-03,  1.11480052e-02,  8.32798677e-02,
         2.26008846e-04,  1.69777969e-04, -2.97835398e-05],
       [-1.77527478e-05,  3.03237042e-05,  2.26008846e-04,
         6.72618080e-07,  4.56253937e-07, -1.21446034e-07],
       [-1.48241711e-05,  2.46042583e-05,  1.69777969e-04,
         4.56253937e-07,  4.05374440e-07, -7.23119572e-08],
       [ 2.78994757e-06, -4.99593436e-06, -2.97835398e-05,
        -1.21446034e-07, -7.23119572e-08,  2.13003255e-07]])}
[[-4.57227013e+03]
 [-2.49492634e+03]
 [-4.87332987e+03]
 [-4.13850309e+00]
 [-3.00234686e+00]
 [ 5.44018581e+00]
 [ 1.25593972e-01]
 [ 3.51579653e-03]
 [ 9.51398335e-01]
 [-2.81167211e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80270678e-18]]
2018-07-13 08:24:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:50
[[-4.61340374e+03]
 [-2.52481235e+03]
 [-4.81866104e+03]
 [-4.08814365e+00]
 [-2.97482681e+00]
 [ 5.49345912e+00]
 [ 1.30559809e-01]
 [ 4.98381067e-03]
 [ 9.50729601e-01]
 [-2.81145021e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80291907e-18]]
[[ 3.16692566e-04 -7.59819587e-04 -4.44502977e-03 -1.10277800e-05
  -1.02760430e-05  1.55396525e-06]
 [-7.59819587e-04  2.12058582e-03  1.27915877e-02  3.50903820e-05
   2.87935695e-05 -5.66310976e-06]
 [-4.44502977e-03  1.27915877e-02  8.27094784e-02  2.26067110e-04
   1.69586921e-04 -2.72364360e-05]
 [-1.10277800e-05  3.50903820e-05  2.26067110e-04  6.89541485e-07
   4.60310566e-07 -1.20875395e-07]
 [-1.02760430e-05  2.87935695e-05  1.69586921e-04  4.60310566e-07
   4.17491634e-07 -7.17293324e-08]
 [ 1.55396525e-06 -5.66310976e-06 -2.72364360e-05 -1.20875395e-07
  -7.17293324e-08  2.22737874e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.57227898e+03],
       [-2.49490719e+03],
       [-4.87313477e+03],
       [-4.13792245e+00],
       [-3.00204974e+00],
       [ 5.44019960e+00]]), 'covar': array([[ 1.45116540e-04, -2.08401644e-04, -1.66981825e-03,
        -4.28182357e-06, -2.91155491e-06,  9.20801448e-07],
       [-2.08401644e-04,  3.38945722e-04,  2.66822816e-03,
         7.11631826e-06,  4.79854380e-06, -1.62080531e-06],
       [-1.66981825e-03,  2.66822816e-03,  2.31195600e-02,
         5.82079681e-05,  3.83586957e-05, -1.15787919e-05],
       [-4.28182357e-06,  7.11631826e-06,  5.82079681e-05,
         1.58524710e-07,  1.03348322e-07, -3.57745980e-08],
       [-2.91155491e-06,  4.79854380e-06,  3.83586957e-05,
         1.03348322e-07,  7.01073015e-08, -2.39032247e-08],
       [ 9.20801448e-07, -1.62080531e-06, -1.15787919e-05,
        -3.57745980e-08, -2.39032247e-08,  1.19588294e-08]])}
[[-4.57227898e+03]
 [-2.49490719e+03]
 [-4.87313477e+03]
 [-4.13792245e+00]
 [-3.00204974e+00]
 [ 5.44019960e+00]]
2018-07-13 08:24:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:24:50
[[-4.61340662e+03]
 [-2.52479034e+03]
 [-4.81846586e+03]
 [-4.08756007e+00]
 [-2.97452822e+00]
 [ 5.49347401e+00]]
[[ 7.52665867e-05 -1.55798244e-04 -1.08036732e-03 -2.70814309e-06
  -1.88201972e-06  5.57674485e-07]
 [-1.55798244e-04  4.42130019e-04  3.03404424e-03  8.19809915e-06
   5.52099338e-06 -1.84676770e-06]
 [-1.08036732e-03  3.03404424e-03  2.28901918e-02  5.81996506e-05
   3.82713725e-05 -1.13582599e-05]
 [-2.70814309e-06  8.19809915e-06  5.81996506e-05  1.60397339e-07
   1.04311844e-07 -3.56921724e-08]
 [-1.88201972e-06  5.52099338e-06  3.82713725e-05  1.04311844e-07
   7.07037972e-08 -2.38062565e-08]
 [ 5.57674485e-07 -1.84676770e-06 -1.13582599e-05 -3.56921724e-08
  -2.38062565e-08  1.19547812e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.61340662e+03],
       [-2.52479034e+03],
       [-4.81846586e+03],
       [-4.08756007e+00],
       [-2.97452822e+00],
       [ 5.49347401e+00]]), 'covar': array([[ 7.52665867e-05, -1.55798244e-04, -1.08036732e-03,
        -2.70814309e-06, -1.88201972e-06,  5.57674485e-07],
       [-1.55798244e-04,  4.42130019e-04,  3.03404424e-03,
         8.19809915e-06,  5.52099338e-06, -1.84676770e-06],
       [-1.08036732e-03,  3.03404424e-03,  2.28901918e-02,
         5.81996506e-05,  3.82713725e-05, -1.13582599e-05],
       [-2.70814309e-06,  8.19809915e-06,  5.81996506e-05,
         1.60397339e-07,  1.04311844e-07, -3.56921724e-08],
       [-1.88201972e-06,  5.52099338e-06,  3.82713725e-05,
         1.04311844e-07,  7.07037972e-08, -2.38062565e-08],
       [ 5.57674485e-07, -1.84676770e-06, -1.13582599e-05,
        -3.56921724e-08, -2.38062565e-08,  1.19547812e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.35499933e-05],
       [-2.59044228e-05],
       [-8.24538770e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.61340374e+03],
       [-2.52481235e+03],
       [-4.81866104e+03],
       [-4.08814365e+00],
       [-2.97482681e+00],
       [ 5.49345912e+00],
       [ 1.30559809e-01],
       [ 4.98381067e-03],
       [ 9.50729601e-01],
       [-2.81145021e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80291907e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.16692566e-04, -7.59819587e-04, -4.44502977e-03,
        -1.10277800e-05, -1.02760430e-05,  1.55396525e-06],
       [-7.59819587e-04,  2.12058582e-03,  1.27915877e-02,
         3.50903820e-05,  2.87935695e-05, -5.66310976e-06],
       [-4.44502977e-03,  1.27915877e-02,  8.27094784e-02,
         2.26067110e-04,  1.69586921e-04, -2.72364360e-05],
       [-1.10277800e-05,  3.50903820e-05,  2.26067110e-04,
         6.89541485e-07,  4.60310566e-07, -1.20875395e-07],
       [-1.02760430e-05,  2.87935695e-05,  1.69586921e-04,
         4.60310566e-07,  4.17491634e-07, -7.17293324e-08],
       [ 1.55396525e-06, -5.66310976e-06, -2.72364360e-05,
        -1.20875395e-07, -7.17293324e-08,  2.22737874e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-4.82475890e-06],
       [-1.49798812e-05],
       [ 2.29410078e-01]])}}
Yi [[-1.27488524]
 [-1.38048046]
 [11.2821768 ]]
posterior
[[-4.61340374e+03]
 [-2.52481235e+03]
 [-4.81866104e+03]
 [-4.08814365e+00]
 [-2.97482681e+00]
 [ 5.49345912e+00]
 [ 1.30559809e-01]
 [ 4.98381067e-03]
 [ 9.50729601e-01]
 [-2.81145021e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80291907e-18]]
[[-4.61340399e+03]
 [-2.52480802e+03]
 [-4.81860655e+03]
 [-4.08798117e+00]
 [-2.97478690e+00]
 [ 5.49347354e+00]
 [ 1.30559809e-01]
 [ 4.98381067e-03]
 [ 9.50729601e-01]
 [-2.81145021e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80291907e-18]]
[[ 2.25206211e-04 -6.27936547e-04 -3.72743427e-03 -1.02715779e-05
  -8.57527133e-06  1.77261742e-06]
 [-6.27936547e-04  1.90671757e-03  1.14451544e-02  3.30448913e-05
   2.61289005e-05 -6.05735260e-06]
 [-3.72743427e-03  1.14451544e-02  7.29824816e-02  2.07585589e-04
   1.53450303e-04 -2.99904811e-05]
 [-1.02715779e-05  3.30448913e-05  2.07585589e-04  6.44859275e-07
   4.37689051e-07 -1.25863591e-07]
 [-8.57527133e-06  2.61289005e-05  1.53450303e-04  4.37689051e-07
   3.83964737e-07 -7.65021022e-08]
 [ 1.77261742e-06 -6.05735260e-06 -2.99904811e-05 -1.25863591e-07
  -7.65021022e-08  2.21951024e-07]]
[[-1.27489083]
 [-1.38050318]
 [11.229074  ]]
[[5.58304514e-06]
 [2.27171835e-05]
 [5.31027986e-02]]


 Corrector Step
2018-07-13 08:24:50
[[-4.61340399e+03]
 [-2.52480802e+03]
 [-4.81860655e+03]
 [-4.08798117e+00]
 [-2.97478690e+00]
 [ 5.49347354e+00]
 [ 1.30559809e-01]
 [ 4.98381067e-03]
 [ 9.50729601e-01]
 [-2.81145021e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80291907e-18]]
[[ 2.25206211e-04 -6.27936547e-04 -3.72743427e-03 -1.02715779e-05
  -8.57527133e-06  1.77261742e-06]
 [-6.27936547e-04  1.90671757e-03  1.14451544e-02  3.30448913e-05
   2.61289005e-05 -6.05735260e-06]
 [-3.72743427e-03  1.14451544e-02  7.29824816e-02  2.07585589e-04
   1.53450303e-04 -2.99904811e-05]
 [-1.02715779e-05  3.30448913e-05  2.07585589e-04  6.44859275e-07
   4.37689051e-07 -1.25863591e-07]
 [-8.57527133e-06  2.61289005e-05  1.53450303e-04  4.37689051e-07
   3.83964737e-07 -7.65021022e-08]
 [ 1.77261742e-06 -6.05735260e-06 -2.99904811e-05 -1.25863591e-07
  -7.65021022e-08  2.21951024e-07]]
367396833.2926349
post
cubesat_nadir
Ybar_post [[-1.27488625]
 [-1.380498  ]
 [11.22896381]]
resids [[1.00850161e-06]
 [1.75378198e-05]
 [5.32129899e-02]]
posterior
[[-4.61340662e+03]
 [-2.52479034e+03]
 [-4.81846586e+03]
 [-4.08756007e+00]
 [-2.97452822e+00]
 [ 5.49347401e+00]]
[[-4.61340842e+03]
 [-2.52478780e+03]
 [-4.81844306e+03]
 [-4.08751625e+00]
 [-2.97449838e+00]
 [ 5.49347057e+00]]
[[ 5.95019319e-05 -1.40554118e-04 -9.55042492e-04 -2.50287584e-06
  -1.72100681e-06  5.50681287e-07]
 [-1.40554118e-04  4.20026074e-04  2.83051669e-03  7.80717226e-06
   5.25850686e-06 -1.81774686e-06]
 [-9.55042492e-04  2.83051669e-03  2.09730696e-02  5.44158197e-05
   3.57971456e-05 -1.10537664e-05]
 [-2.50287584e-06  7.80717226e-06  5.44158197e-05  1.52695211e-07
   9.94243605e-08 -3.50193989e-08]
 [-1.72100681e-06  5.25850686e-06  3.57971456e-05  9.94243605e-08
   6.75104774e-08 -2.34120118e-08]
 [ 5.50681287e-07 -1.81774686e-06 -1.10537664e-05 -3.50193989e-08
  -2.34120118e-08  1.18843841e-08]]
[[-1.2748744 ]
 [-1.38049018]
 [11.55268002]]
[[-1.08380345e-05]
 [ 9.72337092e-06]
 [-2.70503216e-01]]


 Corrector Step
2018-07-13 08:24:50
[[-4.61340842e+03]
 [-2.52478780e+03]
 [-4.81844306e+03]
 [-4.08751625e+00]
 [-2.97449838e+00]
 [ 5.49347057e+00]]
[[ 5.95019319e-05 -1.40554118e-04 -9.55042492e-04 -2.50287584e-06
  -1.72100681e-06  5.50681287e-07]
 [-1.40554118e-04  4.20026074e-04  2.83051669e-03  7.80717226e-06
   5.25850686e-06 -1.81774686e-06]
 [-9.55042492e-04  2.83051669e-03  2.09730696e-02  5.44158197e-05
   3.57971456e-05 -1.10537664e-05]
 [-2.50287584e-06  7.80717226e-06  5.44158197e-05  1.52695211e-07
   9.94243605e-08 -3.50193989e-08]
 [-1.72100681e-06  5.25850686e-06  3.57971456e-05  9.94243605e-08
   6.75104774e-08 -2.34120118e-08]
 [ 5.50681287e-07 -1.81774686e-06 -1.10537664e-05 -3.50193989e-08
  -2.34120118e-08  1.18843841e-08]]
17873130.15530369
post
sphere_lamr_small
Ybar_post [[-1.27487883]
 [-1.38048898]
 [11.55263715]]
resids [[-6.41567871e-06]
 [ 8.52352202e-06]
 [-2.70460347e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [367396833.2926349, 17873130.15530369]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.61340399e+03],
       [-2.52480802e+03],
       [-4.81860655e+03],
       [-4.08798117e+00],
       [-2.97478690e+00],
       [ 5.49347354e+00]]), 'est_covars': array([[ 2.25206211e-04, -6.27936547e-04, -3.72743427e-03,
        -1.02715779e-05, -8.57527133e-06,  1.77261742e-06],
       [-6.27936547e-04,  1.90671757e-03,  1.14451544e-02,
         3.30448913e-05,  2.61289005e-05, -6.05735260e-06],
       [-3.72743427e-03,  1.14451544e-02,  7.29824816e-02,
         2.07585589e-04,  1.53450303e-04, -2.99904811e-05],
       [-1.02715779e-05,  3.30448913e-05,  2.07585589e-04,
         6.44859275e-07,  4.37689051e-07, -1.25863591e-07],
       [-8.57527133e-06,  2.61289005e-05,  1.53450303e-04,
         4.37689051e-07,  3.83964737e-07, -7.65021022e-08],
       [ 1.77261742e-06, -6.05735260e-06, -2.99904811e-05,
        -1.25863591e-07, -7.65021022e-08,  2.21951024e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.61340842e+03],
       [-2.52478780e+03],
       [-4.81844306e+03],
       [-4.08751625e+00],
       [-2.97449838e+00],
       [ 5.49347057e+00]]), 'covar': array([[ 5.95019319e-05, -1.40554118e-04, -9.55042492e-04,
        -2.50287584e-06, -1.72100681e-06,  5.50681287e-07],
       [-1.40554118e-04,  4.20026074e-04,  2.83051669e-03,
         7.80717226e-06,  5.25850686e-06, -1.81774686e-06],
       [-9.55042492e-04,  2.83051669e-03,  2.09730696e-02,
         5.44158197e-05,  3.57971456e-05, -1.10537664e-05],
       [-2.50287584e-06,  7.80717226e-06,  5.44158197e-05,
         1.52695211e-07,  9.94243605e-08, -3.50193989e-08],
       [-1.72100681e-06,  5.25850686e-06,  3.57971456e-05,
         9.94243605e-08,  6.75104774e-08, -2.34120118e-08],
       [ 5.50681287e-07, -1.81774686e-06, -1.10537664e-05,
        -3.50193989e-08, -2.34120118e-08,  1.18843841e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-6.41567871e-06],
       [ 8.52352202e-06],
       [-2.70460347e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.61340399e+03],
       [-2.52480802e+03],
       [-4.81860655e+03],
       [-4.08798117e+00],
       [-2.97478690e+00],
       [ 5.49347354e+00],
       [ 1.30559809e-01],
       [ 4.98381067e-03],
       [ 9.50729601e-01],
       [-2.81145021e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80291907e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.25206211e-04, -6.27936547e-04, -3.72743427e-03,
        -1.02715779e-05, -8.57527133e-06,  1.77261742e-06],
       [-6.27936547e-04,  1.90671757e-03,  1.14451544e-02,
         3.30448913e-05,  2.61289005e-05, -6.05735260e-06],
       [-3.72743427e-03,  1.14451544e-02,  7.29824816e-02,
         2.07585589e-04,  1.53450303e-04, -2.99904811e-05],
       [-1.02715779e-05,  3.30448913e-05,  2.07585589e-04,
         6.44859275e-07,  4.37689051e-07, -1.25863591e-07],
       [-8.57527133e-06,  2.61289005e-05,  1.53450303e-04,
         4.37689051e-07,  3.83964737e-07, -7.65021022e-08],
       [ 1.77261742e-06, -6.05735260e-06, -2.99904811e-05,
        -1.25863591e-07, -7.65021022e-08,  2.21951024e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.00850161e-06],
       [1.75378198e-05],
       [5.32129899e-02]])}}
Current time:  2018-07-13 08:25:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.61340399e+03],
       [-2.52480802e+03],
       [-4.81860655e+03],
       [-4.08798117e+00],
       [-2.97478690e+00],
       [ 5.49347354e+00],
       [ 1.30559809e-01],
       [ 4.98381067e-03],
       [ 9.50729601e-01],
       [-2.81145021e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80291907e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.25206211e-04, -6.27936547e-04, -3.72743427e-03,
        -1.02715779e-05, -8.57527133e-06,  1.77261742e-06],
       [-6.27936547e-04,  1.90671757e-03,  1.14451544e-02,
         3.30448913e-05,  2.61289005e-05, -6.05735260e-06],
       [-3.72743427e-03,  1.14451544e-02,  7.29824816e-02,
         2.07585589e-04,  1.53450303e-04, -2.99904811e-05],
       [-1.02715779e-05,  3.30448913e-05,  2.07585589e-04,
         6.44859275e-07,  4.37689051e-07, -1.25863591e-07],
       [-8.57527133e-06,  2.61289005e-05,  1.53450303e-04,
         4.37689051e-07,  3.83964737e-07, -7.65021022e-08],
       [ 1.77261742e-06, -6.05735260e-06, -2.99904811e-05,
        -1.25863591e-07, -7.65021022e-08,  2.21951024e-07]])}
[[-4.61340399e+03]
 [-2.52480802e+03]
 [-4.81860655e+03]
 [-4.08798117e+00]
 [-2.97478690e+00]
 [ 5.49347354e+00]
 [ 1.30559809e-01]
 [ 4.98381067e-03]
 [ 9.50729601e-01]
 [-2.81145021e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80291907e-18]]
2018-07-13 08:24:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:00
[[-4.65403007e+03]
 [-2.55441676e+03]
 [-4.76340806e+03]
 [-4.03716627e+00]
 [-2.94693665e+00]
 [ 5.54614995e+00]
 [ 1.35522086e-01]
 [ 6.45168895e-03]
 [ 9.50034948e-01]
 [-2.81115167e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80313136e-18]]
[[ 8.42614832e-05 -3.38483829e-04 -1.64086446e-03 -3.78264573e-06
  -4.19643798e-06  5.04163487e-07]
 [-3.38483829e-04  2.46886134e-03  1.29140326e-02  3.76306339e-05
   3.01056012e-05 -6.76169354e-06]
 [-1.64086446e-03  1.29140326e-02  7.24085281e-02  2.07459207e-04
   1.53157459e-04 -2.73791914e-05]
 [-3.78264573e-06  3.76306339e-05  2.07459207e-04  6.61321103e-07
   4.41428435e-07 -1.25328849e-07]
 [-4.19643798e-06  3.01056012e-05  1.53157459e-04  4.41428435e-07
   3.95900959e-07 -7.59437986e-08]
 [ 5.04163487e-07 -6.76169354e-06 -2.73791914e-05 -1.25328849e-07
  -7.59437986e-08  2.31656800e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.61340842e+03],
       [-2.52478780e+03],
       [-4.81844306e+03],
       [-4.08751625e+00],
       [-2.97449838e+00],
       [ 5.49347057e+00]]), 'covar': array([[ 5.95019319e-05, -1.40554118e-04, -9.55042492e-04,
        -2.50287584e-06, -1.72100681e-06,  5.50681287e-07],
       [-1.40554118e-04,  4.20026074e-04,  2.83051669e-03,
         7.80717226e-06,  5.25850686e-06, -1.81774686e-06],
       [-9.55042492e-04,  2.83051669e-03,  2.09730696e-02,
         5.44158197e-05,  3.57971456e-05, -1.10537664e-05],
       [-2.50287584e-06,  7.80717226e-06,  5.44158197e-05,
         1.52695211e-07,  9.94243605e-08, -3.50193989e-08],
       [-1.72100681e-06,  5.25850686e-06,  3.57971456e-05,
         9.94243605e-08,  6.75104774e-08, -2.34120118e-08],
       [ 5.50681287e-07, -1.81774686e-06, -1.10537664e-05,
        -3.50193989e-08, -2.34120118e-08,  1.18843841e-08]])}
[[-4.61340842e+03]
 [-2.52478780e+03]
 [-4.81844306e+03]
 [-4.08751625e+00]
 [-2.97449838e+00]
 [ 5.49347057e+00]]
2018-07-13 08:24:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:00
[[-4.65402973e+03]
 [-2.55439377e+03]
 [-4.76324433e+03]
 [-4.03669863e+00]
 [-2.94664684e+00]
 [ 5.54614744e+00]]
[[ 2.47496293e-05 -6.94859541e-05 -4.07201384e-04 -9.77429986e-07
  -7.26476057e-07  1.97683358e-07]
 [-6.94859541e-05  5.32166493e-04  3.16876398e-03  8.85241811e-06
   5.95606848e-06 -2.03748103e-06]
 [-4.07201384e-04  3.16876398e-03  2.07542192e-02  5.43868482e-05
   3.57023618e-05 -1.08392934e-05]
 [-9.77429986e-07  8.85241811e-06  5.43868482e-05  1.54475780e-07
   1.00336075e-07 -3.49361052e-08]
 [-7.26476057e-07  5.95606848e-06  3.57023618e-05  1.00336075e-07
   6.80789437e-08 -2.33153641e-08]
 [ 1.97683358e-07 -2.03748103e-06 -1.08392934e-05 -3.49361052e-08
  -2.33153641e-08  1.18792833e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 24, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.65402973e+03],
       [-2.55439377e+03],
       [-4.76324433e+03],
       [-4.03669863e+00],
       [-2.94664684e+00],
       [ 5.54614744e+00]]), 'covar': array([[ 2.47496293e-05, -6.94859541e-05, -4.07201384e-04,
        -9.77429986e-07, -7.26476057e-07,  1.97683358e-07],
       [-6.94859541e-05,  5.32166493e-04,  3.16876398e-03,
         8.85241811e-06,  5.95606848e-06, -2.03748103e-06],
       [-4.07201384e-04,  3.16876398e-03,  2.07542192e-02,
         5.43868482e-05,  3.57023618e-05, -1.08392934e-05],
       [-9.77429986e-07,  8.85241811e-06,  5.43868482e-05,
         1.54475780e-07,  1.00336075e-07, -3.49361052e-08],
       [-7.26476057e-07,  5.95606848e-06,  3.57023618e-05,
         1.00336075e-07,  6.80789437e-08, -2.33153641e-08],
       [ 1.97683358e-07, -2.03748103e-06, -1.08392934e-05,
        -3.49361052e-08, -2.33153641e-08,  1.18792833e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-6.41567871e-06],
       [ 8.52352202e-06],
       [-2.70460347e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 24, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.65403007e+03],
       [-2.55441676e+03],
       [-4.76340806e+03],
       [-4.03716627e+00],
       [-2.94693665e+00],
       [ 5.54614995e+00],
       [ 1.35522086e-01],
       [ 6.45168895e-03],
       [ 9.50034948e-01],
       [-2.81115167e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80313136e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.42614832e-05, -3.38483829e-04, -1.64086446e-03,
        -3.78264573e-06, -4.19643798e-06,  5.04163487e-07],
       [-3.38483829e-04,  2.46886134e-03,  1.29140326e-02,
         3.76306339e-05,  3.01056012e-05, -6.76169354e-06],
       [-1.64086446e-03,  1.29140326e-02,  7.24085281e-02,
         2.07459207e-04,  1.53157459e-04, -2.73791914e-05],
       [-3.78264573e-06,  3.76306339e-05,  2.07459207e-04,
         6.61321103e-07,  4.41428435e-07, -1.25328849e-07],
       [-4.19643798e-06,  3.01056012e-05,  1.53157459e-04,
         4.41428435e-07,  3.95900959e-07, -7.59437986e-08],
       [ 5.04163487e-07, -6.76169354e-06, -2.73791914e-05,
        -1.25328849e-07, -7.59437986e-08,  2.31656800e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.00850161e-06],
       [1.75378198e-05],
       [5.32129899e-02]])}}
Yi [[-1.47548794]
 [-1.35602612]
 [11.22549416]]
posterior
[[-4.65403007e+03]
 [-2.55441676e+03]
 [-4.76340806e+03]
 [-4.03716627e+00]
 [-2.94693665e+00]
 [ 5.54614995e+00]
 [ 1.35522086e-01]
 [ 6.45168895e-03]
 [ 9.50034948e-01]
 [-2.81115167e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80313136e-18]]
[[-4.65403001e+03]
 [-2.55440697e+03]
 [-4.76331978e+03]
 [-4.03692286e+00]
 [-2.94684969e+00]
 [ 5.54617649e+00]
 [ 1.35522086e-01]
 [ 6.45168895e-03]
 [ 9.50034948e-01]
 [-2.81115167e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80313136e-18]]
[[ 4.85256449e-05 -2.60772029e-04 -1.29742482e-03 -3.47962727e-06
  -3.22428177e-06  6.20385584e-07]
 [-2.60772029e-04  2.21615815e-03  1.14225486e-02  3.49205164e-05
   2.72389819e-05 -7.22883052e-06]
 [-1.29742482e-03  1.14225486e-02  6.24837872e-02  1.86300657e-04
   1.37120527e-04 -3.04038884e-05]
 [-3.47962727e-06  3.49205164e-05  1.86300657e-04  6.08490711e-07
   4.14745450e-07 -1.31568593e-07]
 [-3.22428177e-06  2.72389819e-05  1.37120527e-04  4.14745450e-07
   3.62688794e-07 -8.10324079e-08]
 [ 6.20385584e-07 -7.22883052e-06 -3.04038884e-05 -1.31568593e-07
  -8.10324079e-08  2.30728462e-07]]
[[-1.47549331]
 [-1.35605726]
 [11.10840678]]
[[5.36690075e-06]
 [3.11380498e-05]
 [1.17087380e-01]]


 Corrector Step
2018-07-13 08:25:00
[[-4.65403001e+03]
 [-2.55440697e+03]
 [-4.76331978e+03]
 [-4.03692286e+00]
 [-2.94684969e+00]
 [ 5.54617649e+00]
 [ 1.35522086e-01]
 [ 6.45168895e-03]
 [ 9.50034948e-01]
 [-2.81115167e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80313136e-18]]
[[ 4.85256449e-05 -2.60772029e-04 -1.29742482e-03 -3.47962727e-06
  -3.22428177e-06  6.20385584e-07]
 [-2.60772029e-04  2.21615815e-03  1.14225486e-02  3.49205164e-05
   2.72389819e-05 -7.22883052e-06]
 [-1.29742482e-03  1.14225486e-02  6.24837872e-02  1.86300657e-04
   1.37120527e-04 -3.04038884e-05]
 [-3.47962727e-06  3.49205164e-05  1.86300657e-04  6.08490711e-07
   4.14745450e-07 -1.31568593e-07]
 [-3.22428177e-06  2.72389819e-05  1.37120527e-04  4.14745450e-07
   3.62688794e-07 -8.10324079e-08]
 [ 6.20385584e-07 -7.22883052e-06 -3.04038884e-05 -1.31568593e-07
  -8.10324079e-08  2.30728462e-07]]
170272750.49481767
post
cubesat_nadir
Ybar_post [[-1.4754893 ]
 [-1.35604914]
 [11.10822239]]
resids [[1.35589414e-06]
 [2.30252440e-05]
 [1.17271774e-01]]
posterior
[[-4.65402973e+03]
 [-2.55439377e+03]
 [-4.76324433e+03]
 [-4.03669863e+00]
 [-2.94664684e+00]
 [ 5.54614744e+00]]
[[-4.65403059e+03]
 [-2.55438933e+03]
 [-4.76320760e+03]
 [-4.03661907e+00]
 [-2.94659685e+00]
 [ 5.54613894e+00]]
[[ 1.80168666e-05 -6.01366000e-05 -3.46551052e-04 -8.78457719e-07
  -6.39011193e-07  1.91031713e-07]
 [-6.01366000e-05  4.99766011e-04  2.90965687e-03  8.31363500e-06
   5.60233408e-06 -1.98368601e-06]
 [-3.46551052e-04  2.90965687e-03  1.86327323e-02  4.98805201e-05
   3.28224361e-05 -1.03780681e-05]
 [-8.78457719e-07  8.31363500e-06  4.98805201e-05  1.44725358e-07
   9.42493435e-08 -3.39173508e-08]
 [-6.39011193e-07  5.60233408e-06  3.28224361e-05  9.42493435e-08
   6.41641435e-08 -2.26959390e-08]
 [ 1.91031713e-07 -1.98368601e-06 -1.03780681e-05 -3.39173508e-08
  -2.26959390e-08  1.17704547e-08]]
[[-1.47548297]
 [-1.35604626]
 [11.44319534]]
[[-4.97450512e-06]
 [ 2.01409929e-05]
 [-2.17701180e-01]]


 Corrector Step
2018-07-13 08:25:00
[[-4.65403059e+03]
 [-2.55438933e+03]
 [-4.76320760e+03]
 [-4.03661907e+00]
 [-2.94659685e+00]
 [ 5.54613894e+00]]
[[ 1.80168666e-05 -6.01366000e-05 -3.46551052e-04 -8.78457719e-07
  -6.39011193e-07  1.91031713e-07]
 [-6.01366000e-05  4.99766011e-04  2.90965687e-03  8.31363500e-06
   5.60233408e-06 -1.98368601e-06]
 [-3.46551052e-04  2.90965687e-03  1.86327323e-02  4.98805201e-05
   3.28224361e-05 -1.03780681e-05]
 [-8.78457719e-07  8.31363500e-06  4.98805201e-05  1.44725358e-07
   9.42493435e-08 -3.39173508e-08]
 [-6.39011193e-07  5.60233408e-06  3.28224361e-05  9.42493435e-08
   6.41641435e-08 -2.26959390e-08]
 [ 1.91031713e-07 -1.98368601e-06 -1.03780681e-05 -3.39173508e-08
  -2.26959390e-08  1.17704547e-08]]
56665866.01005358
post
sphere_lamr_small
Ybar_post [[-1.47548474]
 [-1.35604323]
 [11.44312216]]
resids [[-3.20567832e-06]
 [ 1.71154559e-05]
 [-2.17628000e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [170272750.49481767, 56665866.01005358]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.65403001e+03],
       [-2.55440697e+03],
       [-4.76331978e+03],
       [-4.03692286e+00],
       [-2.94684969e+00],
       [ 5.54617649e+00]]), 'est_covars': array([[ 4.85256449e-05, -2.60772029e-04, -1.29742482e-03,
        -3.47962727e-06, -3.22428177e-06,  6.20385584e-07],
       [-2.60772029e-04,  2.21615815e-03,  1.14225486e-02,
         3.49205164e-05,  2.72389819e-05, -7.22883052e-06],
       [-1.29742482e-03,  1.14225486e-02,  6.24837872e-02,
         1.86300657e-04,  1.37120527e-04, -3.04038884e-05],
       [-3.47962727e-06,  3.49205164e-05,  1.86300657e-04,
         6.08490711e-07,  4.14745450e-07, -1.31568593e-07],
       [-3.22428177e-06,  2.72389819e-05,  1.37120527e-04,
         4.14745450e-07,  3.62688794e-07, -8.10324079e-08],
       [ 6.20385584e-07, -7.22883052e-06, -3.04038884e-05,
        -1.31568593e-07, -8.10324079e-08,  2.30728462e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.65403059e+03],
       [-2.55438933e+03],
       [-4.76320760e+03],
       [-4.03661907e+00],
       [-2.94659685e+00],
       [ 5.54613894e+00]]), 'covar': array([[ 1.80168666e-05, -6.01366000e-05, -3.46551052e-04,
        -8.78457719e-07, -6.39011193e-07,  1.91031713e-07],
       [-6.01366000e-05,  4.99766011e-04,  2.90965687e-03,
         8.31363500e-06,  5.60233408e-06, -1.98368601e-06],
       [-3.46551052e-04,  2.90965687e-03,  1.86327323e-02,
         4.98805201e-05,  3.28224361e-05, -1.03780681e-05],
       [-8.78457719e-07,  8.31363500e-06,  4.98805201e-05,
         1.44725358e-07,  9.42493435e-08, -3.39173508e-08],
       [-6.39011193e-07,  5.60233408e-06,  3.28224361e-05,
         9.42493435e-08,  6.41641435e-08, -2.26959390e-08],
       [ 1.91031713e-07, -1.98368601e-06, -1.03780681e-05,
        -3.39173508e-08, -2.26959390e-08,  1.17704547e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.20567832e-06],
       [ 1.71154559e-05],
       [-2.17628000e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.65403001e+03],
       [-2.55440697e+03],
       [-4.76331978e+03],
       [-4.03692286e+00],
       [-2.94684969e+00],
       [ 5.54617649e+00],
       [ 1.35522086e-01],
       [ 6.45168895e-03],
       [ 9.50034948e-01],
       [-2.81115167e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80313136e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.85256449e-05, -2.60772029e-04, -1.29742482e-03,
        -3.47962727e-06, -3.22428177e-06,  6.20385584e-07],
       [-2.60772029e-04,  2.21615815e-03,  1.14225486e-02,
         3.49205164e-05,  2.72389819e-05, -7.22883052e-06],
       [-1.29742482e-03,  1.14225486e-02,  6.24837872e-02,
         1.86300657e-04,  1.37120527e-04, -3.04038884e-05],
       [-3.47962727e-06,  3.49205164e-05,  1.86300657e-04,
         6.08490711e-07,  4.14745450e-07, -1.31568593e-07],
       [-3.22428177e-06,  2.72389819e-05,  1.37120527e-04,
         4.14745450e-07,  3.62688794e-07, -8.10324079e-08],
       [ 6.20385584e-07, -7.22883052e-06, -3.04038884e-05,
        -1.31568593e-07, -8.10324079e-08,  2.30728462e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.35589414e-06],
       [2.30252440e-05],
       [1.17271774e-01]])}}
Current time:  2018-07-13 08:25:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.65403001e+03],
       [-2.55440697e+03],
       [-4.76331978e+03],
       [-4.03692286e+00],
       [-2.94684969e+00],
       [ 5.54617649e+00],
       [ 1.35522086e-01],
       [ 6.45168895e-03],
       [ 9.50034948e-01],
       [-2.81115167e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80313136e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.85256449e-05, -2.60772029e-04, -1.29742482e-03,
        -3.47962727e-06, -3.22428177e-06,  6.20385584e-07],
       [-2.60772029e-04,  2.21615815e-03,  1.14225486e-02,
         3.49205164e-05,  2.72389819e-05, -7.22883052e-06],
       [-1.29742482e-03,  1.14225486e-02,  6.24837872e-02,
         1.86300657e-04,  1.37120527e-04, -3.04038884e-05],
       [-3.47962727e-06,  3.49205164e-05,  1.86300657e-04,
         6.08490711e-07,  4.14745450e-07, -1.31568593e-07],
       [-3.22428177e-06,  2.72389819e-05,  1.37120527e-04,
         4.14745450e-07,  3.62688794e-07, -8.10324079e-08],
       [ 6.20385584e-07, -7.22883052e-06, -3.04038884e-05,
        -1.31568593e-07, -8.10324079e-08,  2.30728462e-07]])}
[[-4.65403001e+03]
 [-2.55440697e+03]
 [-4.76331978e+03]
 [-4.03692286e+00]
 [-2.94684969e+00]
 [ 5.54617649e+00]
 [ 1.35522086e-01]
 [ 6.45168895e-03]
 [ 9.50034948e-01]
 [-2.81115167e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80313136e-18]]
2018-07-13 08:25:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:10
[[-4.69414317e+03]
 [-2.58373486e+03]
 [-4.70759737e+03]
 [-3.98565720e+00]
 [-2.91867194e+00]
 [ 5.59825019e+00]
 [ 1.40480669e-01]
 [ 7.91939134e-03]
 [ 9.49314395e-01]
 [-2.81077649e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80334365e-18]]
[[ 4.01620033e-05  9.87004122e-05  5.63470631e-04  2.67895784e-06
   9.38131825e-07 -6.94594709e-07]
 [ 9.87004122e-05  2.79827432e-03  1.27157013e-02  3.92770586e-05
   3.10022544e-05 -7.97482827e-06]
 [ 5.63470631e-04  1.27157013e-02  6.19022496e-02  1.85971146e-04
   1.36718940e-04 -2.77349975e-05]
 [ 2.67895784e-06  3.92770586e-05  1.85971146e-04  6.24399662e-07
   4.18144615e-07 -1.31090367e-07]
 [ 9.38131825e-07  3.10022544e-05  1.36718940e-04  4.18144615e-07
   3.74438404e-07 -8.05065697e-08]
 [-6.94594709e-07 -7.97482827e-06 -2.77349975e-05 -1.31090367e-07
  -8.05065697e-08  2.40398498e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.65403059e+03],
       [-2.55438933e+03],
       [-4.76320760e+03],
       [-4.03661907e+00],
       [-2.94659685e+00],
       [ 5.54613894e+00]]), 'covar': array([[ 1.80168666e-05, -6.01366000e-05, -3.46551052e-04,
        -8.78457719e-07, -6.39011193e-07,  1.91031713e-07],
       [-6.01366000e-05,  4.99766011e-04,  2.90965687e-03,
         8.31363500e-06,  5.60233408e-06, -1.98368601e-06],
       [-3.46551052e-04,  2.90965687e-03,  1.86327323e-02,
         4.98805201e-05,  3.28224361e-05, -1.03780681e-05],
       [-8.78457719e-07,  8.31363500e-06,  4.98805201e-05,
         1.44725358e-07,  9.42493435e-08, -3.39173508e-08],
       [-6.39011193e-07,  5.60233408e-06,  3.28224361e-05,
         9.42493435e-08,  6.41641435e-08, -2.26959390e-08],
       [ 1.91031713e-07, -1.98368601e-06, -1.03780681e-05,
        -3.39173508e-08, -2.26959390e-08,  1.17704547e-08]])}
[[-4.65403059e+03]
 [-2.55438933e+03]
 [-4.76320760e+03]
 [-4.03661907e+00]
 [-2.94659685e+00]
 [ 5.54613894e+00]]
2018-07-13 08:25:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:10
[[-4.69414044e+03]
 [-2.58371466e+03]
 [-4.70748531e+03]
 [-3.98535163e+00]
 [-2.91841831e+00]
 [ 5.59821305e+00]]
[[ 1.53571503e-05  2.63216630e-05  1.52306849e-04  5.75758100e-07
   3.07323896e-07 -1.48339763e-07]
 [ 2.63216630e-05  6.18446269e-04  3.21647924e-03  9.30854979e-06
   6.26690280e-06 -2.19507411e-06]
 [ 1.52306849e-04  3.21647924e-03  1.84272459e-02  4.98308590e-05
   3.27206796e-05 -1.01711675e-05]
 [ 5.75758100e-07  9.30854979e-06  4.98308590e-05  1.46390463e-07
   9.50972210e-08 -3.38346659e-08]
 [ 3.07323896e-07  6.26690280e-06  3.27206796e-05  9.50972210e-08
   6.46984435e-08 -2.26007907e-08]
 [-1.48339763e-07 -2.19507411e-06 -1.01711675e-05 -3.38346659e-08
  -2.26007907e-08  1.17645500e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.69414044e+03],
       [-2.58371466e+03],
       [-4.70748531e+03],
       [-3.98535163e+00],
       [-2.91841831e+00],
       [ 5.59821305e+00]]), 'covar': array([[ 1.53571503e-05,  2.63216630e-05,  1.52306849e-04,
         5.75758100e-07,  3.07323896e-07, -1.48339763e-07],
       [ 2.63216630e-05,  6.18446269e-04,  3.21647924e-03,
         9.30854979e-06,  6.26690280e-06, -2.19507411e-06],
       [ 1.52306849e-04,  3.21647924e-03,  1.84272459e-02,
         4.98308590e-05,  3.27206796e-05, -1.01711675e-05],
       [ 5.75758100e-07,  9.30854979e-06,  4.98308590e-05,
         1.46390463e-07,  9.50972210e-08, -3.38346659e-08],
       [ 3.07323896e-07,  6.26690280e-06,  3.27206796e-05,
         9.50972210e-08,  6.46984435e-08, -2.26007907e-08],
       [-1.48339763e-07, -2.19507411e-06, -1.01711675e-05,
        -3.38346659e-08, -2.26007907e-08,  1.17645500e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.20567832e-06],
       [ 1.71154559e-05],
       [-2.17628000e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.69414317e+03],
       [-2.58373486e+03],
       [-4.70759737e+03],
       [-3.98565720e+00],
       [-2.91867194e+00],
       [ 5.59825019e+00],
       [ 1.40480669e-01],
       [ 7.91939134e-03],
       [ 9.49314395e-01],
       [-2.81077649e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80334365e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.01620033e-05,  9.87004122e-05,  5.63470631e-04,
         2.67895784e-06,  9.38131825e-07, -6.94594709e-07],
       [ 9.87004122e-05,  2.79827432e-03,  1.27157013e-02,
         3.92770586e-05,  3.10022544e-05, -7.97482827e-06],
       [ 5.63470631e-04,  1.27157013e-02,  6.19022496e-02,
         1.85971146e-04,  1.36718940e-04, -2.77349975e-05],
       [ 2.67895784e-06,  3.92770586e-05,  1.85971146e-04,
         6.24399662e-07,  4.18144615e-07, -1.31090367e-07],
       [ 9.38131825e-07,  3.10022544e-05,  1.36718940e-04,
         4.18144615e-07,  3.74438404e-07, -8.05065697e-08],
       [-6.94594709e-07, -7.97482827e-06, -2.77349975e-05,
        -1.31090367e-07, -8.05065697e-08,  2.40398498e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.35589414e-06],
       [2.30252440e-05],
       [1.17271774e-01]])}}
Yi [[-1.64138362]
 [-1.32213895]
 [10.80421217]]
posterior
[[-4.69414317e+03]
 [-2.58373486e+03]
 [-4.70759737e+03]
 [-3.98565720e+00]
 [-2.91867194e+00]
 [ 5.59825019e+00]
 [ 1.40480669e-01]
 [ 7.91939134e-03]
 [ 9.49314395e-01]
 [-2.81077649e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80334365e-18]]
[[-4.69414427e+03]
 [-2.58373516e+03]
 [-4.70760909e+03]
 [-3.98570613e+00]
 [-2.91866382e+00]
 [ 5.59824517e+00]
 [ 1.40480669e-01]
 [ 7.91939134e-03]
 [ 9.49314395e-01]
 [-2.81077649e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80334365e-18]]
[[ 2.54738756e-05  1.23121167e-04  5.92260942e-04  2.44279119e-06
   1.30721924e-06 -6.76141993e-07]
 [ 1.23121167e-04  2.49305027e-03  1.10397563e-02  3.58688359e-05
   2.78615071e-05 -8.54186921e-06]
 [ 5.92260942e-04  1.10397563e-02  5.18289243e-02  1.63049086e-04
   1.20447783e-04 -3.10716044e-05]
 [ 2.44279119e-06  3.58688359e-05  1.63049086e-04  5.66008555e-07
   3.87781452e-07 -1.38498110e-07]
 [ 1.30721924e-06  2.78615071e-05  1.20447783e-04  3.87781452e-07
   3.41030319e-07 -8.60919418e-08]
 [-6.76141993e-07 -8.54186921e-06 -3.10716044e-05 -1.38498110e-07
  -8.60919418e-08  2.39286890e-07]]
[[-1.64137575]
 [-1.32213172]
 [10.98892164]]
[[-7.87362074e-06]
 [-7.22896227e-06]
 [-1.84709471e-01]]


 Corrector Step
2018-07-13 08:25:10
[[-4.69414427e+03]
 [-2.58373516e+03]
 [-4.70760909e+03]
 [-3.98570613e+00]
 [-2.91866382e+00]
 [ 5.59824517e+00]
 [ 1.40480669e-01]
 [ 7.91939134e-03]
 [ 9.49314395e-01]
 [-2.81077649e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80334365e-18]]
[[ 2.54738756e-05  1.23121167e-04  5.92260942e-04  2.44279119e-06
   1.30721924e-06 -6.76141993e-07]
 [ 1.23121167e-04  2.49305027e-03  1.10397563e-02  3.58688359e-05
   2.78615071e-05 -8.54186921e-06]
 [ 5.92260942e-04  1.10397563e-02  5.18289243e-02  1.63049086e-04
   1.20447783e-04 -3.10716044e-05]
 [ 2.44279119e-06  3.58688359e-05  1.63049086e-04  5.66008555e-07
   3.87781452e-07 -1.38498110e-07]
 [ 1.30721924e-06  2.78615071e-05  1.20447783e-04  3.87781452e-07
   3.41030319e-07 -8.60919418e-08]
 [-6.76141993e-07 -8.54186921e-06 -3.10716044e-05 -1.38498110e-07
  -8.60919418e-08  2.39286890e-07]]
110429317.70265006
post
cubesat_nadir
Ybar_post [[-1.64137981]
 [-1.32213409]
 [10.98894986]]
resids [[-3.81208543e-06]
 [-4.86383972e-06]
 [-1.84737691e-01]]
posterior
[[-4.69414044e+03]
 [-2.58371466e+03]
 [-4.70748531e+03]
 [-3.98535163e+00]
 [-2.91841831e+00]
 [ 5.59821305e+00]]
[[-4.69414144e+03]
 [-2.58371685e+03]
 [-4.70750523e+03]
 [-3.98540155e+00]
 [-2.91844344e+00]
 [ 5.59821846e+00]]
[[ 1.19925135e-05  2.78564642e-05  1.50947136e-04  5.51499946e-07
   3.12817070e-07 -1.44923547e-07]
 [ 2.78564642e-05  5.70297653e-04  2.87719734e-03  8.56157704e-06
   5.78463221e-06 -2.10994215e-06]
 [ 1.50947136e-04  2.87719734e-03  1.59917618e-02  4.43907643e-05
   2.92860553e-05 -9.54878125e-06]
 [ 5.51499946e-07  8.56157704e-06  4.43907643e-05  1.34105128e-07
   8.74720928e-08 -3.24250767e-08]
 [ 3.12817070e-07  5.78463221e-06  2.92860553e-05  8.74720928e-08
   5.98384417e-08 -2.17298193e-08]
 [-1.44923547e-07 -2.10994215e-06 -9.54878125e-06 -3.24250767e-08
  -2.17298193e-08  1.16026880e-08]]
[[-1.64137092]
 [-1.32212451]
 [11.33396888]]
[[-1.27015970e-05]
 [-1.44411243e-05]
 [-5.29756707e-01]]


 Corrector Step
2018-07-13 08:25:10
[[-4.69414144e+03]
 [-2.58371685e+03]
 [-4.70750523e+03]
 [-3.98540155e+00]
 [-2.91844344e+00]
 [ 5.59821846e+00]]
[[ 1.19925135e-05  2.78564642e-05  1.50947136e-04  5.51499946e-07
   3.12817070e-07 -1.44923547e-07]
 [ 2.78564642e-05  5.70297653e-04  2.87719734e-03  8.56157704e-06
   5.78463221e-06 -2.10994215e-06]
 [ 1.50947136e-04  2.87719734e-03  1.59917618e-02  4.43907643e-05
   2.92860553e-05 -9.54878125e-06]
 [ 5.51499946e-07  8.56157704e-06  4.43907643e-05  1.34105128e-07
   8.74720928e-08 -3.24250767e-08]
 [ 3.12817070e-07  5.78463221e-06  2.92860553e-05  8.74720928e-08
   5.98384417e-08 -2.17298193e-08]
 [-1.44923547e-07 -2.10994215e-06 -9.54878125e-06 -3.24250767e-08
  -2.17298193e-08  1.16026880e-08]]
524.6352386228408
post
sphere_lamr_small
Ybar_post [[-1.64137409]
 [-1.32212702]
 [11.33401159]]
resids [[-9.53095964e-06]
 [-1.19307902e-05]
 [-5.29799422e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [110429317.70265006, 524.6352386228408]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.69414427e+03],
       [-2.58373516e+03],
       [-4.70760909e+03],
       [-3.98570613e+00],
       [-2.91866382e+00],
       [ 5.59824517e+00]]), 'est_covars': array([[ 2.54738756e-05,  1.23121167e-04,  5.92260942e-04,
         2.44279119e-06,  1.30721924e-06, -6.76141993e-07],
       [ 1.23121167e-04,  2.49305027e-03,  1.10397563e-02,
         3.58688359e-05,  2.78615071e-05, -8.54186921e-06],
       [ 5.92260942e-04,  1.10397563e-02,  5.18289243e-02,
         1.63049086e-04,  1.20447783e-04, -3.10716044e-05],
       [ 2.44279119e-06,  3.58688359e-05,  1.63049086e-04,
         5.66008555e-07,  3.87781452e-07, -1.38498110e-07],
       [ 1.30721924e-06,  2.78615071e-05,  1.20447783e-04,
         3.87781452e-07,  3.41030319e-07, -8.60919418e-08],
       [-6.76141993e-07, -8.54186921e-06, -3.10716044e-05,
        -1.38498110e-07, -8.60919418e-08,  2.39286890e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.69414144e+03],
       [-2.58371685e+03],
       [-4.70750523e+03],
       [-3.98540155e+00],
       [-2.91844344e+00],
       [ 5.59821846e+00]]), 'covar': array([[ 1.19925135e-05,  2.78564642e-05,  1.50947136e-04,
         5.51499946e-07,  3.12817070e-07, -1.44923547e-07],
       [ 2.78564642e-05,  5.70297653e-04,  2.87719734e-03,
         8.56157704e-06,  5.78463221e-06, -2.10994215e-06],
       [ 1.50947136e-04,  2.87719734e-03,  1.59917618e-02,
         4.43907643e-05,  2.92860553e-05, -9.54878125e-06],
       [ 5.51499946e-07,  8.56157704e-06,  4.43907643e-05,
         1.34105128e-07,  8.74720928e-08, -3.24250767e-08],
       [ 3.12817070e-07,  5.78463221e-06,  2.92860553e-05,
         8.74720928e-08,  5.98384417e-08, -2.17298193e-08],
       [-1.44923547e-07, -2.10994215e-06, -9.54878125e-06,
        -3.24250767e-08, -2.17298193e-08,  1.16026880e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-9.53095964e-06],
       [-1.19307902e-05],
       [-5.29799422e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.69414427e+03],
       [-2.58373516e+03],
       [-4.70760909e+03],
       [-3.98570613e+00],
       [-2.91866382e+00],
       [ 5.59824517e+00],
       [ 1.40480669e-01],
       [ 7.91939134e-03],
       [ 9.49314395e-01],
       [-2.81077649e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80334365e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.54738756e-05,  1.23121167e-04,  5.92260942e-04,
         2.44279119e-06,  1.30721924e-06, -6.76141993e-07],
       [ 1.23121167e-04,  2.49305027e-03,  1.10397563e-02,
         3.58688359e-05,  2.78615071e-05, -8.54186921e-06],
       [ 5.92260942e-04,  1.10397563e-02,  5.18289243e-02,
         1.63049086e-04,  1.20447783e-04, -3.10716044e-05],
       [ 2.44279119e-06,  3.58688359e-05,  1.63049086e-04,
         5.66008555e-07,  3.87781452e-07, -1.38498110e-07],
       [ 1.30721924e-06,  2.78615071e-05,  1.20447783e-04,
         3.87781452e-07,  3.41030319e-07, -8.60919418e-08],
       [-6.76141993e-07, -8.54186921e-06, -3.10716044e-05,
        -1.38498110e-07, -8.60919418e-08,  2.39286890e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.81208543e-06],
       [-4.86383972e-06],
       [-1.84737691e-01]])}}
Current time:  2018-07-13 08:25:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.69414427e+03],
       [-2.58373516e+03],
       [-4.70760909e+03],
       [-3.98570613e+00],
       [-2.91866382e+00],
       [ 5.59824517e+00],
       [ 1.40480669e-01],
       [ 7.91939134e-03],
       [ 9.49314395e-01],
       [-2.81077649e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80334365e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.54738756e-05,  1.23121167e-04,  5.92260942e-04,
         2.44279119e-06,  1.30721924e-06, -6.76141993e-07],
       [ 1.23121167e-04,  2.49305027e-03,  1.10397563e-02,
         3.58688359e-05,  2.78615071e-05, -8.54186921e-06],
       [ 5.92260942e-04,  1.10397563e-02,  5.18289243e-02,
         1.63049086e-04,  1.20447783e-04, -3.10716044e-05],
       [ 2.44279119e-06,  3.58688359e-05,  1.63049086e-04,
         5.66008555e-07,  3.87781452e-07, -1.38498110e-07],
       [ 1.30721924e-06,  2.78615071e-05,  1.20447783e-04,
         3.87781452e-07,  3.41030319e-07, -8.60919418e-08],
       [-6.76141993e-07, -8.54186921e-06, -3.10716044e-05,
        -1.38498110e-07, -8.60919418e-08,  2.39286890e-07]])}
[[-4.69414427e+03]
 [-2.58373516e+03]
 [-4.70760909e+03]
 [-3.98570613e+00]
 [-2.91866382e+00]
 [ 5.59824517e+00]
 [ 1.40480669e-01]
 [ 7.91939134e-03]
 [ 9.49314395e-01]
 [-2.81077649e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80334365e-18]]
2018-07-13 08:25:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:20
[[-4.73374313e+03]
 [-2.61277941e+03]
 [-4.65136845e+03]
 [-3.93399691e+00]
 [-2.89016237e+00]
 [ 5.64970980e+00]
 [ 1.45435422e-01]
 [ 9.38687783e-03]
 [ 9.48567961e-01]
 [-2.81032468e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80355593e-18]]
[[ 1.31547023e-04  5.34750535e-04  2.20640751e-03  8.20204372e-06
   5.20964084e-06 -2.05116698e-06]
 [ 5.34750535e-04  3.08548044e-03  1.21523729e-02  3.99506155e-05
   3.14051133e-05 -9.33628020e-06]
 [ 2.20640751e-03  1.21523729e-02  5.12347775e-02  1.62498824e-04
   1.19929629e-04 -2.83518811e-05]
 [ 8.20204372e-06  3.99506155e-05  1.62498824e-04  5.81295740e-07
   3.90817333e-07 -1.38095174e-07]
 [ 5.20964084e-06  3.14051133e-05  1.19929629e-04  3.90817333e-07
   3.52583681e-07 -8.56075628e-08]
 [-2.05116698e-06 -9.33628020e-06 -2.83518811e-05 -1.38095174e-07
  -8.56075628e-08  2.48913647e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.69414144e+03],
       [-2.58371685e+03],
       [-4.70750523e+03],
       [-3.98540155e+00],
       [-2.91844344e+00],
       [ 5.59821846e+00]]), 'covar': array([[ 1.19925135e-05,  2.78564642e-05,  1.50947136e-04,
         5.51499946e-07,  3.12817070e-07, -1.44923547e-07],
       [ 2.78564642e-05,  5.70297653e-04,  2.87719734e-03,
         8.56157704e-06,  5.78463221e-06, -2.10994215e-06],
       [ 1.50947136e-04,  2.87719734e-03,  1.59917618e-02,
         4.43907643e-05,  2.92860553e-05, -9.54878125e-06],
       [ 5.51499946e-07,  8.56157704e-06,  4.43907643e-05,
         1.34105128e-07,  8.74720928e-08, -3.24250767e-08],
       [ 3.12817070e-07,  5.78463221e-06,  2.92860553e-05,
         8.74720928e-08,  5.98384417e-08, -2.17298193e-08],
       [-1.44923547e-07, -2.10994215e-06, -9.54878125e-06,
        -3.24250767e-08, -2.17298193e-08,  1.16026880e-08]])}
[[-4.69414144e+03]
 [-2.58371685e+03]
 [-4.70750523e+03]
 [-3.98540155e+00]
 [-2.91844344e+00]
 [ 5.59821846e+00]]
2018-07-13 08:25:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:20
[[-4.73373738e+03]
 [-2.61275897e+03]
 [-4.65126520e+03]
 [-3.93369069e+00]
 [-2.88994128e+00]
 [ 5.64968378e+00]]
[[ 3.65649035e-05  1.25594663e-04  5.91424077e-04  1.90608375e-06
   1.19394513e-06 -4.66685785e-07]
 [ 1.25594663e-04  6.92206946e-04  3.14741327e-03  9.48842960e-06
   6.40564820e-06 -2.31096609e-06]
 [ 5.91424077e-04  3.14741327e-03  1.58027496e-02  4.43191549e-05
   2.91774530e-05 -9.35206742e-06]
 [ 1.90608375e-06  9.48842960e-06  4.43191549e-05  1.35623834e-07
   8.82399821e-08 -3.23458868e-08]
 [ 1.19394513e-06  6.40564820e-06  2.91774530e-05  8.82399821e-08
   6.03302739e-08 -2.16383076e-08]
 [-4.66685785e-07 -2.31096609e-06 -9.35206742e-06 -3.23458868e-08
  -2.16383076e-08  1.15976725e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.73373738e+03],
       [-2.61275897e+03],
       [-4.65126520e+03],
       [-3.93369069e+00],
       [-2.88994128e+00],
       [ 5.64968378e+00]]), 'covar': array([[ 3.65649035e-05,  1.25594663e-04,  5.91424077e-04,
         1.90608375e-06,  1.19394513e-06, -4.66685785e-07],
       [ 1.25594663e-04,  6.92206946e-04,  3.14741327e-03,
         9.48842960e-06,  6.40564820e-06, -2.31096609e-06],
       [ 5.91424077e-04,  3.14741327e-03,  1.58027496e-02,
         4.43191549e-05,  2.91774530e-05, -9.35206742e-06],
       [ 1.90608375e-06,  9.48842960e-06,  4.43191549e-05,
         1.35623834e-07,  8.82399821e-08, -3.23458868e-08],
       [ 1.19394513e-06,  6.40564820e-06,  2.91774530e-05,
         8.82399821e-08,  6.03302739e-08, -2.16383076e-08],
       [-4.66685785e-07, -2.31096609e-06, -9.35206742e-06,
        -3.23458868e-08, -2.16383076e-08,  1.15976725e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-9.53095964e-06],
       [-1.19307902e-05],
       [-5.29799422e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.73374313e+03],
       [-2.61277941e+03],
       [-4.65136845e+03],
       [-3.93399691e+00],
       [-2.89016237e+00],
       [ 5.64970980e+00],
       [ 1.45435422e-01],
       [ 9.38687783e-03],
       [ 9.48567961e-01],
       [-2.81032468e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80355593e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.31547023e-04,  5.34750535e-04,  2.20640751e-03,
         8.20204372e-06,  5.20964084e-06, -2.05116698e-06],
       [ 5.34750535e-04,  3.08548044e-03,  1.21523729e-02,
         3.99506155e-05,  3.14051133e-05, -9.33628020e-06],
       [ 2.20640751e-03,  1.21523729e-02,  5.12347775e-02,
         1.62498824e-04,  1.19929629e-04, -2.83518811e-05],
       [ 8.20204372e-06,  3.99506155e-05,  1.62498824e-04,
         5.81295740e-07,  3.90817333e-07, -1.38095174e-07],
       [ 5.20964084e-06,  3.14051133e-05,  1.19929629e-04,
         3.90817333e-07,  3.52583681e-07, -8.56075628e-08],
       [-2.05116698e-06, -9.33628020e-06, -2.83518811e-05,
        -1.38095174e-07, -8.56075628e-08,  2.48913647e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.81208543e-06],
       [-4.86383972e-06],
       [-1.84737691e-01]])}}
Yi [[-1.77390297]
 [-1.27975677]
 [10.94921368]]
posterior
[[-4.73374313e+03]
 [-2.61277941e+03]
 [-4.65136845e+03]
 [-3.93399691e+00]
 [-2.89016237e+00]
 [ 5.64970980e+00]
 [ 1.45435422e-01]
 [ 9.38687783e-03]
 [ 9.48567961e-01]
 [-2.81032468e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80355593e-18]]
[[-4.73374187e+03]
 [-2.61276692e+03]
 [-4.65130462e+03]
 [-3.93385482e+00]
 [-2.89004702e+00]
 [ 5.64973406e+00]
 [ 1.45435422e-01]
 [ 9.38687783e-03]
 [ 9.48567961e-01]
 [-2.81032468e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80355593e-18]]
[[ 1.15583838e-04  5.04201513e-04  1.96298794e-03  7.39875774e-06
   5.05973679e-06 -2.13265172e-06]
 [ 5.04201513e-04  2.73110603e-03  1.03854078e-02  3.61087775e-05
   2.80705506e-05 -9.98904031e-06]
 [ 1.96298794e-03  1.03854078e-02  4.18017007e-02  1.40116342e-04
   1.04243199e-04 -3.17793902e-05]
 [ 7.39875774e-06  3.61087775e-05  1.40116342e-04  5.22925281e-07
   3.59538555e-07 -1.46065104e-07]
 [ 5.05973679e-06  2.80705506e-05  1.04243199e-04  3.59538555e-07
   3.19786783e-07 -9.14892244e-08]
 [-2.13265172e-06 -9.98904031e-06 -3.17793902e-05 -1.46065104e-07
  -9.14892244e-08  2.47662233e-07]]
[[-1.77389264]
 [-1.27977452]
 [10.87247443]]
[[-1.03278943e-05]
 [ 1.77471235e-05]
 [ 7.67392529e-02]]


 Corrector Step
2018-07-13 08:25:20
[[-4.73374187e+03]
 [-2.61276692e+03]
 [-4.65130462e+03]
 [-3.93385482e+00]
 [-2.89004702e+00]
 [ 5.64973406e+00]
 [ 1.45435422e-01]
 [ 9.38687783e-03]
 [ 9.48567961e-01]
 [-2.81032468e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80355593e-18]]
[[ 1.15583838e-04  5.04201513e-04  1.96298794e-03  7.39875774e-06
   5.05973679e-06 -2.13265172e-06]
 [ 5.04201513e-04  2.73110603e-03  1.03854078e-02  3.61087775e-05
   2.80705506e-05 -9.98904031e-06]
 [ 1.96298794e-03  1.03854078e-02  4.18017007e-02  1.40116342e-04
   1.04243199e-04 -3.17793902e-05]
 [ 7.39875774e-06  3.61087775e-05  1.40116342e-04  5.22925281e-07
   3.59538555e-07 -1.46065104e-07]
 [ 5.05973679e-06  2.80705506e-05  1.04243199e-04  3.59538555e-07
   3.19786783e-07 -9.14892244e-08]
 [-2.13265172e-06 -9.98904031e-06 -3.17793902e-05 -1.46065104e-07
  -9.14892244e-08  2.47662233e-07]]
386690657.8848004
post
cubesat_nadir
Ybar_post [[-1.77389697]
 [-1.27976843]
 [10.8723327 ]]
resids [[-5.99690170e-06]
 [ 1.16573914e-05]
 [ 7.68809865e-02]]
posterior
[[-4.73373738e+03]
 [-2.61275897e+03]
 [-4.65126520e+03]
 [-3.93369069e+00]
 [-2.88994128e+00]
 [ 5.64968378e+00]]
[[-4.73373759e+03]
 [-2.61275519e+03]
 [-4.65124483e+03]
 [-3.93364820e+00]
 [-2.88990841e+00]
 [ 5.64967808e+00]]
[[ 3.24388168e-05  1.15798917e-04  5.20608801e-04  1.72626019e-06
   1.09781968e-06 -4.45028451e-07]
 [ 1.15798917e-04  6.25020937e-04  2.72998065e-03  8.52816798e-06
   5.78905699e-06 -2.19174057e-06]
 [ 5.20608801e-04  2.72998065e-03  1.31724732e-02  3.82060591e-05
   2.53235463e-05 -8.59554670e-06]
 [ 1.72626019e-06  8.52816798e-06  3.82060591e-05  1.21311562e-07
   7.93354099e-08 -3.05787687e-08]
 [ 1.09781968e-06  5.78905699e-06  2.53235463e-05  7.93354099e-08
   5.46572159e-08 -2.05342661e-08]
 [-4.45028451e-07 -2.19174057e-06 -8.59554670e-06 -3.05787687e-08
  -2.05342661e-08  1.13793222e-08]]
[[-1.77388757]
 [-1.2797655 ]
 [11.22629333]]
[[-1.53942891e-05]
 [ 8.73192096e-06]
 [-2.77079641e-01]]


 Corrector Step
2018-07-13 08:25:20
[[-4.73373759e+03]
 [-2.61275519e+03]
 [-4.65124483e+03]
 [-3.93364820e+00]
 [-2.88990841e+00]
 [ 5.64967808e+00]]
[[ 3.24388168e-05  1.15798917e-04  5.20608801e-04  1.72626019e-06
   1.09781968e-06 -4.45028451e-07]
 [ 1.15798917e-04  6.25020937e-04  2.72998065e-03  8.52816798e-06
   5.78905699e-06 -2.19174057e-06]
 [ 5.20608801e-04  2.72998065e-03  1.31724732e-02  3.82060591e-05
   2.53235463e-05 -8.59554670e-06]
 [ 1.72626019e-06  8.52816798e-06  3.82060591e-05  1.21311562e-07
   7.93354099e-08 -3.05787687e-08]
 [ 1.09781968e-06  5.78905699e-06  2.53235463e-05  7.93354099e-08
   5.46572159e-08 -2.05342661e-08]
 [-4.45028451e-07 -2.19174057e-06 -8.59554670e-06 -3.05787687e-08
  -2.05342661e-08  1.13793222e-08]]
14715581.5054583
post
sphere_lamr_small
Ybar_post [[-1.77389087]
 [-1.2797633 ]
 [11.22625018]]
resids [[-1.21038941e-05]
 [ 6.52535710e-06]
 [-2.77036498e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [386690657.8848004, 14715581.5054583]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.73374187e+03],
       [-2.61276692e+03],
       [-4.65130462e+03],
       [-3.93385482e+00],
       [-2.89004702e+00],
       [ 5.64973406e+00]]), 'est_covars': array([[ 1.15583838e-04,  5.04201513e-04,  1.96298794e-03,
         7.39875774e-06,  5.05973679e-06, -2.13265172e-06],
       [ 5.04201513e-04,  2.73110603e-03,  1.03854078e-02,
         3.61087775e-05,  2.80705506e-05, -9.98904031e-06],
       [ 1.96298794e-03,  1.03854078e-02,  4.18017007e-02,
         1.40116342e-04,  1.04243199e-04, -3.17793902e-05],
       [ 7.39875774e-06,  3.61087775e-05,  1.40116342e-04,
         5.22925281e-07,  3.59538555e-07, -1.46065104e-07],
       [ 5.05973679e-06,  2.80705506e-05,  1.04243199e-04,
         3.59538555e-07,  3.19786783e-07, -9.14892244e-08],
       [-2.13265172e-06, -9.98904031e-06, -3.17793902e-05,
        -1.46065104e-07, -9.14892244e-08,  2.47662233e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.73373759e+03],
       [-2.61275519e+03],
       [-4.65124483e+03],
       [-3.93364820e+00],
       [-2.88990841e+00],
       [ 5.64967808e+00]]), 'covar': array([[ 3.24388168e-05,  1.15798917e-04,  5.20608801e-04,
         1.72626019e-06,  1.09781968e-06, -4.45028451e-07],
       [ 1.15798917e-04,  6.25020937e-04,  2.72998065e-03,
         8.52816798e-06,  5.78905699e-06, -2.19174057e-06],
       [ 5.20608801e-04,  2.72998065e-03,  1.31724732e-02,
         3.82060591e-05,  2.53235463e-05, -8.59554670e-06],
       [ 1.72626019e-06,  8.52816798e-06,  3.82060591e-05,
         1.21311562e-07,  7.93354099e-08, -3.05787687e-08],
       [ 1.09781968e-06,  5.78905699e-06,  2.53235463e-05,
         7.93354099e-08,  5.46572159e-08, -2.05342661e-08],
       [-4.45028451e-07, -2.19174057e-06, -8.59554670e-06,
        -3.05787687e-08, -2.05342661e-08,  1.13793222e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.21038941e-05],
       [ 6.52535710e-06],
       [-2.77036498e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.73374187e+03],
       [-2.61276692e+03],
       [-4.65130462e+03],
       [-3.93385482e+00],
       [-2.89004702e+00],
       [ 5.64973406e+00],
       [ 1.45435422e-01],
       [ 9.38687783e-03],
       [ 9.48567961e-01],
       [-2.81032468e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80355593e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.15583838e-04,  5.04201513e-04,  1.96298794e-03,
         7.39875774e-06,  5.05973679e-06, -2.13265172e-06],
       [ 5.04201513e-04,  2.73110603e-03,  1.03854078e-02,
         3.61087775e-05,  2.80705506e-05, -9.98904031e-06],
       [ 1.96298794e-03,  1.03854078e-02,  4.18017007e-02,
         1.40116342e-04,  1.04243199e-04, -3.17793902e-05],
       [ 7.39875774e-06,  3.61087775e-05,  1.40116342e-04,
         5.22925281e-07,  3.59538555e-07, -1.46065104e-07],
       [ 5.05973679e-06,  2.80705506e-05,  1.04243199e-04,
         3.59538555e-07,  3.19786783e-07, -9.14892244e-08],
       [-2.13265172e-06, -9.98904031e-06, -3.17793902e-05,
        -1.46065104e-07, -9.14892244e-08,  2.47662233e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-5.99690170e-06],
       [ 1.16573914e-05],
       [ 7.68809865e-02]])}}
Current time:  2018-07-13 08:25:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.73374187e+03],
       [-2.61276692e+03],
       [-4.65130462e+03],
       [-3.93385482e+00],
       [-2.89004702e+00],
       [ 5.64973406e+00],
       [ 1.45435422e-01],
       [ 9.38687783e-03],
       [ 9.48567961e-01],
       [-2.81032468e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80355593e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.15583838e-04,  5.04201513e-04,  1.96298794e-03,
         7.39875774e-06,  5.05973679e-06, -2.13265172e-06],
       [ 5.04201513e-04,  2.73110603e-03,  1.03854078e-02,
         3.61087775e-05,  2.80705506e-05, -9.98904031e-06],
       [ 1.96298794e-03,  1.03854078e-02,  4.18017007e-02,
         1.40116342e-04,  1.04243199e-04, -3.17793902e-05],
       [ 7.39875774e-06,  3.61087775e-05,  1.40116342e-04,
         5.22925281e-07,  3.59538555e-07, -1.46065104e-07],
       [ 5.05973679e-06,  2.80705506e-05,  1.04243199e-04,
         3.59538555e-07,  3.19786783e-07, -9.14892244e-08],
       [-2.13265172e-06, -9.98904031e-06, -3.17793902e-05,
        -1.46065104e-07, -9.14892244e-08,  2.47662233e-07]])}
[[-4.73374187e+03]
 [-2.61276692e+03]
 [-4.65130462e+03]
 [-3.93385482e+00]
 [-2.89004702e+00]
 [ 5.64973406e+00]
 [ 1.45435422e-01]
 [ 9.38687783e-03]
 [ 9.48567961e-01]
 [-2.81032468e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80355593e-18]]
2018-07-13 08:25:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:30
[[-4.77282001e+03]
 [-2.64152344e+03]
 [-4.59455237e+03]
 [-3.88170612e+00]
 [-2.86122433e+00]
 [ 5.70058433e+00]
 [ 1.50386210e-01]
 [ 1.08541084e-02]
 [ 9.47795667e-01]
 [-2.80979625e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80376822e-18]]
[[ 3.16665427e-04  9.52920287e-04  3.33176320e-03  1.27456044e-05
   8.68631308e-06 -3.57545838e-06]
 [ 9.52920287e-04  3.32554251e-03  1.13205833e-02  3.98991474e-05
   3.13968244e-05 -1.08361489e-05]
 [ 3.33176320e-03  1.13205833e-02  4.11936194e-02  1.39345275e-04
   1.03607734e-04 -2.90109561e-05]
 [ 1.27456044e-05  3.98991474e-05  1.39345275e-04  5.37590128e-07
   3.62215909e-07 -1.45743868e-07]
 [ 8.68631308e-06  3.13968244e-05  1.03607734e-04  3.62215909e-07
   3.31146349e-07 -9.10497459e-08]
 [-3.57545838e-06 -1.08361489e-05 -2.90109561e-05 -1.45743868e-07
  -9.10497459e-08  2.57239796e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.73373759e+03],
       [-2.61275519e+03],
       [-4.65124483e+03],
       [-3.93364820e+00],
       [-2.88990841e+00],
       [ 5.64967808e+00]]), 'covar': array([[ 3.24388168e-05,  1.15798917e-04,  5.20608801e-04,
         1.72626019e-06,  1.09781968e-06, -4.45028451e-07],
       [ 1.15798917e-04,  6.25020937e-04,  2.72998065e-03,
         8.52816798e-06,  5.78905699e-06, -2.19174057e-06],
       [ 5.20608801e-04,  2.72998065e-03,  1.31724732e-02,
         3.82060591e-05,  2.53235463e-05, -8.59554670e-06],
       [ 1.72626019e-06,  8.52816798e-06,  3.82060591e-05,
         1.21311562e-07,  7.93354099e-08, -3.05787687e-08],
       [ 1.09781968e-06,  5.78905699e-06,  2.53235463e-05,
         7.93354099e-08,  5.46572159e-08, -2.05342661e-08],
       [-4.45028451e-07, -2.19174057e-06, -8.59554670e-06,
        -3.05787687e-08, -2.05342661e-08,  1.13793222e-08]])}
[[-4.73373759e+03]
 [-2.61275519e+03]
 [-4.65124483e+03]
 [-3.93364820e+00]
 [-2.88990841e+00]
 [ 5.64967808e+00]]
2018-07-13 08:25:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:30
[[-4.77281365e+03]
 [-2.64151027e+03]
 [-4.59449327e+03]
 [-3.88149854e+00]
 [-2.86108552e+00]
 [ 5.70052850e+00]]
[[ 7.92625595e-05  2.20306795e-04  8.96248472e-04  2.95779801e-06
   1.89945071e-06 -7.46388005e-07]
 [ 2.20306795e-04  7.46531389e-04  2.95979749e-03  9.37164408e-06
   6.35708975e-06 -2.38072978e-06]
 [ 8.96248472e-04  2.95979749e-03  1.30024041e-02  3.81125189e-05
   2.52087954e-05 -8.41121733e-06]
 [ 2.95779801e-06  9.37164408e-06  3.81125189e-05  1.22659748e-07
   8.00104019e-08 -3.05058418e-08]
 [ 1.89945071e-06  6.35708975e-06  2.52087954e-05  8.00104019e-08
   5.50999521e-08 -2.04484120e-08]
 [-7.46388005e-07 -2.38072978e-06 -8.41121733e-06 -3.05058418e-08
  -2.04484120e-08  1.13770262e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.77281365e+03],
       [-2.64151027e+03],
       [-4.59449327e+03],
       [-3.88149854e+00],
       [-2.86108552e+00],
       [ 5.70052850e+00]]), 'covar': array([[ 7.92625595e-05,  2.20306795e-04,  8.96248472e-04,
         2.95779801e-06,  1.89945071e-06, -7.46388005e-07],
       [ 2.20306795e-04,  7.46531389e-04,  2.95979749e-03,
         9.37164408e-06,  6.35708975e-06, -2.38072978e-06],
       [ 8.96248472e-04,  2.95979749e-03,  1.30024041e-02,
         3.81125189e-05,  2.52087954e-05, -8.41121733e-06],
       [ 2.95779801e-06,  9.37164408e-06,  3.81125189e-05,
         1.22659748e-07,  8.00104019e-08, -3.05058418e-08],
       [ 1.89945071e-06,  6.35708975e-06,  2.52087954e-05,
         8.00104019e-08,  5.50999521e-08, -2.04484120e-08],
       [-7.46388005e-07, -2.38072978e-06, -8.41121733e-06,
        -3.05058418e-08, -2.04484120e-08,  1.13770262e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.21038941e-05],
       [ 6.52535710e-06],
       [-2.77036498e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.77282001e+03],
       [-2.64152344e+03],
       [-4.59455237e+03],
       [-3.88170612e+00],
       [-2.86122433e+00],
       [ 5.70058433e+00],
       [ 1.50386210e-01],
       [ 1.08541084e-02],
       [ 9.47795667e-01],
       [-2.80979625e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80376822e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.16665427e-04,  9.52920287e-04,  3.33176320e-03,
         1.27456044e-05,  8.68631308e-06, -3.57545838e-06],
       [ 9.52920287e-04,  3.32554251e-03,  1.13205833e-02,
         3.98991474e-05,  3.13968244e-05, -1.08361489e-05],
       [ 3.33176320e-03,  1.13205833e-02,  4.11936194e-02,
         1.39345275e-04,  1.03607734e-04, -2.90109561e-05],
       [ 1.27456044e-05,  3.98991474e-05,  1.39345275e-04,
         5.37590128e-07,  3.62215909e-07, -1.45743868e-07],
       [ 8.68631308e-06,  3.13968244e-05,  1.03607734e-04,
         3.62215909e-07,  3.31146349e-07, -9.10497459e-08],
       [-3.57545838e-06, -1.08361489e-05, -2.90109561e-05,
        -1.45743868e-07, -9.10497459e-08,  2.57239796e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-5.99690170e-06],
       [ 1.16573914e-05],
       [ 7.68809865e-02]])}}
Yi [[-1.8786607 ]
 [-1.22979965]
 [10.80468325]]
posterior
[[-4.77282001e+03]
 [-2.64152344e+03]
 [-4.59455237e+03]
 [-3.88170612e+00]
 [-2.86122433e+00]
 [ 5.70058433e+00]
 [ 1.50386210e-01]
 [ 1.08541084e-02]
 [ 9.47795667e-01]
 [-2.80979625e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80376822e-18]]
[[-4.77281497e+03]
 [-2.64151593e+03]
 [-4.59449972e+03]
 [-3.88152147e+00]
 [-2.86119668e+00]
 [ 5.70060432e+00]
 [ 1.50386210e-01]
 [ 1.08541084e-02]
 [ 9.47795667e-01]
 [-2.80979625e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80376822e-18]]
[[ 2.85429454e-04  8.71778477e-04  2.89290213e-03  1.14798624e-05
   8.13342481e-06 -3.74647158e-06]
 [ 8.71778477e-04  2.94071805e-03  9.60906137e-03  3.59959777e-05
   2.80474381e-05 -1.15343078e-05]
 [ 2.89290213e-03  9.60906137e-03  3.31510043e-02  1.19541819e-04
   8.95577729e-05 -3.22478334e-05]
 [ 1.14798624e-05  3.59959777e-05  1.19541819e-04  4.84125582e-07
   3.33049888e-07 -1.53571257e-07]
 [ 8.13342481e-06  2.80474381e-05  8.95577729e-05  3.33049888e-07
   3.00329759e-07 -9.68674921e-08]
 [-3.74647158e-06 -1.15343078e-05 -3.22478334e-05 -1.53571257e-07
  -9.68674921e-08  2.55931667e-07]]
[[-1.87867987]
 [-1.22982413]
 [10.76062083]]
[[1.91694596e-05]
 [2.44774211e-05]
 [4.40624141e-02]]


 Corrector Step
2018-07-13 08:25:30
[[-4.77281497e+03]
 [-2.64151593e+03]
 [-4.59449972e+03]
 [-3.88152147e+00]
 [-2.86119668e+00]
 [ 5.70060432e+00]
 [ 1.50386210e-01]
 [ 1.08541084e-02]
 [ 9.47795667e-01]
 [-2.80979625e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80376822e-18]]
[[ 2.85429454e-04  8.71778477e-04  2.89290213e-03  1.14798624e-05
   8.13342481e-06 -3.74647158e-06]
 [ 8.71778477e-04  2.94071805e-03  9.60906137e-03  3.59959777e-05
   2.80474381e-05 -1.15343078e-05]
 [ 2.89290213e-03  9.60906137e-03  3.31510043e-02  1.19541819e-04
   8.95577729e-05 -3.22478334e-05]
 [ 1.14798624e-05  3.59959777e-05  1.19541819e-04  4.84125582e-07
   3.33049888e-07 -1.53571257e-07]
 [ 8.13342481e-06  2.80474381e-05  8.95577729e-05  3.33049888e-07
   3.00329759e-07 -9.68674921e-08]
 [-3.74647158e-06 -1.15343078e-05 -3.22478334e-05 -1.53571257e-07
  -9.68674921e-08  2.55931667e-07]]
361517179.6733281
post
cubesat_nadir
Ybar_post [[-1.8786723 ]
 [-1.22981469]
 [10.7604919 ]]
resids [[1.16022721e-05]
 [1.50404970e-05]
 [4.41913421e-02]]
posterior
[[-4.77281365e+03]
 [-2.64151027e+03]
 [-4.59449327e+03]
 [-3.88149854e+00]
 [-2.86108552e+00]
 [ 5.70052850e+00]]
[[-4.77281131e+03]
 [-2.64150519e+03]
 [-4.59446242e+03]
 [-3.88141851e+00]
 [-2.86104110e+00]
 [ 5.70051806e+00]]
[[ 7.04739351e-05  1.96984088e-04  7.60285573e-04  2.61798647e-06
   1.69879125e-06 -7.02215690e-07]
 [ 1.96984088e-04  6.62166571e-04  2.49756140e-03  8.26510860e-06
   5.64474382e-06 -2.23268943e-06]
 [ 7.60285573e-04  2.49756140e-03  1.04412348e-02  3.19313443e-05
   2.12928091e-05 -7.58876772e-06]
 [ 2.61798647e-06  8.26510860e-06  3.19313443e-05  1.07655181e-07
   7.06131761e-08 -2.85171124e-08]
 [ 1.69879125e-06  5.64474382e-06  2.12928091e-05  7.06131761e-08
   4.90792154e-08 -1.91932389e-08]
 [-7.02215690e-07 -2.23268943e-06 -7.58876772e-06 -2.85171124e-08
  -1.91932389e-08  1.11127430e-08]]
[[-1.87867364]
 [-1.22981793]
 [11.12141681]]
[[ 1.29407742e-05]
 [ 1.82785381e-05]
 [-3.16733561e-01]]


 Corrector Step
2018-07-13 08:25:30
[[-4.77281131e+03]
 [-2.64150519e+03]
 [-4.59446242e+03]
 [-3.88141851e+00]
 [-2.86104110e+00]
 [ 5.70051806e+00]]
[[ 7.04739351e-05  1.96984088e-04  7.60285573e-04  2.61798647e-06
   1.69879125e-06 -7.02215690e-07]
 [ 1.96984088e-04  6.62166571e-04  2.49756140e-03  8.26510860e-06
   5.64474382e-06 -2.23268943e-06]
 [ 7.60285573e-04  2.49756140e-03  1.04412348e-02  3.19313443e-05
   2.12928091e-05 -7.58876772e-06]
 [ 2.61798647e-06  8.26510860e-06  3.19313443e-05  1.07655181e-07
   7.06131761e-08 -2.85171124e-08]
 [ 1.69879125e-06  5.64474382e-06  2.12928091e-05  7.06131761e-08
   4.90792154e-08 -1.91932389e-08]
 [-7.02215690e-07 -2.23268943e-06 -7.58876772e-06 -2.85171124e-08
  -1.91932389e-08  1.11127430e-08]]
4008766.037232927
post
sphere_lamr_small
Ybar_post [[-1.87867161]
 [-1.22981289]
 [11.12134654]]
resids [[ 1.09052448e-05]
 [ 1.32412444e-05]
 [-3.16663293e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [361517179.6733281, 4008766.037232927]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.77281497e+03],
       [-2.64151593e+03],
       [-4.59449972e+03],
       [-3.88152147e+00],
       [-2.86119668e+00],
       [ 5.70060432e+00]]), 'est_covars': array([[ 2.85429454e-04,  8.71778477e-04,  2.89290213e-03,
         1.14798624e-05,  8.13342481e-06, -3.74647158e-06],
       [ 8.71778477e-04,  2.94071805e-03,  9.60906137e-03,
         3.59959777e-05,  2.80474381e-05, -1.15343078e-05],
       [ 2.89290213e-03,  9.60906137e-03,  3.31510043e-02,
         1.19541819e-04,  8.95577729e-05, -3.22478334e-05],
       [ 1.14798624e-05,  3.59959777e-05,  1.19541819e-04,
         4.84125582e-07,  3.33049888e-07, -1.53571257e-07],
       [ 8.13342481e-06,  2.80474381e-05,  8.95577729e-05,
         3.33049888e-07,  3.00329759e-07, -9.68674921e-08],
       [-3.74647158e-06, -1.15343078e-05, -3.22478334e-05,
        -1.53571257e-07, -9.68674921e-08,  2.55931667e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.77281131e+03],
       [-2.64150519e+03],
       [-4.59446242e+03],
       [-3.88141851e+00],
       [-2.86104110e+00],
       [ 5.70051806e+00]]), 'covar': array([[ 7.04739351e-05,  1.96984088e-04,  7.60285573e-04,
         2.61798647e-06,  1.69879125e-06, -7.02215690e-07],
       [ 1.96984088e-04,  6.62166571e-04,  2.49756140e-03,
         8.26510860e-06,  5.64474382e-06, -2.23268943e-06],
       [ 7.60285573e-04,  2.49756140e-03,  1.04412348e-02,
         3.19313443e-05,  2.12928091e-05, -7.58876772e-06],
       [ 2.61798647e-06,  8.26510860e-06,  3.19313443e-05,
         1.07655181e-07,  7.06131761e-08, -2.85171124e-08],
       [ 1.69879125e-06,  5.64474382e-06,  2.12928091e-05,
         7.06131761e-08,  4.90792154e-08, -1.91932389e-08],
       [-7.02215690e-07, -2.23268943e-06, -7.58876772e-06,
        -2.85171124e-08, -1.91932389e-08,  1.11127430e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.09052448e-05],
       [ 1.32412444e-05],
       [-3.16663293e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.77281497e+03],
       [-2.64151593e+03],
       [-4.59449972e+03],
       [-3.88152147e+00],
       [-2.86119668e+00],
       [ 5.70060432e+00],
       [ 1.50386210e-01],
       [ 1.08541084e-02],
       [ 9.47795667e-01],
       [-2.80979625e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80376822e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.85429454e-04,  8.71778477e-04,  2.89290213e-03,
         1.14798624e-05,  8.13342481e-06, -3.74647158e-06],
       [ 8.71778477e-04,  2.94071805e-03,  9.60906137e-03,
         3.59959777e-05,  2.80474381e-05, -1.15343078e-05],
       [ 2.89290213e-03,  9.60906137e-03,  3.31510043e-02,
         1.19541819e-04,  8.95577729e-05, -3.22478334e-05],
       [ 1.14798624e-05,  3.59959777e-05,  1.19541819e-04,
         4.84125582e-07,  3.33049888e-07, -1.53571257e-07],
       [ 8.13342481e-06,  2.80474381e-05,  8.95577729e-05,
         3.33049888e-07,  3.00329759e-07, -9.68674921e-08],
       [-3.74647158e-06, -1.15343078e-05, -3.22478334e-05,
        -1.53571257e-07, -9.68674921e-08,  2.55931667e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.16022721e-05],
       [1.50404970e-05],
       [4.41913421e-02]])}}
Current time:  2018-07-13 08:25:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.77281497e+03],
       [-2.64151593e+03],
       [-4.59449972e+03],
       [-3.88152147e+00],
       [-2.86119668e+00],
       [ 5.70060432e+00],
       [ 1.50386210e-01],
       [ 1.08541084e-02],
       [ 9.47795667e-01],
       [-2.80979625e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80376822e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.85429454e-04,  8.71778477e-04,  2.89290213e-03,
         1.14798624e-05,  8.13342481e-06, -3.74647158e-06],
       [ 8.71778477e-04,  2.94071805e-03,  9.60906137e-03,
         3.59959777e-05,  2.80474381e-05, -1.15343078e-05],
       [ 2.89290213e-03,  9.60906137e-03,  3.31510043e-02,
         1.19541819e-04,  8.95577729e-05, -3.22478334e-05],
       [ 1.14798624e-05,  3.59959777e-05,  1.19541819e-04,
         4.84125582e-07,  3.33049888e-07, -1.53571257e-07],
       [ 8.13342481e-06,  2.80474381e-05,  8.95577729e-05,
         3.33049888e-07,  3.00329759e-07, -9.68674921e-08],
       [-3.74647158e-06, -1.15343078e-05, -3.22478334e-05,
        -1.53571257e-07, -9.68674921e-08,  2.55931667e-07]])}
[[-4.77281497e+03]
 [-2.64151593e+03]
 [-4.59449972e+03]
 [-3.88152147e+00]
 [-2.86119668e+00]
 [ 5.70060432e+00]
 [ 1.50386210e-01]
 [ 1.08541084e-02]
 [ 9.47795667e-01]
 [-2.80979625e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80376822e-18]]
2018-07-13 08:25:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:40
[[-4.81136715e+03]
 [-2.66998226e+03]
 [-4.53724192e+03]
 [-3.82893936e+00]
 [-2.83205588e+00]
 [ 5.75083422e+00]
 [ 1.55332898e-01]
 [ 1.23210431e-02]
 [ 9.46997534e-01]
 [-2.80919122e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80398051e-18]]
[[ 5.65045234e-04  1.34768237e-03  4.03850442e-03  1.64516277e-05
   1.14995255e-05 -5.25771156e-06]
 [ 1.34768237e-03  3.53275664e-03  1.03810945e-02  3.95108718e-05
   3.11736601e-05 -1.24343678e-05]
 [ 4.03850442e-03  1.03810945e-02  3.25339917e-02  1.18568541e-04
   8.88135200e-05 -2.94286966e-05]
 [ 1.64516277e-05  3.95108718e-05  1.18568541e-04  4.98230516e-07
   3.35403768e-07 -1.53324397e-07]
 [ 1.14995255e-05  3.11736601e-05  8.88135200e-05  3.35403768e-07
   3.11513377e-07 -9.64691797e-08]
 [-5.25771156e-06 -1.24343678e-05 -2.94286966e-05 -1.53324397e-07
  -9.64691797e-08  2.65456704e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.77281131e+03],
       [-2.64150519e+03],
       [-4.59446242e+03],
       [-3.88141851e+00],
       [-2.86104110e+00],
       [ 5.70051806e+00]]), 'covar': array([[ 7.04739351e-05,  1.96984088e-04,  7.60285573e-04,
         2.61798647e-06,  1.69879125e-06, -7.02215690e-07],
       [ 1.96984088e-04,  6.62166571e-04,  2.49756140e-03,
         8.26510860e-06,  5.64474382e-06, -2.23268943e-06],
       [ 7.60285573e-04,  2.49756140e-03,  1.04412348e-02,
         3.19313443e-05,  2.12928091e-05, -7.58876772e-06],
       [ 2.61798647e-06,  8.26510860e-06,  3.19313443e-05,
         1.07655181e-07,  7.06131761e-08, -2.85171124e-08],
       [ 1.69879125e-06,  5.64474382e-06,  2.12928091e-05,
         7.06131761e-08,  4.90792154e-08, -1.91932389e-08],
       [-7.02215690e-07, -2.23268943e-06, -7.58876772e-06,
        -2.85171124e-08, -1.91932389e-08,  1.11127430e-08]])}
[[-4.77281131e+03]
 [-2.64150519e+03]
 [-4.59446242e+03]
 [-3.88141851e+00]
 [-2.86104110e+00]
 [ 5.70051806e+00]]
2018-07-13 08:25:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:40
[[-4.81136285e+03]
 [-2.66997014e+03]
 [-4.53720538e+03]
 [-3.82883581e+00]
 [-2.83190004e+00]
 [ 5.75074852e+00]]
[[ 1.33802379e-04  3.03952599e-04  1.07065950e-03  3.71582150e-06
   2.41428437e-06 -9.81296731e-07]
 [ 3.03952599e-04  7.80157714e-04  2.68669470e-03  9.01777859e-06
   6.15530468e-06 -2.40836722e-06]
 [ 1.07065950e-03  2.68669470e-03  1.02912758e-02  3.18183999e-05
   2.11737527e-05 -7.41751435e-06]
 [ 3.71582150e-06  9.01777859e-06  3.18183999e-05  1.08825771e-07
   7.11918735e-08 -2.84510363e-08]
 [ 2.41428437e-06  6.15530468e-06  2.11737527e-05  7.11918735e-08
   4.94711957e-08 -1.91140058e-08]
 [-9.81296731e-07 -2.40836722e-06 -7.41751435e-06 -2.84510363e-08
  -1.91140058e-08  1.11138627e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.81136285e+03],
       [-2.66997014e+03],
       [-4.53720538e+03],
       [-3.82883581e+00],
       [-2.83190004e+00],
       [ 5.75074852e+00]]), 'covar': array([[ 1.33802379e-04,  3.03952599e-04,  1.07065950e-03,
         3.71582150e-06,  2.41428437e-06, -9.81296731e-07],
       [ 3.03952599e-04,  7.80157714e-04,  2.68669470e-03,
         9.01777859e-06,  6.15530468e-06, -2.40836722e-06],
       [ 1.07065950e-03,  2.68669470e-03,  1.02912758e-02,
         3.18183999e-05,  2.11737527e-05, -7.41751435e-06],
       [ 3.71582150e-06,  9.01777859e-06,  3.18183999e-05,
         1.08825771e-07,  7.11918735e-08, -2.84510363e-08],
       [ 2.41428437e-06,  6.15530468e-06,  2.11737527e-05,
         7.11918735e-08,  4.94711957e-08, -1.91140058e-08],
       [-9.81296731e-07, -2.40836722e-06, -7.41751435e-06,
        -2.84510363e-08, -1.91140058e-08,  1.11138627e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.09052448e-05],
       [ 1.32412444e-05],
       [-3.16663293e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.81136715e+03],
       [-2.66998226e+03],
       [-4.53724192e+03],
       [-3.82893936e+00],
       [-2.83205588e+00],
       [ 5.75083422e+00],
       [ 1.55332898e-01],
       [ 1.23210431e-02],
       [ 9.46997534e-01],
       [-2.80919122e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80398051e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.65045234e-04,  1.34768237e-03,  4.03850442e-03,
         1.64516277e-05,  1.14995255e-05, -5.25771156e-06],
       [ 1.34768237e-03,  3.53275664e-03,  1.03810945e-02,
         3.95108718e-05,  3.11736601e-05, -1.24343678e-05],
       [ 4.03850442e-03,  1.03810945e-02,  3.25339917e-02,
         1.18568541e-04,  8.88135200e-05, -2.94286966e-05],
       [ 1.64516277e-05,  3.95108718e-05,  1.18568541e-04,
         4.98230516e-07,  3.35403768e-07, -1.53324397e-07],
       [ 1.14995255e-05,  3.11736601e-05,  8.88135200e-05,
         3.35403768e-07,  3.11513377e-07, -9.64691797e-08],
       [-5.25771156e-06, -1.24343678e-05, -2.94286966e-05,
        -1.53324397e-07, -9.64691797e-08,  2.65456704e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.16022721e-05],
       [1.50404970e-05],
       [4.41913421e-02]])}}
Yi [[-1.9618563 ]
 [-1.17293587]
 [10.50235855]]
posterior
[[-4.81136715e+03]
 [-2.66998226e+03]
 [-4.53724192e+03]
 [-3.82893936e+00]
 [-2.83205588e+00]
 [ 5.75083422e+00]
 [ 1.55332898e-01]
 [ 1.23210431e-02]
 [ 9.46997534e-01]
 [-2.80919122e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80398051e-18]]
[[-4.81137657e+03]
 [-2.67000109e+03]
 [-4.53733210e+03]
 [-3.82921638e+00]
 [-2.83216878e+00]
 [ 5.75079320e+00]
 [ 1.55332898e-01]
 [ 1.23210431e-02]
 [ 9.46997534e-01]
 [-2.80919122e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80398051e-18]]
[[ 5.12117173e-04  1.22613080e-03  3.49371631e-03  1.48825456e-05
   1.06809576e-05 -5.49856024e-06]
 [ 1.22613080e-03  3.13774461e-03  8.82938785e-03  3.58032558e-05
   2.79627749e-05 -1.31421588e-05]
 [ 3.49371631e-03  8.82938785e-03  2.61466379e-02  1.02147783e-04
   7.69351576e-05 -3.23093612e-05]
 [ 1.48825456e-05  3.58032558e-05  1.02147783e-04  4.51620570e-07
   3.09940417e-07 -1.60603593e-07]
 [ 1.06809576e-05  2.79627749e-05  7.69351576e-05  3.09940417e-07
   2.83563309e-07 -1.01970482e-07]
 [-5.49856024e-06 -1.31421588e-05 -3.23093612e-05 -1.60603593e-07
  -1.01970482e-07  2.64152770e-07]]
[[-1.96184421]
 [-1.17289567]
 [10.65589094]]
[[-1.20921517e-05]
 [-4.01967678e-05]
 [-1.53532389e-01]]


 Corrector Step
2018-07-13 08:25:40
[[-4.81137657e+03]
 [-2.67000109e+03]
 [-4.53733210e+03]
 [-3.82921638e+00]
 [-2.83216878e+00]
 [ 5.75079320e+00]
 [ 1.55332898e-01]
 [ 1.23210431e-02]
 [ 9.46997534e-01]
 [-2.80919122e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80398051e-18]]
[[ 5.12117173e-04  1.22613080e-03  3.49371631e-03  1.48825456e-05
   1.06809576e-05 -5.49856024e-06]
 [ 1.22613080e-03  3.13774461e-03  8.82938785e-03  3.58032558e-05
   2.79627749e-05 -1.31421588e-05]
 [ 3.49371631e-03  8.82938785e-03  2.61466379e-02  1.02147783e-04
   7.69351576e-05 -3.23093612e-05]
 [ 1.48825456e-05  3.58032558e-05  1.02147783e-04  4.51620570e-07
   3.09940417e-07 -1.60603593e-07]
 [ 1.06809576e-05  2.79627749e-05  7.69351576e-05  3.09940417e-07
   2.83563309e-07 -1.01970482e-07]
 [-5.49856024e-06 -1.31421588e-05 -3.23093612e-05 -1.60603593e-07
  -1.01970482e-07  2.64152770e-07]]
82727712.3502928
post
cubesat_nadir
Ybar_post [[-1.9618484 ]
 [-1.17291203]
 [10.6561177 ]]
resids [[-7.89763910e-06]
 [-2.38381244e-05]
 [-1.53759152e-01]]
posterior
[[-4.81136285e+03]
 [-2.66997014e+03]
 [-4.53720538e+03]
 [-3.82883581e+00]
 [-2.83190004e+00]
 [ 5.75074852e+00]]
[[-4.81136875e+03]
 [-2.66998326e+03]
 [-4.53727203e+03]
 [-3.82900690e+00]
 [-2.83200338e+00]
 [ 5.75077216e+00]]
[[ 1.17939461e-04  2.67778290e-04  8.89163189e-04  3.25015109e-06
   2.12966187e-06 -9.15687169e-07]
 [ 2.67778290e-04  6.84652271e-04  2.22569422e-03  7.86761371e-06
   5.40939792e-06 -2.24233386e-06]
 [ 8.89163189e-04  2.22569422e-03  8.04411221e-03  2.61709590e-05
   1.75666128e-05 -6.60741400e-06]
 [ 3.25015109e-06  7.86761371e-06  2.61709590e-05  9.45572810e-08
   6.21798328e-08 -2.64137007e-08]
 [ 2.12966187e-06  5.40939792e-06  1.75666128e-05  6.21798328e-08
   4.36435558e-08 -1.78146275e-08]
 [-9.15687169e-07 -2.24233386e-06 -6.60741400e-06 -2.64137007e-08
  -1.78146275e-08  1.08217871e-08]]
[[-1.96184602]
 [-1.17289324]
 [11.02119899]]
[[-1.02742100e-05]
 [-4.26256571e-05]
 [-5.18840435e-01]]


 Corrector Step
2018-07-13 08:25:40
[[-4.81136875e+03]
 [-2.66998326e+03]
 [-4.53727203e+03]
 [-3.82900690e+00]
 [-2.83200338e+00]
 [ 5.75077216e+00]]
[[ 1.17939461e-04  2.67778290e-04  8.89163189e-04  3.25015109e-06
   2.12966187e-06 -9.15687169e-07]
 [ 2.67778290e-04  6.84652271e-04  2.22569422e-03  7.86761371e-06
   5.40939792e-06 -2.24233386e-06]
 [ 8.89163189e-04  2.22569422e-03  8.04411221e-03  2.61709590e-05
   1.75666128e-05 -6.60741400e-06]
 [ 3.25015109e-06  7.86761371e-06  2.61709590e-05  9.45572810e-08
   6.21798328e-08 -2.64137007e-08]
 [ 2.12966187e-06  5.40939792e-06  1.75666128e-05  6.21798328e-08
   4.36435558e-08 -1.78146275e-08]
 [-9.15687169e-07 -2.24233386e-06 -6.60741400e-06 -2.64137007e-08
  -1.78146275e-08  1.08217871e-08]]
373.88128165418357
post
sphere_lamr_small
Ybar_post [[-1.96184723]
 [-1.17290645]
 [11.02135922]]
resids [[-9.06697075e-06]
 [-2.94164825e-05]
 [-5.19000672e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [82727712.3502928, 373.88128165418357]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.81137657e+03],
       [-2.67000109e+03],
       [-4.53733210e+03],
       [-3.82921638e+00],
       [-2.83216878e+00],
       [ 5.75079320e+00]]), 'est_covars': array([[ 5.12117173e-04,  1.22613080e-03,  3.49371631e-03,
         1.48825456e-05,  1.06809576e-05, -5.49856024e-06],
       [ 1.22613080e-03,  3.13774461e-03,  8.82938785e-03,
         3.58032558e-05,  2.79627749e-05, -1.31421588e-05],
       [ 3.49371631e-03,  8.82938785e-03,  2.61466379e-02,
         1.02147783e-04,  7.69351576e-05, -3.23093612e-05],
       [ 1.48825456e-05,  3.58032558e-05,  1.02147783e-04,
         4.51620570e-07,  3.09940417e-07, -1.60603593e-07],
       [ 1.06809576e-05,  2.79627749e-05,  7.69351576e-05,
         3.09940417e-07,  2.83563309e-07, -1.01970482e-07],
       [-5.49856024e-06, -1.31421588e-05, -3.23093612e-05,
        -1.60603593e-07, -1.01970482e-07,  2.64152770e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.81136875e+03],
       [-2.66998326e+03],
       [-4.53727203e+03],
       [-3.82900690e+00],
       [-2.83200338e+00],
       [ 5.75077216e+00]]), 'covar': array([[ 1.17939461e-04,  2.67778290e-04,  8.89163189e-04,
         3.25015109e-06,  2.12966187e-06, -9.15687169e-07],
       [ 2.67778290e-04,  6.84652271e-04,  2.22569422e-03,
         7.86761371e-06,  5.40939792e-06, -2.24233386e-06],
       [ 8.89163189e-04,  2.22569422e-03,  8.04411221e-03,
         2.61709590e-05,  1.75666128e-05, -6.60741400e-06],
       [ 3.25015109e-06,  7.86761371e-06,  2.61709590e-05,
         9.45572810e-08,  6.21798328e-08, -2.64137007e-08],
       [ 2.12966187e-06,  5.40939792e-06,  1.75666128e-05,
         6.21798328e-08,  4.36435558e-08, -1.78146275e-08],
       [-9.15687169e-07, -2.24233386e-06, -6.60741400e-06,
        -2.64137007e-08, -1.78146275e-08,  1.08217871e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-9.06697075e-06],
       [-2.94164825e-05],
       [-5.19000672e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.81137657e+03],
       [-2.67000109e+03],
       [-4.53733210e+03],
       [-3.82921638e+00],
       [-2.83216878e+00],
       [ 5.75079320e+00],
       [ 1.55332898e-01],
       [ 1.23210431e-02],
       [ 9.46997534e-01],
       [-2.80919122e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80398051e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.12117173e-04,  1.22613080e-03,  3.49371631e-03,
         1.48825456e-05,  1.06809576e-05, -5.49856024e-06],
       [ 1.22613080e-03,  3.13774461e-03,  8.82938785e-03,
         3.58032558e-05,  2.79627749e-05, -1.31421588e-05],
       [ 3.49371631e-03,  8.82938785e-03,  2.61466379e-02,
         1.02147783e-04,  7.69351576e-05, -3.23093612e-05],
       [ 1.48825456e-05,  3.58032558e-05,  1.02147783e-04,
         4.51620570e-07,  3.09940417e-07, -1.60603593e-07],
       [ 1.06809576e-05,  2.79627749e-05,  7.69351576e-05,
         3.09940417e-07,  2.83563309e-07, -1.01970482e-07],
       [-5.49856024e-06, -1.31421588e-05, -3.23093612e-05,
        -1.60603593e-07, -1.01970482e-07,  2.64152770e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-7.89763910e-06],
       [-2.38381244e-05],
       [-1.53759152e-01]])}}
Current time:  2018-07-13 08:25:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.81137657e+03],
       [-2.67000109e+03],
       [-4.53733210e+03],
       [-3.82921638e+00],
       [-2.83216878e+00],
       [ 5.75079320e+00],
       [ 1.55332898e-01],
       [ 1.23210431e-02],
       [ 9.46997534e-01],
       [-2.80919122e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80398051e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.12117173e-04,  1.22613080e-03,  3.49371631e-03,
         1.48825456e-05,  1.06809576e-05, -5.49856024e-06],
       [ 1.22613080e-03,  3.13774461e-03,  8.82938785e-03,
         3.58032558e-05,  2.79627749e-05, -1.31421588e-05],
       [ 3.49371631e-03,  8.82938785e-03,  2.61466379e-02,
         1.02147783e-04,  7.69351576e-05, -3.23093612e-05],
       [ 1.48825456e-05,  3.58032558e-05,  1.02147783e-04,
         4.51620570e-07,  3.09940417e-07, -1.60603593e-07],
       [ 1.06809576e-05,  2.79627749e-05,  7.69351576e-05,
         3.09940417e-07,  2.83563309e-07, -1.01970482e-07],
       [-5.49856024e-06, -1.31421588e-05, -3.23093612e-05,
        -1.60603593e-07, -1.01970482e-07,  2.64152770e-07]])}
[[-4.81137657e+03]
 [-2.67000109e+03]
 [-4.53733210e+03]
 [-3.82921638e+00]
 [-2.83216878e+00]
 [ 5.75079320e+00]
 [ 1.55332898e-01]
 [ 1.23210431e-02]
 [ 9.46997534e-01]
 [-2.80919122e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80398051e-18]]
2018-07-13 08:25:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:50
[[-4.84940390e+03]
 [-2.69817581e+03]
 [-4.47957545e+03]
 [-3.77620873e+00]
 [-2.80271410e+00]
 [ 5.80039626e+00]
 [ 1.60275351e-01]
 [ 1.37876419e-02]
 [ 9.46173584e-01]
 [-2.80850961e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80419279e-18]]
[[ 8.56088164e-04  1.72296560e-03  4.44670489e-03  1.95381024e-05
   1.38183545e-05 -7.07400212e-06]
 [ 1.72296560e-03  3.72625143e-03  9.45834716e-03  3.90768599e-05
   3.09159575e-05 -1.40920266e-05]
 [ 4.44670489e-03  9.45834716e-03  2.55290807e-02  1.01000272e-04
   7.60954507e-05 -2.94351274e-05]
 [ 1.95381024e-05  3.90768599e-05  1.01000272e-04  4.65256469e-07
   3.12021315e-07 -1.60416531e-07]
 [ 1.38183545e-05  3.09159575e-05  7.60954507e-05  3.12021315e-07
   2.94597212e-07 -1.01604980e-07]
 [-7.07400212e-06 -1.40920266e-05 -2.94351274e-05 -1.60416531e-07
  -1.01604980e-07  2.73623730e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.81136875e+03],
       [-2.66998326e+03],
       [-4.53727203e+03],
       [-3.82900690e+00],
       [-2.83200338e+00],
       [ 5.75077216e+00]]), 'covar': array([[ 1.17939461e-04,  2.67778290e-04,  8.89163189e-04,
         3.25015109e-06,  2.12966187e-06, -9.15687169e-07],
       [ 2.67778290e-04,  6.84652271e-04,  2.22569422e-03,
         7.86761371e-06,  5.40939792e-06, -2.24233386e-06],
       [ 8.89163189e-04,  2.22569422e-03,  8.04411221e-03,
         2.61709590e-05,  1.75666128e-05, -6.60741400e-06],
       [ 3.25015109e-06,  7.86761371e-06,  2.61709590e-05,
         9.45572810e-08,  6.21798328e-08, -2.64137007e-08],
       [ 2.12966187e-06,  5.40939792e-06,  1.75666128e-05,
         6.21798328e-08,  4.36435558e-08, -1.78146275e-08],
       [-9.15687169e-07, -2.24233386e-06, -6.60741400e-06,
        -2.64137007e-08, -1.78146275e-08,  1.08217871e-08]])}
[[-4.81136875e+03]
 [-2.66998326e+03]
 [-4.53727203e+03]
 [-3.82900690e+00]
 [-2.83200338e+00]
 [ 5.75077216e+00]]
2018-07-13 08:25:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:25:50
[[-4.84939402e+03]
 [-2.69815632e+03]
 [-4.47951566e+03]
 [-3.77599841e+00]
 [-2.80254828e+00]
 [ 5.80037565e+00]]
[[ 1.92644790e-04  3.74210245e-04  1.13985337e-03  4.21833611e-06
   2.76116673e-06 -1.17272257e-06]
 [ 3.74210245e-04  7.97372918e-04  2.37750282e-03  8.53186140e-06
   5.86360524e-06 -2.40463901e-06]
 [ 1.13985337e-03  2.37750282e-03  7.91362331e-03  2.60431401e-05
   1.74454303e-05 -6.44912424e-06]
 [ 4.21833611e-06  8.53186140e-06  2.60431401e-05  9.55624087e-08
   6.26684259e-08 -2.63541614e-08]
 [ 2.76116673e-06  5.86360524e-06  1.74454303e-05  6.26684259e-08
   4.39879793e-08 -1.77421847e-08]
 [-1.17272257e-06 -2.40463901e-06 -6.44912424e-06 -2.63541614e-08
  -1.77421847e-08  1.08270063e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.84939402e+03],
       [-2.69815632e+03],
       [-4.47951566e+03],
       [-3.77599841e+00],
       [-2.80254828e+00],
       [ 5.80037565e+00]]), 'covar': array([[ 1.92644790e-04,  3.74210245e-04,  1.13985337e-03,
         4.21833611e-06,  2.76116673e-06, -1.17272257e-06],
       [ 3.74210245e-04,  7.97372918e-04,  2.37750282e-03,
         8.53186140e-06,  5.86360524e-06, -2.40463901e-06],
       [ 1.13985337e-03,  2.37750282e-03,  7.91362331e-03,
         2.60431401e-05,  1.74454303e-05, -6.44912424e-06],
       [ 4.21833611e-06,  8.53186140e-06,  2.60431401e-05,
         9.55624087e-08,  6.26684259e-08, -2.63541614e-08],
       [ 2.76116673e-06,  5.86360524e-06,  1.74454303e-05,
         6.26684259e-08,  4.39879793e-08, -1.77421847e-08],
       [-1.17272257e-06, -2.40463901e-06, -6.44912424e-06,
        -2.63541614e-08, -1.77421847e-08,  1.08270063e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-9.06697075e-06],
       [-2.94164825e-05],
       [-5.19000672e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.84940390e+03],
       [-2.69817581e+03],
       [-4.47957545e+03],
       [-3.77620873e+00],
       [-2.80271410e+00],
       [ 5.80039626e+00],
       [ 1.60275351e-01],
       [ 1.37876419e-02],
       [ 9.46173584e-01],
       [-2.80850961e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80419279e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.56088164e-04,  1.72296560e-03,  4.44670489e-03,
         1.95381024e-05,  1.38183545e-05, -7.07400212e-06],
       [ 1.72296560e-03,  3.72625143e-03,  9.45834716e-03,
         3.90768599e-05,  3.09159575e-05, -1.40920266e-05],
       [ 4.44670489e-03,  9.45834716e-03,  2.55290807e-02,
         1.01000272e-04,  7.60954507e-05, -2.94351274e-05],
       [ 1.95381024e-05,  3.90768599e-05,  1.01000272e-04,
         4.65256469e-07,  3.12021315e-07, -1.60416531e-07],
       [ 1.38183545e-05,  3.09159575e-05,  7.60954507e-05,
         3.12021315e-07,  2.94597212e-07, -1.01604980e-07],
       [-7.07400212e-06, -1.40920266e-05, -2.94351274e-05,
        -1.60416531e-07, -1.01604980e-07,  2.73623730e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-7.89763910e-06],
       [-2.38381244e-05],
       [-1.53759152e-01]])}}
Yi [[-2.02857687]
 [-1.10952191]
 [10.47075053]]
posterior
[[-4.84940390e+03]
 [-2.69817581e+03]
 [-4.47957545e+03]
 [-3.77620873e+00]
 [-2.80271410e+00]
 [ 5.80039626e+00]
 [ 1.60275351e-01]
 [ 1.37876419e-02]
 [ 9.46173584e-01]
 [-2.80850961e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80419279e-18]]
[[-4.84942044e+03]
 [-2.69820684e+03]
 [-4.47969769e+03]
 [-3.77658817e+00]
 [-2.80290300e+00]
 [ 5.80033397e+00]
 [ 1.60275351e-01]
 [ 1.37876419e-02]
 [ 9.46173584e-01]
 [-2.80850961e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80419279e-18]]
[[ 7.78884120e-04  1.56838969e-03  3.85663725e-03  1.77755507e-05
   1.28204454e-05 -7.37153996e-06]
 [ 1.56838969e-03  3.32886381e-03  8.09163988e-03  3.56314120e-05
   2.78779658e-05 -1.47975461e-05]
 [ 3.85663725e-03  8.09163988e-03  2.06285683e-02  8.77051413e-05
   6.62762601e-05 -3.19409626e-05]
 [ 1.77755507e-05  3.56314120e-05  8.77051413e-05  4.24938496e-07
   2.90227054e-07 -1.67104972e-07]
 [ 1.28204454e-05  2.78779658e-05  6.62762601e-05  2.90227054e-07
   2.69393510e-07 -1.06749527e-07]
 [-7.37153996e-06 -1.47975461e-05 -3.19409626e-05 -1.67104972e-07
  -1.06749527e-07  2.72338340e-07]]
[[-2.0285669 ]
 [-1.10946234]
 [10.5613482 ]]
[[-9.96842991e-06]
 [-5.95741777e-05]
 [-9.05976666e-02]]


 Corrector Step
2018-07-13 08:25:50
[[-4.84942044e+03]
 [-2.69820684e+03]
 [-4.47969769e+03]
 [-3.77658817e+00]
 [-2.80290300e+00]
 [ 5.80033397e+00]
 [ 1.60275351e-01]
 [ 1.37876419e-02]
 [ 9.46173584e-01]
 [-2.80850961e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80419279e-18]]
[[ 7.78884120e-04  1.56838969e-03  3.85663725e-03  1.77755507e-05
   1.28204454e-05 -7.37153996e-06]
 [ 1.56838969e-03  3.32886381e-03  8.09163988e-03  3.56314120e-05
   2.78779658e-05 -1.47975461e-05]
 [ 3.85663725e-03  8.09163988e-03  2.06285683e-02  8.77051413e-05
   6.62762601e-05 -3.19409626e-05]
 [ 1.77755507e-05  3.56314120e-05  8.77051413e-05  4.24938496e-07
   2.90227054e-07 -1.67104972e-07]
 [ 1.28204454e-05  2.78779658e-05  6.62762601e-05  2.90227054e-07
   2.69393510e-07 -1.06749527e-07]
 [-7.37153996e-06 -1.47975461e-05 -3.19409626e-05 -1.67104972e-07
  -1.06749527e-07  2.72338340e-07]]
71980610.93763395
post
cubesat_nadir
Ybar_post [[-2.02856968]
 [-1.10948735]
 [10.56166686]]
resids [[-7.18480068e-06]
 [-3.45598011e-05]
 [-9.09163285e-02]]
posterior
[[-4.84939402e+03]
 [-2.69815632e+03]
 [-4.47951566e+03]
 [-3.77599841e+00]
 [-2.80254828e+00]
 [ 5.80037565e+00]]
[[-4.84940503e+03]
 [-2.69817779e+03]
 [-4.47961018e+03]
 [-3.77625108e+00]
 [-2.80270482e+00]
 [ 5.80041395e+00]]
[[ 1.69230810e-04  3.28062838e-04  9.38053437e-04  3.67896409e-06
   2.42484118e-06 -1.09013615e-06]
 [ 3.28062838e-04  6.97488536e-04  1.95349073e-03  7.42386551e-06
   5.13771834e-06 -2.23134296e-06]
 [ 9.38053437e-04  1.95349073e-03  6.09703227e-03  2.12622126e-05
   1.43613133e-05 -5.70636944e-06]
 [ 3.67896409e-06  7.42386551e-06  2.12622126e-05  8.29112308e-08
   5.46037254e-08 -2.43987330e-08]
 [ 2.42484118e-06  5.13771834e-06  1.43613133e-05  5.46037254e-08
   3.87123222e-08 -1.64816387e-08]
 [-1.09013615e-06 -2.23134296e-06 -5.70636944e-06 -2.43987330e-08
  -1.64816387e-08  1.05233011e-08]]
[[-2.0285663 ]
 [-1.10945475]
 [10.92807341]]
[[-1.05644764e-05]
 [-6.71588687e-05]
 [-4.57322873e-01]]


 Corrector Step
2018-07-13 08:25:50
[[-4.84940503e+03]
 [-2.69817779e+03]
 [-4.47961018e+03]
 [-3.77625108e+00]
 [-2.80270482e+00]
 [ 5.80041395e+00]]
[[ 1.69230810e-04  3.28062838e-04  9.38053437e-04  3.67896409e-06
   2.42484118e-06 -1.09013615e-06]
 [ 3.28062838e-04  6.97488536e-04  1.95349073e-03  7.42386551e-06
   5.13771834e-06 -2.23134296e-06]
 [ 9.38053437e-04  1.95349073e-03  6.09703227e-03  2.12622126e-05
   1.43613133e-05 -5.70636944e-06]
 [ 3.67896409e-06  7.42386551e-06  2.12622126e-05  8.29112308e-08
   5.46037254e-08 -2.43987330e-08]
 [ 2.42484118e-06  5.13771834e-06  1.43613133e-05  5.46037254e-08
   3.87123222e-08 -1.64816387e-08]
 [-1.09013615e-06 -2.23134296e-06 -5.70636944e-06 -2.43987330e-08
  -1.64816387e-08  1.05233011e-08]]
1663.0248777469553
post
sphere_lamr_small
Ybar_post [[-2.02856729]
 [-1.10947699]
 [10.92830852]]
resids [[-9.57891339e-06]
 [-4.49161954e-05]
 [-4.57557982e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [71980610.93763395, 1663.0248777469553]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.84942044e+03],
       [-2.69820684e+03],
       [-4.47969769e+03],
       [-3.77658817e+00],
       [-2.80290300e+00],
       [ 5.80033397e+00]]), 'est_covars': array([[ 7.78884120e-04,  1.56838969e-03,  3.85663725e-03,
         1.77755507e-05,  1.28204454e-05, -7.37153996e-06],
       [ 1.56838969e-03,  3.32886381e-03,  8.09163988e-03,
         3.56314120e-05,  2.78779658e-05, -1.47975461e-05],
       [ 3.85663725e-03,  8.09163988e-03,  2.06285683e-02,
         8.77051413e-05,  6.62762601e-05, -3.19409626e-05],
       [ 1.77755507e-05,  3.56314120e-05,  8.77051413e-05,
         4.24938496e-07,  2.90227054e-07, -1.67104972e-07],
       [ 1.28204454e-05,  2.78779658e-05,  6.62762601e-05,
         2.90227054e-07,  2.69393510e-07, -1.06749527e-07],
       [-7.37153996e-06, -1.47975461e-05, -3.19409626e-05,
        -1.67104972e-07, -1.06749527e-07,  2.72338340e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.84940503e+03],
       [-2.69817779e+03],
       [-4.47961018e+03],
       [-3.77625108e+00],
       [-2.80270482e+00],
       [ 5.80041395e+00]]), 'covar': array([[ 1.69230810e-04,  3.28062838e-04,  9.38053437e-04,
         3.67896409e-06,  2.42484118e-06, -1.09013615e-06],
       [ 3.28062838e-04,  6.97488536e-04,  1.95349073e-03,
         7.42386551e-06,  5.13771834e-06, -2.23134296e-06],
       [ 9.38053437e-04,  1.95349073e-03,  6.09703227e-03,
         2.12622126e-05,  1.43613133e-05, -5.70636944e-06],
       [ 3.67896409e-06,  7.42386551e-06,  2.12622126e-05,
         8.29112308e-08,  5.46037254e-08, -2.43987330e-08],
       [ 2.42484118e-06,  5.13771834e-06,  1.43613133e-05,
         5.46037254e-08,  3.87123222e-08, -1.64816387e-08],
       [-1.09013615e-06, -2.23134296e-06, -5.70636944e-06,
        -2.43987330e-08, -1.64816387e-08,  1.05233011e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-9.57891339e-06],
       [-4.49161954e-05],
       [-4.57557982e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.84942044e+03],
       [-2.69820684e+03],
       [-4.47969769e+03],
       [-3.77658817e+00],
       [-2.80290300e+00],
       [ 5.80033397e+00],
       [ 1.60275351e-01],
       [ 1.37876419e-02],
       [ 9.46173584e-01],
       [-2.80850961e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80419279e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.78884120e-04,  1.56838969e-03,  3.85663725e-03,
         1.77755507e-05,  1.28204454e-05, -7.37153996e-06],
       [ 1.56838969e-03,  3.32886381e-03,  8.09163988e-03,
         3.56314120e-05,  2.78779658e-05, -1.47975461e-05],
       [ 3.85663725e-03,  8.09163988e-03,  2.06285683e-02,
         8.77051413e-05,  6.62762601e-05, -3.19409626e-05],
       [ 1.77755507e-05,  3.56314120e-05,  8.77051413e-05,
         4.24938496e-07,  2.90227054e-07, -1.67104972e-07],
       [ 1.28204454e-05,  2.78779658e-05,  6.62762601e-05,
         2.90227054e-07,  2.69393510e-07, -1.06749527e-07],
       [-7.37153996e-06, -1.47975461e-05, -3.19409626e-05,
        -1.67104972e-07, -1.06749527e-07,  2.72338340e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-7.18480068e-06],
       [-3.45598011e-05],
       [-9.09163285e-02]])}}
Current time:  2018-07-13 08:26:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.84942044e+03],
       [-2.69820684e+03],
       [-4.47969769e+03],
       [-3.77658817e+00],
       [-2.80290300e+00],
       [ 5.80033397e+00],
       [ 1.60275351e-01],
       [ 1.37876419e-02],
       [ 9.46173584e-01],
       [-2.80850961e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80419279e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.78884120e-04,  1.56838969e-03,  3.85663725e-03,
         1.77755507e-05,  1.28204454e-05, -7.37153996e-06],
       [ 1.56838969e-03,  3.32886381e-03,  8.09163988e-03,
         3.56314120e-05,  2.78779658e-05, -1.47975461e-05],
       [ 3.85663725e-03,  8.09163988e-03,  2.06285683e-02,
         8.77051413e-05,  6.62762601e-05, -3.19409626e-05],
       [ 1.77755507e-05,  3.56314120e-05,  8.77051413e-05,
         4.24938496e-07,  2.90227054e-07, -1.67104972e-07],
       [ 1.28204454e-05,  2.78779658e-05,  6.62762601e-05,
         2.90227054e-07,  2.69393510e-07, -1.06749527e-07],
       [-7.37153996e-06, -1.47975461e-05, -3.19409626e-05,
        -1.67104972e-07, -1.06749527e-07,  2.72338340e-07]])}
[[-4.84942044e+03]
 [-2.69820684e+03]
 [-4.47969769e+03]
 [-3.77658817e+00]
 [-2.80290300e+00]
 [ 5.80033397e+00]
 [ 1.60275351e-01]
 [ 1.37876419e-02]
 [ 9.46173584e-01]
 [-2.80850961e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80419279e-18]]
2018-07-13 08:25:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:00
[[-4.88691964e+03]
 [-2.72608723e+03]
 [-4.42144888e+03]
 [-3.72316112e+00]
 [-2.77313765e+00]
 [ 5.84930435e+00]
 [ 1.65213435e-01]
 [ 1.52538647e-02]
 [ 9.45323838e-01]
 [-2.80775143e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80440508e-18]]
[[ 1.17804439e-03  2.08288332e-03  4.64526900e-03  2.21705692e-05
   1.57621258e-05 -9.00585683e-06]
 [ 2.08288332e-03  3.91423361e-03  8.59685172e-03  3.86989702e-05
   3.06848464e-05 -1.57937692e-05]
 [ 4.64526900e-03  8.59685172e-03  2.00188910e-02  8.64098955e-05
   6.53539128e-05 -2.90070257e-05]
 [ 2.21705692e-05  3.86989702e-05  8.64098955e-05  4.38191500e-07
   2.92083503e-07 -1.66963409e-07]
 [ 1.57621258e-05  3.06848464e-05  6.53539128e-05  2.92083503e-07
   2.80303592e-07 -1.06408611e-07]
 [-9.00585683e-06 -1.57937692e-05 -2.90070257e-05 -1.66963409e-07
  -1.06408611e-07  2.81753490e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.84940503e+03],
       [-2.69817779e+03],
       [-4.47961018e+03],
       [-3.77625108e+00],
       [-2.80270482e+00],
       [ 5.80041395e+00]]), 'covar': array([[ 1.69230810e-04,  3.28062838e-04,  9.38053437e-04,
         3.67896409e-06,  2.42484118e-06, -1.09013615e-06],
       [ 3.28062838e-04,  6.97488536e-04,  1.95349073e-03,
         7.42386551e-06,  5.13771834e-06, -2.23134296e-06],
       [ 9.38053437e-04,  1.95349073e-03,  6.09703227e-03,
         2.12622126e-05,  1.43613133e-05, -5.70636944e-06],
       [ 3.67896409e-06,  7.42386551e-06,  2.12622126e-05,
         8.29112308e-08,  5.46037254e-08, -2.43987330e-08],
       [ 2.42484118e-06,  5.13771834e-06,  1.43613133e-05,
         5.46037254e-08,  3.87123222e-08, -1.64816387e-08],
       [-1.09013615e-06, -2.23134296e-06, -5.70636944e-06,
        -2.43987330e-08, -1.64816387e-08,  1.05233011e-08]])}
[[-4.84940503e+03]
 [-2.69817779e+03]
 [-4.47961018e+03]
 [-3.77625108e+00]
 [-2.80270482e+00]
 [ 5.80041395e+00]]
2018-07-13 08:25:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:00
[[-4.88690051e+03]
 [-2.72605618e+03]
 [-4.42136073e+03]
 [-3.72282254e+00]
 [-2.77293903e+00]
 [ 5.84938553e+00]]
[[ 2.51436083e-04  4.32303808e-04  1.13787016e-03  4.53119524e-06
   2.98051863e-06 -1.32595703e-06]
 [ 4.32303808e-04  8.04295796e-04  2.07341672e-03  8.00832861e-06
   5.54070513e-06 -2.38079323e-06]
 [ 1.13787016e-03  2.07341672e-03  5.98438217e-03  2.11250017e-05
   1.42404176e-05 -5.55928542e-06]
 [ 4.53119524e-06  8.00832861e-06  2.11250017e-05  8.37739816e-08
   5.50147854e-08 -2.43444862e-08]
 [ 2.98051863e-06  5.54070513e-06  1.42404176e-05  5.50147854e-08
   3.90158493e-08 -1.64147783e-08]
 [-1.32595703e-06 -2.38079323e-06 -5.55928542e-06 -2.43444862e-08
  -1.64147783e-08  1.05318683e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 25, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.88690051e+03],
       [-2.72605618e+03],
       [-4.42136073e+03],
       [-3.72282254e+00],
       [-2.77293903e+00],
       [ 5.84938553e+00]]), 'covar': array([[ 2.51436083e-04,  4.32303808e-04,  1.13787016e-03,
         4.53119524e-06,  2.98051863e-06, -1.32595703e-06],
       [ 4.32303808e-04,  8.04295796e-04,  2.07341672e-03,
         8.00832861e-06,  5.54070513e-06, -2.38079323e-06],
       [ 1.13787016e-03,  2.07341672e-03,  5.98438217e-03,
         2.11250017e-05,  1.42404176e-05, -5.55928542e-06],
       [ 4.53119524e-06,  8.00832861e-06,  2.11250017e-05,
         8.37739816e-08,  5.50147854e-08, -2.43444862e-08],
       [ 2.98051863e-06,  5.54070513e-06,  1.42404176e-05,
         5.50147854e-08,  3.90158493e-08, -1.64147783e-08],
       [-1.32595703e-06, -2.38079323e-06, -5.55928542e-06,
        -2.43444862e-08, -1.64147783e-08,  1.05318683e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-9.57891339e-06],
       [-4.49161954e-05],
       [-4.57557982e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 25, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.88691964e+03],
       [-2.72608723e+03],
       [-4.42144888e+03],
       [-3.72316112e+00],
       [-2.77313765e+00],
       [ 5.84930435e+00],
       [ 1.65213435e-01],
       [ 1.52538647e-02],
       [ 9.45323838e-01],
       [-2.80775143e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80440508e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.17804439e-03,  2.08288332e-03,  4.64526900e-03,
         2.21705692e-05,  1.57621258e-05, -9.00585683e-06],
       [ 2.08288332e-03,  3.91423361e-03,  8.59685172e-03,
         3.86989702e-05,  3.06848464e-05, -1.57937692e-05],
       [ 4.64526900e-03,  8.59685172e-03,  2.00188910e-02,
         8.64098955e-05,  6.53539128e-05, -2.90070257e-05],
       [ 2.21705692e-05,  3.86989702e-05,  8.64098955e-05,
         4.38191500e-07,  2.92083503e-07, -1.66963409e-07],
       [ 1.57621258e-05,  3.06848464e-05,  6.53539128e-05,
         2.92083503e-07,  2.80303592e-07, -1.06408611e-07],
       [-9.00585683e-06, -1.57937692e-05, -2.90070257e-05,
        -1.66963409e-07, -1.06408611e-07,  2.81753490e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-7.18480068e-06],
       [-3.45598011e-05],
       [-9.09163285e-02]])}}
Yi [[-2.08282396]
 [-1.03986834]
 [10.57667329]]
posterior
[[-4.88691964e+03]
 [-2.72608723e+03]
 [-4.42144888e+03]
 [-3.72316112e+00]
 [-2.77313765e+00]
 [ 5.84930435e+00]
 [ 1.65213435e-01]
 [ 1.52538647e-02]
 [ 9.45323838e-01]
 [-2.80775143e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80440508e-18]]
[[-4.88691342e+03]
 [-2.72606556e+03]
 [-4.42139372e+03]
 [-3.72306946e+00]
 [-2.77294237e+00]
 [ 5.84933919e+00]
 [ 1.65213435e-01]
 [ 1.52538647e-02]
 [ 9.45323838e-01]
 [-2.80775143e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80440508e-18]]
[[ 1.07458834e-03  1.89894164e-03  4.04271717e-03  2.02590306e-05
   1.46306590e-05 -9.35390348e-06]
 [ 1.89894164e-03  3.51307260e-03  7.39474694e-03  3.54619175e-05
   2.77825587e-05 -1.65010530e-05]
 [ 4.04271717e-03  7.39474694e-03  1.62786640e-02  7.55618236e-05
   5.71925840e-05 -3.11905125e-05]
 [ 2.02590306e-05  3.54619175e-05  7.55618236e-05  4.02519995e-07
   2.73119353e-07 -1.73201265e-07]
 [ 1.46306590e-05  2.77825587e-05  5.71925840e-05  2.73119353e-07
   2.57228238e-07 -1.11277698e-07]
 [-9.35390348e-06 -1.65010530e-05 -3.11905125e-05 -1.73201265e-07
  -1.11277698e-07  2.80475364e-07]]
[[-2.08278865]
 [-1.03989102]
 [10.47990859]]
[[-3.53165994e-05]
 [ 2.26797491e-05]
 [ 9.67647023e-02]]


 Corrector Step
2018-07-13 08:26:00
[[-4.88691342e+03]
 [-2.72606556e+03]
 [-4.42139372e+03]
 [-3.72306946e+00]
 [-2.77294237e+00]
 [ 5.84933919e+00]
 [ 1.65213435e-01]
 [ 1.52538647e-02]
 [ 9.45323838e-01]
 [-2.80775143e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80440508e-18]]
[[ 1.07458834e-03  1.89894164e-03  4.04271717e-03  2.02590306e-05
   1.46306590e-05 -9.35390348e-06]
 [ 1.89894164e-03  3.51307260e-03  7.39474694e-03  3.54619175e-05
   2.77825587e-05 -1.65010530e-05]
 [ 4.04271717e-03  7.39474694e-03  1.62786640e-02  7.55618236e-05
   5.71925840e-05 -3.11905125e-05]
 [ 2.02590306e-05  3.54619175e-05  7.55618236e-05  4.02519995e-07
   2.73119353e-07 -1.73201265e-07]
 [ 1.46306590e-05  2.77825587e-05  5.71925840e-05  2.73119353e-07
   2.57228238e-07 -1.11277698e-07]
 [-9.35390348e-06 -1.65010530e-05 -3.11905125e-05 -1.73201265e-07
  -1.11277698e-07  2.80475364e-07]]
162384246.0978295
post
cubesat_nadir
Ybar_post [[-2.08280029]
 [-1.03988092]
 [10.47977032]]
resids [[-2.36718089e-05]
 [ 1.25827378e-05]
 [ 9.69029708e-02]]
posterior
[[-4.88690051e+03]
 [-2.72605618e+03]
 [-4.42136073e+03]
 [-3.72282254e+00]
 [-2.77293903e+00]
 [ 5.84938553e+00]]
[[-4.88690004e+03]
 [-2.72605135e+03]
 [-4.42134798e+03]
 [-3.72279875e+00]
 [-2.77290630e+00]
 [ 5.84937943e+00]]
[[ 2.21200213e-04  3.79330234e-04  9.35583234e-04  3.96178722e-06
   2.62016488e-06 -1.23098976e-06]
 [ 3.79330234e-04  7.04585186e-04  1.70220945e-03  6.98492728e-06
   4.86256648e-06 -2.20669248e-06]
 [ 9.35583234e-04  1.70220945e-03  4.59012556e-03  1.72527029e-05
   1.17156254e-05 -4.90514238e-06]
 [ 3.96178722e-06  6.98492728e-06  1.72527029e-05  7.29543669e-08
   4.80536191e-08 -2.25271992e-08]
 [ 2.62016488e-06  4.86256648e-06  1.17156254e-05  4.80536191e-08
   3.44037793e-08 -1.52306162e-08]
 [-1.23098976e-06 -2.20669248e-06 -4.90514238e-06 -2.25271992e-08
  -1.52306162e-08  1.02249540e-08]]
[[-2.0827854 ]
 [-1.03987616]
 [10.84438968]]
[[-3.85650525e-05]
 [ 7.82329134e-06]
 [-2.67716389e-01]]


 Corrector Step
2018-07-13 08:26:00
[[-4.88690004e+03]
 [-2.72605135e+03]
 [-4.42134798e+03]
 [-3.72279875e+00]
 [-2.77290630e+00]
 [ 5.84937943e+00]]
[[ 2.21200213e-04  3.79330234e-04  9.35583234e-04  3.96178722e-06
   2.62016488e-06 -1.23098976e-06]
 [ 3.79330234e-04  7.04585186e-04  1.70220945e-03  6.98492728e-06
   4.86256648e-06 -2.20669248e-06]
 [ 9.35583234e-04  1.70220945e-03  4.59012556e-03  1.72527029e-05
   1.17156254e-05 -4.90514238e-06]
 [ 3.96178722e-06  6.98492728e-06  1.72527029e-05  7.29543669e-08
   4.80536191e-08 -2.25271992e-08]
 [ 2.62016488e-06  4.86256648e-06  1.17156254e-05  4.80536191e-08
   3.44037793e-08 -1.52306162e-08]
 [-1.23098976e-06 -2.20669248e-06 -4.90514238e-06 -2.25271992e-08
  -1.52306162e-08  1.02249540e-08]]
7217377.650427678
post
sphere_lamr_small
Ybar_post [[-2.08278982]
 [-1.03987323]
 [10.84435842]]
resids [[-3.41451656e-05]
 [ 4.88638545e-06]
 [-2.67685135e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [162384246.0978295, 7217377.650427678]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.88691342e+03],
       [-2.72606556e+03],
       [-4.42139372e+03],
       [-3.72306946e+00],
       [-2.77294237e+00],
       [ 5.84933919e+00]]), 'est_covars': array([[ 1.07458834e-03,  1.89894164e-03,  4.04271717e-03,
         2.02590306e-05,  1.46306590e-05, -9.35390348e-06],
       [ 1.89894164e-03,  3.51307260e-03,  7.39474694e-03,
         3.54619175e-05,  2.77825587e-05, -1.65010530e-05],
       [ 4.04271717e-03,  7.39474694e-03,  1.62786640e-02,
         7.55618236e-05,  5.71925840e-05, -3.11905125e-05],
       [ 2.02590306e-05,  3.54619175e-05,  7.55618236e-05,
         4.02519995e-07,  2.73119353e-07, -1.73201265e-07],
       [ 1.46306590e-05,  2.77825587e-05,  5.71925840e-05,
         2.73119353e-07,  2.57228238e-07, -1.11277698e-07],
       [-9.35390348e-06, -1.65010530e-05, -3.11905125e-05,
        -1.73201265e-07, -1.11277698e-07,  2.80475364e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.88690004e+03],
       [-2.72605135e+03],
       [-4.42134798e+03],
       [-3.72279875e+00],
       [-2.77290630e+00],
       [ 5.84937943e+00]]), 'covar': array([[ 2.21200213e-04,  3.79330234e-04,  9.35583234e-04,
         3.96178722e-06,  2.62016488e-06, -1.23098976e-06],
       [ 3.79330234e-04,  7.04585186e-04,  1.70220945e-03,
         6.98492728e-06,  4.86256648e-06, -2.20669248e-06],
       [ 9.35583234e-04,  1.70220945e-03,  4.59012556e-03,
         1.72527029e-05,  1.17156254e-05, -4.90514238e-06],
       [ 3.96178722e-06,  6.98492728e-06,  1.72527029e-05,
         7.29543669e-08,  4.80536191e-08, -2.25271992e-08],
       [ 2.62016488e-06,  4.86256648e-06,  1.17156254e-05,
         4.80536191e-08,  3.44037793e-08, -1.52306162e-08],
       [-1.23098976e-06, -2.20669248e-06, -4.90514238e-06,
        -2.25271992e-08, -1.52306162e-08,  1.02249540e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.41451656e-05],
       [ 4.88638545e-06],
       [-2.67685135e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.88691342e+03],
       [-2.72606556e+03],
       [-4.42139372e+03],
       [-3.72306946e+00],
       [-2.77294237e+00],
       [ 5.84933919e+00],
       [ 1.65213435e-01],
       [ 1.52538647e-02],
       [ 9.45323838e-01],
       [-2.80775143e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80440508e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.07458834e-03,  1.89894164e-03,  4.04271717e-03,
         2.02590306e-05,  1.46306590e-05, -9.35390348e-06],
       [ 1.89894164e-03,  3.51307260e-03,  7.39474694e-03,
         3.54619175e-05,  2.77825587e-05, -1.65010530e-05],
       [ 4.04271717e-03,  7.39474694e-03,  1.62786640e-02,
         7.55618236e-05,  5.71925840e-05, -3.11905125e-05],
       [ 2.02590306e-05,  3.54619175e-05,  7.55618236e-05,
         4.02519995e-07,  2.73119353e-07, -1.73201265e-07],
       [ 1.46306590e-05,  2.77825587e-05,  5.71925840e-05,
         2.73119353e-07,  2.57228238e-07, -1.11277698e-07],
       [-9.35390348e-06, -1.65010530e-05, -3.11905125e-05,
        -1.73201265e-07, -1.11277698e-07,  2.80475364e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.36718089e-05],
       [ 1.25827378e-05],
       [ 9.69029708e-02]])}}
Current time:  2018-07-13 08:26:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.88691342e+03],
       [-2.72606556e+03],
       [-4.42139372e+03],
       [-3.72306946e+00],
       [-2.77294237e+00],
       [ 5.84933919e+00],
       [ 1.65213435e-01],
       [ 1.52538647e-02],
       [ 9.45323838e-01],
       [-2.80775143e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80440508e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.07458834e-03,  1.89894164e-03,  4.04271717e-03,
         2.02590306e-05,  1.46306590e-05, -9.35390348e-06],
       [ 1.89894164e-03,  3.51307260e-03,  7.39474694e-03,
         3.54619175e-05,  2.77825587e-05, -1.65010530e-05],
       [ 4.04271717e-03,  7.39474694e-03,  1.62786640e-02,
         7.55618236e-05,  5.71925840e-05, -3.11905125e-05],
       [ 2.02590306e-05,  3.54619175e-05,  7.55618236e-05,
         4.02519995e-07,  2.73119353e-07, -1.73201265e-07],
       [ 1.46306590e-05,  2.77825587e-05,  5.71925840e-05,
         2.73119353e-07,  2.57228238e-07, -1.11277698e-07],
       [-9.35390348e-06, -1.65010530e-05, -3.11905125e-05,
        -1.73201265e-07, -1.11277698e-07,  2.80475364e-07]])}
[[-4.88691342e+03]
 [-2.72606556e+03]
 [-4.42139372e+03]
 [-3.72306946e+00]
 [-2.77294237e+00]
 [ 5.84933919e+00]
 [ 1.65213435e-01]
 [ 1.52538647e-02]
 [ 9.45323838e-01]
 [-2.80775143e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80440508e-18]]
2018-07-13 08:26:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:10
[[-4.92387505e+03]
 [-2.75364479e+03]
 [-4.36265786e+03]
 [-3.66922592e+00]
 [-2.74286850e+00]
 [ 5.89767272e+00]
 [ 1.70147015e-01]
 [ 1.67196718e-02]
 [ 9.44448321e-01]
 [-2.80691671e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80461737e-18]]
[[ 1.52137453e-03  2.42818158e-03  4.68943139e-03  2.44346505e-05
   1.74024181e-05 -1.10439987e-05]
 [ 2.42818158e-03  4.09528031e-03  7.79153960e-03  3.83504515e-05
   3.04636681e-05 -1.75406549e-05]
 [ 4.68943139e-03  7.79153960e-03  1.56848048e-02  7.41395602e-05
   5.61976722e-05 -2.81939358e-05]
 [ 2.44346505e-05  3.83504515e-05  7.41395602e-05  4.15456904e-07
   2.74789499e-07 -1.73094173e-07]
 [ 1.74024181e-05  3.04636681e-05  5.61976722e-05  2.74789499e-07
   2.68035030e-07 -1.10954644e-07]
 [-1.10439987e-05 -1.75406549e-05 -2.81939358e-05 -1.73094173e-07
  -1.10954644e-07  2.89831908e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.88690004e+03],
       [-2.72605135e+03],
       [-4.42134798e+03],
       [-3.72279875e+00],
       [-2.77290630e+00],
       [ 5.84937943e+00]]), 'covar': array([[ 2.21200213e-04,  3.79330234e-04,  9.35583234e-04,
         3.96178722e-06,  2.62016488e-06, -1.23098976e-06],
       [ 3.79330234e-04,  7.04585186e-04,  1.70220945e-03,
         6.98492728e-06,  4.86256648e-06, -2.20669248e-06],
       [ 9.35583234e-04,  1.70220945e-03,  4.59012556e-03,
         1.72527029e-05,  1.17156254e-05, -4.90514238e-06],
       [ 3.96178722e-06,  6.98492728e-06,  1.72527029e-05,
         7.29543669e-08,  4.80536191e-08, -2.25271992e-08],
       [ 2.62016488e-06,  4.86256648e-06,  1.17156254e-05,
         4.80536191e-08,  3.44037793e-08, -1.52306162e-08],
       [-1.23098976e-06, -2.20669248e-06, -4.90514238e-06,
        -2.25271992e-08, -1.52306162e-08,  1.02249540e-08]])}
[[-4.88690004e+03]
 [-2.72605135e+03]
 [-4.42134798e+03]
 [-3.72279875e+00]
 [-2.77290630e+00]
 [ 5.84937943e+00]]
2018-07-13 08:26:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:10
[[-4.92385867e+03]
 [-2.75363030e+03]
 [-4.36261214e+03]
 [-3.66895455e+00]
 [-2.74283231e+00]
 [ 5.89771339e+00]]
[[ 3.08722874e-04  4.80387081e-04  1.09385061e-03  4.71415001e-06
   3.10990663e-06 -1.44790771e-06]
 [ 4.80387081e-04  8.05410528e-04  1.79602088e-03  7.50015273e-06
   5.22071108e-06 -2.34407195e-06]
 [ 1.09385061e-03  1.79602088e-03  4.49341430e-03  1.71109686e-05
   1.15971917e-05 -4.76778604e-06]
 [ 4.71415001e-06  7.50015273e-06  1.71109686e-05  7.36999916e-08
   4.84007817e-08 -2.24766765e-08]
 [ 3.10990663e-06  5.22071108e-06  1.15971917e-05  4.84007817e-08
   3.46737404e-08 -1.51683916e-08]
 [-1.44790771e-06 -2.34407195e-06 -4.76778604e-06 -2.24766765e-08
  -1.51683916e-08  1.02371920e-08]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.92385867e+03],
       [-2.75363030e+03],
       [-4.36261214e+03],
       [-3.66895455e+00],
       [-2.74283231e+00],
       [ 5.89771339e+00]]), 'covar': array([[ 3.08722874e-04,  4.80387081e-04,  1.09385061e-03,
         4.71415001e-06,  3.10990663e-06, -1.44790771e-06],
       [ 4.80387081e-04,  8.05410528e-04,  1.79602088e-03,
         7.50015273e-06,  5.22071108e-06, -2.34407195e-06],
       [ 1.09385061e-03,  1.79602088e-03,  4.49341430e-03,
         1.71109686e-05,  1.15971917e-05, -4.76778604e-06],
       [ 4.71415001e-06,  7.50015273e-06,  1.71109686e-05,
         7.36999916e-08,  4.84007817e-08, -2.24766765e-08],
       [ 3.10990663e-06,  5.22071108e-06,  1.15971917e-05,
         4.84007817e-08,  3.46737404e-08, -1.51683916e-08],
       [-1.44790771e-06, -2.34407195e-06, -4.76778604e-06,
        -2.24766765e-08, -1.51683916e-08,  1.02371920e-08]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.41451656e-05],
       [ 4.88638545e-06],
       [-2.67685135e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.92387505e+03],
       [-2.75364479e+03],
       [-4.36265786e+03],
       [-3.66922592e+00],
       [-2.74286850e+00],
       [ 5.89767272e+00],
       [ 1.70147015e-01],
       [ 1.67196718e-02],
       [ 9.44448321e-01],
       [-2.80691671e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80461737e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.52137453e-03,  2.42818158e-03,  4.68943139e-03,
         2.44346505e-05,  1.74024181e-05, -1.10439987e-05],
       [ 2.42818158e-03,  4.09528031e-03,  7.79153960e-03,
         3.83504515e-05,  3.04636681e-05, -1.75406549e-05],
       [ 4.68943139e-03,  7.79153960e-03,  1.56848048e-02,
         7.41395602e-05,  5.61976722e-05, -2.81939358e-05],
       [ 2.44346505e-05,  3.83504515e-05,  7.41395602e-05,
         4.15456904e-07,  2.74789499e-07, -1.73094173e-07],
       [ 1.74024181e-05,  3.04636681e-05,  5.61976722e-05,
         2.74789499e-07,  2.68035030e-07, -1.10954644e-07],
       [-1.10439987e-05, -1.75406549e-05, -2.81939358e-05,
        -1.73094173e-07, -1.10954644e-07,  2.89831908e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.36718089e-05],
       [ 1.25827378e-05],
       [ 9.69029708e-02]])}}
Yi [[-2.12746205]
 [-0.96455346]
 [10.52749298]]
posterior
[[-4.92387505e+03]
 [-2.75364479e+03]
 [-4.36265786e+03]
 [-3.66922592e+00]
 [-2.74286850e+00]
 [ 5.89767272e+00]
 [ 1.70147015e-01]
 [ 1.67196718e-02]
 [ 9.44448321e-01]
 [-2.80691671e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80461737e-18]]
[[-4.92387316e+03]
 [-2.75363912e+03]
 [-4.36264514e+03]
 [-3.66920451e+00]
 [-2.74281924e+00]
 [ 5.89768291e+00]
 [ 1.70147015e-01]
 [ 1.67196718e-02]
 [ 9.44448321e-01]
 [-2.80691671e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80461737e-18]]
[[ 1.38864361e-03  2.21466417e-03  4.08766918e-03  2.23722424e-05
   1.61482166e-05 -1.14410680e-05]
 [ 2.21466417e-03  3.68483475e-03  6.72274080e-03  3.52327594e-05
   2.76376889e-05 -1.82573103e-05]
 [ 4.08766918e-03  6.72274080e-03  1.28049208e-02  6.50901788e-05
   4.92950923e-05 -3.01116037e-05]
 [ 2.23722424e-05  3.52327594e-05  6.50901788e-05  3.82813402e-07
   2.57715545e-07 -1.79031192e-07]
 [ 1.61482166e-05  2.76376889e-05  4.92950923e-05  2.57715545e-07
   2.46425415e-07 -1.15646734e-07]
 [-1.14410680e-05 -1.82573103e-05 -3.01116037e-05 -1.79031192e-07
  -1.15646734e-07  2.88551716e-07]]
[[-2.127453  ]
 [-0.9645599 ]
 [10.41445625]]
[[-9.05438254e-06]
 [ 6.43949684e-06]
 [ 1.13036735e-01]]


 Corrector Step
2018-07-13 08:26:10
[[-4.92387316e+03]
 [-2.75363912e+03]
 [-4.36264514e+03]
 [-3.66920451e+00]
 [-2.74281924e+00]
 [ 5.89768291e+00]
 [ 1.70147015e-01]
 [ 1.67196718e-02]
 [ 9.44448321e-01]
 [-2.80691671e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80461737e-18]]
[[ 1.38864361e-03  2.21466417e-03  4.08766918e-03  2.23722424e-05
   1.61482166e-05 -1.14410680e-05]
 [ 2.21466417e-03  3.68483475e-03  6.72274080e-03  3.52327594e-05
   2.76376889e-05 -1.82573103e-05]
 [ 4.08766918e-03  6.72274080e-03  1.28049208e-02  6.50901788e-05
   4.92950923e-05 -3.01116037e-05]
 [ 2.23722424e-05  3.52327594e-05  6.50901788e-05  3.82813402e-07
   2.57715545e-07 -1.79031192e-07]
 [ 1.61482166e-05  2.76376889e-05  4.92950923e-05  2.57715545e-07
   2.46425415e-07 -1.15646734e-07]
 [-1.14410680e-05 -1.82573103e-05 -3.01116037e-05 -1.79031192e-07
  -1.15646734e-07  2.88551716e-07]]
335802890.3111133
post
cubesat_nadir
Ybar_post [[-2.12745592]
 [-0.96455703]
 [10.4144243 ]]
resids [[-6.13828807e-06]
 [ 3.56924975e-06]
 [ 1.13068684e-01]]
posterior
[[-4.92385867e+03]
 [-2.75363030e+03]
 [-4.36261214e+03]
 [-3.66895455e+00]
 [-2.74283231e+00]
 [ 5.89771339e+00]]
[[-4.92385998e+03]
 [-2.75363032e+03]
 [-4.36261489e+03]
 [-3.66896923e+00]
 [-2.74283209e+00]
 [ 5.89771484e+00]]
[[ 2.72527752e-04  4.22764379e-04  9.02006992e-04  4.13914639e-06
   2.74209170e-06 -1.34350584e-06]
 [ 4.22764379e-04  7.07533342e-04  1.47783597e-03  6.56642620e-06
   4.59492514e-06 -2.17128152e-06]
 [ 9.02006992e-04  1.47783597e-03  3.45004144e-03  1.40252092e-05
   9.56404554e-06 -4.20074506e-06]
 [ 4.13914639e-06  6.56642620e-06  1.40252092e-05  6.45107141e-08
   4.24376128e-08 -2.07984920e-08]
 [ 2.74209170e-06  4.59492514e-06  9.56404554e-06  4.24376128e-08
   3.06725671e-08 -1.40643490e-08]
 [-1.34350584e-06 -2.17128152e-06 -4.20074506e-06 -2.07984920e-08
  -1.40643490e-08  9.92899624e-09]]
[[-2.12744021]
 [-0.96454962]
 [10.77256155]]
[[-2.18395788e-05]
 [-3.84230439e-06]
 [-2.45068567e-01]]


 Corrector Step
2018-07-13 08:26:10
[[-4.92385998e+03]
 [-2.75363032e+03]
 [-4.36261489e+03]
 [-3.66896923e+00]
 [-2.74283209e+00]
 [ 5.89771484e+00]]
[[ 2.72527752e-04  4.22764379e-04  9.02006992e-04  4.13914639e-06
   2.74209170e-06 -1.34350584e-06]
 [ 4.22764379e-04  7.07533342e-04  1.47783597e-03  6.56642620e-06
   4.59492514e-06 -2.17128152e-06]
 [ 9.02006992e-04  1.47783597e-03  3.45004144e-03  1.40252092e-05
   9.56404554e-06 -4.20074506e-06]
 [ 4.13914639e-06  6.56642620e-06  1.40252092e-05  6.45107141e-08
   4.24376128e-08 -2.07984920e-08]
 [ 2.74209170e-06  4.59492514e-06  9.56404554e-06  4.24376128e-08
   3.06725671e-08 -1.40643490e-08]
 [-1.34350584e-06 -2.17128152e-06 -4.20074506e-06 -2.07984920e-08
  -1.40643490e-08  9.92899624e-09]]
28249213.213343356
post
sphere_lamr_small
Ybar_post [[-2.12744255]
 [-0.96455078]
 [10.77257014]]
resids [[-1.95026286e-05]
 [-2.67584119e-06]
 [-2.45077152e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [335802890.3111133, 28249213.213343356]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.92387316e+03],
       [-2.75363912e+03],
       [-4.36264514e+03],
       [-3.66920451e+00],
       [-2.74281924e+00],
       [ 5.89768291e+00]]), 'est_covars': array([[ 1.38864361e-03,  2.21466417e-03,  4.08766918e-03,
         2.23722424e-05,  1.61482166e-05, -1.14410680e-05],
       [ 2.21466417e-03,  3.68483475e-03,  6.72274080e-03,
         3.52327594e-05,  2.76376889e-05, -1.82573103e-05],
       [ 4.08766918e-03,  6.72274080e-03,  1.28049208e-02,
         6.50901788e-05,  4.92950923e-05, -3.01116037e-05],
       [ 2.23722424e-05,  3.52327594e-05,  6.50901788e-05,
         3.82813402e-07,  2.57715545e-07, -1.79031192e-07],
       [ 1.61482166e-05,  2.76376889e-05,  4.92950923e-05,
         2.57715545e-07,  2.46425415e-07, -1.15646734e-07],
       [-1.14410680e-05, -1.82573103e-05, -3.01116037e-05,
        -1.79031192e-07, -1.15646734e-07,  2.88551716e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.92385998e+03],
       [-2.75363032e+03],
       [-4.36261489e+03],
       [-3.66896923e+00],
       [-2.74283209e+00],
       [ 5.89771484e+00]]), 'covar': array([[ 2.72527752e-04,  4.22764379e-04,  9.02006992e-04,
         4.13914639e-06,  2.74209170e-06, -1.34350584e-06],
       [ 4.22764379e-04,  7.07533342e-04,  1.47783597e-03,
         6.56642620e-06,  4.59492514e-06, -2.17128152e-06],
       [ 9.02006992e-04,  1.47783597e-03,  3.45004144e-03,
         1.40252092e-05,  9.56404554e-06, -4.20074506e-06],
       [ 4.13914639e-06,  6.56642620e-06,  1.40252092e-05,
         6.45107141e-08,  4.24376128e-08, -2.07984920e-08],
       [ 2.74209170e-06,  4.59492514e-06,  9.56404554e-06,
         4.24376128e-08,  3.06725671e-08, -1.40643490e-08],
       [-1.34350584e-06, -2.17128152e-06, -4.20074506e-06,
        -2.07984920e-08, -1.40643490e-08,  9.92899624e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.95026286e-05],
       [-2.67584119e-06],
       [-2.45077152e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.92387316e+03],
       [-2.75363912e+03],
       [-4.36264514e+03],
       [-3.66920451e+00],
       [-2.74281924e+00],
       [ 5.89768291e+00],
       [ 1.70147015e-01],
       [ 1.67196718e-02],
       [ 9.44448321e-01],
       [-2.80691671e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80461737e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.38864361e-03,  2.21466417e-03,  4.08766918e-03,
         2.23722424e-05,  1.61482166e-05, -1.14410680e-05],
       [ 2.21466417e-03,  3.68483475e-03,  6.72274080e-03,
         3.52327594e-05,  2.76376889e-05, -1.82573103e-05],
       [ 4.08766918e-03,  6.72274080e-03,  1.28049208e-02,
         6.50901788e-05,  4.92950923e-05, -3.01116037e-05],
       [ 2.23722424e-05,  3.52327594e-05,  6.50901788e-05,
         3.82813402e-07,  2.57715545e-07, -1.79031192e-07],
       [ 1.61482166e-05,  2.76376889e-05,  4.92950923e-05,
         2.57715545e-07,  2.46425415e-07, -1.15646734e-07],
       [-1.14410680e-05, -1.82573103e-05, -3.01116037e-05,
        -1.79031192e-07, -1.15646734e-07,  2.88551716e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-6.13828807e-06],
       [ 3.56924975e-06],
       [ 1.13068684e-01]])}}
Current time:  2018-07-13 08:26:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.92387316e+03],
       [-2.75363912e+03],
       [-4.36264514e+03],
       [-3.66920451e+00],
       [-2.74281924e+00],
       [ 5.89768291e+00],
       [ 1.70147015e-01],
       [ 1.67196718e-02],
       [ 9.44448321e-01],
       [-2.80691671e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80461737e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.38864361e-03,  2.21466417e-03,  4.08766918e-03,
         2.23722424e-05,  1.61482166e-05, -1.14410680e-05],
       [ 2.21466417e-03,  3.68483475e-03,  6.72274080e-03,
         3.52327594e-05,  2.76376889e-05, -1.82573103e-05],
       [ 4.08766918e-03,  6.72274080e-03,  1.28049208e-02,
         6.50901788e-05,  4.92950923e-05, -3.01116037e-05],
       [ 2.23722424e-05,  3.52327594e-05,  6.50901788e-05,
         3.82813402e-07,  2.57715545e-07, -1.79031192e-07],
       [ 1.61482166e-05,  2.76376889e-05,  4.92950923e-05,
         2.57715545e-07,  2.46425415e-07, -1.15646734e-07],
       [-1.14410680e-05, -1.82573103e-05, -3.01116037e-05,
        -1.79031192e-07, -1.15646734e-07,  2.88551716e-07]])}
[[-4.92387316e+03]
 [-2.75363912e+03]
 [-4.36264514e+03]
 [-3.66920451e+00]
 [-2.74281924e+00]
 [ 5.89768291e+00]
 [ 1.70147015e-01]
 [ 1.67196718e-02]
 [ 9.44448321e-01]
 [-2.80691671e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80461737e-18]]
2018-07-13 08:26:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:20
[[-4.96029427e+03]
 [-2.78091566e+03]
 [-4.30342928e+03]
 [-3.61495084e+00]
 [-2.71244048e+00]
 [ 5.94537378e+00]
 [ 1.75075956e-01]
 [ 1.81850230e-02]
 [ 9.43547057e-01]
 [-2.80600546e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80482965e-18]]
[[ 1.87558647e-03  2.75516061e-03  4.60776843e-03  2.63538644e-05
   1.87661583e-05 -1.31838510e-05]
 [ 2.75516061e-03  4.26301394e-03  7.02240013e-03  3.79599747e-05
   3.02070017e-05 -1.93385105e-05]
 [ 4.60776843e-03  7.02240013e-03  1.22330597e-02  6.35557445e-05
   4.82344825e-05 -2.70502900e-05]
 [ 2.63538644e-05  3.79599747e-05  6.35557445e-05  3.95481596e-07
   2.59227173e-07 -1.78952240e-07]
 [ 1.87661583e-05  3.02070017e-05  4.82344825e-05  2.59227173e-07
   2.57144258e-07 -1.15337470e-07]
 [-1.31838510e-05 -1.93385105e-05 -2.70502900e-05 -1.78952240e-07
  -1.15337470e-07  2.97846812e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.92385998e+03],
       [-2.75363032e+03],
       [-4.36261489e+03],
       [-3.66896923e+00],
       [-2.74283209e+00],
       [ 5.89771484e+00]]), 'covar': array([[ 2.72527752e-04,  4.22764379e-04,  9.02006992e-04,
         4.13914639e-06,  2.74209170e-06, -1.34350584e-06],
       [ 4.22764379e-04,  7.07533342e-04,  1.47783597e-03,
         6.56642620e-06,  4.59492514e-06, -2.17128152e-06],
       [ 9.02006992e-04,  1.47783597e-03,  3.45004144e-03,
         1.40252092e-05,  9.56404554e-06, -4.20074506e-06],
       [ 4.13914639e-06,  6.56642620e-06,  1.40252092e-05,
         6.45107141e-08,  4.24376128e-08, -2.07984920e-08],
       [ 2.74209170e-06,  4.59492514e-06,  9.56404554e-06,
         4.24376128e-08,  3.06725671e-08, -1.40643490e-08],
       [-1.34350584e-06, -2.17128152e-06, -4.20074506e-06,
        -2.07984920e-08, -1.40643490e-08,  9.92899624e-09]])}
[[-4.92385998e+03]
 [-2.75363032e+03]
 [-4.36261489e+03]
 [-3.66896923e+00]
 [-2.74283209e+00]
 [ 5.89771484e+00]]
2018-07-13 08:26:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:20
[[-4.96027869e+03]
 [-2.78090686e+03]
 [-4.30339870e+03]
 [-3.61471494e+00]
 [-2.71245291e+00]
 [ 5.94540618e+00]]
[[ 3.61974310e-04  5.20306183e-04  1.02712437e-03  4.80661803e-06
   3.17541799e-06 -1.54203914e-06]
 [ 5.20306183e-04  8.02677625e-04  1.55058125e-03  7.02235389e-06
   4.91430739e-06 -2.29742793e-06]
 [ 1.02712437e-03  1.55058125e-03  3.36731997e-03  1.38828776e-05
   9.44962269e-06 -4.07202102e-06]
 [ 4.80661803e-06  7.02235389e-06  1.38828776e-05  6.51617258e-08
   4.27331439e-08 -2.07506180e-08]
 [ 3.17541799e-06  4.91430739e-06  9.44962269e-06  4.27331439e-08
   3.09154958e-08 -1.40060851e-08]
 [-1.54203914e-06 -2.29742793e-06 -4.07202102e-06 -2.07506180e-08
  -1.40060851e-08  9.94401647e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.96027869e+03],
       [-2.78090686e+03],
       [-4.30339870e+03],
       [-3.61471494e+00],
       [-2.71245291e+00],
       [ 5.94540618e+00]]), 'covar': array([[ 3.61974310e-04,  5.20306183e-04,  1.02712437e-03,
         4.80661803e-06,  3.17541799e-06, -1.54203914e-06],
       [ 5.20306183e-04,  8.02677625e-04,  1.55058125e-03,
         7.02235389e-06,  4.91430739e-06, -2.29742793e-06],
       [ 1.02712437e-03,  1.55058125e-03,  3.36731997e-03,
         1.38828776e-05,  9.44962269e-06, -4.07202102e-06],
       [ 4.80661803e-06,  7.02235389e-06,  1.38828776e-05,
         6.51617258e-08,  4.27331439e-08, -2.07506180e-08],
       [ 3.17541799e-06,  4.91430739e-06,  9.44962269e-06,
         4.27331439e-08,  3.09154958e-08, -1.40060851e-08],
       [-1.54203914e-06, -2.29742793e-06, -4.07202102e-06,
        -2.07506180e-08, -1.40060851e-08,  9.94401647e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.95026286e-05],
       [-2.67584119e-06],
       [-2.45077152e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.96029427e+03],
       [-2.78091566e+03],
       [-4.30342928e+03],
       [-3.61495084e+00],
       [-2.71244048e+00],
       [ 5.94537378e+00],
       [ 1.75075956e-01],
       [ 1.81850230e-02],
       [ 9.43547057e-01],
       [-2.80600546e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80482965e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.87558647e-03,  2.75516061e-03,  4.60776843e-03,
         2.63538644e-05,  1.87661583e-05, -1.31838510e-05],
       [ 2.75516061e-03,  4.26301394e-03,  7.02240013e-03,
         3.79599747e-05,  3.02070017e-05, -1.93385105e-05],
       [ 4.60776843e-03,  7.02240013e-03,  1.22330597e-02,
         6.35557445e-05,  4.82344825e-05, -2.70502900e-05],
       [ 2.63538644e-05,  3.79599747e-05,  6.35557445e-05,
         3.95481596e-07,  2.59227173e-07, -1.78952240e-07],
       [ 1.87661583e-05,  3.02070017e-05,  4.82344825e-05,
         2.59227173e-07,  2.57144258e-07, -1.15337470e-07],
       [-1.31838510e-05, -1.93385105e-05, -2.70502900e-05,
        -1.78952240e-07, -1.15337470e-07,  2.97846812e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-6.13828807e-06],
       [ 3.56924975e-06],
       [ 1.13068684e-01]])}}
Yi [[-2.16466954]
 [-0.88414996]
 [10.30432109]]
posterior
[[-4.96029427e+03]
 [-2.78091566e+03]
 [-4.30342928e+03]
 [-3.61495084e+00]
 [-2.71244048e+00]
 [ 5.94537378e+00]
 [ 1.75075956e-01]
 [ 1.81850230e-02]
 [ 9.43547057e-01]
 [-2.80600546e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80482965e-18]]
[[-4.96031799e+03]
 [-2.78096041e+03]
 [-4.30352716e+03]
 [-3.61523573e+00]
 [-2.71275476e+00]
 [ 5.94529782e+00]
 [ 1.75075956e-01]
 [ 1.81850230e-02]
 [ 9.43547057e-01]
 [-2.80600546e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80482965e-18]]
[[ 1.71095340e-03  2.51165730e-03  4.01584517e-03  2.41377745e-05
   1.73923566e-05 -1.36280756e-05]
 [ 2.51165730e-03  3.83988400e-03  6.06544058e-03  3.49055539e-05
   2.74163181e-05 -2.00676881e-05]
 [ 4.01584517e-03  6.06544058e-03  9.99943978e-03  5.58769144e-05
   4.23135811e-05 -2.87409901e-05]
 [ 2.41377745e-05  3.49055539e-05  5.58769144e-05  3.64859292e-07
   2.43425493e-07 -1.84675913e-07]
 [ 1.73923566e-05  2.74163181e-05  4.23135811e-05  2.43425493e-07
   2.36538453e-07 -1.19913229e-07]
 [-1.36280756e-05 -2.00676881e-05 -2.87409901e-05 -1.84675913e-07
  -1.19913229e-07  2.96563756e-07]]
[[-2.1647011 ]
 [-0.88408704]
 [10.36909819]]
[[ 3.15631429e-05]
 [-6.29200152e-05]
 [-6.47770961e-02]]


 Corrector Step
2018-07-13 08:26:20
[[-4.96031799e+03]
 [-2.78096041e+03]
 [-4.30352716e+03]
 [-3.61523573e+00]
 [-2.71275476e+00]
 [ 5.94529782e+00]
 [ 1.75075956e-01]
 [ 1.81850230e-02]
 [ 9.43547057e-01]
 [-2.80600546e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80482965e-18]]
[[ 1.71095340e-03  2.51165730e-03  4.01584517e-03  2.41377745e-05
   1.73923566e-05 -1.36280756e-05]
 [ 2.51165730e-03  3.83988400e-03  6.06544058e-03  3.49055539e-05
   2.74163181e-05 -2.00676881e-05]
 [ 4.01584517e-03  6.06544058e-03  9.99943978e-03  5.58769144e-05
   4.23135811e-05 -2.87409901e-05]
 [ 2.41377745e-05  3.49055539e-05  5.58769144e-05  3.64859292e-07
   2.43425493e-07 -1.84675913e-07]
 [ 1.73923566e-05  2.74163181e-05  4.23135811e-05  2.43425493e-07
   2.36538453e-07 -1.19913229e-07]
 [-1.36280756e-05 -2.00676881e-05 -2.87409901e-05 -1.84675913e-07
  -1.19913229e-07  2.96563756e-07]]
47285264.61822049
post
cubesat_nadir
Ybar_post [[-2.16469093]
 [-0.88411469]
 [10.36937144]]
resids [[ 2.13916311e-05]
 [-3.52705852e-05]
 [-6.50503459e-02]]
posterior
[[-4.96027869e+03]
 [-2.78090686e+03]
 [-4.30339870e+03]
 [-3.61471494e+00]
 [-2.71245291e+00]
 [ 5.94540618e+00]]
[[-4.96029346e+03]
 [-2.78093063e+03]
 [-4.30346525e+03]
 [-3.61492174e+00]
 [-2.71259663e+00]
 [ 5.94544799e+00]]
[[ 3.20110223e-04  4.58667170e-04  8.48935780e-04  4.23294770e-06
   2.80446526e-06 -1.42885529e-06]
 [ 4.58667170e-04  7.06621448e-04  1.27897033e-03  6.16621157e-06
   4.33447344e-06 -2.12538625e-06]
 [ 8.48935780e-04  1.27897033e-03  2.59273336e-03  1.14210701e-05
   7.81196721e-06 -3.58085607e-06]
 [ 4.23294770e-06  6.16621157e-06  1.14210701e-05  5.72757128e-08
   3.75769507e-08 -1.91879474e-08]
 [ 2.80446526e-06  4.33447344e-06  7.81196721e-06  3.75769507e-08
   2.74148354e-08 -1.29689283e-08]
 [-1.42885529e-06 -2.12538625e-06 -3.58085607e-06 -1.91879474e-08
  -1.29689283e-08  9.63252170e-09]]
[[-2.16468599]
 [-0.88407867]
 [10.7157625 ]]
[[ 1.64533655e-05]
 [-7.12944677e-05]
 [-4.11441406e-01]]


 Corrector Step
2018-07-13 08:26:20
[[-4.96029346e+03]
 [-2.78093063e+03]
 [-4.30346525e+03]
 [-3.61492174e+00]
 [-2.71259663e+00]
 [ 5.94544799e+00]]
[[ 3.20110223e-04  4.58667170e-04  8.48935780e-04  4.23294770e-06
   2.80446526e-06 -1.42885529e-06]
 [ 4.58667170e-04  7.06621448e-04  1.27897033e-03  6.16621157e-06
   4.33447344e-06 -2.12538625e-06]
 [ 8.48935780e-04  1.27897033e-03  2.59273336e-03  1.14210701e-05
   7.81196721e-06 -3.58085607e-06]
 [ 4.23294770e-06  6.16621157e-06  1.14210701e-05  5.72757128e-08
   3.75769507e-08 -1.91879474e-08]
 [ 2.80446526e-06  4.33447344e-06  7.81196721e-06  3.75769507e-08
   2.74148354e-08 -1.29689283e-08]
 [-1.42885529e-06 -2.12538625e-06 -3.58085607e-06 -1.91879474e-08
  -1.29689283e-08  9.63252170e-09]]
8395.751984420975
post
sphere_lamr_small
Ybar_post [[-2.16468404]
 [-0.88410328]
 [10.71594581]]
resids [[ 1.44969612e-05]
 [-4.66793233e-05]
 [-4.11624721e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [47285264.61822049, 8395.751984420975]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.96031799e+03],
       [-2.78096041e+03],
       [-4.30352716e+03],
       [-3.61523573e+00],
       [-2.71275476e+00],
       [ 5.94529782e+00]]), 'est_covars': array([[ 1.71095340e-03,  2.51165730e-03,  4.01584517e-03,
         2.41377745e-05,  1.73923566e-05, -1.36280756e-05],
       [ 2.51165730e-03,  3.83988400e-03,  6.06544058e-03,
         3.49055539e-05,  2.74163181e-05, -2.00676881e-05],
       [ 4.01584517e-03,  6.06544058e-03,  9.99943978e-03,
         5.58769144e-05,  4.23135811e-05, -2.87409901e-05],
       [ 2.41377745e-05,  3.49055539e-05,  5.58769144e-05,
         3.64859292e-07,  2.43425493e-07, -1.84675913e-07],
       [ 1.73923566e-05,  2.74163181e-05,  4.23135811e-05,
         2.43425493e-07,  2.36538453e-07, -1.19913229e-07],
       [-1.36280756e-05, -2.00676881e-05, -2.87409901e-05,
        -1.84675913e-07, -1.19913229e-07,  2.96563756e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.96029346e+03],
       [-2.78093063e+03],
       [-4.30346525e+03],
       [-3.61492174e+00],
       [-2.71259663e+00],
       [ 5.94544799e+00]]), 'covar': array([[ 3.20110223e-04,  4.58667170e-04,  8.48935780e-04,
         4.23294770e-06,  2.80446526e-06, -1.42885529e-06],
       [ 4.58667170e-04,  7.06621448e-04,  1.27897033e-03,
         6.16621157e-06,  4.33447344e-06, -2.12538625e-06],
       [ 8.48935780e-04,  1.27897033e-03,  2.59273336e-03,
         1.14210701e-05,  7.81196721e-06, -3.58085607e-06],
       [ 4.23294770e-06,  6.16621157e-06,  1.14210701e-05,
         5.72757128e-08,  3.75769507e-08, -1.91879474e-08],
       [ 2.80446526e-06,  4.33447344e-06,  7.81196721e-06,
         3.75769507e-08,  2.74148354e-08, -1.29689283e-08],
       [-1.42885529e-06, -2.12538625e-06, -3.58085607e-06,
        -1.91879474e-08, -1.29689283e-08,  9.63252170e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.44969612e-05],
       [-4.66793233e-05],
       [-4.11624721e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.96031799e+03],
       [-2.78096041e+03],
       [-4.30352716e+03],
       [-3.61523573e+00],
       [-2.71275476e+00],
       [ 5.94529782e+00],
       [ 1.75075956e-01],
       [ 1.81850230e-02],
       [ 9.43547057e-01],
       [-2.80600546e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80482965e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.71095340e-03,  2.51165730e-03,  4.01584517e-03,
         2.41377745e-05,  1.73923566e-05, -1.36280756e-05],
       [ 2.51165730e-03,  3.83988400e-03,  6.06544058e-03,
         3.49055539e-05,  2.74163181e-05, -2.00676881e-05],
       [ 4.01584517e-03,  6.06544058e-03,  9.99943978e-03,
         5.58769144e-05,  4.23135811e-05, -2.87409901e-05],
       [ 2.41377745e-05,  3.49055539e-05,  5.58769144e-05,
         3.64859292e-07,  2.43425493e-07, -1.84675913e-07],
       [ 1.73923566e-05,  2.74163181e-05,  4.23135811e-05,
         2.43425493e-07,  2.36538453e-07, -1.19913229e-07],
       [-1.36280756e-05, -2.00676881e-05, -2.87409901e-05,
        -1.84675913e-07, -1.19913229e-07,  2.96563756e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.13916311e-05],
       [-3.52705852e-05],
       [-6.50503459e-02]])}}
Current time:  2018-07-13 08:26:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.96031799e+03],
       [-2.78096041e+03],
       [-4.30352716e+03],
       [-3.61523573e+00],
       [-2.71275476e+00],
       [ 5.94529782e+00],
       [ 1.75075956e-01],
       [ 1.81850230e-02],
       [ 9.43547057e-01],
       [-2.80600546e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80482965e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.71095340e-03,  2.51165730e-03,  4.01584517e-03,
         2.41377745e-05,  1.73923566e-05, -1.36280756e-05],
       [ 2.51165730e-03,  3.83988400e-03,  6.06544058e-03,
         3.49055539e-05,  2.74163181e-05, -2.00676881e-05],
       [ 4.01584517e-03,  6.06544058e-03,  9.99943978e-03,
         5.58769144e-05,  4.23135811e-05, -2.87409901e-05],
       [ 2.41377745e-05,  3.49055539e-05,  5.58769144e-05,
         3.64859292e-07,  2.43425493e-07, -1.84675913e-07],
       [ 1.73923566e-05,  2.74163181e-05,  4.23135811e-05,
         2.43425493e-07,  2.36538453e-07, -1.19913229e-07],
       [-1.36280756e-05, -2.00676881e-05, -2.87409901e-05,
        -1.84675913e-07, -1.19913229e-07,  2.96563756e-07]])}
[[-4.96031799e+03]
 [-2.78096041e+03]
 [-4.30352716e+03]
 [-3.61523573e+00]
 [-2.71275476e+00]
 [ 5.94529782e+00]
 [ 1.75075956e-01]
 [ 1.81850230e-02]
 [ 9.43547057e-01]
 [-2.80600546e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80482965e-18]]
2018-07-13 08:26:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:30
[[-4.99619727e+03]
 [-2.80793482e+03]
 [-4.24383825e+03]
 [-3.56057987e+00]
 [-2.68207484e+00]
 [ 5.99233967e+00]
 [ 1.80000124e-01]
 [ 1.96498784e-02]
 [ 9.42620069e-01]
 [-2.80501771e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80504194e-18]]
[[ 2.23151031e-03  3.05987055e-03  4.42127840e-03  2.79418358e-05
   1.98673850e-05 -1.54222831e-05]
 [ 3.05987055e-03  4.41261169e-03  6.27668553e-03  3.74829750e-05
   2.98833174e-05 -2.11895103e-05]
 [ 4.42127840e-03  6.27668553e-03  9.45577696e-03  5.42415660e-05
   4.11926427e-05 -2.56144665e-05]
 [ 2.79418358e-05  3.74829750e-05  5.42415660e-05  3.77292879e-07
   2.44799180e-07 -1.84621321e-07]
 [ 1.98673850e-05  2.98833174e-05  4.11926427e-05  2.44799180e-07
   2.47181063e-07 -1.19615834e-07]
 [-1.54222831e-05 -2.11895103e-05 -2.56144665e-05 -1.84621321e-07
  -1.19615834e-07  3.05794076e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.96029346e+03],
       [-2.78093063e+03],
       [-4.30346525e+03],
       [-3.61492174e+00],
       [-2.71259663e+00],
       [ 5.94544799e+00]]), 'covar': array([[ 3.20110223e-04,  4.58667170e-04,  8.48935780e-04,
         4.23294770e-06,  2.80446526e-06, -1.42885529e-06],
       [ 4.58667170e-04,  7.06621448e-04,  1.27897033e-03,
         6.16621157e-06,  4.33447344e-06, -2.12538625e-06],
       [ 8.48935780e-04,  1.27897033e-03,  2.59273336e-03,
         1.14210701e-05,  7.81196721e-06, -3.58085607e-06],
       [ 4.23294770e-06,  6.16621157e-06,  1.14210701e-05,
         5.72757128e-08,  3.75769507e-08, -1.91879474e-08],
       [ 2.80446526e-06,  4.33447344e-06,  7.81196721e-06,
         3.75769507e-08,  2.74148354e-08, -1.29689283e-08],
       [-1.42885529e-06, -2.12538625e-06, -3.58085607e-06,
        -1.91879474e-08, -1.29689283e-08,  9.63252170e-09]])}
[[-4.96029346e+03]
 [-2.78093063e+03]
 [-4.30346525e+03]
 [-3.61492174e+00]
 [-2.71259663e+00]
 [ 5.94544799e+00]]
2018-07-13 08:26:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:30
[[-4.99616993e+03]
 [-2.80790335e+03]
 [-4.24377494e+03]
 [-3.56026462e+00]
 [-2.68191608e+00]
 [ 5.99249080e+00]]
[[ 4.10817449e-04  5.52243446e-04  9.47208428e-04  4.82717309e-06
   3.18862761e-06 -1.61075168e-06]
 [ 5.52243446e-04  7.96195426e-04  1.33473135e-03  6.57067837e-06
   4.62000163e-06 -2.24084719e-06]
 [ 9.47208428e-04  1.33473135e-03  2.52233677e-03  1.12810551e-05
   7.70272814e-06 -3.45961219e-06]
 [ 4.82717309e-06  6.57067837e-06  1.12810551e-05  5.78495559e-08
   3.78304878e-08 -1.91417812e-08]
 [ 3.18862761e-06  4.62000163e-06  7.70272814e-06  3.78304878e-08
   2.76359536e-08 -1.29139084e-08]
 [-1.61075168e-06 -2.24084719e-06 -3.45961219e-06 -1.91417812e-08
  -1.29139084e-08  9.65038196e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.99616993e+03],
       [-2.80790335e+03],
       [-4.24377494e+03],
       [-3.56026462e+00],
       [-2.68191608e+00],
       [ 5.99249080e+00]]), 'covar': array([[ 4.10817449e-04,  5.52243446e-04,  9.47208428e-04,
         4.82717309e-06,  3.18862761e-06, -1.61075168e-06],
       [ 5.52243446e-04,  7.96195426e-04,  1.33473135e-03,
         6.57067837e-06,  4.62000163e-06, -2.24084719e-06],
       [ 9.47208428e-04,  1.33473135e-03,  2.52233677e-03,
         1.12810551e-05,  7.70272814e-06, -3.45961219e-06],
       [ 4.82717309e-06,  6.57067837e-06,  1.12810551e-05,
         5.78495559e-08,  3.78304878e-08, -1.91417812e-08],
       [ 3.18862761e-06,  4.62000163e-06,  7.70272814e-06,
         3.78304878e-08,  2.76359536e-08, -1.29139084e-08],
       [-1.61075168e-06, -2.24084719e-06, -3.45961219e-06,
        -1.91417812e-08, -1.29139084e-08,  9.65038196e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.44969612e-05],
       [-4.66793233e-05],
       [-4.11624721e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.99619727e+03],
       [-2.80793482e+03],
       [-4.24383825e+03],
       [-3.56057987e+00],
       [-2.68207484e+00],
       [ 5.99233967e+00],
       [ 1.80000124e-01],
       [ 1.96498784e-02],
       [ 9.42620069e-01],
       [-2.80501771e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80504194e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.23151031e-03,  3.05987055e-03,  4.42127840e-03,
         2.79418358e-05,  1.98673850e-05, -1.54222831e-05],
       [ 3.05987055e-03,  4.41261169e-03,  6.27668553e-03,
         3.74829750e-05,  2.98833174e-05, -2.11895103e-05],
       [ 4.42127840e-03,  6.27668553e-03,  9.45577696e-03,
         5.42415660e-05,  4.11926427e-05, -2.56144665e-05],
       [ 2.79418358e-05,  3.74829750e-05,  5.42415660e-05,
         3.77292879e-07,  2.44799180e-07, -1.84621321e-07],
       [ 1.98673850e-05,  2.98833174e-05,  4.11926427e-05,
         2.44799180e-07,  2.47181063e-07, -1.19615834e-07],
       [-1.54222831e-05, -2.11895103e-05, -2.56144665e-05,
        -1.84621321e-07, -1.19615834e-07,  3.05794076e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.13916311e-05],
       [-3.52705852e-05],
       [-6.50503459e-02]])}}
Yi [[-2.19612156]
 [-0.79921115]
 [10.22910152]]
posterior
[[-4.99619727e+03]
 [-2.80793482e+03]
 [-4.24383825e+03]
 [-3.56057987e+00]
 [-2.68207484e+00]
 [ 5.99233967e+00]
 [ 1.80000124e-01]
 [ 1.96498784e-02]
 [ 9.42620069e-01]
 [-2.80501771e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80504194e-18]]
[[-4.99616612e+03]
 [-2.80789067e+03]
 [-4.24374673e+03]
 [-3.56021286e+00]
 [-2.68182560e+00]
 [ 5.99241605e+00]
 [ 1.80000124e-01]
 [ 1.96498784e-02]
 [ 9.42620069e-01]
 [-2.80501771e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80504194e-18]]
[[ 2.03423562e-03  2.78831833e-03  3.84973920e-03  2.55864213e-05
   1.83869963e-05 -1.59067999e-05]
 [ 2.78831833e-03  3.97782152e-03  5.42179695e-03  3.44793320e-05
   2.71155632e-05 -2.19260447e-05]
 [ 3.84973920e-03  5.42179695e-03  7.72375483e-03  4.76841737e-05
   3.60880530e-05 -2.70961330e-05]
 [ 2.55864213e-05  3.44793320e-05  4.76841737e-05  3.48236167e-07
   2.29979568e-07 -1.90133978e-07]
 [ 1.83869963e-05  2.71155632e-05  3.60880530e-05  2.29979568e-07
   2.27335565e-07 -1.24084290e-07]
 [-1.59067999e-05 -2.19260447e-05 -2.70961330e-05 -1.90133978e-07
  -1.24084290e-07  3.04522845e-07]]
[[-2.1961219 ]
 [-0.79928219]
 [10.34741235]]
[[ 3.41769951e-07]
 [ 7.10396923e-05]
 [-1.18310825e-01]]


 Corrector Step
2018-07-13 08:26:30
[[-4.99616612e+03]
 [-2.80789067e+03]
 [-4.24374673e+03]
 [-3.56021286e+00]
 [-2.68182560e+00]
 [ 5.99241605e+00]
 [ 1.80000124e-01]
 [ 1.96498784e-02]
 [ 9.42620069e-01]
 [-2.80501771e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80504194e-18]]
[[ 2.03423562e-03  2.78831833e-03  3.84973920e-03  2.55864213e-05
   1.83869963e-05 -1.59067999e-05]
 [ 2.78831833e-03  3.97782152e-03  5.42179695e-03  3.44793320e-05
   2.71155632e-05 -2.19260447e-05]
 [ 3.84973920e-03  5.42179695e-03  7.72375483e-03  4.76841737e-05
   3.60880530e-05 -2.70961330e-05]
 [ 2.55864213e-05  3.44793320e-05  4.76841737e-05  3.48236167e-07
   2.29979568e-07 -1.90133978e-07]
 [ 1.83869963e-05  2.71155632e-05  3.60880530e-05  2.29979568e-07
   2.27335565e-07 -1.24084290e-07]
 [-1.59067999e-05 -2.19260447e-05 -2.70961330e-05 -1.90133978e-07
  -1.24084290e-07  3.04522845e-07]]
29855995.884004734
post
cubesat_nadir
Ybar_post [[-2.19612299]
 [-0.79925161]
 [10.34713539]]
resids [[ 1.42599106e-06]
 [ 4.04586642e-05]
 [-1.18033870e-01]]
posterior
[[-4.99616993e+03]
 [-2.80790335e+03]
 [-4.24377494e+03]
 [-3.56026462e+00]
 [-2.68191608e+00]
 [ 5.99249080e+00]]
[[-4.99615768e+03]
 [-2.80788552e+03]
 [-4.24373137e+03]
 [-3.56011560e+00]
 [-2.68181407e+00]
 [ 5.99245831e+00]]
[[ 3.63401248e-04  4.86847680e-04  7.83463467e-04  4.25616723e-06
   2.81620315e-06 -1.48918709e-06]
 [ 4.86847680e-04  7.01134078e-04  1.10167792e-03  5.77540585e-06
   4.07637248e-06 -2.06846267e-06]
 [ 7.83463467e-04  1.10167792e-03  1.94616299e-03  9.29767899e-06
   6.37215189e-06 -3.03280262e-06]
 [ 4.25616723e-06  5.77540585e-06  9.29767899e-06  5.09609283e-08
   3.32978655e-08 -1.76703297e-08]
 [ 2.81620315e-06  4.07637248e-06  6.37215189e-06  3.32978655e-08
   2.45260948e-08 -1.19299958e-08]
 [-1.48918709e-06 -2.06846267e-06 -3.03280262e-06 -1.76703297e-08
  -1.19299958e-08  9.33413152e-09]]
[[-2.19611529]
 [-0.79926467]
 [10.67686272]]
[[-6.27434562e-06]
 [ 5.35159267e-05]
 [-4.47761194e-01]]


 Corrector Step
2018-07-13 08:26:30
[[-4.99615768e+03]
 [-2.80788552e+03]
 [-4.24373137e+03]
 [-3.56011560e+00]
 [-2.68181407e+00]
 [ 5.99245831e+00]]
[[ 3.63401248e-04  4.86847680e-04  7.83463467e-04  4.25616723e-06
   2.81620315e-06 -1.48918709e-06]
 [ 4.86847680e-04  7.01134078e-04  1.10167792e-03  5.77540585e-06
   4.07637248e-06 -2.06846267e-06]
 [ 7.83463467e-04  1.10167792e-03  1.94616299e-03  9.29767899e-06
   6.37215189e-06 -3.03280262e-06]
 [ 4.25616723e-06  5.77540585e-06  9.29767899e-06  5.09609283e-08
   3.32978655e-08 -1.76703297e-08]
 [ 2.81620315e-06  4.07637248e-06  6.37215189e-06  3.32978655e-08
   2.45260948e-08 -1.19299958e-08]
 [-1.48918709e-06 -2.06846267e-06 -3.03280262e-06 -1.76703297e-08
  -1.19299958e-08  9.33413152e-09]]
7240.465179073427
post
sphere_lamr_small
Ybar_post [[-2.19611628]
 [-0.79924652]
 [10.67673885]]
resids [[-5.27552978e-06]
 [ 3.53628563e-05]
 [-4.47637332e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [29855995.884004734, 7240.465179073427]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-4.99616612e+03],
       [-2.80789067e+03],
       [-4.24374673e+03],
       [-3.56021286e+00],
       [-2.68182560e+00],
       [ 5.99241605e+00]]), 'est_covars': array([[ 2.03423562e-03,  2.78831833e-03,  3.84973920e-03,
         2.55864213e-05,  1.83869963e-05, -1.59067999e-05],
       [ 2.78831833e-03,  3.97782152e-03,  5.42179695e-03,
         3.44793320e-05,  2.71155632e-05, -2.19260447e-05],
       [ 3.84973920e-03,  5.42179695e-03,  7.72375483e-03,
         4.76841737e-05,  3.60880530e-05, -2.70961330e-05],
       [ 2.55864213e-05,  3.44793320e-05,  4.76841737e-05,
         3.48236167e-07,  2.29979568e-07, -1.90133978e-07],
       [ 1.83869963e-05,  2.71155632e-05,  3.60880530e-05,
         2.29979568e-07,  2.27335565e-07, -1.24084290e-07],
       [-1.59067999e-05, -2.19260447e-05, -2.70961330e-05,
        -1.90133978e-07, -1.24084290e-07,  3.04522845e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.99615768e+03],
       [-2.80788552e+03],
       [-4.24373137e+03],
       [-3.56011560e+00],
       [-2.68181407e+00],
       [ 5.99245831e+00]]), 'covar': array([[ 3.63401248e-04,  4.86847680e-04,  7.83463467e-04,
         4.25616723e-06,  2.81620315e-06, -1.48918709e-06],
       [ 4.86847680e-04,  7.01134078e-04,  1.10167792e-03,
         5.77540585e-06,  4.07637248e-06, -2.06846267e-06],
       [ 7.83463467e-04,  1.10167792e-03,  1.94616299e-03,
         9.29767899e-06,  6.37215189e-06, -3.03280262e-06],
       [ 4.25616723e-06,  5.77540585e-06,  9.29767899e-06,
         5.09609283e-08,  3.32978655e-08, -1.76703297e-08],
       [ 2.81620315e-06,  4.07637248e-06,  6.37215189e-06,
         3.32978655e-08,  2.45260948e-08, -1.19299958e-08],
       [-1.48918709e-06, -2.06846267e-06, -3.03280262e-06,
        -1.76703297e-08, -1.19299958e-08,  9.33413152e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-5.27552978e-06],
       [ 3.53628563e-05],
       [-4.47637332e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.99616612e+03],
       [-2.80789067e+03],
       [-4.24374673e+03],
       [-3.56021286e+00],
       [-2.68182560e+00],
       [ 5.99241605e+00],
       [ 1.80000124e-01],
       [ 1.96498784e-02],
       [ 9.42620069e-01],
       [-2.80501771e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80504194e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.03423562e-03,  2.78831833e-03,  3.84973920e-03,
         2.55864213e-05,  1.83869963e-05, -1.59067999e-05],
       [ 2.78831833e-03,  3.97782152e-03,  5.42179695e-03,
         3.44793320e-05,  2.71155632e-05, -2.19260447e-05],
       [ 3.84973920e-03,  5.42179695e-03,  7.72375483e-03,
         4.76841737e-05,  3.60880530e-05, -2.70961330e-05],
       [ 2.55864213e-05,  3.44793320e-05,  4.76841737e-05,
         3.48236167e-07,  2.29979568e-07, -1.90133978e-07],
       [ 1.83869963e-05,  2.71155632e-05,  3.60880530e-05,
         2.29979568e-07,  2.27335565e-07, -1.24084290e-07],
       [-1.59067999e-05, -2.19260447e-05, -2.70961330e-05,
        -1.90133978e-07, -1.24084290e-07,  3.04522845e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.42599106e-06],
       [ 4.04586642e-05],
       [-1.18033870e-01]])}}
Current time:  2018-07-13 08:26:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-4.99616612e+03],
       [-2.80789067e+03],
       [-4.24374673e+03],
       [-3.56021286e+00],
       [-2.68182560e+00],
       [ 5.99241605e+00],
       [ 1.80000124e-01],
       [ 1.96498784e-02],
       [ 9.42620069e-01],
       [-2.80501771e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80504194e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.03423562e-03,  2.78831833e-03,  3.84973920e-03,
         2.55864213e-05,  1.83869963e-05, -1.59067999e-05],
       [ 2.78831833e-03,  3.97782152e-03,  5.42179695e-03,
         3.44793320e-05,  2.71155632e-05, -2.19260447e-05],
       [ 3.84973920e-03,  5.42179695e-03,  7.72375483e-03,
         4.76841737e-05,  3.60880530e-05, -2.70961330e-05],
       [ 2.55864213e-05,  3.44793320e-05,  4.76841737e-05,
         3.48236167e-07,  2.29979568e-07, -1.90133978e-07],
       [ 1.83869963e-05,  2.71155632e-05,  3.60880530e-05,
         2.29979568e-07,  2.27335565e-07, -1.24084290e-07],
       [-1.59067999e-05, -2.19260447e-05, -2.70961330e-05,
        -1.90133978e-07, -1.24084290e-07,  3.04522845e-07]])}
[[-4.99616612e+03]
 [-2.80789067e+03]
 [-4.24374673e+03]
 [-3.56021286e+00]
 [-2.68182560e+00]
 [ 5.99241605e+00]
 [ 1.80000124e-01]
 [ 1.96498784e-02]
 [ 9.42620069e-01]
 [-2.80501771e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80504194e-18]]
2018-07-13 08:26:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:40
[[-5.03149312e+03]
 [-2.83455417e+03]
 [-4.18358997e+03]
 [-3.50515722e+00]
 [-2.65084640e+00]
 [ 6.03880555e+00]
 [ 1.84919385e-01]
 [ 2.11141982e-02]
 [ 9.41667383e-01]
 [-2.80395350e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80525423e-18]]
[[ 2.58213082e-03  3.34089414e-03  4.14972617e-03  2.92249814e-05
   2.07271793e-05 -1.77505144e-05]
 [ 3.34089414e-03  4.54362871e-03  5.55176276e-03  3.69157596e-05
   2.94873515e-05 -2.30875158e-05]
 [ 4.14972617e-03  5.55176276e-03  7.21357865e-03  4.59566636e-05
   3.49108368e-05 -2.39035115e-05]
 [ 2.92249814e-05  3.69157596e-05  4.59566636e-05  3.60462010e-07
   2.31231566e-07 -1.90100990e-07]
 [ 2.07271793e-05  2.94873515e-05  3.49108368e-05  2.31231566e-07
   2.37911221e-07 -1.23797222e-07]
 [-1.77505144e-05 -2.30875158e-05 -2.39035115e-05 -1.90100990e-07
  -1.23797222e-07  3.13684749e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-4.99615768e+03],
       [-2.80788552e+03],
       [-4.24373137e+03],
       [-3.56011560e+00],
       [-2.68181407e+00],
       [ 5.99245831e+00]]), 'covar': array([[ 3.63401248e-04,  4.86847680e-04,  7.83463467e-04,
         4.25616723e-06,  2.81620315e-06, -1.48918709e-06],
       [ 4.86847680e-04,  7.01134078e-04,  1.10167792e-03,
         5.77540585e-06,  4.07637248e-06, -2.06846267e-06],
       [ 7.83463467e-04,  1.10167792e-03,  1.94616299e-03,
         9.29767899e-06,  6.37215189e-06, -3.03280262e-06],
       [ 4.25616723e-06,  5.77540585e-06,  9.29767899e-06,
         5.09609283e-08,  3.32978655e-08, -1.76703297e-08],
       [ 2.81620315e-06,  4.07637248e-06,  6.37215189e-06,
         3.32978655e-08,  2.45260948e-08, -1.19299958e-08],
       [-1.48918709e-06, -2.06846267e-06, -3.03280262e-06,
        -1.76703297e-08, -1.19299958e-08,  9.33413152e-09]])}
[[-4.99615768e+03]
 [-2.80788552e+03]
 [-4.24373137e+03]
 [-3.56011560e+00]
 [-2.68181407e+00]
 [ 5.99245831e+00]]
2018-07-13 08:26:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:40
[[-5.03148378e+03]
 [-2.83454896e+03]
 [-4.18357418e+03]
 [-3.50505960e+00]
 [-2.65083492e+00]
 [ 6.03884779e+00]]
[[ 4.53871222e-04  5.76284771e-04  8.60080021e-04  4.78669210e-06
   3.15721982e-06 -1.65556754e-06]
 [ 5.76284771e-04  7.85223209e-04  1.14368953e-03  6.13450891e-06
   4.33182170e-06 -2.17387916e-06]
 [ 8.60080021e-04  1.14368953e-03  1.88668012e-03  9.16214454e-06
   6.26884426e-06 -2.91836130e-06]
 [ 4.78669210e-06  6.13450891e-06  9.16214454e-06  5.14708166e-08
   3.35165167e-08 -1.76257178e-08]
 [ 3.15721982e-06  4.33182170e-06  6.26884426e-06  3.35165167e-08
   2.47292198e-08 -1.18779572e-08]
 [-1.65556754e-06 -2.17387916e-06 -2.91836130e-06 -1.76257178e-08
  -1.18779572e-08  9.35491314e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.03148378e+03],
       [-2.83454896e+03],
       [-4.18357418e+03],
       [-3.50505960e+00],
       [-2.65083492e+00],
       [ 6.03884779e+00]]), 'covar': array([[ 4.53871222e-04,  5.76284771e-04,  8.60080021e-04,
         4.78669210e-06,  3.15721982e-06, -1.65556754e-06],
       [ 5.76284771e-04,  7.85223209e-04,  1.14368953e-03,
         6.13450891e-06,  4.33182170e-06, -2.17387916e-06],
       [ 8.60080021e-04,  1.14368953e-03,  1.88668012e-03,
         9.16214454e-06,  6.26884426e-06, -2.91836130e-06],
       [ 4.78669210e-06,  6.13450891e-06,  9.16214454e-06,
         5.14708166e-08,  3.35165167e-08, -1.76257178e-08],
       [ 3.15721982e-06,  4.33182170e-06,  6.26884426e-06,
         3.35165167e-08,  2.47292198e-08, -1.18779572e-08],
       [-1.65556754e-06, -2.17387916e-06, -2.91836130e-06,
        -1.76257178e-08, -1.18779572e-08,  9.35491314e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-5.27552978e-06],
       [ 3.53628563e-05],
       [-4.47637332e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.03149312e+03],
       [-2.83455417e+03],
       [-4.18358997e+03],
       [-3.50515722e+00],
       [-2.65084640e+00],
       [ 6.03880555e+00],
       [ 1.84919385e-01],
       [ 2.11141982e-02],
       [ 9.41667383e-01],
       [-2.80395350e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80525423e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.58213082e-03,  3.34089414e-03,  4.14972617e-03,
         2.92249814e-05,  2.07271793e-05, -1.77505144e-05],
       [ 3.34089414e-03,  4.54362871e-03,  5.55176276e-03,
         3.69157596e-05,  2.94873515e-05, -2.30875158e-05],
       [ 4.14972617e-03,  5.55176276e-03,  7.21357865e-03,
         4.59566636e-05,  3.49108368e-05, -2.39035115e-05],
       [ 2.92249814e-05,  3.69157596e-05,  4.59566636e-05,
         3.60462010e-07,  2.31231566e-07, -1.90100990e-07],
       [ 2.07271793e-05,  2.94873515e-05,  3.49108368e-05,
         2.31231566e-07,  2.37911221e-07, -1.23797222e-07],
       [-1.77505144e-05, -2.30875158e-05, -2.39035115e-05,
        -1.90100990e-07, -1.23797222e-07,  3.13684749e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.42599106e-06],
       [ 4.04586642e-05],
       [-1.18033870e-01]])}}
Yi [[-2.22294624]
 [-0.71101824]
 [10.19373526]]
posterior
[[-5.03149312e+03]
 [-2.83455417e+03]
 [-4.18358997e+03]
 [-3.50515722e+00]
 [-2.65084640e+00]
 [ 6.03880555e+00]
 [ 1.84919385e-01]
 [ 2.11141982e-02]
 [ 9.41667383e-01]
 [-2.80395350e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80525423e-18]]
[[-5.03148178e+03]
 [-2.83453504e+03]
 [-4.18355900e+03]
 [-3.50505311e+00]
 [-2.65071542e+00]
 [ 6.03883376e+00]
 [ 1.84919385e-01]
 [ 2.11141982e-02]
 [ 9.41667383e-01]
 [-2.80395350e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80525423e-18]]
[[ 2.35379342e-03  3.04540576e-03  3.60939989e-03  2.67594281e-05
   1.91602798e-05 -1.82603714e-05]
 [ 3.04540576e-03  4.10109579e-03  4.79442030e-03  3.39749945e-05
   2.67461179e-05 -2.38153124e-05]
 [ 3.60939989e-03  4.79442030e-03  5.87881410e-03  4.03637427e-05
   3.05135994e-05 -2.51758696e-05]
 [ 2.67594281e-05  3.39749945e-05  4.03637427e-05  3.32801220e-07
   2.17276774e-07 -1.95323746e-07]
 [ 1.91602798e-05  2.67461179e-05  3.05135994e-05  2.17276774e-07
   2.18693883e-07 -1.28102410e-07]
 [-1.82603714e-05 -2.38153124e-05 -2.51758696e-05 -1.95323746e-07
  -1.28102410e-07  3.12467519e-07]]
[[-2.22293198]
 [-0.71104383]
 [10.35148573]]
[[-1.42561553e-05]
 [ 2.55922098e-05]
 [-1.57750466e-01]]


 Corrector Step
2018-07-13 08:26:40
[[-5.03148178e+03]
 [-2.83453504e+03]
 [-4.18355900e+03]
 [-3.50505311e+00]
 [-2.65071542e+00]
 [ 6.03883376e+00]
 [ 1.84919385e-01]
 [ 2.11141982e-02]
 [ 9.41667383e-01]
 [-2.80395350e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80525423e-18]]
[[ 2.35379342e-03  3.04540576e-03  3.60939989e-03  2.67594281e-05
   1.91602798e-05 -1.82603714e-05]
 [ 3.04540576e-03  4.10109579e-03  4.79442030e-03  3.39749945e-05
   2.67461179e-05 -2.38153124e-05]
 [ 3.60939989e-03  4.79442030e-03  5.87881410e-03  4.03637427e-05
   3.05135994e-05 -2.51758696e-05]
 [ 2.67594281e-05  3.39749945e-05  4.03637427e-05  3.32801220e-07
   2.17276774e-07 -1.95323746e-07]
 [ 1.91602798e-05  2.67461179e-05  3.05135994e-05  2.17276774e-07
   2.18693883e-07 -1.28102410e-07]
 [-1.82603714e-05 -2.38153124e-05 -2.51758696e-05 -1.95323746e-07
  -1.28102410e-07  3.12467519e-07]]
130318575.8978745
post
cubesat_nadir
Ybar_post [[-2.22293631]
 [-0.71103264]
 [10.35139475]]
resids [[-9.93107609e-06]
 [ 1.44000927e-05]
 [-1.57659486e-01]]
posterior
[[-5.03148378e+03]
 [-2.83454896e+03]
 [-4.18357418e+03]
 [-3.50505960e+00]
 [-2.65083492e+00]
 [ 6.03884779e+00]]
[[-5.03147972e+03]
 [-2.83454176e+03]
 [-4.18356041e+03]
 [-3.50501389e+00]
 [-2.65079485e+00]
 [ 6.03883596e+00]]
[[ 4.00850819e-04  5.07113404e-04  7.10240056e-04  4.21713924e-06
   2.78315826e-06 -1.52592587e-06]
 [ 5.07113404e-04  6.90442114e-04  9.42462013e-04  5.38640094e-06
   3.81657997e-06 -2.00055503e-06]
 [ 7.10240056e-04  9.42462013e-04  1.45595156e-03  7.54613989e-06
   5.17725307e-06 -2.54668043e-06]
 [ 4.21713924e-06  5.38640094e-06  7.54613989e-06  4.53469582e-08
   2.94679374e-08 -1.62284167e-08]
 [ 2.78315826e-06  3.81657997e-06  5.17725307e-06  2.94679374e-08
   2.19267853e-08 -1.09381801e-08]
 [-1.52592587e-06 -2.00055503e-06 -2.54668043e-06 -1.62284167e-08
  -1.09381801e-08  9.03405129e-09]]
[[-2.2229251 ]
 [-0.71103692]
 [10.65768862]]
[[-2.11404917e-05]
 [ 1.86780710e-05]
 [-4.63953355e-01]]


 Corrector Step
2018-07-13 08:26:40
[[-5.03147972e+03]
 [-2.83454176e+03]
 [-4.18356041e+03]
 [-3.50501389e+00]
 [-2.65079485e+00]
 [ 6.03883596e+00]]
[[ 4.00850819e-04  5.07113404e-04  7.10240056e-04  4.21713924e-06
   2.78315826e-06 -1.52592587e-06]
 [ 5.07113404e-04  6.90442114e-04  9.42462013e-04  5.38640094e-06
   3.81657997e-06 -2.00055503e-06]
 [ 7.10240056e-04  9.42462013e-04  1.45595156e-03  7.54613989e-06
   5.17725307e-06 -2.54668043e-06]
 [ 4.21713924e-06  5.38640094e-06  7.54613989e-06  4.53469582e-08
   2.94679374e-08 -1.62284167e-08]
 [ 2.78315826e-06  3.81657997e-06  5.17725307e-06  2.94679374e-08
   2.19267853e-08 -1.09381801e-08]
 [-1.52592587e-06 -2.00055503e-06 -2.54668043e-06 -1.62284167e-08
  -1.09381801e-08  9.03405129e-09]]
10440.561891357074
post
sphere_lamr_small
Ybar_post [[-2.22292697]
 [-0.71103066]
 [10.65764919]]
resids [[-1.92718592e-05]
 [ 1.24158091e-05]
 [-4.63913931e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [130318575.8978745, 10440.561891357074]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.03148178e+03],
       [-2.83453504e+03],
       [-4.18355900e+03],
       [-3.50505311e+00],
       [-2.65071542e+00],
       [ 6.03883376e+00]]), 'est_covars': array([[ 2.35379342e-03,  3.04540576e-03,  3.60939989e-03,
         2.67594281e-05,  1.91602798e-05, -1.82603714e-05],
       [ 3.04540576e-03,  4.10109579e-03,  4.79442030e-03,
         3.39749945e-05,  2.67461179e-05, -2.38153124e-05],
       [ 3.60939989e-03,  4.79442030e-03,  5.87881410e-03,
         4.03637427e-05,  3.05135994e-05, -2.51758696e-05],
       [ 2.67594281e-05,  3.39749945e-05,  4.03637427e-05,
         3.32801220e-07,  2.17276774e-07, -1.95323746e-07],
       [ 1.91602798e-05,  2.67461179e-05,  3.05135994e-05,
         2.17276774e-07,  2.18693883e-07, -1.28102410e-07],
       [-1.82603714e-05, -2.38153124e-05, -2.51758696e-05,
        -1.95323746e-07, -1.28102410e-07,  3.12467519e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.03147972e+03],
       [-2.83454176e+03],
       [-4.18356041e+03],
       [-3.50501389e+00],
       [-2.65079485e+00],
       [ 6.03883596e+00]]), 'covar': array([[ 4.00850819e-04,  5.07113404e-04,  7.10240056e-04,
         4.21713924e-06,  2.78315826e-06, -1.52592587e-06],
       [ 5.07113404e-04,  6.90442114e-04,  9.42462013e-04,
         5.38640094e-06,  3.81657997e-06, -2.00055503e-06],
       [ 7.10240056e-04,  9.42462013e-04,  1.45595156e-03,
         7.54613989e-06,  5.17725307e-06, -2.54668043e-06],
       [ 4.21713924e-06,  5.38640094e-06,  7.54613989e-06,
         4.53469582e-08,  2.94679374e-08, -1.62284167e-08],
       [ 2.78315826e-06,  3.81657997e-06,  5.17725307e-06,
         2.94679374e-08,  2.19267853e-08, -1.09381801e-08],
       [-1.52592587e-06, -2.00055503e-06, -2.54668043e-06,
        -1.62284167e-08, -1.09381801e-08,  9.03405129e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.92718592e-05],
       [ 1.24158091e-05],
       [-4.63913931e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.03148178e+03],
       [-2.83453504e+03],
       [-4.18355900e+03],
       [-3.50505311e+00],
       [-2.65071542e+00],
       [ 6.03883376e+00],
       [ 1.84919385e-01],
       [ 2.11141982e-02],
       [ 9.41667383e-01],
       [-2.80395350e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80525423e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.35379342e-03,  3.04540576e-03,  3.60939989e-03,
         2.67594281e-05,  1.91602798e-05, -1.82603714e-05],
       [ 3.04540576e-03,  4.10109579e-03,  4.79442030e-03,
         3.39749945e-05,  2.67461179e-05, -2.38153124e-05],
       [ 3.60939989e-03,  4.79442030e-03,  5.87881410e-03,
         4.03637427e-05,  3.05135994e-05, -2.51758696e-05],
       [ 2.67594281e-05,  3.39749945e-05,  4.03637427e-05,
         3.32801220e-07,  2.17276774e-07, -1.95323746e-07],
       [ 1.91602798e-05,  2.67461179e-05,  3.05135994e-05,
         2.17276774e-07,  2.18693883e-07, -1.28102410e-07],
       [-1.82603714e-05, -2.38153124e-05, -2.51758696e-05,
        -1.95323746e-07, -1.28102410e-07,  3.12467519e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-9.93107609e-06],
       [ 1.44000927e-05],
       [-1.57659486e-01]])}}
Current time:  2018-07-13 08:26:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.03148178e+03],
       [-2.83453504e+03],
       [-4.18355900e+03],
       [-3.50505311e+00],
       [-2.65071542e+00],
       [ 6.03883376e+00],
       [ 1.84919385e-01],
       [ 2.11141982e-02],
       [ 9.41667383e-01],
       [-2.80395350e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80525423e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.35379342e-03,  3.04540576e-03,  3.60939989e-03,
         2.67594281e-05,  1.91602798e-05, -1.82603714e-05],
       [ 3.04540576e-03,  4.10109579e-03,  4.79442030e-03,
         3.39749945e-05,  2.67461179e-05, -2.38153124e-05],
       [ 3.60939989e-03,  4.79442030e-03,  5.87881410e-03,
         4.03637427e-05,  3.05135994e-05, -2.51758696e-05],
       [ 2.67594281e-05,  3.39749945e-05,  4.03637427e-05,
         3.32801220e-07,  2.17276774e-07, -1.95323746e-07],
       [ 1.91602798e-05,  2.67461179e-05,  3.05135994e-05,
         2.17276774e-07,  2.18693883e-07, -1.28102410e-07],
       [-1.82603714e-05, -2.38153124e-05, -2.51758696e-05,
        -1.95323746e-07, -1.28102410e-07,  3.12467519e-07]])}
[[-5.03148178e+03]
 [-2.83453504e+03]
 [-4.18355900e+03]
 [-3.50505311e+00]
 [-2.65071542e+00]
 [ 6.03883376e+00]
 [ 1.84919385e-01]
 [ 2.11141982e-02]
 [ 9.41667383e-01]
 [-2.80395350e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80525423e-18]]
2018-07-13 08:26:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:50
[[-5.06625513e+03]
 [-2.86088606e+03]
 [-4.12294149e+03]
 [-3.44960468e+00]
 [-2.61944074e+00]
 [ 6.08456454e+00]
 [ 1.89833605e-01]
 [ 2.25779423e-02]
 [ 9.40689025e-01]
 [-2.80281284e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80546652e-18]]
[[ 2.92368244e-03  3.59932337e-03  3.81189451e-03  3.02435981e-05
   2.13728409e-05 -2.01515547e-05]
 [ 3.59932337e-03  4.65857795e-03  4.84924251e-03  3.62780960e-05
   2.90284445e-05 -2.50150543e-05]
 [ 3.81189451e-03  4.84924251e-03  5.40765469e-03  3.85525525e-05
   2.92840518e-05 -2.19166998e-05]
 [ 3.02435981e-05  3.62780960e-05  3.85525525e-05  3.44842320e-07
   2.18420746e-07 -1.95310528e-07]
 [ 2.13728409e-05  2.90284445e-05  2.92840518e-05  2.18420746e-07
   2.29210352e-07 -1.27824961e-07]
 [-2.01515547e-05 -2.50150543e-05 -2.19166998e-05 -1.95310528e-07
  -1.27824961e-07  3.21558151e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.03147972e+03],
       [-2.83454176e+03],
       [-4.18356041e+03],
       [-3.50501389e+00],
       [-2.65079485e+00],
       [ 6.03883596e+00]]), 'covar': array([[ 4.00850819e-04,  5.07113404e-04,  7.10240056e-04,
         4.21713924e-06,  2.78315826e-06, -1.52592587e-06],
       [ 5.07113404e-04,  6.90442114e-04,  9.42462013e-04,
         5.38640094e-06,  3.81657997e-06, -2.00055503e-06],
       [ 7.10240056e-04,  9.42462013e-04,  1.45595156e-03,
         7.54613989e-06,  5.17725307e-06, -2.54668043e-06],
       [ 4.21713924e-06,  5.38640094e-06,  7.54613989e-06,
         4.53469582e-08,  2.94679374e-08, -1.62284167e-08],
       [ 2.78315826e-06,  3.81657997e-06,  5.17725307e-06,
         2.94679374e-08,  2.19267853e-08, -1.09381801e-08],
       [-1.52592587e-06, -2.00055503e-06, -2.54668043e-06,
        -1.62284167e-08, -1.09381801e-08,  9.03405129e-09]])}
[[-5.03147972e+03]
 [-2.83454176e+03]
 [-4.18356041e+03]
 [-3.50501389e+00]
 [-2.65079485e+00]
 [ 6.03883596e+00]]
2018-07-13 08:26:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:26:50
[[-5.06625277e+03]
 [-2.86089357e+03]
 [-4.12294274e+03]
 [-3.44956573e+00]
 [-2.61952037e+00]
 [ 6.08456684e+00]]
[[ 4.89956176e-04  5.91922136e-04  7.69077583e-04  4.69048266e-06
   3.08543416e-06 -1.67755767e-06]
 [ 5.91922136e-04  7.69054942e-04  9.73274314e-04  5.70486247e-06
   4.04505886e-06 -2.09639309e-06]
 [ 7.69077583e-04  9.73274314e-04  1.40613755e-03  7.41650480e-06
   5.08047052e-06 -2.43845059e-06]
 [ 4.69048266e-06  5.70486247e-06  7.41650480e-06  4.58028238e-08
   2.96575075e-08 -1.61852011e-08]
 [ 3.08543416e-06  4.04505886e-06  5.08047052e-06  2.96575075e-08
   2.21150222e-08 -1.08890957e-08]
 [-1.67755767e-06 -2.09639309e-06 -2.43845059e-06 -1.61852011e-08
  -1.08890957e-08  9.05776072e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.06625277e+03],
       [-2.86089357e+03],
       [-4.12294274e+03],
       [-3.44956573e+00],
       [-2.61952037e+00],
       [ 6.08456684e+00]]), 'covar': array([[ 4.89956176e-04,  5.91922136e-04,  7.69077583e-04,
         4.69048266e-06,  3.08543416e-06, -1.67755767e-06],
       [ 5.91922136e-04,  7.69054942e-04,  9.73274314e-04,
         5.70486247e-06,  4.04505886e-06, -2.09639309e-06],
       [ 7.69077583e-04,  9.73274314e-04,  1.40613755e-03,
         7.41650480e-06,  5.08047052e-06, -2.43845059e-06],
       [ 4.69048266e-06,  5.70486247e-06,  7.41650480e-06,
         4.58028238e-08,  2.96575075e-08, -1.61852011e-08],
       [ 3.08543416e-06,  4.04505886e-06,  5.08047052e-06,
         2.96575075e-08,  2.21150222e-08, -1.08890957e-08],
       [-1.67755767e-06, -2.09639309e-06, -2.43845059e-06,
        -1.61852011e-08, -1.08890957e-08,  9.05776072e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.92718592e-05],
       [ 1.24158091e-05],
       [-4.63913931e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.06625513e+03],
       [-2.86088606e+03],
       [-4.12294149e+03],
       [-3.44960468e+00],
       [-2.61944074e+00],
       [ 6.08456454e+00],
       [ 1.89833605e-01],
       [ 2.25779423e-02],
       [ 9.40689025e-01],
       [-2.80281284e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80546652e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.92368244e-03,  3.59932337e-03,  3.81189451e-03,
         3.02435981e-05,  2.13728409e-05, -2.01515547e-05],
       [ 3.59932337e-03,  4.65857795e-03,  4.84924251e-03,
         3.62780960e-05,  2.90284445e-05, -2.50150543e-05],
       [ 3.81189451e-03,  4.84924251e-03,  5.40765469e-03,
         3.85525525e-05,  2.92840518e-05, -2.19166998e-05],
       [ 3.02435981e-05,  3.62780960e-05,  3.85525525e-05,
         3.44842320e-07,  2.18420746e-07, -1.95310528e-07],
       [ 2.13728409e-05,  2.90284445e-05,  2.92840518e-05,
         2.18420746e-07,  2.29210352e-07, -1.27824961e-07],
       [-2.01515547e-05, -2.50150543e-05, -2.19166998e-05,
        -1.95310528e-07, -1.27824961e-07,  3.21558151e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-9.93107609e-06],
       [ 1.44000927e-05],
       [-1.57659486e-01]])}}
Yi [[-2.24599023]
 [-0.62062615]
 [10.31555012]]
posterior
[[-5.06625513e+03]
 [-2.86088606e+03]
 [-4.12294149e+03]
 [-3.44960468e+00]
 [-2.61944074e+00]
 [ 6.08456454e+00]
 [ 1.89833605e-01]
 [ 2.25779423e-02]
 [ 9.40689025e-01]
 [-2.80281284e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80546652e-18]]
[[-5.06623446e+03]
 [-2.86086856e+03]
 [-4.12290772e+03]
 [-3.44936586e+00]
 [-2.61940129e+00]
 [ 6.08459689e+00]
 [ 1.89833605e-01]
 [ 2.25779423e-02]
 [ 9.40689025e-01]
 [-2.80281284e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80546652e-18]]
[[ 2.66986421e-03  3.28824637e-03  3.31574986e-03  2.77241670e-05
   1.97606299e-05 -2.06681423e-05]
 [ 3.28824637e-03  4.21720055e-03  4.19087325e-03  3.34486412e-05
   2.63467397e-05 -2.57155252e-05]
 [ 3.31574986e-03  4.19087325e-03  4.39573837e-03  3.38438853e-05
   2.55421784e-05 -2.29829691e-05]
 [ 2.77241670e-05  3.34486412e-05  3.38438853e-05  3.18724163e-07
   2.05450281e-07 -2.00148782e-07]
 [ 1.97606299e-05  2.63467397e-05  2.55421784e-05  2.05450281e-07
   2.10684592e-07 -1.31896617e-07]
 [-2.06681423e-05 -2.57155252e-05 -2.29829691e-05 -2.00148782e-07
  -1.31896617e-07  3.20429389e-07]]
[[-2.24602258]
 [-0.62066272]
 [10.384323  ]]
[[ 3.23489710e-05]
 [ 3.65643305e-05]
 [-6.87728778e-02]]


 Corrector Step
2018-07-13 08:26:50
[[-5.06623446e+03]
 [-2.86086856e+03]
 [-4.12290772e+03]
 [-3.44936586e+00]
 [-2.61940129e+00]
 [ 6.08459689e+00]
 [ 1.89833605e-01]
 [ 2.25779423e-02]
 [ 9.40689025e-01]
 [-2.80281284e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80546652e-18]]
[[ 2.66986421e-03  3.28824637e-03  3.31574986e-03  2.77241670e-05
   1.97606299e-05 -2.06681423e-05]
 [ 3.28824637e-03  4.21720055e-03  4.19087325e-03  3.34486412e-05
   2.63467397e-05 -2.57155252e-05]
 [ 3.31574986e-03  4.19087325e-03  4.39573837e-03  3.38438853e-05
   2.55421784e-05 -2.29829691e-05]
 [ 2.77241670e-05  3.34486412e-05  3.38438853e-05  3.18724163e-07
   2.05450281e-07 -2.00148782e-07]
 [ 1.97606299e-05  2.63467397e-05  2.55421784e-05  2.05450281e-07
   2.10684592e-07 -1.31896617e-07]
 [-2.06681423e-05 -2.57155252e-05 -2.29829691e-05 -2.00148782e-07
  -1.31896617e-07  3.20429389e-07]]
145403555.61388835
post
cubesat_nadir
Ybar_post [[-2.24601472]
 [-0.62064776]
 [10.38419623]]
resids [[ 2.44841971e-05]
 [ 2.16065448e-05]
 [-6.86461089e-02]]
posterior
[[-5.06625277e+03]
 [-2.86089357e+03]
 [-4.12294274e+03]
 [-3.44956573e+00]
 [-2.61952037e+00]
 [ 6.08456684e+00]]
[[-5.06624298e+03]
 [-2.86088299e+03]
 [-4.12292172e+03]
 [-3.44947199e+00]
 [-2.61946701e+00]
 [ 6.08454528e+00]]
[[ 4.31548736e-04  5.19318128e-04  6.32918868e-04  4.12393474e-06
   2.71152217e-06 -1.54115384e-06]
 [ 5.19318128e-04  6.74467645e-04  7.99313779e-04  4.99737474e-06
   3.55490310e-06 -1.92302392e-06]
 [ 6.32918868e-04  7.99313779e-04  1.08361612e-03  6.09226436e-06
   4.18128206e-06 -2.11633135e-06]
 [ 4.12393474e-06  4.99737474e-06  6.09226436e-06  4.03049379e-08
   2.60116731e-08 -1.48592515e-08]
 [ 2.71152217e-06  3.55490310e-06  4.18128206e-06  2.60116731e-08
   1.95729928e-08 -9.99357871e-09]
 [-1.54115384e-06 -1.92302392e-06 -2.11633135e-06 -1.48592515e-08
  -9.99357871e-09  8.73585516e-09]]
[[-2.2460126 ]
 [-0.62066081]
 [10.66022265]]
[[ 2.23651930e-05]
 [ 3.46569819e-05]
 [-3.44672527e-01]]


 Corrector Step
2018-07-13 08:26:50
[[-5.06624298e+03]
 [-2.86088299e+03]
 [-4.12292172e+03]
 [-3.44947199e+00]
 [-2.61946701e+00]
 [ 6.08454528e+00]]
[[ 4.31548736e-04  5.19318128e-04  6.32918868e-04  4.12393474e-06
   2.71152217e-06 -1.54115384e-06]
 [ 5.19318128e-04  6.74467645e-04  7.99313779e-04  4.99737474e-06
   3.55490310e-06 -1.92302392e-06]
 [ 6.32918868e-04  7.99313779e-04  1.08361612e-03  6.09226436e-06
   4.18128206e-06 -2.11633135e-06]
 [ 4.12393474e-06  4.99737474e-06  6.09226436e-06  4.03049379e-08
   2.60116731e-08 -1.48592515e-08]
 [ 2.71152217e-06  3.55490310e-06  4.18128206e-06  2.60116731e-08
   1.95729928e-08 -9.99357871e-09]
 [-1.54115384e-06 -1.92302392e-06 -2.11633135e-06 -1.48592515e-08
  -9.99357871e-09  8.73585516e-09]]
754765.020284619
post
sphere_lamr_small
Ybar_post [[-2.24601109]
 [-0.62064993]
 [10.660158  ]]
resids [[ 2.08533830e-05]
 [ 2.37734936e-05]
 [-3.44607879e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [145403555.61388835, 754765.020284619]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.06623446e+03],
       [-2.86086856e+03],
       [-4.12290772e+03],
       [-3.44936586e+00],
       [-2.61940129e+00],
       [ 6.08459689e+00]]), 'est_covars': array([[ 2.66986421e-03,  3.28824637e-03,  3.31574986e-03,
         2.77241670e-05,  1.97606299e-05, -2.06681423e-05],
       [ 3.28824637e-03,  4.21720055e-03,  4.19087325e-03,
         3.34486412e-05,  2.63467397e-05, -2.57155252e-05],
       [ 3.31574986e-03,  4.19087325e-03,  4.39573837e-03,
         3.38438853e-05,  2.55421784e-05, -2.29829691e-05],
       [ 2.77241670e-05,  3.34486412e-05,  3.38438853e-05,
         3.18724163e-07,  2.05450281e-07, -2.00148782e-07],
       [ 1.97606299e-05,  2.63467397e-05,  2.55421784e-05,
         2.05450281e-07,  2.10684592e-07, -1.31896617e-07],
       [-2.06681423e-05, -2.57155252e-05, -2.29829691e-05,
        -2.00148782e-07, -1.31896617e-07,  3.20429389e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.06624298e+03],
       [-2.86088299e+03],
       [-4.12292172e+03],
       [-3.44947199e+00],
       [-2.61946701e+00],
       [ 6.08454528e+00]]), 'covar': array([[ 4.31548736e-04,  5.19318128e-04,  6.32918868e-04,
         4.12393474e-06,  2.71152217e-06, -1.54115384e-06],
       [ 5.19318128e-04,  6.74467645e-04,  7.99313779e-04,
         4.99737474e-06,  3.55490310e-06, -1.92302392e-06],
       [ 6.32918868e-04,  7.99313779e-04,  1.08361612e-03,
         6.09226436e-06,  4.18128206e-06, -2.11633135e-06],
       [ 4.12393474e-06,  4.99737474e-06,  6.09226436e-06,
         4.03049379e-08,  2.60116731e-08, -1.48592515e-08],
       [ 2.71152217e-06,  3.55490310e-06,  4.18128206e-06,
         2.60116731e-08,  1.95729928e-08, -9.99357871e-09],
       [-1.54115384e-06, -1.92302392e-06, -2.11633135e-06,
        -1.48592515e-08, -9.99357871e-09,  8.73585516e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.08533830e-05],
       [ 2.37734936e-05],
       [-3.44607879e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.06623446e+03],
       [-2.86086856e+03],
       [-4.12290772e+03],
       [-3.44936586e+00],
       [-2.61940129e+00],
       [ 6.08459689e+00],
       [ 1.89833605e-01],
       [ 2.25779423e-02],
       [ 9.40689025e-01],
       [-2.80281284e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80546652e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.66986421e-03,  3.28824637e-03,  3.31574986e-03,
         2.77241670e-05,  1.97606299e-05, -2.06681423e-05],
       [ 3.28824637e-03,  4.21720055e-03,  4.19087325e-03,
         3.34486412e-05,  2.63467397e-05, -2.57155252e-05],
       [ 3.31574986e-03,  4.19087325e-03,  4.39573837e-03,
         3.38438853e-05,  2.55421784e-05, -2.29829691e-05],
       [ 2.77241670e-05,  3.34486412e-05,  3.38438853e-05,
         3.18724163e-07,  2.05450281e-07, -2.00148782e-07],
       [ 1.97606299e-05,  2.63467397e-05,  2.55421784e-05,
         2.05450281e-07,  2.10684592e-07, -1.31896617e-07],
       [-2.06681423e-05, -2.57155252e-05, -2.29829691e-05,
        -2.00148782e-07, -1.31896617e-07,  3.20429389e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.44841971e-05],
       [ 2.16065448e-05],
       [-6.86461089e-02]])}}
Current time:  2018-07-13 08:27:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.06623446e+03],
       [-2.86086856e+03],
       [-4.12290772e+03],
       [-3.44936586e+00],
       [-2.61940129e+00],
       [ 6.08459689e+00],
       [ 1.89833605e-01],
       [ 2.25779423e-02],
       [ 9.40689025e-01],
       [-2.80281284e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80546652e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.66986421e-03,  3.28824637e-03,  3.31574986e-03,
         2.77241670e-05,  1.97606299e-05, -2.06681423e-05],
       [ 3.28824637e-03,  4.21720055e-03,  4.19087325e-03,
         3.34486412e-05,  2.63467397e-05, -2.57155252e-05],
       [ 3.31574986e-03,  4.19087325e-03,  4.39573837e-03,
         3.38438853e-05,  2.55421784e-05, -2.29829691e-05],
       [ 2.77241670e-05,  3.34486412e-05,  3.38438853e-05,
         3.18724163e-07,  2.05450281e-07, -2.00148782e-07],
       [ 1.97606299e-05,  2.63467397e-05,  2.55421784e-05,
         2.05450281e-07,  2.10684592e-07, -1.31896617e-07],
       [-2.06681423e-05, -2.57155252e-05, -2.29829691e-05,
        -2.00148782e-07, -1.31896617e-07,  3.20429389e-07]])}
[[-5.06623446e+03]
 [-2.86086856e+03]
 [-4.12290772e+03]
 [-3.44936586e+00]
 [-2.61940129e+00]
 [ 6.08459689e+00]
 [ 1.89833605e-01]
 [ 2.25779423e-02]
 [ 9.40689025e-01]
 [-2.80281284e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80546652e-18]]
2018-07-13 08:26:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:00
[[-5.10044897e+03]
 [-2.88690497e+03]
 [-4.06183583e+03]
 [-3.39353052e+00]
 [-2.58783461e+00]
 [ 6.12966432e+00]
 [ 1.94742649e-01]
 [ 2.40410709e-02]
 [ 9.39685021e-01]
 [-2.80159577e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80567880e-18]]
[[ 3.25777526e-03  3.84168698e-03  3.42842324e-03  3.10670294e-05
   2.18540149e-05 -2.26028194e-05]
 [ 3.84168698e-03  4.76586871e-03  4.17656444e-03  3.56277502e-05
   2.85462225e-05 -2.69511393e-05]
 [ 3.42842324e-03  4.17656444e-03  3.96911498e-03  3.19576656e-05
   2.42647139e-05 -1.96563153e-05]
 [ 3.10670294e-05  3.56277502e-05  3.19576656e-05  3.30602674e-07
   2.06499192e-07 -2.00152193e-07]
 [ 2.18540149e-05  2.85462225e-05  2.42647139e-05  2.06499192e-07
   2.21148935e-07 -1.31627084e-07]
 [-2.26028194e-05 -2.69511393e-05 -1.96563153e-05 -2.00152193e-07
  -1.31627084e-07  3.29445846e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.06624298e+03],
       [-2.86088299e+03],
       [-4.12292172e+03],
       [-3.44947199e+00],
       [-2.61946701e+00],
       [ 6.08454528e+00]]), 'covar': array([[ 4.31548736e-04,  5.19318128e-04,  6.32918868e-04,
         4.12393474e-06,  2.71152217e-06, -1.54115384e-06],
       [ 5.19318128e-04,  6.74467645e-04,  7.99313779e-04,
         4.99737474e-06,  3.55490310e-06, -1.92302392e-06],
       [ 6.32918868e-04,  7.99313779e-04,  1.08361612e-03,
         6.09226436e-06,  4.18128206e-06, -2.11633135e-06],
       [ 4.12393474e-06,  4.99737474e-06,  6.09226436e-06,
         4.03049379e-08,  2.60116731e-08, -1.48592515e-08],
       [ 2.71152217e-06,  3.55490310e-06,  4.18128206e-06,
         2.60116731e-08,  1.95729928e-08, -9.99357871e-09],
       [-1.54115384e-06, -1.92302392e-06, -2.11633135e-06,
        -1.48592515e-08, -9.99357871e-09,  8.73585516e-09]])}
[[-5.06624298e+03]
 [-2.86088299e+03]
 [-4.12292172e+03]
 [-3.44947199e+00]
 [-2.61946701e+00]
 [ 6.08454528e+00]]
2018-07-13 08:26:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:00
[[-5.10045872e+03]
 [-2.88692013e+03]
 [-4.06185016e+03]
 [-3.39363685e+00]
 [-2.58790033e+00]
 [ 6.12961213e+00]]
[[ 5.18274305e-04  5.99144497e-04  6.77201950e-04  4.54596173e-06
   2.97883011e-06 -1.67904979e-06]
 [ 5.99144497e-04  7.47597800e-04  8.20999627e-04  5.27916562e-06
   3.75896516e-06 -2.00980077e-06]
 [ 6.77201950e-04  8.20999627e-04  1.04245700e-03  5.96980730e-06
   4.09138309e-06 -2.01411693e-06]
 [ 4.54596173e-06  5.27916562e-06  5.96980730e-06  4.07148756e-08
   2.61765398e-08 -1.48179294e-08]
 [ 2.97883011e-06  3.75896516e-06  4.09138309e-06  2.61765398e-08
   1.97487337e-08 -9.94757065e-09]
 [-1.67904979e-06 -2.00980077e-06 -2.01411693e-06 -1.48179294e-08
  -9.94757065e-09  8.76301864e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 26, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.10045872e+03],
       [-2.88692013e+03],
       [-4.06185016e+03],
       [-3.39363685e+00],
       [-2.58790033e+00],
       [ 6.12961213e+00]]), 'covar': array([[ 5.18274305e-04,  5.99144497e-04,  6.77201950e-04,
         4.54596173e-06,  2.97883011e-06, -1.67904979e-06],
       [ 5.99144497e-04,  7.47597800e-04,  8.20999627e-04,
         5.27916562e-06,  3.75896516e-06, -2.00980077e-06],
       [ 6.77201950e-04,  8.20999627e-04,  1.04245700e-03,
         5.96980730e-06,  4.09138309e-06, -2.01411693e-06],
       [ 4.54596173e-06,  5.27916562e-06,  5.96980730e-06,
         4.07148756e-08,  2.61765398e-08, -1.48179294e-08],
       [ 2.97883011e-06,  3.75896516e-06,  4.09138309e-06,
         2.61765398e-08,  1.97487337e-08, -9.94757065e-09],
       [-1.67904979e-06, -2.00980077e-06, -2.01411693e-06,
        -1.48179294e-08, -9.94757065e-09,  8.76301864e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.08533830e-05],
       [ 2.37734936e-05],
       [-3.44607879e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 26, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.10044897e+03],
       [-2.88690497e+03],
       [-4.06183583e+03],
       [-3.39353052e+00],
       [-2.58783461e+00],
       [ 6.12966432e+00],
       [ 1.94742649e-01],
       [ 2.40410709e-02],
       [ 9.39685021e-01],
       [-2.80159577e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80567880e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.25777526e-03,  3.84168698e-03,  3.42842324e-03,
         3.10670294e-05,  2.18540149e-05, -2.26028194e-05],
       [ 3.84168698e-03,  4.76586871e-03,  4.17656444e-03,
         3.56277502e-05,  2.85462225e-05, -2.69511393e-05],
       [ 3.42842324e-03,  4.17656444e-03,  3.96911498e-03,
         3.19576656e-05,  2.42647139e-05, -1.96563153e-05],
       [ 3.10670294e-05,  3.56277502e-05,  3.19576656e-05,
         3.30602674e-07,  2.06499192e-07, -2.00152193e-07],
       [ 2.18540149e-05,  2.85462225e-05,  2.42647139e-05,
         2.06499192e-07,  2.21148935e-07, -1.31627084e-07],
       [-2.26028194e-05, -2.69511393e-05, -1.96563153e-05,
        -2.00152193e-07, -1.31627084e-07,  3.29445846e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.44841971e-05],
       [ 2.16065448e-05],
       [-6.86461089e-02]])}}
Yi [[-2.26607916]
 [-0.52939729]
 [10.30865025]]
posterior
[[-5.10044897e+03]
 [-2.88690497e+03]
 [-4.06183583e+03]
 [-3.39353052e+00]
 [-2.58783461e+00]
 [ 6.12966432e+00]
 [ 1.94742649e-01]
 [ 2.40410709e-02]
 [ 9.39685021e-01]
 [-2.80159577e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80567880e-18]]
[[-5.10041737e+03]
 [-2.88686208e+03]
 [-4.06178017e+03]
 [-3.39326445e+00]
 [-2.58757710e+00]
 [ 6.12972754e+00]
 [ 1.94742649e-01]
 [ 2.40410709e-02]
 [ 9.39685021e-01]
 [-2.80159577e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80567880e-18]]
[[ 2.98546292e-03  3.52391070e-03  2.98519985e-03  2.85476685e-05
   2.02379218e-05 -2.31066852e-05]
 [ 3.52391070e-03  4.33440943e-03  3.61541737e-03  3.29525746e-05
   2.59564954e-05 -2.76063698e-05]
 [ 2.98519985e-03  3.61541737e-03  3.21587946e-03  2.80489375e-05
   2.11244087e-05 -2.05252689e-05]
 [ 2.85476685e-05  3.29525746e-05  2.80489375e-05  3.06137638e-07
   1.94621572e-07 -2.04520059e-07]
 [ 2.02379218e-05  2.59564954e-05  2.11244087e-05  1.94621572e-07
   2.03387472e-07 -1.35397827e-07]
 [-2.31066852e-05 -2.76063698e-05 -2.05252689e-05 -2.04520059e-07
  -1.35397827e-07  3.28436987e-07]]
[[-2.26606438]
 [-0.52946047]
 [10.44705093]]
[[-1.47828894e-05]
 [ 6.31848255e-05]
 [-1.38400675e-01]]


 Corrector Step
2018-07-13 08:27:00
[[-5.10041737e+03]
 [-2.88686208e+03]
 [-4.06178017e+03]
 [-3.39326445e+00]
 [-2.58757710e+00]
 [ 6.12972754e+00]
 [ 1.94742649e-01]
 [ 2.40410709e-02]
 [ 9.39685021e-01]
 [-2.80159577e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80567880e-18]]
[[ 2.98546292e-03  3.52391070e-03  2.98519985e-03  2.85476685e-05
   2.02379218e-05 -2.31066852e-05]
 [ 3.52391070e-03  4.33440943e-03  3.61541737e-03  3.29525746e-05
   2.59564954e-05 -2.76063698e-05]
 [ 2.98519985e-03  3.61541737e-03  3.21587946e-03  2.80489375e-05
   2.11244087e-05 -2.05252689e-05]
 [ 2.85476685e-05  3.29525746e-05  2.80489375e-05  3.06137638e-07
   1.94621572e-07 -2.04520059e-07]
 [ 2.02379218e-05  2.59564954e-05  2.11244087e-05  1.94621572e-07
   2.03387472e-07 -1.35397827e-07]
 [-2.31066852e-05 -2.76063698e-05 -2.05252689e-05 -2.04520059e-07
  -1.35397827e-07  3.28436987e-07]]
33354957.899012115
post
cubesat_nadir
Ybar_post [[-2.26606912]
 [-0.52943409]
 [10.44687115]]
resids [[-1.00376159e-05]
 [ 3.67999465e-05]
 [-1.38220899e-01]]
posterior
[[-5.10045872e+03]
 [-2.88692013e+03]
 [-4.06185016e+03]
 [-3.39363685e+00]
 [-2.58790033e+00]
 [ 6.12961213e+00]]
[[-5.10044092e+03]
 [-2.88689700e+03]
 [-4.06181392e+03]
 [-3.39347850e+00]
 [-2.58778504e+00]
 [ 6.12957073e+00]]
[[ 4.55075600e-04  5.23884630e-04  5.54737889e-04  3.98678399e-06
   2.60871450e-06 -1.53809981e-06]
 [ 5.23884630e-04  6.53752802e-04  6.71217923e-04  4.61133542e-06
   3.29414496e-06 -1.83843397e-06]
 [ 5.54737889e-04  6.71217923e-04  8.01462667e-04  4.88444430e-06
   3.35169168e-06 -1.73770264e-06]
 [ 3.98678399e-06  4.61133542e-06  4.88444430e-06  3.57664220e-08
   2.28907451e-08 -1.35692009e-08]
 [ 2.60871450e-06  3.29414496e-06  3.35169168e-06  2.28907451e-08
   1.74439777e-08 -9.10206294e-09]
 [-1.53809981e-06 -1.83843397e-06 -1.73770264e-06 -1.35692009e-08
  -9.10206294e-09  8.44573190e-09]]
[[-2.26606125]
 [-0.52946461]
 [10.68498302]]
[[-1.79121332e-05]
 [ 6.73198977e-05]
 [-3.76332761e-01]]


 Corrector Step
2018-07-13 08:27:00
[[-5.10044092e+03]
 [-2.88689700e+03]
 [-4.06181392e+03]
 [-3.39347850e+00]
 [-2.58778504e+00]
 [ 6.12957073e+00]]
[[ 4.55075600e-04  5.23884630e-04  5.54737889e-04  3.98678399e-06
   2.60871450e-06 -1.53809981e-06]
 [ 5.23884630e-04  6.53752802e-04  6.71217923e-04  4.61133542e-06
   3.29414496e-06 -1.83843397e-06]
 [ 5.54737889e-04  6.71217923e-04  8.01462667e-04  4.88444430e-06
   3.35169168e-06 -1.73770264e-06]
 [ 3.98678399e-06  4.61133542e-06  4.88444430e-06  3.57664220e-08
   2.28907451e-08 -1.35692009e-08]
 [ 2.60871450e-06  3.29414496e-06  3.35169168e-06  2.28907451e-08
   1.74439777e-08 -9.10206294e-09]
 [-1.53809981e-06 -1.83843397e-06 -1.73770264e-06 -1.35692009e-08
  -9.10206294e-09  8.44573190e-09]]
39252.92667697214
post
sphere_lamr_small
Ybar_post [[-2.26606294]
 [-0.52944402]
 [10.68486937]]
resids [[-1.62206428e-05]
 [ 4.67271219e-05]
 [-3.76219116e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [33354957.899012115, 39252.92667697214]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.10041737e+03],
       [-2.88686208e+03],
       [-4.06178017e+03],
       [-3.39326445e+00],
       [-2.58757710e+00],
       [ 6.12972754e+00]]), 'est_covars': array([[ 2.98546292e-03,  3.52391070e-03,  2.98519985e-03,
         2.85476685e-05,  2.02379218e-05, -2.31066852e-05],
       [ 3.52391070e-03,  4.33440943e-03,  3.61541737e-03,
         3.29525746e-05,  2.59564954e-05, -2.76063698e-05],
       [ 2.98519985e-03,  3.61541737e-03,  3.21587946e-03,
         2.80489375e-05,  2.11244087e-05, -2.05252689e-05],
       [ 2.85476685e-05,  3.29525746e-05,  2.80489375e-05,
         3.06137638e-07,  1.94621572e-07, -2.04520059e-07],
       [ 2.02379218e-05,  2.59564954e-05,  2.11244087e-05,
         1.94621572e-07,  2.03387472e-07, -1.35397827e-07],
       [-2.31066852e-05, -2.76063698e-05, -2.05252689e-05,
        -2.04520059e-07, -1.35397827e-07,  3.28436987e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.10044092e+03],
       [-2.88689700e+03],
       [-4.06181392e+03],
       [-3.39347850e+00],
       [-2.58778504e+00],
       [ 6.12957073e+00]]), 'covar': array([[ 4.55075600e-04,  5.23884630e-04,  5.54737889e-04,
         3.98678399e-06,  2.60871450e-06, -1.53809981e-06],
       [ 5.23884630e-04,  6.53752802e-04,  6.71217923e-04,
         4.61133542e-06,  3.29414496e-06, -1.83843397e-06],
       [ 5.54737889e-04,  6.71217923e-04,  8.01462667e-04,
         4.88444430e-06,  3.35169168e-06, -1.73770264e-06],
       [ 3.98678399e-06,  4.61133542e-06,  4.88444430e-06,
         3.57664220e-08,  2.28907451e-08, -1.35692009e-08],
       [ 2.60871450e-06,  3.29414496e-06,  3.35169168e-06,
         2.28907451e-08,  1.74439777e-08, -9.10206294e-09],
       [-1.53809981e-06, -1.83843397e-06, -1.73770264e-06,
        -1.35692009e-08, -9.10206294e-09,  8.44573190e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.62206428e-05],
       [ 4.67271219e-05],
       [-3.76219116e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.10041737e+03],
       [-2.88686208e+03],
       [-4.06178017e+03],
       [-3.39326445e+00],
       [-2.58757710e+00],
       [ 6.12972754e+00],
       [ 1.94742649e-01],
       [ 2.40410709e-02],
       [ 9.39685021e-01],
       [-2.80159577e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80567880e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.98546292e-03,  3.52391070e-03,  2.98519985e-03,
         2.85476685e-05,  2.02379218e-05, -2.31066852e-05],
       [ 3.52391070e-03,  4.33440943e-03,  3.61541737e-03,
         3.29525746e-05,  2.59564954e-05, -2.76063698e-05],
       [ 2.98519985e-03,  3.61541737e-03,  3.21587946e-03,
         2.80489375e-05,  2.11244087e-05, -2.05252689e-05],
       [ 2.85476685e-05,  3.29525746e-05,  2.80489375e-05,
         3.06137638e-07,  1.94621572e-07, -2.04520059e-07],
       [ 2.02379218e-05,  2.59564954e-05,  2.11244087e-05,
         1.94621572e-07,  2.03387472e-07, -1.35397827e-07],
       [-2.31066852e-05, -2.76063698e-05, -2.05252689e-05,
        -2.04520059e-07, -1.35397827e-07,  3.28436987e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.00376159e-05],
       [ 3.67999465e-05],
       [-1.38220899e-01]])}}
Current time:  2018-07-13 08:27:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.10041737e+03],
       [-2.88686208e+03],
       [-4.06178017e+03],
       [-3.39326445e+00],
       [-2.58757710e+00],
       [ 6.12972754e+00],
       [ 1.94742649e-01],
       [ 2.40410709e-02],
       [ 9.39685021e-01],
       [-2.80159577e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80567880e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.98546292e-03,  3.52391070e-03,  2.98519985e-03,
         2.85476685e-05,  2.02379218e-05, -2.31066852e-05],
       [ 3.52391070e-03,  4.33440943e-03,  3.61541737e-03,
         3.29525746e-05,  2.59564954e-05, -2.76063698e-05],
       [ 2.98519985e-03,  3.61541737e-03,  3.21587946e-03,
         2.80489375e-05,  2.11244087e-05, -2.05252689e-05],
       [ 2.85476685e-05,  3.29525746e-05,  2.80489375e-05,
         3.06137638e-07,  1.94621572e-07, -2.04520059e-07],
       [ 2.02379218e-05,  2.59564954e-05,  2.11244087e-05,
         1.94621572e-07,  2.03387472e-07, -1.35397827e-07],
       [-2.31066852e-05, -2.76063698e-05, -2.05252689e-05,
        -2.04520059e-07, -1.35397827e-07,  3.28436987e-07]])}
[[-5.10041737e+03]
 [-2.88686208e+03]
 [-4.06178017e+03]
 [-3.39326445e+00]
 [-2.58757710e+00]
 [ 6.12972754e+00]
 [ 1.94742649e-01]
 [ 2.40410709e-02]
 [ 9.39685021e-01]
 [-2.80159577e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80567880e-18]]
2018-07-13 08:27:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:10
[[-5.13406906e+03]
 [-2.91257865e+03]
 [-4.00026022e+03]
 [-3.33704745e+00]
 [-2.55572128e+00]
 [ 6.17412633e+00]
 [ 1.99646385e-01]
 [ 2.55035441e-02]
 [ 9.38655400e-01]
 [-2.80030232e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80589109e-18]]
[[ 3.58841539e-03  4.07614262e-03  3.01507934e-03  3.17640277e-05
   2.22223039e-05 -2.50806184e-05]
 [ 4.07614262e-03  4.87459792e-03  3.53771419e-03  3.50184126e-05
   2.80806565e-05 -2.88748460e-05]
 [ 3.01507934e-03  3.53771419e-03  2.83916325e-03  2.60964008e-05
   1.98037146e-05 -1.71300709e-05]
 [ 3.17640277e-05  3.50184126e-05  2.60964008e-05  3.17874993e-07
   1.95588003e-07 -2.04536696e-07]
 [ 2.22223039e-05  2.80806565e-05  1.98037146e-05  1.95588003e-07
   2.13806683e-07 -1.35134703e-07]
 [-2.50806184e-05 -2.88748460e-05 -1.71300709e-05 -2.04536696e-07
  -1.35134703e-07  3.37377687e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.10044092e+03],
       [-2.88689700e+03],
       [-4.06181392e+03],
       [-3.39347850e+00],
       [-2.58778504e+00],
       [ 6.12957073e+00]]), 'covar': array([[ 4.55075600e-04,  5.23884630e-04,  5.54737889e-04,
         3.98678399e-06,  2.60871450e-06, -1.53809981e-06],
       [ 5.23884630e-04,  6.53752802e-04,  6.71217923e-04,
         4.61133542e-06,  3.29414496e-06, -1.83843397e-06],
       [ 5.54737889e-04,  6.71217923e-04,  8.01462667e-04,
         4.88444430e-06,  3.35169168e-06, -1.73770264e-06],
       [ 3.98678399e-06,  4.61133542e-06,  4.88444430e-06,
         3.57664220e-08,  2.28907451e-08, -1.35692009e-08],
       [ 2.60871450e-06,  3.29414496e-06,  3.35169168e-06,
         2.28907451e-08,  1.74439777e-08, -9.10206294e-09],
       [-1.53809981e-06, -1.83843397e-06, -1.73770264e-06,
        -1.35692009e-08, -9.10206294e-09,  8.44573190e-09]])}
[[-5.10044092e+03]
 [-2.88689700e+03]
 [-4.06181392e+03]
 [-3.39347850e+00]
 [-2.58778504e+00]
 [ 6.12957073e+00]]
2018-07-13 08:27:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:10
[[-5.13409486e+03]
 [-2.91261578e+03]
 [-4.00029551e+03]
 [-3.33726243e+00]
 [-2.55592959e+00]
 [ 6.17396886e+00]]
[[ 5.38589264e-04  5.98517621e-04  5.87057790e-04  4.36232800e-06
   2.84434816e-06 -1.66304657e-06]
 [ 5.98517621e-04  7.21458111e-04  6.85568479e-04  4.86001007e-06
   3.47614421e-06 -1.91684277e-06]
 [ 5.87057790e-04  6.85568479e-04  7.67776170e-04  4.76944637e-06
   3.26859464e-06 -1.64081610e-06]
 [ 4.36232800e-06  4.86001007e-06  4.76944637e-06  3.61365168e-08
   2.30343456e-08 -1.35296277e-08]
 [ 2.84434816e-06  3.47614421e-06  3.26859464e-06  2.30343456e-08
   1.76090810e-08 -9.05902831e-09]
 [-1.66304657e-06 -1.91684277e-06 -1.64081610e-06 -1.35296277e-08
  -9.05902831e-09  8.47612993e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.13409486e+03],
       [-2.91261578e+03],
       [-4.00029551e+03],
       [-3.33726243e+00],
       [-2.55592959e+00],
       [ 6.17396886e+00]]), 'covar': array([[ 5.38589264e-04,  5.98517621e-04,  5.87057790e-04,
         4.36232800e-06,  2.84434816e-06, -1.66304657e-06],
       [ 5.98517621e-04,  7.21458111e-04,  6.85568479e-04,
         4.86001007e-06,  3.47614421e-06, -1.91684277e-06],
       [ 5.87057790e-04,  6.85568479e-04,  7.67776170e-04,
         4.76944637e-06,  3.26859464e-06, -1.64081610e-06],
       [ 4.36232800e-06,  4.86001007e-06,  4.76944637e-06,
         3.61365168e-08,  2.30343456e-08, -1.35296277e-08],
       [ 2.84434816e-06,  3.47614421e-06,  3.26859464e-06,
         2.30343456e-08,  1.76090810e-08, -9.05902831e-09],
       [-1.66304657e-06, -1.91684277e-06, -1.64081610e-06,
        -1.35296277e-08, -9.05902831e-09,  8.47612993e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.62206428e-05],
       [ 4.67271219e-05],
       [-3.76219116e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.13406906e+03],
       [-2.91257865e+03],
       [-4.00026022e+03],
       [-3.33704745e+00],
       [-2.55572128e+00],
       [ 6.17412633e+00],
       [ 1.99646385e-01],
       [ 2.55035441e-02],
       [ 9.38655400e-01],
       [-2.80030232e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80589109e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.58841539e-03,  4.07614262e-03,  3.01507934e-03,
         3.17640277e-05,  2.22223039e-05, -2.50806184e-05],
       [ 4.07614262e-03,  4.87459792e-03,  3.53771419e-03,
         3.50184126e-05,  2.80806565e-05, -2.88748460e-05],
       [ 3.01507934e-03,  3.53771419e-03,  2.83916325e-03,
         2.60964008e-05,  1.98037146e-05, -1.71300709e-05],
       [ 3.17640277e-05,  3.50184126e-05,  2.60964008e-05,
         3.17874993e-07,  1.95588003e-07, -2.04536696e-07],
       [ 2.22223039e-05,  2.80806565e-05,  1.98037146e-05,
         1.95588003e-07,  2.13806683e-07, -1.35134703e-07],
       [-2.50806184e-05, -2.88748460e-05, -1.71300709e-05,
        -2.04536696e-07, -1.35134703e-07,  3.37377687e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.00376159e-05],
       [ 3.67999465e-05],
       [-1.38220899e-01]])}}
Yi [[-2.28361779]
 [-0.43882881]
 [10.57952111]]
posterior
[[-5.13406906e+03]
 [-2.91257865e+03]
 [-4.00026022e+03]
 [-3.33704745e+00]
 [-2.55572128e+00]
 [ 6.17412633e+00]
 [ 1.99646385e-01]
 [ 2.55035441e-02]
 [ 9.38655400e-01]
 [-2.80030232e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80589109e-18]]
[[-5.13408111e+03]
 [-2.91259266e+03]
 [-4.00027694e+03]
 [-3.33715007e+00]
 [-2.55579506e+00]
 [ 6.17410610e+00]
 [ 1.99646385e-01]
 [ 2.55035441e-02]
 [ 9.38655400e-01]
 [-2.80030232e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80589109e-18]]
[[ 3.30461424e-03  3.75932096e-03  2.62833724e-03  2.92883163e-05
   2.06351131e-05 -2.55559249e-05]
 [ 3.75932096e-03  4.45967082e-03  3.06765840e-03  3.25249890e-05
   2.56048036e-05 -2.94720762e-05]
 [ 2.62833724e-03  3.06765840e-03  2.28816179e-03  2.28918314e-05
   1.72003764e-05 -1.78195852e-05]
 [ 2.92883163e-05  3.25249890e-05  2.28918314e-05  2.95085036e-07
   1.84849859e-07 -2.08388854e-07]
 [ 2.06351131e-05  2.56048036e-05  1.72003764e-05  1.84849859e-07
   1.96837715e-07 -1.38558641e-07]
 [-2.55559249e-05 -2.94720762e-05 -1.78195852e-05 -2.08388854e-07
  -1.38558641e-07  3.36507183e-07]]
[[-2.28361693]
 [-0.43880642]
 [10.5399822 ]]
[[-8.60560467e-07]
 [-2.23873972e-05]
 [ 3.95389059e-02]]


 Corrector Step
2018-07-13 08:27:10
[[-5.13408111e+03]
 [-2.91259266e+03]
 [-4.00027694e+03]
 [-3.33715007e+00]
 [-2.55579506e+00]
 [ 6.17410610e+00]
 [ 1.99646385e-01]
 [ 2.55035441e-02]
 [ 9.38655400e-01]
 [-2.80030232e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80589109e-18]]
[[ 3.30461424e-03  3.75932096e-03  2.62833724e-03  2.92883163e-05
   2.06351131e-05 -2.55559249e-05]
 [ 3.75932096e-03  4.45967082e-03  3.06765840e-03  3.25249890e-05
   2.56048036e-05 -2.94720762e-05]
 [ 2.62833724e-03  3.06765840e-03  2.28816179e-03  2.28918314e-05
   1.72003764e-05 -1.78195852e-05]
 [ 2.92883163e-05  3.25249890e-05  2.28918314e-05  2.95085036e-07
   1.84849859e-07 -2.08388854e-07]
 [ 2.06351131e-05  2.56048036e-05  1.72003764e-05  1.84849859e-07
   1.96837715e-07 -1.38558641e-07]
 [-2.55559249e-05 -2.94720762e-05 -1.78195852e-05 -2.08388854e-07
  -1.38558641e-07  3.36507183e-07]]
518045871.2653628
post
cubesat_nadir
Ybar_post [[-2.28361695]
 [-0.43881545]
 [10.54004197]]
resids [[-8.39502606e-07]
 [-1.33605771e-05]
 [ 3.94791329e-02]]
posterior
[[-5.13409486e+03]
 [-2.91261578e+03]
 [-4.00029551e+03]
 [-3.33726243e+00]
 [-2.55592959e+00]
 [ 6.17396886e+00]]
[[-5.13409694e+03]
 [-2.91261761e+03]
 [-4.00029845e+03]
 [-3.33727917e+00]
 [-2.55593777e+00]
 [ 6.17397280e+00]]
[[ 4.71688862e-04  5.21827990e-04  4.78525714e-04  3.81764517e-06
   2.48342956e-06 -1.52071558e-06]
 [ 5.21827990e-04  6.29385237e-04  5.57790692e-04  4.23465699e-06
   3.03927234e-06 -1.75039770e-06]
 [ 4.78525714e-04  5.57790692e-04  5.88984742e-04  3.88502734e-06
   2.66436845e-06 -1.40725585e-06]
 [ 3.81764517e-06  4.23465699e-06  3.88502734e-06  3.17016483e-08
   2.00904655e-08 -1.23700462e-08]
 [ 2.48342956e-06  3.03927234e-06  2.66436845e-06  2.00904655e-08
   1.55332883e-08 -8.27289118e-09]
 [-1.52071558e-06 -1.75039770e-06 -1.40725585e-06 -1.23700462e-08
  -8.27289118e-09  8.17072246e-09]]
[[-2.28361049]
 [-0.43882229]
 [10.73149693]]
[[-7.29786210e-06]
 [-6.51766048e-06]
 [-1.51975825e-01]]


 Corrector Step
2018-07-13 08:27:10
[[-5.13409694e+03]
 [-2.91261761e+03]
 [-4.00029845e+03]
 [-3.33727917e+00]
 [-2.55593777e+00]
 [ 6.17397280e+00]]
[[ 4.71688862e-04  5.21827990e-04  4.78525714e-04  3.81764517e-06
   2.48342956e-06 -1.52071558e-06]
 [ 5.21827990e-04  6.29385237e-04  5.57790692e-04  4.23465699e-06
   3.03927234e-06 -1.75039770e-06]
 [ 4.78525714e-04  5.57790692e-04  5.88984742e-04  3.88502734e-06
   2.66436845e-06 -1.40725585e-06]
 [ 3.81764517e-06  4.23465699e-06  3.88502734e-06  3.17016483e-08
   2.00904655e-08 -1.23700462e-08]
 [ 2.48342956e-06  3.03927234e-06  2.66436845e-06  2.00904655e-08
   1.55332883e-08 -8.27289118e-09]
 [-1.52071558e-06 -1.75039770e-06 -1.40725585e-06 -1.23700462e-08
  -8.27289118e-09  8.17072246e-09]]
257984770.6952123
post
sphere_lamr_small
Ybar_post [[-2.28361102]
 [-0.43882416]
 [10.73150699]]
resids [[-6.76790118e-06]
 [-4.65309324e-06]
 [-1.51985884e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [518045871.2653628, 257984770.6952123]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.13408111e+03],
       [-2.91259266e+03],
       [-4.00027694e+03],
       [-3.33715007e+00],
       [-2.55579506e+00],
       [ 6.17410610e+00]]), 'est_covars': array([[ 3.30461424e-03,  3.75932096e-03,  2.62833724e-03,
         2.92883163e-05,  2.06351131e-05, -2.55559249e-05],
       [ 3.75932096e-03,  4.45967082e-03,  3.06765840e-03,
         3.25249890e-05,  2.56048036e-05, -2.94720762e-05],
       [ 2.62833724e-03,  3.06765840e-03,  2.28816179e-03,
         2.28918314e-05,  1.72003764e-05, -1.78195852e-05],
       [ 2.92883163e-05,  3.25249890e-05,  2.28918314e-05,
         2.95085036e-07,  1.84849859e-07, -2.08388854e-07],
       [ 2.06351131e-05,  2.56048036e-05,  1.72003764e-05,
         1.84849859e-07,  1.96837715e-07, -1.38558641e-07],
       [-2.55559249e-05, -2.94720762e-05, -1.78195852e-05,
        -2.08388854e-07, -1.38558641e-07,  3.36507183e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.13409694e+03],
       [-2.91261761e+03],
       [-4.00029845e+03],
       [-3.33727917e+00],
       [-2.55593777e+00],
       [ 6.17397280e+00]]), 'covar': array([[ 4.71688862e-04,  5.21827990e-04,  4.78525714e-04,
         3.81764517e-06,  2.48342956e-06, -1.52071558e-06],
       [ 5.21827990e-04,  6.29385237e-04,  5.57790692e-04,
         4.23465699e-06,  3.03927234e-06, -1.75039770e-06],
       [ 4.78525714e-04,  5.57790692e-04,  5.88984742e-04,
         3.88502734e-06,  2.66436845e-06, -1.40725585e-06],
       [ 3.81764517e-06,  4.23465699e-06,  3.88502734e-06,
         3.17016483e-08,  2.00904655e-08, -1.23700462e-08],
       [ 2.48342956e-06,  3.03927234e-06,  2.66436845e-06,
         2.00904655e-08,  1.55332883e-08, -8.27289118e-09],
       [-1.52071558e-06, -1.75039770e-06, -1.40725585e-06,
        -1.23700462e-08, -8.27289118e-09,  8.17072246e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-6.76790118e-06],
       [-4.65309324e-06],
       [-1.51985884e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.13408111e+03],
       [-2.91259266e+03],
       [-4.00027694e+03],
       [-3.33715007e+00],
       [-2.55579506e+00],
       [ 6.17410610e+00],
       [ 1.99646385e-01],
       [ 2.55035441e-02],
       [ 9.38655400e-01],
       [-2.80030232e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80589109e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.30461424e-03,  3.75932096e-03,  2.62833724e-03,
         2.92883163e-05,  2.06351131e-05, -2.55559249e-05],
       [ 3.75932096e-03,  4.45967082e-03,  3.06765840e-03,
         3.25249890e-05,  2.56048036e-05, -2.94720762e-05],
       [ 2.62833724e-03,  3.06765840e-03,  2.28816179e-03,
         2.28918314e-05,  1.72003764e-05, -1.78195852e-05],
       [ 2.92883163e-05,  3.25249890e-05,  2.28918314e-05,
         2.95085036e-07,  1.84849859e-07, -2.08388854e-07],
       [ 2.06351131e-05,  2.56048036e-05,  1.72003764e-05,
         1.84849859e-07,  1.96837715e-07, -1.38558641e-07],
       [-2.55559249e-05, -2.94720762e-05, -1.78195852e-05,
        -2.08388854e-07, -1.38558641e-07,  3.36507183e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.39502606e-07],
       [-1.33605771e-05],
       [ 3.94791329e-02]])}}
Current time:  2018-07-13 08:27:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.13408111e+03],
       [-2.91259266e+03],
       [-4.00027694e+03],
       [-3.33715007e+00],
       [-2.55579506e+00],
       [ 6.17410610e+00],
       [ 1.99646385e-01],
       [ 2.55035441e-02],
       [ 9.38655400e-01],
       [-2.80030232e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80589109e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.30461424e-03,  3.75932096e-03,  2.62833724e-03,
         2.92883163e-05,  2.06351131e-05, -2.55559249e-05],
       [ 3.75932096e-03,  4.45967082e-03,  3.06765840e-03,
         3.25249890e-05,  2.56048036e-05, -2.94720762e-05],
       [ 2.62833724e-03,  3.06765840e-03,  2.28816179e-03,
         2.28918314e-05,  1.72003764e-05, -1.78195852e-05],
       [ 2.92883163e-05,  3.25249890e-05,  2.28918314e-05,
         2.95085036e-07,  1.84849859e-07, -2.08388854e-07],
       [ 2.06351131e-05,  2.56048036e-05,  1.72003764e-05,
         1.84849859e-07,  1.96837715e-07, -1.38558641e-07],
       [-2.55559249e-05, -2.94720762e-05, -1.78195852e-05,
        -2.08388854e-07, -1.38558641e-07,  3.36507183e-07]])}
[[-5.13408111e+03]
 [-2.91259266e+03]
 [-4.00027694e+03]
 [-3.33715007e+00]
 [-2.55579506e+00]
 [ 6.17410610e+00]
 [ 1.99646385e-01]
 [ 2.55035441e-02]
 [ 9.38655400e-01]
 [-2.80030232e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80589109e-18]]
2018-07-13 08:27:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:20
[[-5.16716997e+03]
 [-2.93798995e+03]
 [-3.93831659e+03]
 [-3.28055920e+00]
 [-2.52365435e+00]
 [ 6.21783075e+00]
 [ 2.04544677e-01]
 [ 2.69653220e-02]
 [ 9.37600189e-01]
 [-2.79893253e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80610338e-18]]
[[ 3.92113675e-03  4.31016007e-03  2.58160787e-03  3.23935073e-05
   2.25209716e-05 -2.75635408e-05]
 [ 4.31016007e-03  4.99218189e-03  2.93172833e-03  3.44889255e-05
   2.76613758e-05 -3.07694131e-05]
 [ 2.58160787e-03  2.93172833e-03  1.96625085e-03  2.08814293e-05
   1.58411764e-05 -1.43543912e-05]
 [ 3.23935073e-05  3.44889255e-05  2.08814293e-05  3.06701280e-07
   1.85745396e-07 -2.08414590e-07]
 [ 2.25209716e-05  2.76613758e-05  1.58411764e-05  1.85745396e-07
   2.07217962e-07 -1.38299687e-07]
 [-2.75635408e-05 -3.07694131e-05 -1.43543912e-05 -2.08414590e-07
  -1.38299687e-07  3.45370138e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.13409694e+03],
       [-2.91261761e+03],
       [-4.00029845e+03],
       [-3.33727917e+00],
       [-2.55593777e+00],
       [ 6.17397280e+00]]), 'covar': array([[ 4.71688862e-04,  5.21827990e-04,  4.78525714e-04,
         3.81764517e-06,  2.48342956e-06, -1.52071558e-06],
       [ 5.21827990e-04,  6.29385237e-04,  5.57790692e-04,
         4.23465699e-06,  3.03927234e-06, -1.75039770e-06],
       [ 4.78525714e-04,  5.57790692e-04,  5.88984742e-04,
         3.88502734e-06,  2.66436845e-06, -1.40725585e-06],
       [ 3.81764517e-06,  4.23465699e-06,  3.88502734e-06,
         3.17016483e-08,  2.00904655e-08, -1.23700462e-08],
       [ 2.48342956e-06,  3.03927234e-06,  2.66436845e-06,
         2.00904655e-08,  1.55332883e-08, -8.27289118e-09],
       [-1.52071558e-06, -1.75039770e-06, -1.40725585e-06,
        -1.23700462e-08, -8.27289118e-09,  8.17072246e-09]])}
[[-5.13409694e+03]
 [-2.91261761e+03]
 [-4.00029845e+03]
 [-3.33727917e+00]
 [-2.55593777e+00]
 [ 6.17397280e+00]]
2018-07-13 08:27:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:20
[[-5.16718688e+03]
 [-2.93801659e+03]
 [-3.93833923e+03]
 [-3.28068906e+00]
 [-2.52379730e+00]
 [ 6.21769707e+00]]
[[ 5.51512365e-04  5.91095044e-04  5.01302710e-04  4.15147112e-06
   2.69063686e-06 -1.63361636e-06]
 [ 5.91095044e-04  6.91799484e-04  5.66125696e-04  4.45351798e-06
   3.20144287e-06 -1.82096426e-06]
 [ 5.01302710e-04  5.66125696e-04  5.62151488e-04  3.77773801e-06
   2.58794127e-06 -1.31506446e-06]
 [ 4.15147112e-06  4.45351798e-06  3.77773801e-06  3.20374475e-08
   2.02158755e-08 -1.23323883e-08]
 [ 2.69063686e-06  3.20144287e-06  2.58794127e-06  2.02158755e-08
   1.56893793e-08 -8.23282072e-09]
 [-1.63361636e-06 -1.82096426e-06 -1.31506446e-06 -1.23323883e-08
  -8.23282072e-09  8.20384040e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.16718688e+03],
       [-2.93801659e+03],
       [-3.93833923e+03],
       [-3.28068906e+00],
       [-2.52379730e+00],
       [ 6.21769707e+00]]), 'covar': array([[ 5.51512365e-04,  5.91095044e-04,  5.01302710e-04,
         4.15147112e-06,  2.69063686e-06, -1.63361636e-06],
       [ 5.91095044e-04,  6.91799484e-04,  5.66125696e-04,
         4.45351798e-06,  3.20144287e-06, -1.82096426e-06],
       [ 5.01302710e-04,  5.66125696e-04,  5.62151488e-04,
         3.77773801e-06,  2.58794127e-06, -1.31506446e-06],
       [ 4.15147112e-06,  4.45351798e-06,  3.77773801e-06,
         3.20374475e-08,  2.02158755e-08, -1.23323883e-08],
       [ 2.69063686e-06,  3.20144287e-06,  2.58794127e-06,
         2.02158755e-08,  1.56893793e-08, -8.23282072e-09],
       [-1.63361636e-06, -1.82096426e-06, -1.31506446e-06,
        -1.23323883e-08, -8.23282072e-09,  8.20384040e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-6.76790118e-06],
       [-4.65309324e-06],
       [-1.51985884e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.16716997e+03],
       [-2.93798995e+03],
       [-3.93831659e+03],
       [-3.28055920e+00],
       [-2.52365435e+00],
       [ 6.21783075e+00],
       [ 2.04544677e-01],
       [ 2.69653220e-02],
       [ 9.37600189e-01],
       [-2.79893253e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80610338e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.92113675e-03,  4.31016007e-03,  2.58160787e-03,
         3.23935073e-05,  2.25209716e-05, -2.75635408e-05],
       [ 4.31016007e-03,  4.99218189e-03,  2.93172833e-03,
         3.44889255e-05,  2.76613758e-05, -3.07694131e-05],
       [ 2.58160787e-03,  2.93172833e-03,  1.96625085e-03,
         2.08814293e-05,  1.58411764e-05, -1.43543912e-05],
       [ 3.23935073e-05,  3.44889255e-05,  2.08814293e-05,
         3.06701280e-07,  1.85745396e-07, -2.08414590e-07],
       [ 2.25209716e-05,  2.76613758e-05,  1.58411764e-05,
         1.85745396e-07,  2.07217962e-07, -1.38299687e-07],
       [-2.75635408e-05, -3.07694131e-05, -1.43543912e-05,
        -2.08414590e-07, -1.38299687e-07,  3.45370138e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.39502606e-07],
       [-1.33605771e-05],
       [ 3.94791329e-02]])}}
Yi [[-2.29905813]
 [-0.35010085]
 [10.88008937]]
posterior
[[-5.16716997e+03]
 [-2.93798995e+03]
 [-3.93831659e+03]
 [-3.28055920e+00]
 [-2.52365435e+00]
 [ 6.21783075e+00]
 [ 2.04544677e-01]
 [ 2.69653220e-02]
 [ 9.37600189e-01]
 [-2.79893253e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80610338e-18]]
[[-5.16719203e+03]
 [-2.93802145e+03]
 [-3.93834590e+03]
 [-3.28070777e+00]
 [-2.52386085e+00]
 [ 6.21779207e+00]
 [ 2.04544677e-01]
 [ 2.69653220e-02]
 [ 9.37600189e-01]
 [-2.79893253e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80610338e-18]]
[[ 3.63228508e-03  4.00061812e-03  2.25103318e-03  2.99924061e-05
   2.09900281e-05 -2.80006373e-05]
 [ 4.00061812e-03  4.59829212e-03  2.54390390e-03  3.21906636e-05
   2.53132778e-05 -3.13040096e-05]
 [ 2.25103318e-03  2.54390390e-03  1.56979345e-03  1.82818936e-05
   1.37070963e-05 -1.48904806e-05]
 [ 2.99924061e-05  3.21906636e-05  1.82818936e-05  2.85527144e-07
   1.76146586e-07 -2.11755392e-07]
 [ 2.09900281e-05  2.53132778e-05  1.37070963e-05  1.76146586e-07
   1.91053245e-07 -1.41369499e-07]
 [-2.80006373e-05 -3.13040096e-05 -1.48904806e-05 -2.11755392e-07
  -1.41369499e-07  3.44636232e-07]]
[[-2.29907998]
 [-0.35005644]
 [10.66265488]]
[[ 2.18585479e-05]
 [-4.44128701e-05]
 [ 2.17434495e-01]]


 Corrector Step
2018-07-13 08:27:20
[[-5.16719203e+03]
 [-2.93802145e+03]
 [-3.93834590e+03]
 [-3.28070777e+00]
 [-2.52386085e+00]
 [ 6.21779207e+00]
 [ 2.04544677e-01]
 [ 2.69653220e-02]
 [ 9.37600189e-01]
 [-2.79893253e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80610338e-18]]
[[ 3.63228508e-03  4.00061812e-03  2.25103318e-03  2.99924061e-05
   2.09900281e-05 -2.80006373e-05]
 [ 4.00061812e-03  4.59829212e-03  2.54390390e-03  3.21906636e-05
   2.53132778e-05 -3.13040096e-05]
 [ 2.25103318e-03  2.54390390e-03  1.56979345e-03  1.82818936e-05
   1.37070963e-05 -1.48904806e-05]
 [ 2.99924061e-05  3.21906636e-05  1.82818936e-05  2.85527144e-07
   1.76146586e-07 -2.11755392e-07]
 [ 2.09900281e-05  2.53132778e-05  1.37070963e-05  1.76146586e-07
   1.91053245e-07 -1.41369499e-07]
 [-2.80006373e-05 -3.13040096e-05 -1.48904806e-05 -2.11755392e-07
  -1.41369499e-07  3.44636232e-07]]
18592066.31993257
post
cubesat_nadir
Ybar_post [[-2.29907422]
 [-0.35007401]
 [10.66274613]]
resids [[ 1.60944165e-05]
 [-2.68426953e-05]
 [ 2.17343239e-01]]
posterior
[[-5.16718688e+03]
 [-2.93801659e+03]
 [-3.93833923e+03]
 [-3.28068906e+00]
 [-2.52379730e+00]
 [ 6.21769707e+00]]
[[-5.16719545e+03]
 [-2.93802756e+03]
 [-3.93835198e+03]
 [-3.28075384e+00]
 [-2.52384817e+00]
 [ 6.21771557e+00]]
[[ 4.82249822e-04  5.14498072e-04  4.06609707e-04  3.62920971e-06
   2.34480879e-06 -1.49340816e-06]
 [ 5.14498072e-04  6.02917657e-04  4.58489938e-04  3.87563948e-06
   2.79638029e-06 -1.66277344e-06]
 [ 4.06609707e-04  4.58489938e-04  4.30654419e-04  3.06350414e-06
   2.09934297e-06 -1.12118739e-06]
 [ 3.62920971e-06  3.87563948e-06  3.06350414e-06  2.80994082e-08
   1.76065260e-08 -1.12749390e-08]
 [ 2.34480879e-06  2.79638029e-06  2.09934297e-06  1.76065260e-08
   1.38401365e-08 -7.51577223e-09]
 [-1.49340816e-06 -1.66277344e-06 -1.12118739e-06 -1.12749390e-08
  -7.51577223e-09  7.91766080e-09]]
[[-2.29907337]
 [-0.35006933]
 [10.79845333]]
[[ 1.52424323e-05]
 [-3.15233657e-05]
 [ 8.16360411e-02]]


 Corrector Step
2018-07-13 08:27:20
[[-5.16719545e+03]
 [-2.93802756e+03]
 [-3.93835198e+03]
 [-3.28075384e+00]
 [-2.52384817e+00]
 [ 6.21771557e+00]]
[[ 4.82249822e-04  5.14498072e-04  4.06609707e-04  3.62920971e-06
   2.34480879e-06 -1.49340816e-06]
 [ 5.14498072e-04  6.02917657e-04  4.58489938e-04  3.87563948e-06
   2.79638029e-06 -1.66277344e-06]
 [ 4.06609707e-04  4.58489938e-04  4.30654419e-04  3.06350414e-06
   2.09934297e-06 -1.12118739e-06]
 [ 3.62920971e-06  3.87563948e-06  3.06350414e-06  2.80994082e-08
   1.76065260e-08 -1.12749390e-08]
 [ 2.34480879e-06  2.79638029e-06  2.09934297e-06  1.76065260e-08
   1.38401365e-08 -7.51577223e-09]
 [-1.49340816e-06 -1.66277344e-06 -1.12118739e-06 -1.12749390e-08
  -7.51577223e-09  7.91766080e-09]]
287473327.6700212
post
sphere_lamr_small
Ybar_post [[-2.29907227]
 [-0.3500781 ]
 [10.79849614]]
resids [[ 1.41432563e-05]
 [-2.27507600e-05]
 [ 8.15932321e-02]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [18592066.31993257, 287473327.6700212]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.16719203e+03],
       [-2.93802145e+03],
       [-3.93834590e+03],
       [-3.28070777e+00],
       [-2.52386085e+00],
       [ 6.21779207e+00]]), 'est_covars': array([[ 3.63228508e-03,  4.00061812e-03,  2.25103318e-03,
         2.99924061e-05,  2.09900281e-05, -2.80006373e-05],
       [ 4.00061812e-03,  4.59829212e-03,  2.54390390e-03,
         3.21906636e-05,  2.53132778e-05, -3.13040096e-05],
       [ 2.25103318e-03,  2.54390390e-03,  1.56979345e-03,
         1.82818936e-05,  1.37070963e-05, -1.48904806e-05],
       [ 2.99924061e-05,  3.21906636e-05,  1.82818936e-05,
         2.85527144e-07,  1.76146586e-07, -2.11755392e-07],
       [ 2.09900281e-05,  2.53132778e-05,  1.37070963e-05,
         1.76146586e-07,  1.91053245e-07, -1.41369499e-07],
       [-2.80006373e-05, -3.13040096e-05, -1.48904806e-05,
        -2.11755392e-07, -1.41369499e-07,  3.44636232e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.16719545e+03],
       [-2.93802756e+03],
       [-3.93835198e+03],
       [-3.28075384e+00],
       [-2.52384817e+00],
       [ 6.21771557e+00]]), 'covar': array([[ 4.82249822e-04,  5.14498072e-04,  4.06609707e-04,
         3.62920971e-06,  2.34480879e-06, -1.49340816e-06],
       [ 5.14498072e-04,  6.02917657e-04,  4.58489938e-04,
         3.87563948e-06,  2.79638029e-06, -1.66277344e-06],
       [ 4.06609707e-04,  4.58489938e-04,  4.30654419e-04,
         3.06350414e-06,  2.09934297e-06, -1.12118739e-06],
       [ 3.62920971e-06,  3.87563948e-06,  3.06350414e-06,
         2.80994082e-08,  1.76065260e-08, -1.12749390e-08],
       [ 2.34480879e-06,  2.79638029e-06,  2.09934297e-06,
         1.76065260e-08,  1.38401365e-08, -7.51577223e-09],
       [-1.49340816e-06, -1.66277344e-06, -1.12118739e-06,
        -1.12749390e-08, -7.51577223e-09,  7.91766080e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.41432563e-05],
       [-2.27507600e-05],
       [ 8.15932321e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.16719203e+03],
       [-2.93802145e+03],
       [-3.93834590e+03],
       [-3.28070777e+00],
       [-2.52386085e+00],
       [ 6.21779207e+00],
       [ 2.04544677e-01],
       [ 2.69653220e-02],
       [ 9.37600189e-01],
       [-2.79893253e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80610338e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.63228508e-03,  4.00061812e-03,  2.25103318e-03,
         2.99924061e-05,  2.09900281e-05, -2.80006373e-05],
       [ 4.00061812e-03,  4.59829212e-03,  2.54390390e-03,
         3.21906636e-05,  2.53132778e-05, -3.13040096e-05],
       [ 2.25103318e-03,  2.54390390e-03,  1.56979345e-03,
         1.82818936e-05,  1.37070963e-05, -1.48904806e-05],
       [ 2.99924061e-05,  3.21906636e-05,  1.82818936e-05,
         2.85527144e-07,  1.76146586e-07, -2.11755392e-07],
       [ 2.09900281e-05,  2.53132778e-05,  1.37070963e-05,
         1.76146586e-07,  1.91053245e-07, -1.41369499e-07],
       [-2.80006373e-05, -3.13040096e-05, -1.48904806e-05,
        -2.11755392e-07, -1.41369499e-07,  3.44636232e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.60944165e-05],
       [-2.68426953e-05],
       [ 2.17343239e-01]])}}
Current time:  2018-07-13 08:27:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.16719203e+03],
       [-2.93802145e+03],
       [-3.93834590e+03],
       [-3.28070777e+00],
       [-2.52386085e+00],
       [ 6.21779207e+00],
       [ 2.04544677e-01],
       [ 2.69653220e-02],
       [ 9.37600189e-01],
       [-2.79893253e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80610338e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.63228508e-03,  4.00061812e-03,  2.25103318e-03,
         2.99924061e-05,  2.09900281e-05, -2.80006373e-05],
       [ 4.00061812e-03,  4.59829212e-03,  2.54390390e-03,
         3.21906636e-05,  2.53132778e-05, -3.13040096e-05],
       [ 2.25103318e-03,  2.54390390e-03,  1.56979345e-03,
         1.82818936e-05,  1.37070963e-05, -1.48904806e-05],
       [ 2.99924061e-05,  3.21906636e-05,  1.82818936e-05,
         2.85527144e-07,  1.76146586e-07, -2.11755392e-07],
       [ 2.09900281e-05,  2.53132778e-05,  1.37070963e-05,
         1.76146586e-07,  1.91053245e-07, -1.41369499e-07],
       [-2.80006373e-05, -3.13040096e-05, -1.48904806e-05,
        -2.11755392e-07, -1.41369499e-07,  3.44636232e-07]])}
[[-5.16719203e+03]
 [-2.93802145e+03]
 [-3.93834590e+03]
 [-3.28070777e+00]
 [-2.52386085e+00]
 [ 6.21779207e+00]
 [ 2.04544677e-01]
 [ 2.69653220e-02]
 [ 9.37600189e-01]
 [-2.79893253e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80610338e-18]]
2018-07-13 08:27:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:30
[[-5.19971441e+03]
 [-2.96309801e+03]
 [-3.87595193e+03]
 [-3.22374977e+00]
 [-2.49143873e+00]
 [ 6.26083689e+00]
 [ 2.09437393e-01]
 [ 2.84263648e-02]
 [ 9.36519416e-01]
 [-2.79748643e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80631566e-18]]
[[ 4.26212133e-03  4.55090381e-03  2.13356904e-03  3.30017296e-05
   2.27883690e-05 -3.00369248e-05]
 [ 4.55090381e-03  5.12437800e-03  2.35450826e-03  3.40640661e-05
   2.73102974e-05 -3.26264819e-05]
 [ 2.13356904e-03  2.35450826e-03  1.30735857e-03  1.62213894e-05
   1.23141194e-05 -1.13545256e-05]
 [ 3.30017296e-05  3.40640661e-05  1.62213894e-05  2.97040496e-07
   1.76981914e-07 -2.11786375e-07]
 [ 2.27883690e-05  2.73102974e-05  1.23141194e-05  1.76981914e-07
   2.01400335e-07 -1.41112787e-07]
 [-3.00369248e-05 -3.26264819e-05 -1.13545256e-05 -2.11786375e-07
  -1.41112787e-07  3.53420551e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.16719545e+03],
       [-2.93802756e+03],
       [-3.93835198e+03],
       [-3.28075384e+00],
       [-2.52384817e+00],
       [ 6.21771557e+00]]), 'covar': array([[ 4.82249822e-04,  5.14498072e-04,  4.06609707e-04,
         3.62920971e-06,  2.34480879e-06, -1.49340816e-06],
       [ 5.14498072e-04,  6.02917657e-04,  4.58489938e-04,
         3.87563948e-06,  2.79638029e-06, -1.66277344e-06],
       [ 4.06609707e-04,  4.58489938e-04,  4.30654419e-04,
         3.06350414e-06,  2.09934297e-06, -1.12118739e-06],
       [ 3.62920971e-06,  3.87563948e-06,  3.06350414e-06,
         2.80994082e-08,  1.76065260e-08, -1.12749390e-08],
       [ 2.34480879e-06,  2.79638029e-06,  2.09934297e-06,
         1.76065260e-08,  1.38401365e-08, -7.51577223e-09],
       [-1.49340816e-06, -1.66277344e-06, -1.12118739e-06,
        -1.12749390e-08, -7.51577223e-09,  7.91766080e-09]])}
[[-5.16719545e+03]
 [-2.93802756e+03]
 [-3.93835198e+03]
 [-3.28075384e+00]
 [-2.52384817e+00]
 [ 6.21771557e+00]]
2018-07-13 08:27:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:30
[[-5.19971831e+03]
 [-2.96310414e+03]
 [-3.87595894e+03]
 [-3.22379601e+00]
 [-2.49142618e+00]
 [ 6.26076035e+00]]
[[ 5.57889581e-04  5.78591499e-04  4.21360285e-04  3.92595567e-06
   2.52677968e-06 -1.59557928e-06]
 [ 5.78591499e-04  6.60290857e-04  4.62196989e-04  4.06806972e-06
   2.94100928e-06 -1.72632648e-06]
 [ 4.21360285e-04  4.62196989e-04  4.09143515e-04  2.96368875e-06
   2.02917190e-06 -1.03342039e-06]
 [ 3.92595567e-06  4.06806972e-06  2.96368875e-06  2.84057938e-08
   1.77164327e-08 -1.12395029e-08]
 [ 2.52677968e-06  2.94100928e-06  2.02917190e-06  1.77164327e-08
   1.39886102e-08 -7.47870731e-09]
 [-1.59557928e-06 -1.72632648e-06 -1.03342039e-06 -1.12395029e-08
  -7.47870731e-09  7.95393554e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.19971831e+03],
       [-2.96310414e+03],
       [-3.87595894e+03],
       [-3.22379601e+00],
       [-2.49142618e+00],
       [ 6.26076035e+00]]), 'covar': array([[ 5.57889581e-04,  5.78591499e-04,  4.21360285e-04,
         3.92595567e-06,  2.52677968e-06, -1.59557928e-06],
       [ 5.78591499e-04,  6.60290857e-04,  4.62196989e-04,
         4.06806972e-06,  2.94100928e-06, -1.72632648e-06],
       [ 4.21360285e-04,  4.62196989e-04,  4.09143515e-04,
         2.96368875e-06,  2.02917190e-06, -1.03342039e-06],
       [ 3.92595567e-06,  4.06806972e-06,  2.96368875e-06,
         2.84057938e-08,  1.77164327e-08, -1.12395029e-08],
       [ 2.52677968e-06,  2.94100928e-06,  2.02917190e-06,
         1.77164327e-08,  1.39886102e-08, -7.47870731e-09],
       [-1.59557928e-06, -1.72632648e-06, -1.03342039e-06,
        -1.12395029e-08, -7.47870731e-09,  7.95393554e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.41432563e-05],
       [-2.27507600e-05],
       [ 8.15932321e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.19971441e+03],
       [-2.96309801e+03],
       [-3.87595193e+03],
       [-3.22374977e+00],
       [-2.49143873e+00],
       [ 6.26083689e+00],
       [ 2.09437393e-01],
       [ 2.84263648e-02],
       [ 9.36519416e-01],
       [-2.79748643e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80631566e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.26212133e-03,  4.55090381e-03,  2.13356904e-03,
         3.30017296e-05,  2.27883690e-05, -3.00369248e-05],
       [ 4.55090381e-03,  5.12437800e-03,  2.35450826e-03,
         3.40640661e-05,  2.73102974e-05, -3.26264819e-05],
       [ 2.13356904e-03,  2.35450826e-03,  1.30735857e-03,
         1.62213894e-05,  1.23141194e-05, -1.13545256e-05],
       [ 3.30017296e-05,  3.40640661e-05,  1.62213894e-05,
         2.97040496e-07,  1.76981914e-07, -2.11786375e-07],
       [ 2.27883690e-05,  2.73102974e-05,  1.23141194e-05,
         1.76981914e-07,  2.01400335e-07, -1.41112787e-07],
       [-3.00369248e-05, -3.26264819e-05, -1.13545256e-05,
        -2.11786375e-07, -1.41112787e-07,  3.53420551e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.60944165e-05],
       [-2.68426953e-05],
       [ 2.17343239e-01]])}}
Yi [[-2.31281703]
 [-0.26425556]
 [10.88108893]]
posterior
[[-5.19971441e+03]
 [-2.96309801e+03]
 [-3.87595193e+03]
 [-3.22374977e+00]
 [-2.49143873e+00]
 [ 6.26083689e+00]
 [ 2.09437393e-01]
 [ 2.84263648e-02]
 [ 9.36519416e-01]
 [-2.79748643e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80631566e-18]]
[[-5.19969171e+03]
 [-2.96306276e+03]
 [-3.87592455e+03]
 [-3.22362039e+00]
 [-2.49119084e+00]
 [ 6.26088101e+00]
 [ 2.09437393e-01]
 [ 2.84263648e-02]
 [ 9.36519416e-01]
 [-2.79748643e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80631566e-18]]
[[ 3.97213033e-03  4.25185728e-03  1.85481937e-03  3.06847602e-05
   2.13262644e-05 -3.04305907e-05]
 [ 4.25185728e-03  4.75273194e-03  2.03762380e-03  3.19527809e-05
   2.50894762e-05 -3.30982360e-05]
 [ 1.85481937e-03  2.03762380e-03  1.02571645e-03  1.41235824e-05
   1.05769624e-05 -1.17636553e-05]
 [ 3.06847602e-05  3.19527809e-05  1.41235824e-05  2.77306399e-07
   1.68433922e-07 -2.14642534e-07]
 [ 2.13262644e-05  2.50894762e-05  1.05769624e-05  1.68433922e-07
   1.85991186e-07 -1.43839257e-07]
 [-3.04305907e-05 -3.30982360e-05 -1.17636553e-05 -2.14642534e-07
  -1.43839257e-07  3.52815683e-07]]
[[-2.3127827 ]
 [-0.26430442]
 [10.81311941]]
[[-3.43247409e-05]
 [ 4.88593786e-05]
 [ 6.79695216e-02]]


 Corrector Step
2018-07-13 08:27:30
[[-5.19969171e+03]
 [-2.96306276e+03]
 [-3.87592455e+03]
 [-3.22362039e+00]
 [-2.49119084e+00]
 [ 6.26088101e+00]
 [ 2.09437393e-01]
 [ 2.84263648e-02]
 [ 9.36519416e-01]
 [-2.79748643e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80631566e-18]]
[[ 3.97213033e-03  4.25185728e-03  1.85481937e-03  3.06847602e-05
   2.13262644e-05 -3.04305907e-05]
 [ 4.25185728e-03  4.75273194e-03  2.03762380e-03  3.19527809e-05
   2.50894762e-05 -3.30982360e-05]
 [ 1.85481937e-03  2.03762380e-03  1.02571645e-03  1.41235824e-05
   1.05769624e-05 -1.17636553e-05]
 [ 3.06847602e-05  3.19527809e-05  1.41235824e-05  2.77306399e-07
   1.68433922e-07 -2.14642534e-07]
 [ 2.13262644e-05  2.50894762e-05  1.05769624e-05  1.68433922e-07
   1.85991186e-07 -1.43839257e-07]
 [-3.04305907e-05 -3.30982360e-05 -1.17636553e-05 -2.14642534e-07
  -1.43839257e-07  3.52815683e-07]]
79635764.69646113
post
cubesat_nadir
Ybar_post [[-2.31279153]
 [-0.26428582]
 [10.81304534]]
resids [[-2.54969782e-05]
 [ 3.02621948e-05]
 [ 6.80435924e-02]]
posterior
[[-5.19971831e+03]
 [-2.96310414e+03]
 [-3.87595894e+03]
 [-3.22379601e+00]
 [-2.49142618e+00]
 [ 6.26076035e+00]]
[[-5.19970367e+03]
 [-2.96308507e+03]
 [-3.87593992e+03]
 [-3.22369316e+00]
 [-2.49134025e+00]
 [ 6.26072973e+00]]
[[ 4.87945336e-04  5.03629985e-04  3.40354711e-04  3.43388929e-06
   2.20161107e-06 -1.46081811e-06]
 [ 5.03629985e-04  5.75763718e-04  3.72832430e-04  3.54095436e-06
   2.57036169e-06 -1.57892011e-06]
 [ 3.40354711e-04  3.72832430e-04  3.13776883e-04  2.39395551e-06
   1.63910110e-06 -8.75535508e-07]
 [ 3.43388929e-06  3.54095436e-06  2.39395551e-06  2.49440314e-08
   1.54301439e-08 -1.02916179e-08]
 [ 2.20161107e-06  2.57036169e-06  1.63910110e-06  1.54301439e-08
   1.23597339e-08 -6.83645297e-09]
 [-1.46081811e-06 -1.57892011e-06 -8.75535508e-07 -1.02916179e-08
  -6.83645297e-09  7.69217352e-09]]
[[-2.31278118]
 [-0.26431026]
 [10.88344908]]
[[-3.58446594e-05]
 [ 5.46931832e-05]
 [-2.36014455e-03]]


 Corrector Step
2018-07-13 08:27:30
[[-5.19970367e+03]
 [-2.96308507e+03]
 [-3.87593992e+03]
 [-3.22369316e+00]
 [-2.49134025e+00]
 [ 6.26072973e+00]]
[[ 4.87945336e-04  5.03629985e-04  3.40354711e-04  3.43388929e-06
   2.20161107e-06 -1.46081811e-06]
 [ 5.03629985e-04  5.75763718e-04  3.72832430e-04  3.54095436e-06
   2.57036169e-06 -1.57892011e-06]
 [ 3.40354711e-04  3.72832430e-04  3.13776883e-04  2.39395551e-06
   1.63910110e-06 -8.75535508e-07]
 [ 3.43388929e-06  3.54095436e-06  2.39395551e-06  2.49440314e-08
   1.54301439e-08 -1.02916179e-08]
 [ 2.20161107e-06  2.57036169e-06  1.63910110e-06  1.54301439e-08
   1.23597339e-08 -6.83645297e-09]
 [-1.46081811e-06 -1.57892011e-06 -8.75535508e-07 -1.02916179e-08
  -6.83645297e-09  7.69217352e-09]]
49789095.68425756
post
sphere_lamr_small
Ybar_post [[-2.31278381]
 [-0.26429586]
 [10.88338413]]
resids [[-3.32151355e-05]
 [ 4.02996126e-05]
 [-2.29519637e-03]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [79635764.69646113, 49789095.68425756]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.19969171e+03],
       [-2.96306276e+03],
       [-3.87592455e+03],
       [-3.22362039e+00],
       [-2.49119084e+00],
       [ 6.26088101e+00]]), 'est_covars': array([[ 3.97213033e-03,  4.25185728e-03,  1.85481937e-03,
         3.06847602e-05,  2.13262644e-05, -3.04305907e-05],
       [ 4.25185728e-03,  4.75273194e-03,  2.03762380e-03,
         3.19527809e-05,  2.50894762e-05, -3.30982360e-05],
       [ 1.85481937e-03,  2.03762380e-03,  1.02571645e-03,
         1.41235824e-05,  1.05769624e-05, -1.17636553e-05],
       [ 3.06847602e-05,  3.19527809e-05,  1.41235824e-05,
         2.77306399e-07,  1.68433922e-07, -2.14642534e-07],
       [ 2.13262644e-05,  2.50894762e-05,  1.05769624e-05,
         1.68433922e-07,  1.85991186e-07, -1.43839257e-07],
       [-3.04305907e-05, -3.30982360e-05, -1.17636553e-05,
        -2.14642534e-07, -1.43839257e-07,  3.52815683e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.19970367e+03],
       [-2.96308507e+03],
       [-3.87593992e+03],
       [-3.22369316e+00],
       [-2.49134025e+00],
       [ 6.26072973e+00]]), 'covar': array([[ 4.87945336e-04,  5.03629985e-04,  3.40354711e-04,
         3.43388929e-06,  2.20161107e-06, -1.46081811e-06],
       [ 5.03629985e-04,  5.75763718e-04,  3.72832430e-04,
         3.54095436e-06,  2.57036169e-06, -1.57892011e-06],
       [ 3.40354711e-04,  3.72832430e-04,  3.13776883e-04,
         2.39395551e-06,  1.63910110e-06, -8.75535508e-07],
       [ 3.43388929e-06,  3.54095436e-06,  2.39395551e-06,
         2.49440314e-08,  1.54301439e-08, -1.02916179e-08],
       [ 2.20161107e-06,  2.57036169e-06,  1.63910110e-06,
         1.54301439e-08,  1.23597339e-08, -6.83645297e-09],
       [-1.46081811e-06, -1.57892011e-06, -8.75535508e-07,
        -1.02916179e-08, -6.83645297e-09,  7.69217352e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.32151355e-05],
       [ 4.02996126e-05],
       [-2.29519637e-03]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.19969171e+03],
       [-2.96306276e+03],
       [-3.87592455e+03],
       [-3.22362039e+00],
       [-2.49119084e+00],
       [ 6.26088101e+00],
       [ 2.09437393e-01],
       [ 2.84263648e-02],
       [ 9.36519416e-01],
       [-2.79748643e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80631566e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.97213033e-03,  4.25185728e-03,  1.85481937e-03,
         3.06847602e-05,  2.13262644e-05, -3.04305907e-05],
       [ 4.25185728e-03,  4.75273194e-03,  2.03762380e-03,
         3.19527809e-05,  2.50894762e-05, -3.30982360e-05],
       [ 1.85481937e-03,  2.03762380e-03,  1.02571645e-03,
         1.41235824e-05,  1.05769624e-05, -1.17636553e-05],
       [ 3.06847602e-05,  3.19527809e-05,  1.41235824e-05,
         2.77306399e-07,  1.68433922e-07, -2.14642534e-07],
       [ 2.13262644e-05,  2.50894762e-05,  1.05769624e-05,
         1.68433922e-07,  1.85991186e-07, -1.43839257e-07],
       [-3.04305907e-05, -3.30982360e-05, -1.17636553e-05,
        -2.14642534e-07, -1.43839257e-07,  3.52815683e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.54969782e-05],
       [ 3.02621948e-05],
       [ 6.80435924e-02]])}}
Current time:  2018-07-13 08:27:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.19969171e+03],
       [-2.96306276e+03],
       [-3.87592455e+03],
       [-3.22362039e+00],
       [-2.49119084e+00],
       [ 6.26088101e+00],
       [ 2.09437393e-01],
       [ 2.84263648e-02],
       [ 9.36519416e-01],
       [-2.79748643e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80631566e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.97213033e-03,  4.25185728e-03,  1.85481937e-03,
         3.06847602e-05,  2.13262644e-05, -3.04305907e-05],
       [ 4.25185728e-03,  4.75273194e-03,  2.03762380e-03,
         3.19527809e-05,  2.50894762e-05, -3.30982360e-05],
       [ 1.85481937e-03,  2.03762380e-03,  1.02571645e-03,
         1.41235824e-05,  1.05769624e-05, -1.17636553e-05],
       [ 3.06847602e-05,  3.19527809e-05,  1.41235824e-05,
         2.77306399e-07,  1.68433922e-07, -2.14642534e-07],
       [ 2.13262644e-05,  2.50894762e-05,  1.05769624e-05,
         1.68433922e-07,  1.85991186e-07, -1.43839257e-07],
       [-3.04305907e-05, -3.30982360e-05, -1.17636553e-05,
        -2.14642534e-07, -1.43839257e-07,  3.52815683e-07]])}
[[-5.19969171e+03]
 [-2.96306276e+03]
 [-3.87592455e+03]
 [-3.22362039e+00]
 [-2.49119084e+00]
 [ 6.26088101e+00]
 [ 2.09437393e-01]
 [ 2.84263648e-02]
 [ 9.36519416e-01]
 [-2.79748643e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80631566e-18]]
2018-07-13 08:27:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:40
[[-5.23164181e+03]
 [-2.98781147e+03]
 [-3.81310336e+03]
 [-3.16629963e+00]
 [-2.45849050e+00]
 [ 6.30324258e+00]
 [ 2.14324399e-01]
 [ 2.98866326e-02]
 [ 9.35413112e-01]
 [-2.79596407e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80652795e-18]]
[[ 4.61489799e-03  4.80222274e-03  1.67092876e-03  3.36118082e-05
   2.30469673e-05 -3.24901217e-05]
 [ 4.80222274e-03  5.27371829e-03  1.79856841e-03  3.37463715e-05
   2.70343959e-05 -3.44417598e-05]
 [ 1.67092876e-03  1.79856841e-03  8.26300133e-04  1.20199344e-05
   9.15431152e-06 -8.15585279e-06]
 [ 3.36118082e-05  3.37463715e-05  1.20199344e-05  2.88733124e-07
   1.69218531e-07 -2.14675151e-07]
 [ 2.30469673e-05  2.70343959e-05  9.15431152e-06  1.69218531e-07
   1.96310100e-07 -1.43582650e-07]
 [-3.24901217e-05 -3.44417598e-05 -8.15585279e-06 -2.14675151e-07
  -1.43582650e-07  3.61519992e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.19970367e+03],
       [-2.96308507e+03],
       [-3.87593992e+03],
       [-3.22369316e+00],
       [-2.49134025e+00],
       [ 6.26072973e+00]]), 'covar': array([[ 4.87945336e-04,  5.03629985e-04,  3.40354711e-04,
         3.43388929e-06,  2.20161107e-06, -1.46081811e-06],
       [ 5.03629985e-04,  5.75763718e-04,  3.72832430e-04,
         3.54095436e-06,  2.57036169e-06, -1.57892011e-06],
       [ 3.40354711e-04,  3.72832430e-04,  3.13776883e-04,
         2.39395551e-06,  1.63910110e-06, -8.75535508e-07],
       [ 3.43388929e-06,  3.54095436e-06,  2.39395551e-06,
         2.49440314e-08,  1.54301439e-08, -1.02916179e-08],
       [ 2.20161107e-06,  2.57036169e-06,  1.63910110e-06,
         1.54301439e-08,  1.23597339e-08, -6.83645297e-09],
       [-1.46081811e-06, -1.57892011e-06, -8.75535508e-07,
        -1.02916179e-08, -6.83645297e-09,  7.69217352e-09]])}
[[-5.19970367e+03]
 [-2.96308507e+03]
 [-3.87593992e+03]
 [-3.22369316e+00]
 [-2.49134025e+00]
 [ 6.26072973e+00]]
2018-07-13 08:27:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:40
[[-5.23165419e+03]
 [-2.98783521e+03]
 [-3.81312019e+03]
 [-3.16637279e+00]
 [-2.45863998e+00]
 [ 6.30309073e+00]]
[[ 5.59300632e-04  5.62691010e-04  3.48791363e-04  3.69811370e-06
   2.36142452e-06 -1.55332891e-06]
 [ 5.62691010e-04  6.28460775e-04  3.72819723e-04  3.71016719e-06
   2.69963131e-06 -1.63618849e-06]
 [ 3.48791363e-04  3.72819723e-04  2.97127680e-04  2.30126512e-06
   1.57468853e-06 -7.91616887e-07]
 [ 3.69811370e-06  3.71016719e-06  2.30126512e-06  2.52254508e-08
   1.55269312e-08 -1.02584866e-08]
 [ 2.36142452e-06  2.69963131e-06  1.57468853e-06  1.55269312e-08
   1.25017902e-08 -6.80221512e-09]
 [-1.55332891e-06 -1.63618849e-06 -7.91616887e-07 -1.02584866e-08
  -6.80221512e-09  7.73134394e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.23165419e+03],
       [-2.98783521e+03],
       [-3.81312019e+03],
       [-3.16637279e+00],
       [-2.45863998e+00],
       [ 6.30309073e+00]]), 'covar': array([[ 5.59300632e-04,  5.62691010e-04,  3.48791363e-04,
         3.69811370e-06,  2.36142452e-06, -1.55332891e-06],
       [ 5.62691010e-04,  6.28460775e-04,  3.72819723e-04,
         3.71016719e-06,  2.69963131e-06, -1.63618849e-06],
       [ 3.48791363e-04,  3.72819723e-04,  2.97127680e-04,
         2.30126512e-06,  1.57468853e-06, -7.91616887e-07],
       [ 3.69811370e-06,  3.71016719e-06,  2.30126512e-06,
         2.52254508e-08,  1.55269312e-08, -1.02584866e-08],
       [ 2.36142452e-06,  2.69963131e-06,  1.57468853e-06,
         1.55269312e-08,  1.25017902e-08, -6.80221512e-09],
       [-1.55332891e-06, -1.63618849e-06, -7.91616887e-07,
        -1.02584866e-08, -6.80221512e-09,  7.73134394e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.32151355e-05],
       [ 4.02996126e-05],
       [-2.29519637e-03]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.23164181e+03],
       [-2.98781147e+03],
       [-3.81310336e+03],
       [-3.16629963e+00],
       [-2.45849050e+00],
       [ 6.30324258e+00],
       [ 2.14324399e-01],
       [ 2.98866326e-02],
       [ 9.35413112e-01],
       [-2.79596407e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80652795e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.61489799e-03,  4.80222274e-03,  1.67092876e-03,
         3.36118082e-05,  2.30469673e-05, -3.24901217e-05],
       [ 4.80222274e-03,  5.27371829e-03,  1.79856841e-03,
         3.37463715e-05,  2.70343959e-05, -3.44417598e-05],
       [ 1.67092876e-03,  1.79856841e-03,  8.26300133e-04,
         1.20199344e-05,  9.15431152e-06, -8.15585279e-06],
       [ 3.36118082e-05,  3.37463715e-05,  1.20199344e-05,
         2.88733124e-07,  1.69218531e-07, -2.14675151e-07],
       [ 2.30469673e-05,  2.70343959e-05,  9.15431152e-06,
         1.69218531e-07,  1.96310100e-07, -1.43582650e-07],
       [-3.24901217e-05, -3.44417598e-05, -8.15585279e-06,
        -2.14675151e-07, -1.43582650e-07,  3.61519992e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.54969782e-05],
       [ 3.02621948e-05],
       [ 6.80435924e-02]])}}
Yi [[-2.32503108]
 [-0.18239413]
 [11.24138133]]
posterior
[[-5.23164181e+03]
 [-2.98781147e+03]
 [-3.81310336e+03]
 [-3.16629963e+00]
 [-2.45849050e+00]
 [ 6.30324258e+00]
 [ 2.14324399e-01]
 [ 2.98866326e-02]
 [ 9.35413112e-01]
 [-2.79596407e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80652795e-18]]
[[-5.23165844e+03]
 [-2.98782434e+03]
 [-3.81311509e+03]
 [-3.16644421e+00]
 [-2.45852941e+00]
 [ 6.30322985e+00]
 [ 2.14324399e-01]
 [ 2.98866326e-02]
 [ 9.35413112e-01]
 [-2.79596407e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80652795e-18]]
[[ 4.32578511e-03  4.51456650e-03  1.43817583e-03  3.13745652e-05
   2.16547145e-05 -3.28379073e-05]
 [ 4.51456650e-03  4.92298376e-03  1.54121322e-03  3.18007498e-05
   2.49286101e-05 -3.48525636e-05]
 [ 1.43817583e-03  1.54121322e-03  6.28618427e-04  1.03308011e-05
   7.74564542e-06 -8.46182598e-06]
 [ 3.13745652e-05  3.18007498e-05  1.03308011e-05  2.70202639e-07
   1.61575379e-07 -2.17085080e-07]
 [ 2.16547145e-05  2.49286101e-05  7.74564542e-06  1.61575379e-07
   1.81559561e-07 -1.45980787e-07]
 [-3.28379073e-05 -3.48525636e-05 -8.46182598e-06 -2.17085080e-07
  -1.45980787e-07  3.61034576e-07]]
[[-2.32501361]
 [-0.18236863]
 [10.98867941]]
[[-1.74757247e-05]
 [-2.54944858e-05]
 [ 2.52701925e-01]]


 Corrector Step
2018-07-13 08:27:40
[[-5.23165844e+03]
 [-2.98782434e+03]
 [-3.81311509e+03]
 [-3.16644421e+00]
 [-2.45852941e+00]
 [ 6.30322985e+00]
 [ 2.14324399e-01]
 [ 2.98866326e-02]
 [ 9.35413112e-01]
 [-2.79596407e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80652795e-18]]
[[ 4.32578511e-03  4.51456650e-03  1.43817583e-03  3.13745652e-05
   2.16547145e-05 -3.28379073e-05]
 [ 4.51456650e-03  4.92298376e-03  1.54121322e-03  3.18007498e-05
   2.49286101e-05 -3.48525636e-05]
 [ 1.43817583e-03  1.54121322e-03  6.28618427e-04  1.03308011e-05
   7.74564542e-06 -8.46182598e-06]
 [ 3.13745652e-05  3.18007498e-05  1.03308011e-05  2.70202639e-07
   1.61575379e-07 -2.17085080e-07]
 [ 2.16547145e-05  2.49286101e-05  7.74564542e-06  1.61575379e-07
   1.81559561e-07 -1.45980787e-07]
 [-3.28379073e-05 -3.48525636e-05 -8.46182598e-06 -2.17085080e-07
  -1.45980787e-07  3.61034576e-07]]
17764480.238285333
post
cubesat_nadir
Ybar_post [[-2.32501764]
 [-0.18237762]
 [10.98874152]]
resids [[-1.34462209e-05]
 [-1.65114993e-05]
 [ 2.52639817e-01]]
posterior
[[-5.23165419e+03]
 [-2.98783521e+03]
 [-3.81312019e+03]
 [-3.16637279e+00]
 [-2.45863998e+00]
 [ 6.30309073e+00]]
[[-5.23165882e+03]
 [-2.98783803e+03]
 [-3.81312367e+03]
 [-3.16640365e+00]
 [-2.45864978e+00]
 [ 6.30309792e+00]]
[[ 4.90033361e-04  4.90586101e-04  2.80546742e-04  3.24095981e-06
   2.06037240e-06 -1.42637583e-06]
 [ 4.90586101e-04  5.49176947e-04  2.99536036e-04  3.23500132e-06
   2.36442540e-06 -1.50119858e-06]
 [ 2.80546742e-04  2.99536036e-04  2.28699445e-04  1.85124075e-06
   1.26649516e-06 -6.65032458e-07]
 [ 3.24095981e-06  3.23500132e-06  1.85124075e-06  2.22081804e-08
   1.35437291e-08 -9.42109539e-09]
 [ 2.06037240e-06  2.36442540e-06  1.26649516e-06  1.35437291e-08
   1.10806496e-08 -6.23579973e-09]
 [-1.42637583e-06 -1.50119858e-06 -6.65032458e-07 -9.42109539e-09
  -6.23579973e-09  7.49676024e-09]]
[[-2.3250052 ]
 [-0.18238236]
 [10.98350358]]
[[-2.58799796e-05]
 [-1.17630658e-05]
 [ 2.57877754e-01]]


 Corrector Step
2018-07-13 08:27:40
[[-5.23165882e+03]
 [-2.98783803e+03]
 [-3.81312367e+03]
 [-3.16640365e+00]
 [-2.45864978e+00]
 [ 6.30309792e+00]]
[[ 4.90033361e-04  4.90586101e-04  2.80546742e-04  3.24095981e-06
   2.06037240e-06 -1.42637583e-06]
 [ 4.90586101e-04  5.49176947e-04  2.99536036e-04  3.23500132e-06
   2.36442540e-06 -1.50119858e-06]
 [ 2.80546742e-04  2.99536036e-04  2.28699445e-04  1.85124075e-06
   1.26649516e-06 -6.65032458e-07]
 [ 3.24095981e-06  3.23500132e-06  1.85124075e-06  2.22081804e-08
   1.35437291e-08 -9.42109539e-09]
 [ 2.06037240e-06  2.36442540e-06  1.26649516e-06  1.35437291e-08
   1.10806496e-08 -6.23579973e-09]
 [-1.42637583e-06 -1.50119858e-06 -6.65032458e-07 -9.42109539e-09
  -6.23579973e-09  7.49676024e-09]]
17516123.773406856
post
sphere_lamr_small
Ybar_post [[-2.32500693]
 [-0.18238523]
 [10.98351863]]
resids [[-2.41485412e-05]
 [-8.89463083e-06]
 [ 2.57862702e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [17764480.238285333, 17516123.773406856]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.23165844e+03],
       [-2.98782434e+03],
       [-3.81311509e+03],
       [-3.16644421e+00],
       [-2.45852941e+00],
       [ 6.30322985e+00]]), 'est_covars': array([[ 4.32578511e-03,  4.51456650e-03,  1.43817583e-03,
         3.13745652e-05,  2.16547145e-05, -3.28379073e-05],
       [ 4.51456650e-03,  4.92298376e-03,  1.54121322e-03,
         3.18007498e-05,  2.49286101e-05, -3.48525636e-05],
       [ 1.43817583e-03,  1.54121322e-03,  6.28618427e-04,
         1.03308011e-05,  7.74564542e-06, -8.46182598e-06],
       [ 3.13745652e-05,  3.18007498e-05,  1.03308011e-05,
         2.70202639e-07,  1.61575379e-07, -2.17085080e-07],
       [ 2.16547145e-05,  2.49286101e-05,  7.74564542e-06,
         1.61575379e-07,  1.81559561e-07, -1.45980787e-07],
       [-3.28379073e-05, -3.48525636e-05, -8.46182598e-06,
        -2.17085080e-07, -1.45980787e-07,  3.61034576e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.23165882e+03],
       [-2.98783803e+03],
       [-3.81312367e+03],
       [-3.16640365e+00],
       [-2.45864978e+00],
       [ 6.30309792e+00]]), 'covar': array([[ 4.90033361e-04,  4.90586101e-04,  2.80546742e-04,
         3.24095981e-06,  2.06037240e-06, -1.42637583e-06],
       [ 4.90586101e-04,  5.49176947e-04,  2.99536036e-04,
         3.23500132e-06,  2.36442540e-06, -1.50119858e-06],
       [ 2.80546742e-04,  2.99536036e-04,  2.28699445e-04,
         1.85124075e-06,  1.26649516e-06, -6.65032458e-07],
       [ 3.24095981e-06,  3.23500132e-06,  1.85124075e-06,
         2.22081804e-08,  1.35437291e-08, -9.42109539e-09],
       [ 2.06037240e-06,  2.36442540e-06,  1.26649516e-06,
         1.35437291e-08,  1.10806496e-08, -6.23579973e-09],
       [-1.42637583e-06, -1.50119858e-06, -6.65032458e-07,
        -9.42109539e-09, -6.23579973e-09,  7.49676024e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.41485412e-05],
       [-8.89463083e-06],
       [ 2.57862702e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.23165844e+03],
       [-2.98782434e+03],
       [-3.81311509e+03],
       [-3.16644421e+00],
       [-2.45852941e+00],
       [ 6.30322985e+00],
       [ 2.14324399e-01],
       [ 2.98866326e-02],
       [ 9.35413112e-01],
       [-2.79596407e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80652795e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.32578511e-03,  4.51456650e-03,  1.43817583e-03,
         3.13745652e-05,  2.16547145e-05, -3.28379073e-05],
       [ 4.51456650e-03,  4.92298376e-03,  1.54121322e-03,
         3.18007498e-05,  2.49286101e-05, -3.48525636e-05],
       [ 1.43817583e-03,  1.54121322e-03,  6.28618427e-04,
         1.03308011e-05,  7.74564542e-06, -8.46182598e-06],
       [ 3.13745652e-05,  3.18007498e-05,  1.03308011e-05,
         2.70202639e-07,  1.61575379e-07, -2.17085080e-07],
       [ 2.16547145e-05,  2.49286101e-05,  7.74564542e-06,
         1.61575379e-07,  1.81559561e-07, -1.45980787e-07],
       [-3.28379073e-05, -3.48525636e-05, -8.46182598e-06,
        -2.17085080e-07, -1.45980787e-07,  3.61034576e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.34462209e-05],
       [-1.65114993e-05],
       [ 2.52639817e-01]])}}
Current time:  2018-07-13 08:27:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.23165844e+03],
       [-2.98782434e+03],
       [-3.81311509e+03],
       [-3.16644421e+00],
       [-2.45852941e+00],
       [ 6.30322985e+00],
       [ 2.14324399e-01],
       [ 2.98866326e-02],
       [ 9.35413112e-01],
       [-2.79596407e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80652795e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.32578511e-03,  4.51456650e-03,  1.43817583e-03,
         3.13745652e-05,  2.16547145e-05, -3.28379073e-05],
       [ 4.51456650e-03,  4.92298376e-03,  1.54121322e-03,
         3.18007498e-05,  2.49286101e-05, -3.48525636e-05],
       [ 1.43817583e-03,  1.54121322e-03,  6.28618427e-04,
         1.03308011e-05,  7.74564542e-06, -8.46182598e-06],
       [ 3.13745652e-05,  3.18007498e-05,  1.03308011e-05,
         2.70202639e-07,  1.61575379e-07, -2.17085080e-07],
       [ 2.16547145e-05,  2.49286101e-05,  7.74564542e-06,
         1.61575379e-07,  1.81559561e-07, -1.45980787e-07],
       [-3.28379073e-05, -3.48525636e-05, -8.46182598e-06,
        -2.17085080e-07, -1.45980787e-07,  3.61034576e-07]])}
[[-5.23165844e+03]
 [-2.98782434e+03]
 [-3.81311509e+03]
 [-3.16644421e+00]
 [-2.45852941e+00]
 [ 6.30322985e+00]
 [ 2.14324399e-01]
 [ 2.98866326e-02]
 [ 9.35413112e-01]
 [-2.79596407e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80652795e-18]]
2018-07-13 08:27:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:50
[[-5.26303458e+03]
 [-3.01224491e+03]
 [-3.74987379e+03]
 [-3.10876794e+00]
 [-2.42555456e+00]
 [ 6.34490190e+00]
 [ 2.19205563e-01]
 [ 3.13460856e-02]
 [ 9.34281307e-01]
 [-2.79436548e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80674024e-18]]
[[ 4.98173628e-03  5.06604222e-03  1.19205379e-03  3.42311286e-05
   2.33066260e-05 -3.49160309e-05]
 [ 5.06604222e-03  5.44031698e-03  1.25610403e-03  3.35238894e-05
   2.68281211e-05 -3.62135299e-05]
 [ 1.19205379e-03  1.25610403e-03  4.95974896e-04  8.19026463e-06
   6.29742169e-06 -4.78192430e-06]
 [ 3.42311286e-05  3.35238894e-05  8.19026463e-06  2.81556415e-07
   1.62317407e-07 -2.17116630e-07]
 [ 2.33066260e-05  2.68281211e-05  6.29742169e-06  1.62317407e-07
   1.91854719e-07 -1.45722746e-07]
 [-3.49160309e-05 -3.62135299e-05 -4.78192430e-06 -2.17116630e-07
  -1.45722746e-07  3.69658048e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.23165882e+03],
       [-2.98783803e+03],
       [-3.81312367e+03],
       [-3.16640365e+00],
       [-2.45864978e+00],
       [ 6.30309792e+00]]), 'covar': array([[ 4.90033361e-04,  4.90586101e-04,  2.80546742e-04,
         3.24095981e-06,  2.06037240e-06, -1.42637583e-06],
       [ 4.90586101e-04,  5.49176947e-04,  2.99536036e-04,
         3.23500132e-06,  2.36442540e-06, -1.50119858e-06],
       [ 2.80546742e-04,  2.99536036e-04,  2.28699445e-04,
         1.85124075e-06,  1.26649516e-06, -6.65032458e-07],
       [ 3.24095981e-06,  3.23500132e-06,  1.85124075e-06,
         2.22081804e-08,  1.35437291e-08, -9.42109539e-09],
       [ 2.06037240e-06,  2.36442540e-06,  1.26649516e-06,
         1.35437291e-08,  1.10806496e-08, -6.23579973e-09],
       [-1.42637583e-06, -1.50119858e-06, -6.65032458e-07,
        -9.42109539e-09, -6.23579973e-09,  7.49676024e-09]])}
[[-5.23165882e+03]
 [-2.98783803e+03]
 [-3.81312367e+03]
 [-3.16640365e+00]
 [-2.45864978e+00]
 [ 6.30309792e+00]]
2018-07-13 08:27:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:27:50
[[-5.26303463e+03]
 [-3.01225974e+03]
 [-3.74988392e+03]
 [-3.10872782e+00]
 [-2.42567480e+00]
 [ 6.34476986e+00]]
[[ 5.57285162e-04  5.45065572e-04  2.83864367e-04  3.47686972e-06
   2.20107678e-06 -1.51046548e-06]
 [ 5.45065572e-04  5.97700514e-04  2.96555298e-04  3.38412863e-06
   2.48052486e-06 -1.55311849e-06]
 [ 2.83864367e-04  2.96555298e-04  2.16275442e-04  1.76499205e-06
   1.20718645e-06 -5.84259967e-07]
 [ 3.47686972e-06  3.38412863e-06  1.76499205e-06  2.24683059e-08
   1.36295047e-08 -9.39010007e-09]
 [ 2.20107678e-06  2.48052486e-06  1.20718645e-06  1.36295047e-08
   1.12174499e-08 -6.20435362e-09]
 [-1.51046548e-06 -1.55311849e-06 -5.84259967e-07 -9.39010007e-09
  -6.20435362e-09  7.53861553e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.26303463e+03],
       [-3.01225974e+03],
       [-3.74988392e+03],
       [-3.10872782e+00],
       [-2.42567480e+00],
       [ 6.34476986e+00]]), 'covar': array([[ 5.57285162e-04,  5.45065572e-04,  2.83864367e-04,
         3.47686972e-06,  2.20107678e-06, -1.51046548e-06],
       [ 5.45065572e-04,  5.97700514e-04,  2.96555298e-04,
         3.38412863e-06,  2.48052486e-06, -1.55311849e-06],
       [ 2.83864367e-04,  2.96555298e-04,  2.16275442e-04,
         1.76499205e-06,  1.20718645e-06, -5.84259967e-07],
       [ 3.47686972e-06,  3.38412863e-06,  1.76499205e-06,
         2.24683059e-08,  1.36295047e-08, -9.39010007e-09],
       [ 2.20107678e-06,  2.48052486e-06,  1.20718645e-06,
         1.36295047e-08,  1.12174499e-08, -6.20435362e-09],
       [-1.51046548e-06, -1.55311849e-06, -5.84259967e-07,
        -9.39010007e-09, -6.20435362e-09,  7.53861553e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.41485412e-05],
       [-8.89463083e-06],
       [ 2.57862702e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.26303458e+03],
       [-3.01224491e+03],
       [-3.74987379e+03],
       [-3.10876794e+00],
       [-2.42555456e+00],
       [ 6.34490190e+00],
       [ 2.19205563e-01],
       [ 3.13460856e-02],
       [ 9.34281307e-01],
       [-2.79436548e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80674024e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.98173628e-03,  5.06604222e-03,  1.19205379e-03,
         3.42311286e-05,  2.33066260e-05, -3.49160309e-05],
       [ 5.06604222e-03,  5.44031698e-03,  1.25610403e-03,
         3.35238894e-05,  2.68281211e-05, -3.62135299e-05],
       [ 1.19205379e-03,  1.25610403e-03,  4.95974896e-04,
         8.19026463e-06,  6.29742169e-06, -4.78192430e-06],
       [ 3.42311286e-05,  3.35238894e-05,  8.19026463e-06,
         2.81556415e-07,  1.62317407e-07, -2.17116630e-07],
       [ 2.33066260e-05,  2.68281211e-05,  6.29742169e-06,
         1.62317407e-07,  1.91854719e-07, -1.45722746e-07],
       [-3.49160309e-05, -3.62135299e-05, -4.78192430e-06,
        -2.17116630e-07, -1.45722746e-07,  3.69658048e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.34462209e-05],
       [-1.65114993e-05],
       [ 2.52639817e-01]])}}
Yi [[-2.33597537]
 [-0.10491866]
 [11.38694474]]
posterior
[[-5.26303458e+03]
 [-3.01224491e+03]
 [-3.74987379e+03]
 [-3.10876794e+00]
 [-2.42555456e+00]
 [ 6.34490190e+00]
 [ 2.19205563e-01]
 [ 3.13460856e-02]
 [ 9.34281307e-01]
 [-2.79436548e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80674024e-18]]
[[-5.26303791e+03]
 [-3.01224611e+03]
 [-3.74987518e+03]
 [-3.10880139e+00]
 [-2.42554765e+00]
 [ 6.34490317e+00]
 [ 2.19205563e-01]
 [ 3.13460856e-02]
 [ 9.34281307e-01]
 [-2.79436548e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80674024e-18]]
[[ 4.69451393e-03  4.78981179e-03  9.99416297e-04  3.20661921e-05
   2.19830330e-05 -3.52200357e-05]
 [ 4.78981179e-03  5.10878738e-03  1.04834178e-03  3.17235825e-05
   2.48263274e-05 -3.65696810e-05]
 [ 9.99416297e-04  1.04834178e-03  3.59084910e-04  6.83449135e-06
   5.16076417e-06 -5.00771390e-06]
 [ 3.20661921e-05  3.17235825e-05  6.83449135e-06  2.64032835e-07
   1.55458692e-07 -2.19135334e-07]
 [ 2.19830330e-05  2.48263274e-05  5.16076417e-06  1.55458692e-07
   1.77690511e-07 -1.47829542e-07]
 [-3.52200357e-05 -3.65696810e-05 -5.00771390e-06 -2.19135334e-07
  -1.47829542e-07  3.69272484e-07]]
[[-2.33596769]
 [-0.10491508]
 [11.18653512]]
[[-7.67854411e-06]
 [-3.58731107e-06]
 [ 2.00409619e-01]]


 Corrector Step
2018-07-13 08:27:50
[[-5.26303791e+03]
 [-3.01224611e+03]
 [-3.74987518e+03]
 [-3.10880139e+00]
 [-2.42554765e+00]
 [ 6.34490317e+00]
 [ 2.19205563e-01]
 [ 3.13460856e-02]
 [ 9.34281307e-01]
 [-2.79436548e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80674024e-18]]
[[ 4.69451393e-03  4.78981179e-03  9.99416297e-04  3.20661921e-05
   2.19830330e-05 -3.52200357e-05]
 [ 4.78981179e-03  5.10878738e-03  1.04834178e-03  3.17235825e-05
   2.48263274e-05 -3.65696810e-05]
 [ 9.99416297e-04  1.04834178e-03  3.59084910e-04  6.83449135e-06
   5.16076417e-06 -5.00771390e-06]
 [ 3.20661921e-05  3.17235825e-05  6.83449135e-06  2.64032835e-07
   1.55458692e-07 -2.19135334e-07]
 [ 2.19830330e-05  2.48263274e-05  5.16076417e-06  1.55458692e-07
   1.77690511e-07 -1.47829542e-07]
 [-3.52200357e-05 -3.65696810e-05 -5.00771390e-06 -2.19135334e-07
  -1.47829542e-07  3.69272484e-07]]
98557405.22511669
post
cubesat_nadir
Ybar_post [[-2.33596957]
 [-0.10491626]
 [11.18654913]]
resids [[-5.80244188e-06]
 [-2.40604453e-06]
 [ 2.00395608e-01]]
posterior
[[-5.26303463e+03]
 [-3.01225974e+03]
 [-3.74988392e+03]
 [-3.10872782e+00]
 [-2.42567480e+00]
 [ 6.34476986e+00]]
[[-5.26303364e+03]
 [-3.01225711e+03]
 [-3.74988231e+03]
 [-3.10872205e+00]
 [-2.42566251e+00]
 [ 6.34476715e+00]]
[[ 4.89932326e-04  4.76828624e-04  2.27189412e-04  3.05765182e-06
   1.92633898e-06 -1.39308242e-06]
 [ 4.76828624e-04  5.24295793e-04  2.37149054e-04  2.96051269e-06
   2.18061513e-06 -1.43149012e-06]
 [ 2.27189412e-04  2.37149054e-04  1.67660993e-04  1.41274945e-06
   9.65972413e-07 -4.84228417e-07]
 [ 3.05765182e-06  2.96051269e-06  1.41274945e-06  1.98587217e-08
   1.19250575e-08 -8.66018321e-09]
 [ 1.92633898e-06  2.18061513e-06  9.65972413e-07  1.19250575e-08
   9.98790756e-09 -5.71188607e-09]
 [-1.39308242e-06 -1.43149012e-06 -4.84228417e-07 -8.66018321e-09
  -5.71188607e-09  7.33232693e-09]]
[[-2.33595622]
 [-0.1049251 ]
 [11.09573364]]
[[-1.91524382e-05]
 [ 6.43185719e-06]
 [ 2.91211097e-01]]


 Corrector Step
2018-07-13 08:27:50
[[-5.26303364e+03]
 [-3.01225711e+03]
 [-3.74988231e+03]
 [-3.10872205e+00]
 [-2.42566251e+00]
 [ 6.34476715e+00]]
[[ 4.89932326e-04  4.76828624e-04  2.27189412e-04  3.05765182e-06
   1.92633898e-06 -1.39308242e-06]
 [ 4.76828624e-04  5.24295793e-04  2.37149054e-04  2.96051269e-06
   2.18061513e-06 -1.43149012e-06]
 [ 2.27189412e-04  2.37149054e-04  1.67660993e-04  1.41274945e-06
   9.65972413e-07 -4.84228417e-07]
 [ 3.05765182e-06  2.96051269e-06  1.41274945e-06  1.98587217e-08
   1.19250575e-08 -8.66018321e-09]
 [ 1.92633898e-06  2.18061513e-06  9.65972413e-07  1.19250575e-08
   9.98790756e-09 -5.71188607e-09]
 [-1.39308242e-06 -1.43149012e-06 -4.84228417e-07 -8.66018321e-09
  -5.71188607e-09  7.33232693e-09]]
9596487.718898023
post
sphere_lamr_small
Ybar_post [[-2.33595752]
 [-0.10492361]
 [11.09572851]]
resids [[-1.78490119e-05]
 [ 4.94343252e-06]
 [ 2.91216230e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [98557405.22511669, 9596487.718898023]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.26303791e+03],
       [-3.01224611e+03],
       [-3.74987518e+03],
       [-3.10880139e+00],
       [-2.42554765e+00],
       [ 6.34490317e+00]]), 'est_covars': array([[ 4.69451393e-03,  4.78981179e-03,  9.99416297e-04,
         3.20661921e-05,  2.19830330e-05, -3.52200357e-05],
       [ 4.78981179e-03,  5.10878738e-03,  1.04834178e-03,
         3.17235825e-05,  2.48263274e-05, -3.65696810e-05],
       [ 9.99416297e-04,  1.04834178e-03,  3.59084910e-04,
         6.83449135e-06,  5.16076417e-06, -5.00771390e-06],
       [ 3.20661921e-05,  3.17235825e-05,  6.83449135e-06,
         2.64032835e-07,  1.55458692e-07, -2.19135334e-07],
       [ 2.19830330e-05,  2.48263274e-05,  5.16076417e-06,
         1.55458692e-07,  1.77690511e-07, -1.47829542e-07],
       [-3.52200357e-05, -3.65696810e-05, -5.00771390e-06,
        -2.19135334e-07, -1.47829542e-07,  3.69272484e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.26303364e+03],
       [-3.01225711e+03],
       [-3.74988231e+03],
       [-3.10872205e+00],
       [-2.42566251e+00],
       [ 6.34476715e+00]]), 'covar': array([[ 4.89932326e-04,  4.76828624e-04,  2.27189412e-04,
         3.05765182e-06,  1.92633898e-06, -1.39308242e-06],
       [ 4.76828624e-04,  5.24295793e-04,  2.37149054e-04,
         2.96051269e-06,  2.18061513e-06, -1.43149012e-06],
       [ 2.27189412e-04,  2.37149054e-04,  1.67660993e-04,
         1.41274945e-06,  9.65972413e-07, -4.84228417e-07],
       [ 3.05765182e-06,  2.96051269e-06,  1.41274945e-06,
         1.98587217e-08,  1.19250575e-08, -8.66018321e-09],
       [ 1.92633898e-06,  2.18061513e-06,  9.65972413e-07,
         1.19250575e-08,  9.98790756e-09, -5.71188607e-09],
       [-1.39308242e-06, -1.43149012e-06, -4.84228417e-07,
        -8.66018321e-09, -5.71188607e-09,  7.33232693e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.78490119e-05],
       [ 4.94343252e-06],
       [ 2.91216230e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.26303791e+03],
       [-3.01224611e+03],
       [-3.74987518e+03],
       [-3.10880139e+00],
       [-2.42554765e+00],
       [ 6.34490317e+00],
       [ 2.19205563e-01],
       [ 3.13460856e-02],
       [ 9.34281307e-01],
       [-2.79436548e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80674024e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.69451393e-03,  4.78981179e-03,  9.99416297e-04,
         3.20661921e-05,  2.19830330e-05, -3.52200357e-05],
       [ 4.78981179e-03,  5.10878738e-03,  1.04834178e-03,
         3.17235825e-05,  2.48263274e-05, -3.65696810e-05],
       [ 9.99416297e-04,  1.04834178e-03,  3.59084910e-04,
         6.83449135e-06,  5.16076417e-06, -5.00771390e-06],
       [ 3.20661921e-05,  3.17235825e-05,  6.83449135e-06,
         2.64032835e-07,  1.55458692e-07, -2.19135334e-07],
       [ 2.19830330e-05,  2.48263274e-05,  5.16076417e-06,
         1.55458692e-07,  1.77690511e-07, -1.47829542e-07],
       [-3.52200357e-05, -3.65696810e-05, -5.00771390e-06,
        -2.19135334e-07, -1.47829542e-07,  3.69272484e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-5.80244188e-06],
       [-2.40604453e-06],
       [ 2.00395608e-01]])}}
Current time:  2018-07-13 08:28:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.26303791e+03],
       [-3.01224611e+03],
       [-3.74987518e+03],
       [-3.10880139e+00],
       [-2.42554765e+00],
       [ 6.34490317e+00],
       [ 2.19205563e-01],
       [ 3.13460856e-02],
       [ 9.34281307e-01],
       [-2.79436548e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80674024e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.69451393e-03,  4.78981179e-03,  9.99416297e-04,
         3.20661921e-05,  2.19830330e-05, -3.52200357e-05],
       [ 4.78981179e-03,  5.10878738e-03,  1.04834178e-03,
         3.17235825e-05,  2.48263274e-05, -3.65696810e-05],
       [ 9.99416297e-04,  1.04834178e-03,  3.59084910e-04,
         6.83449135e-06,  5.16076417e-06, -5.00771390e-06],
       [ 3.20661921e-05,  3.17235825e-05,  6.83449135e-06,
         2.64032835e-07,  1.55458692e-07, -2.19135334e-07],
       [ 2.19830330e-05,  2.48263274e-05,  5.16076417e-06,
         1.55458692e-07,  1.77690511e-07, -1.47829542e-07],
       [-3.52200357e-05, -3.65696810e-05, -5.00771390e-06,
        -2.19135334e-07, -1.47829542e-07,  3.69272484e-07]])}
[[-5.26303791e+03]
 [-3.01224611e+03]
 [-3.74987518e+03]
 [-3.10880139e+00]
 [-2.42554765e+00]
 [ 6.34490317e+00]
 [ 2.19205563e-01]
 [ 3.13460856e-02]
 [ 9.34281307e-01]
 [-2.79436548e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80674024e-18]]
2018-07-13 08:27:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:00
[[-5.29383630e+03]
 [-3.03633536e+03]
 [-3.68622048e+03]
 [-3.05077586e+00]
 [-2.39230173e+00]
 [ 6.38588167e+00]
 [ 2.24080750e-01]
 [ 3.28046841e-02]
 [ 9.33124030e-01]
 [-2.79269071e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80695252e-18]]
[[ 5.36361311e-03  5.34297841e-03  6.94101869e-04  3.48616101e-05
   2.35735993e-05 -3.73120496e-05]
 [ 5.34297841e-03  5.62382081e-03  7.20174263e-04  3.33842450e-05
   2.66863578e-05 -3.79445878e-05]
 [ 6.94101869e-04  7.20174263e-04  2.96390726e-04  4.66225524e-06
   3.69045762e-06 -1.25552578e-06]
 [ 3.48616101e-05  3.33842450e-05  4.66225524e-06  2.75324988e-07
   1.56165019e-07 -2.19163248e-07]
 [ 2.35735993e-05  2.66863578e-05  3.69045762e-06  1.56165019e-07
   1.87965670e-07 -1.47568630e-07]
 [-3.73120496e-05 -3.79445878e-05 -1.25552578e-06 -2.19163248e-07
  -1.47568630e-07  3.77813619e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.26303364e+03],
       [-3.01225711e+03],
       [-3.74988231e+03],
       [-3.10872205e+00],
       [-2.42566251e+00],
       [ 6.34476715e+00]]), 'covar': array([[ 4.89932326e-04,  4.76828624e-04,  2.27189412e-04,
         3.05765182e-06,  1.92633898e-06, -1.39308242e-06],
       [ 4.76828624e-04,  5.24295793e-04,  2.37149054e-04,
         2.96051269e-06,  2.18061513e-06, -1.43149012e-06],
       [ 2.27189412e-04,  2.37149054e-04,  1.67660993e-04,
         1.41274945e-06,  9.65972413e-07, -4.84228417e-07],
       [ 3.05765182e-06,  2.96051269e-06,  1.41274945e-06,
         1.98587217e-08,  1.19250575e-08, -8.66018321e-09],
       [ 1.92633898e-06,  2.18061513e-06,  9.65972413e-07,
         1.19250575e-08,  9.98790756e-09, -5.71188607e-09],
       [-1.39308242e-06, -1.43149012e-06, -4.84228417e-07,
        -8.66018321e-09, -5.71188607e-09,  7.33232693e-09]])}
[[-5.26303364e+03]
 [-3.01225711e+03]
 [-3.74988231e+03]
 [-3.10872205e+00]
 [-2.42566251e+00]
 [ 6.34476715e+00]]
2018-07-13 08:27:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:00
[[-5.29383115e+03]
 [-3.03634782e+03]
 [-3.68622908e+03]
 [-3.05069660e+00]
 [-2.39241668e+00]
 [ 6.38574550e+00]]
[[ 5.53197324e-04  5.26994100e-04  2.26575489e-04  3.26917823e-06
   2.05048441e-06 -1.46962159e-06]
 [ 5.26994100e-04  5.68976555e-04  2.31956963e-04  3.09229086e-06
   2.28529950e-06 -1.47847509e-06]
 [ 2.26575489e-04  2.31956963e-04  1.58782153e-04  1.33244443e-06
   9.11339514e-07 -4.06447943e-07]
 [ 3.26917823e-06  3.09229086e-06  1.33244443e-06  2.01010769e-08
   1.20015676e-08 -8.63131055e-09]
 [ 2.05048441e-06  2.28529950e-06  9.11339514e-07  1.20015676e-08
   1.01201437e-08 -5.68270243e-09]
 [-1.46962159e-06 -1.47847509e-06 -4.06447943e-07 -8.63131055e-09
  -5.68270243e-09  7.37635925e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 27, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.29383115e+03],
       [-3.03634782e+03],
       [-3.68622908e+03],
       [-3.05069660e+00],
       [-2.39241668e+00],
       [ 6.38574550e+00]]), 'covar': array([[ 5.53197324e-04,  5.26994100e-04,  2.26575489e-04,
         3.26917823e-06,  2.05048441e-06, -1.46962159e-06],
       [ 5.26994100e-04,  5.68976555e-04,  2.31956963e-04,
         3.09229086e-06,  2.28529950e-06, -1.47847509e-06],
       [ 2.26575489e-04,  2.31956963e-04,  1.58782153e-04,
         1.33244443e-06,  9.11339514e-07, -4.06447943e-07],
       [ 3.26917823e-06,  3.09229086e-06,  1.33244443e-06,
         2.01010769e-08,  1.20015676e-08, -8.63131055e-09],
       [ 2.05048441e-06,  2.28529950e-06,  9.11339514e-07,
         1.20015676e-08,  1.01201437e-08, -5.68270243e-09],
       [-1.46962159e-06, -1.47847509e-06, -4.06447943e-07,
        -8.63131055e-09, -5.68270243e-09,  7.37635925e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.78490119e-05],
       [ 4.94343252e-06],
       [ 2.91216230e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 27, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.29383630e+03],
       [-3.03633536e+03],
       [-3.68622048e+03],
       [-3.05077586e+00],
       [-2.39230173e+00],
       [ 6.38588167e+00],
       [ 2.24080750e-01],
       [ 3.28046841e-02],
       [ 9.33124030e-01],
       [-2.79269071e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80695252e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.36361311e-03,  5.34297841e-03,  6.94101869e-04,
         3.48616101e-05,  2.35735993e-05, -3.73120496e-05],
       [ 5.34297841e-03,  5.62382081e-03,  7.20174263e-04,
         3.33842450e-05,  2.66863578e-05, -3.79445878e-05],
       [ 6.94101869e-04,  7.20174263e-04,  2.96390726e-04,
         4.66225524e-06,  3.69045762e-06, -1.25552578e-06],
       [ 3.48616101e-05,  3.33842450e-05,  4.66225524e-06,
         2.75324988e-07,  1.56165019e-07, -2.19163248e-07],
       [ 2.35735993e-05,  2.66863578e-05,  3.69045762e-06,
         1.56165019e-07,  1.87965670e-07, -1.47568630e-07],
       [-3.73120496e-05, -3.79445878e-05, -1.25552578e-06,
        -2.19163248e-07, -1.47568630e-07,  3.77813619e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-5.80244188e-06],
       [-2.40604453e-06],
       [ 2.00395608e-01]])}}
Yi [[-2.34580923]
 [-0.03227137]
 [11.30507949]]
posterior
[[-5.29383630e+03]
 [-3.03633536e+03]
 [-3.68622048e+03]
 [-3.05077586e+00]
 [-2.39230173e+00]
 [ 6.38588167e+00]
 [ 2.24080750e-01]
 [ 3.28046841e-02]
 [ 9.33124030e-01]
 [-2.79269071e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80695252e-18]]
[[-5.29385067e+03]
 [-3.03635486e+03]
 [-3.68623030e+03]
 [-3.05085631e+00]
 [-2.39243221e+00]
 [ 6.38586139e+00]
 [ 2.24080750e-01]
 [ 3.28046841e-02]
 [ 9.33124030e-01]
 [-2.79269071e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80695252e-18]]
[[ 5.07816138e-03  5.07701480e-03  5.35925864e-04  3.27560048e-05
   2.23127436e-05 -3.75742763e-05]
 [ 5.07701480e-03  5.30853118e-03  5.53149667e-04  3.17050676e-05
   2.47726520e-05 -3.82515420e-05]
 [ 5.35925864e-04  5.53149667e-04  2.03014817e-04  3.57777683e-06
   2.77664033e-06 -1.41918036e-06]
 [ 3.27560048e-05  3.17050676e-05  3.57777683e-06  2.58609122e-07
   1.49959666e-07 -2.20835348e-07]
 [ 2.23127436e-05  2.47726520e-05  2.77664033e-06  1.49959666e-07
   1.74305274e-07 -1.49412869e-07]
 [-3.75742763e-05 -3.82515420e-05 -1.41918036e-06 -2.20835348e-07
  -1.49412869e-07  3.77512566e-07]]
[[-2.34582418]
 [-0.03224168]
 [11.40312481]]
[[ 1.49503699e-05]
 [-2.96851977e-05]
 [-9.80453241e-02]]


 Corrector Step
2018-07-13 08:28:00
[[-5.29385067e+03]
 [-3.03635486e+03]
 [-3.68623030e+03]
 [-3.05085631e+00]
 [-2.39243221e+00]
 [ 6.38586139e+00]
 [ 2.24080750e-01]
 [ 3.28046841e-02]
 [ 9.33124030e-01]
 [-2.79269071e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80695252e-18]]
[[ 5.07816138e-03  5.07701480e-03  5.35925864e-04  3.27560048e-05
   2.23127436e-05 -3.75742763e-05]
 [ 5.07701480e-03  5.30853118e-03  5.53149667e-04  3.17050676e-05
   2.47726520e-05 -3.82515420e-05]
 [ 5.35925864e-04  5.53149667e-04  2.03014817e-04  3.57777683e-06
   2.77664033e-06 -1.41918036e-06]
 [ 3.27560048e-05  3.17050676e-05  3.57777683e-06  2.58609122e-07
   1.49959666e-07 -2.20835348e-07]
 [ 2.23127436e-05  2.47726520e-05  2.77664033e-06  1.49959666e-07
   1.74305274e-07 -1.49412869e-07]
 [-3.75742763e-05 -3.82515420e-05 -1.41918036e-06 -2.20835348e-07
  -1.49412869e-07  3.77512566e-07]]
252386510.54059055
post
cubesat_nadir
Ybar_post [[-2.34582058]
 [-0.03225145]
 [11.40314858]]
resids [[ 1.13519465e-05]
 [-1.99233252e-05]
 [-9.80690961e-02]]
posterior
[[-5.29383115e+03]
 [-3.03634782e+03]
 [-3.68622908e+03]
 [-3.05069660e+00]
 [-2.39241668e+00]
 [ 6.38574550e+00]]
[[-5.29383709e+03]
 [-3.03635402e+03]
 [-3.68623348e+03]
 [-3.05073145e+00]
 [-2.39244115e+00]
 [ 6.38575555e+00]]
[[ 4.88491914e-04  4.63100595e-04  1.80035570e-04  2.88792035e-06
   1.80210790e-06 -1.36237690e-06]
 [ 4.63100595e-04  5.01551995e-04  1.84234948e-04  2.71725738e-06
   2.01865341e-06 -1.36999374e-06]
 [ 1.80035570e-04  1.84234948e-04  1.24588030e-04  1.05880859e-06
   7.23975474e-07 -3.28258812e-07]
 [ 2.88792035e-06  2.71725738e-06  1.05880859e-06  1.78541463e-08
   1.05451912e-08 -8.00026081e-09]
 [ 1.80210790e-06  2.01865341e-06  7.23975474e-07  1.05451912e-08
   9.06117227e-09 -5.25828960e-09]
 [-1.36237690e-06 -1.36999374e-06 -3.28258812e-07 -8.00026081e-09
  -5.25828960e-09  7.19706925e-09]]
[[-2.34581071]
 [-0.03225078]
 [11.21702719]]
[[ 1.47972018e-06]
 [-2.05880388e-05]
 [ 8.80522978e-02]]


 Corrector Step
2018-07-13 08:28:00
[[-5.29383709e+03]
 [-3.03635402e+03]
 [-3.68623348e+03]
 [-3.05073145e+00]
 [-2.39244115e+00]
 [ 6.38575555e+00]]
[[ 4.88491914e-04  4.63100595e-04  1.80035570e-04  2.88792035e-06
   1.80210790e-06 -1.36237690e-06]
 [ 4.63100595e-04  5.01551995e-04  1.84234948e-04  2.71725738e-06
   2.01865341e-06 -1.36999374e-06]
 [ 1.80035570e-04  1.84234948e-04  1.24588030e-04  1.05880859e-06
   7.23975474e-07 -3.28258812e-07]
 [ 2.88792035e-06  2.71725738e-06  1.05880859e-06  1.78541463e-08
   1.05451912e-08 -8.00026081e-09]
 [ 1.80210790e-06  2.01865341e-06  7.23975474e-07  1.05451912e-08
   9.06117227e-09 -5.25828960e-09]
 [-1.36237690e-06 -1.36999374e-06 -3.28258812e-07 -8.00026081e-09
  -5.25828960e-09  7.19706925e-09]]
472854809.4515692
post
sphere_lamr_small
Ybar_post [[-2.34581073]
 [-0.03225524]
 [11.21704546]]
resids [[ 1.50090713e-06]
 [-1.61334734e-05]
 [ 8.80340244e-02]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [252386510.54059055, 472854809.4515692]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.29385067e+03],
       [-3.03635486e+03],
       [-3.68623030e+03],
       [-3.05085631e+00],
       [-2.39243221e+00],
       [ 6.38586139e+00]]), 'est_covars': array([[ 5.07816138e-03,  5.07701480e-03,  5.35925864e-04,
         3.27560048e-05,  2.23127436e-05, -3.75742763e-05],
       [ 5.07701480e-03,  5.30853118e-03,  5.53149667e-04,
         3.17050676e-05,  2.47726520e-05, -3.82515420e-05],
       [ 5.35925864e-04,  5.53149667e-04,  2.03014817e-04,
         3.57777683e-06,  2.77664033e-06, -1.41918036e-06],
       [ 3.27560048e-05,  3.17050676e-05,  3.57777683e-06,
         2.58609122e-07,  1.49959666e-07, -2.20835348e-07],
       [ 2.23127436e-05,  2.47726520e-05,  2.77664033e-06,
         1.49959666e-07,  1.74305274e-07, -1.49412869e-07],
       [-3.75742763e-05, -3.82515420e-05, -1.41918036e-06,
        -2.20835348e-07, -1.49412869e-07,  3.77512566e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.29383709e+03],
       [-3.03635402e+03],
       [-3.68623348e+03],
       [-3.05073145e+00],
       [-2.39244115e+00],
       [ 6.38575555e+00]]), 'covar': array([[ 4.88491914e-04,  4.63100595e-04,  1.80035570e-04,
         2.88792035e-06,  1.80210790e-06, -1.36237690e-06],
       [ 4.63100595e-04,  5.01551995e-04,  1.84234948e-04,
         2.71725738e-06,  2.01865341e-06, -1.36999374e-06],
       [ 1.80035570e-04,  1.84234948e-04,  1.24588030e-04,
         1.05880859e-06,  7.23975474e-07, -3.28258812e-07],
       [ 2.88792035e-06,  2.71725738e-06,  1.05880859e-06,
         1.78541463e-08,  1.05451912e-08, -8.00026081e-09],
       [ 1.80210790e-06,  2.01865341e-06,  7.23975474e-07,
         1.05451912e-08,  9.06117227e-09, -5.25828960e-09],
       [-1.36237690e-06, -1.36999374e-06, -3.28258812e-07,
        -8.00026081e-09, -5.25828960e-09,  7.19706925e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.50090713e-06],
       [-1.61334734e-05],
       [ 8.80340244e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.29385067e+03],
       [-3.03635486e+03],
       [-3.68623030e+03],
       [-3.05085631e+00],
       [-2.39243221e+00],
       [ 6.38586139e+00],
       [ 2.24080750e-01],
       [ 3.28046841e-02],
       [ 9.33124030e-01],
       [-2.79269071e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80695252e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.07816138e-03,  5.07701480e-03,  5.35925864e-04,
         3.27560048e-05,  2.23127436e-05, -3.75742763e-05],
       [ 5.07701480e-03,  5.30853118e-03,  5.53149667e-04,
         3.17050676e-05,  2.47726520e-05, -3.82515420e-05],
       [ 5.35925864e-04,  5.53149667e-04,  2.03014817e-04,
         3.57777683e-06,  2.77664033e-06, -1.41918036e-06],
       [ 3.27560048e-05,  3.17050676e-05,  3.57777683e-06,
         2.58609122e-07,  1.49959666e-07, -2.20835348e-07],
       [ 2.23127436e-05,  2.47726520e-05,  2.77664033e-06,
         1.49959666e-07,  1.74305274e-07, -1.49412869e-07],
       [-3.75742763e-05, -3.82515420e-05, -1.41918036e-06,
        -2.20835348e-07, -1.49412869e-07,  3.77512566e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.13519465e-05],
       [-1.99233252e-05],
       [-9.80690961e-02]])}}
Current time:  2018-07-13 08:28:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.29385067e+03],
       [-3.03635486e+03],
       [-3.68623030e+03],
       [-3.05085631e+00],
       [-2.39243221e+00],
       [ 6.38586139e+00],
       [ 2.24080750e-01],
       [ 3.28046841e-02],
       [ 9.33124030e-01],
       [-2.79269071e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80695252e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.07816138e-03,  5.07701480e-03,  5.35925864e-04,
         3.27560048e-05,  2.23127436e-05, -3.75742763e-05],
       [ 5.07701480e-03,  5.30853118e-03,  5.53149667e-04,
         3.17050676e-05,  2.47726520e-05, -3.82515420e-05],
       [ 5.35925864e-04,  5.53149667e-04,  2.03014817e-04,
         3.57777683e-06,  2.77664033e-06, -1.41918036e-06],
       [ 3.27560048e-05,  3.17050676e-05,  3.57777683e-06,
         2.58609122e-07,  1.49959666e-07, -2.20835348e-07],
       [ 2.23127436e-05,  2.47726520e-05,  2.77664033e-06,
         1.49959666e-07,  1.74305274e-07, -1.49412869e-07],
       [-3.75742763e-05, -3.82515420e-05, -1.41918036e-06,
        -2.20835348e-07, -1.49412869e-07,  3.77512566e-07]])}
[[-5.29385067e+03]
 [-3.03635486e+03]
 [-3.68623030e+03]
 [-3.05085631e+00]
 [-2.39243221e+00]
 [ 6.38586139e+00]
 [ 2.24080750e-01]
 [ 3.28046841e-02]
 [ 9.33124030e-01]
 [-2.79269071e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80695252e-18]]
2018-07-13 08:28:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:10
[[-5.32406766e+03]
 [-3.06011163e+03]
 [-3.62216958e+03]
 [-2.99248792e+00]
 [-2.35891892e+00]
 [ 6.42614121e+00]
 [ 2.28949828e-01]
 [ 3.42623882e-02]
 [ 9.31941315e-01]
 [-2.79093981e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80716481e-18]]
[[ 5.76042417e-03  5.63290798e-03  1.74467825e-04  3.54983176e-05
   2.38484889e-05 -3.96764480e-05]
 [ 5.63290798e-03  5.82210406e-03  1.84099386e-04  3.33100372e-05
   2.65982317e-05 -3.96373219e-05]
 [ 1.74467825e-04  1.84099386e-04  2.12721278e-04  1.37835960e-06
   1.28723109e-06  2.40506781e-06]
 [ 3.54983176e-05  3.33100372e-05  1.37835960e-06  2.69849399e-07
   1.50636195e-07 -2.20858180e-07]
 [ 2.38484889e-05  2.65982317e-05  1.28723109e-06  1.50636195e-07
   1.84563647e-07 -1.49148126e-07]
 [-3.96764480e-05 -3.96373219e-05  2.40506781e-06 -2.20858180e-07
  -1.49148126e-07  3.85970370e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.29383709e+03],
       [-3.03635402e+03],
       [-3.68623348e+03],
       [-3.05073145e+00],
       [-2.39244115e+00],
       [ 6.38575555e+00]]), 'covar': array([[ 4.88491914e-04,  4.63100595e-04,  1.80035570e-04,
         2.88792035e-06,  1.80210790e-06, -1.36237690e-06],
       [ 4.63100595e-04,  5.01551995e-04,  1.84234948e-04,
         2.71725738e-06,  2.01865341e-06, -1.36999374e-06],
       [ 1.80035570e-04,  1.84234948e-04,  1.24588030e-04,
         1.05880859e-06,  7.23975474e-07, -3.28258812e-07],
       [ 2.88792035e-06,  2.71725738e-06,  1.05880859e-06,
         1.78541463e-08,  1.05451912e-08, -8.00026081e-09],
       [ 1.80210790e-06,  2.01865341e-06,  7.23975474e-07,
         1.05451912e-08,  9.06117227e-09, -5.25828960e-09],
       [-1.36237690e-06, -1.36999374e-06, -3.28258812e-07,
        -8.00026081e-09, -5.25828960e-09,  7.19706925e-09]])}
[[-5.29383709e+03]
 [-3.03635402e+03]
 [-3.68623348e+03]
 [-3.05073145e+00]
 [-2.39244115e+00]
 [ 6.38575555e+00]]
2018-07-13 08:28:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:10
[[-5.32405279e+03]
 [-3.06011105e+03]
 [-3.62217381e+03]
 [-2.99236304e+00]
 [-2.35892774e+00]
 [ 6.42603529e+00]]
[[ 5.48165042e-04  5.09436804e-04  1.76304382e-04  3.07872464e-06
   1.91223386e-06 -1.43264609e-06]
 [ 5.09436804e-04  5.42877829e-04  1.77327240e-04  2.83435311e-06
   2.11373448e-06 -1.41297102e-06]
 [ 1.76304382e-04  1.77327240e-04  1.18854812e-04  9.83704617e-07
   6.73436681e-07 -2.52901470e-07]
 [ 3.07872464e-06  2.83435311e-06  9.83704617e-07  1.80815346e-08
   1.06140834e-08 -7.97330875e-09]
 [ 1.91223386e-06  2.11373448e-06  6.73436681e-07  1.06140834e-08
   9.18974473e-09 -5.23140791e-09]
 [-1.43264609e-06 -1.41297102e-06 -2.52901470e-07 -7.97330875e-09
  -5.23140791e-09  7.24313744e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.32405279e+03],
       [-3.06011105e+03],
       [-3.62217381e+03],
       [-2.99236304e+00],
       [-2.35892774e+00],
       [ 6.42603529e+00]]), 'covar': array([[ 5.48165042e-04,  5.09436804e-04,  1.76304382e-04,
         3.07872464e-06,  1.91223386e-06, -1.43264609e-06],
       [ 5.09436804e-04,  5.42877829e-04,  1.77327240e-04,
         2.83435311e-06,  2.11373448e-06, -1.41297102e-06],
       [ 1.76304382e-04,  1.77327240e-04,  1.18854812e-04,
         9.83704617e-07,  6.73436681e-07, -2.52901470e-07],
       [ 3.07872464e-06,  2.83435311e-06,  9.83704617e-07,
         1.80815346e-08,  1.06140834e-08, -7.97330875e-09],
       [ 1.91223386e-06,  2.11373448e-06,  6.73436681e-07,
         1.06140834e-08,  9.18974473e-09, -5.23140791e-09],
       [-1.43264609e-06, -1.41297102e-06, -2.52901470e-07,
        -7.97330875e-09, -5.23140791e-09,  7.24313744e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.50090713e-06],
       [-1.61334734e-05],
       [ 8.80340244e-02]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.32406766e+03],
       [-3.06011163e+03],
       [-3.62216958e+03],
       [-2.99248792e+00],
       [-2.35891892e+00],
       [ 6.42614121e+00],
       [ 2.28949828e-01],
       [ 3.42623882e-02],
       [ 9.31941315e-01],
       [-2.79093981e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80716481e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.76042417e-03,  5.63290798e-03,  1.74467825e-04,
         3.54983176e-05,  2.38484889e-05, -3.96764480e-05],
       [ 5.63290798e-03,  5.82210406e-03,  1.84099386e-04,
         3.33100372e-05,  2.65982317e-05, -3.96373219e-05],
       [ 1.74467825e-04,  1.84099386e-04,  2.12721278e-04,
         1.37835960e-06,  1.28723109e-06,  2.40506781e-06],
       [ 3.54983176e-05,  3.33100372e-05,  1.37835960e-06,
         2.69849399e-07,  1.50636195e-07, -2.20858180e-07],
       [ 2.38484889e-05,  2.65982317e-05,  1.28723109e-06,
         1.50636195e-07,  1.84563647e-07, -1.49148126e-07],
       [-3.96764480e-05, -3.96373219e-05,  2.40506781e-06,
        -2.20858180e-07, -1.49148126e-07,  3.85970370e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.13519465e-05],
       [-1.99233252e-05],
       [-9.80690961e-02]])}}
Yi [[-2.35471202]
 [ 0.03554083]
 [11.68576154]]
posterior
[[-5.32406766e+03]
 [-3.06011163e+03]
 [-3.62216958e+03]
 [-2.99248792e+00]
 [-2.35891892e+00]
 [ 6.42614121e+00]
 [ 2.28949828e-01]
 [ 3.42623882e-02]
 [ 9.31941315e-01]
 [-2.79093981e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80716481e-18]]
[[-5.32405581e+03]
 [-3.06010318e+03]
 [-3.62216474e+03]
 [-2.99239282e+00]
 [-2.35889310e+00]
 [ 6.42614925e+00]
 [ 2.28949828e-01]
 [ 3.42623882e-02]
 [ 9.31941315e-01]
 [-2.79093981e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80716481e-18]]
[[ 5.47594427e-03  5.37569222e-03  4.59660899e-05  3.34392914e-05
   2.26420696e-05 -3.99001781e-05]
 [ 5.37569222e-03  5.52071159e-03  5.10291248e-05  3.17314002e-05
   2.47601817e-05 -3.99008276e-05]
 [ 4.59660899e-05  5.10291248e-05  1.50527777e-04  5.17705607e-07
   5.58962934e-07  2.28887488e-06]
 [ 3.34392914e-05  3.17314002e-05  5.17705607e-07  2.53782364e-07
   1.44977355e-07 -2.22225953e-07]
 [ 2.26420696e-05  2.47601817e-05  5.58962934e-07  1.44977355e-07
   1.71334666e-07 -1.50761782e-07]
 [-3.99001781e-05 -3.99008276e-05  2.28887488e-06 -2.22225953e-07
  -1.50761782e-07  3.85737938e-07]]
[[-2.35472375]
 [ 0.03552266]
 [11.63503599]]
[[1.17307782e-05]
 [1.81780219e-05]
 [5.07255494e-02]]


 Corrector Step
2018-07-13 08:28:10
[[-5.32405581e+03]
 [-3.06010318e+03]
 [-3.62216474e+03]
 [-2.99239282e+00]
 [-2.35889310e+00]
 [ 6.42614925e+00]
 [ 2.28949828e-01]
 [ 3.42623882e-02]
 [ 9.31941315e-01]
 [-2.79093981e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80716481e-18]]
[[ 5.47594427e-03  5.37569222e-03  4.59660899e-05  3.34392914e-05
   2.26420696e-05 -3.99001781e-05]
 [ 5.37569222e-03  5.52071159e-03  5.10291248e-05  3.17314002e-05
   2.47601817e-05 -3.99008276e-05]
 [ 4.59660899e-05  5.10291248e-05  1.50527777e-04  5.17705607e-07
   5.58962934e-07  2.28887488e-06]
 [ 3.34392914e-05  3.17314002e-05  5.17705607e-07  2.53782364e-07
   1.44977355e-07 -2.22225953e-07]
 [ 2.26420696e-05  2.47601817e-05  5.58962934e-07  1.44977355e-07
   1.71334666e-07 -1.50761782e-07]
 [-3.99001781e-05 -3.99008276e-05  2.28887488e-06 -2.22225953e-07
  -1.50761782e-07  3.85737938e-07]]
521151227.42298895
post
cubesat_nadir
Ybar_post [[-2.35472129]
 [ 0.03552821]
 [11.63500167]]
resids [[9.26472123e-06]
 [1.26271921e-05]
 [5.07598674e-02]]
posterior
[[-5.32405279e+03]
 [-3.06011105e+03]
 [-3.62217381e+03]
 [-2.99236304e+00]
 [-2.35892774e+00]
 [ 6.42603529e+00]]
[[-5.32404644e+03]
 [-3.06010477e+03]
 [-3.62216983e+03]
 [-2.99232757e+00]
 [-2.35890400e+00]
 [ 6.42602526e+00]]
[[ 4.86556318e-04  4.50073917e-04  1.38412705e-04  2.73389933e-06
   1.68915973e-06 -1.33554357e-06]
 [ 4.50073917e-04  4.81271934e-04  1.39241112e-04  2.50381795e-06
   1.87751161e-06 -1.31693889e-06]
 [ 1.38412705e-04  1.39241112e-04  9.49865810e-05  7.72239165e-07
   5.28628829e-07 -1.92296961e-07]
 [ 2.73389933e-06  2.50381795e-06  7.72239165e-07  1.61508687e-08
   9.37383920e-09 -7.43078774e-09]
 [ 1.68915973e-06  1.87751161e-06  5.28628829e-07  9.37383920e-09
   8.27927356e-09 -4.86789326e-09]
 [-1.33554357e-06 -1.31693889e-06 -1.92296961e-07 -7.43078774e-09
  -4.86789326e-09  7.08870862e-09]]
[[-2.35471326]
 [ 0.03551867]
 [11.34466267]]
[[1.24036075e-06]
 [2.21640825e-05]
 [3.41098875e-01]]


 Corrector Step
2018-07-13 08:28:10
[[-5.32404644e+03]
 [-3.06010477e+03]
 [-3.62216983e+03]
 [-2.99232757e+00]
 [-2.35890400e+00]
 [ 6.42602526e+00]]
[[ 4.86556318e-04  4.50073917e-04  1.38412705e-04  2.73389933e-06
   1.68915973e-06 -1.33554357e-06]
 [ 4.50073917e-04  4.81271934e-04  1.39241112e-04  2.50381795e-06
   1.87751161e-06 -1.31693889e-06]
 [ 1.38412705e-04  1.39241112e-04  9.49865810e-05  7.72239165e-07
   5.28628829e-07 -1.92296961e-07]
 [ 2.73389933e-06  2.50381795e-06  7.72239165e-07  1.61508687e-08
   9.37383920e-09 -7.43078774e-09]
 [ 1.68915973e-06  1.87751161e-06  5.28628829e-07  9.37383920e-09
   8.27927356e-09 -4.86789326e-09]
 [-1.33554357e-06 -1.31693889e-06 -1.92296961e-07 -7.43078774e-09
  -4.86789326e-09  7.08870862e-09]]
1988729.9465689182
post
sphere_lamr_small
Ybar_post [[-2.35471322]
 [ 0.03552313]
 [11.34464573]]
resids [[1.20289227e-06]
 [1.77089824e-05]
 [3.41115810e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [521151227.42298895, 1988729.9465689182]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.32405581e+03],
       [-3.06010318e+03],
       [-3.62216474e+03],
       [-2.99239282e+00],
       [-2.35889310e+00],
       [ 6.42614925e+00]]), 'est_covars': array([[ 5.47594427e-03,  5.37569222e-03,  4.59660899e-05,
         3.34392914e-05,  2.26420696e-05, -3.99001781e-05],
       [ 5.37569222e-03,  5.52071159e-03,  5.10291248e-05,
         3.17314002e-05,  2.47601817e-05, -3.99008276e-05],
       [ 4.59660899e-05,  5.10291248e-05,  1.50527777e-04,
         5.17705607e-07,  5.58962934e-07,  2.28887488e-06],
       [ 3.34392914e-05,  3.17314002e-05,  5.17705607e-07,
         2.53782364e-07,  1.44977355e-07, -2.22225953e-07],
       [ 2.26420696e-05,  2.47601817e-05,  5.58962934e-07,
         1.44977355e-07,  1.71334666e-07, -1.50761782e-07],
       [-3.99001781e-05, -3.99008276e-05,  2.28887488e-06,
        -2.22225953e-07, -1.50761782e-07,  3.85737938e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.32404644e+03],
       [-3.06010477e+03],
       [-3.62216983e+03],
       [-2.99232757e+00],
       [-2.35890400e+00],
       [ 6.42602526e+00]]), 'covar': array([[ 4.86556318e-04,  4.50073917e-04,  1.38412705e-04,
         2.73389933e-06,  1.68915973e-06, -1.33554357e-06],
       [ 4.50073917e-04,  4.81271934e-04,  1.39241112e-04,
         2.50381795e-06,  1.87751161e-06, -1.31693889e-06],
       [ 1.38412705e-04,  1.39241112e-04,  9.49865810e-05,
         7.72239165e-07,  5.28628829e-07, -1.92296961e-07],
       [ 2.73389933e-06,  2.50381795e-06,  7.72239165e-07,
         1.61508687e-08,  9.37383920e-09, -7.43078774e-09],
       [ 1.68915973e-06,  1.87751161e-06,  5.28628829e-07,
         9.37383920e-09,  8.27927356e-09, -4.86789326e-09],
       [-1.33554357e-06, -1.31693889e-06, -1.92296961e-07,
        -7.43078774e-09, -4.86789326e-09,  7.08870862e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[1.20289227e-06],
       [1.77089824e-05],
       [3.41115810e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.32405581e+03],
       [-3.06010318e+03],
       [-3.62216474e+03],
       [-2.99239282e+00],
       [-2.35889310e+00],
       [ 6.42614925e+00],
       [ 2.28949828e-01],
       [ 3.42623882e-02],
       [ 9.31941315e-01],
       [-2.79093981e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80716481e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.47594427e-03,  5.37569222e-03,  4.59660899e-05,
         3.34392914e-05,  2.26420696e-05, -3.99001781e-05],
       [ 5.37569222e-03,  5.52071159e-03,  5.10291248e-05,
         3.17314002e-05,  2.47601817e-05, -3.99008276e-05],
       [ 4.59660899e-05,  5.10291248e-05,  1.50527777e-04,
         5.17705607e-07,  5.58962934e-07,  2.28887488e-06],
       [ 3.34392914e-05,  3.17314002e-05,  5.17705607e-07,
         2.53782364e-07,  1.44977355e-07, -2.22225953e-07],
       [ 2.26420696e-05,  2.47601817e-05,  5.58962934e-07,
         1.44977355e-07,  1.71334666e-07, -1.50761782e-07],
       [-3.99001781e-05, -3.99008276e-05,  2.28887488e-06,
        -2.22225953e-07, -1.50761782e-07,  3.85737938e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[9.26472123e-06],
       [1.26271921e-05],
       [5.07598674e-02]])}}
Current time:  2018-07-13 08:28:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.32405581e+03],
       [-3.06010318e+03],
       [-3.62216474e+03],
       [-2.99239282e+00],
       [-2.35889310e+00],
       [ 6.42614925e+00],
       [ 2.28949828e-01],
       [ 3.42623882e-02],
       [ 9.31941315e-01],
       [-2.79093981e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80716481e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.47594427e-03,  5.37569222e-03,  4.59660899e-05,
         3.34392914e-05,  2.26420696e-05, -3.99001781e-05],
       [ 5.37569222e-03,  5.52071159e-03,  5.10291248e-05,
         3.17314002e-05,  2.47601817e-05, -3.99008276e-05],
       [ 4.59660899e-05,  5.10291248e-05,  1.50527777e-04,
         5.17705607e-07,  5.58962934e-07,  2.28887488e-06],
       [ 3.34392914e-05,  3.17314002e-05,  5.17705607e-07,
         2.53782364e-07,  1.44977355e-07, -2.22225953e-07],
       [ 2.26420696e-05,  2.47601817e-05,  5.58962934e-07,
         1.44977355e-07,  1.71334666e-07, -1.50761782e-07],
       [-3.99001781e-05, -3.99008276e-05,  2.28887488e-06,
        -2.22225953e-07, -1.50761782e-07,  3.85737938e-07]])}
[[-5.32405581e+03]
 [-3.06010318e+03]
 [-3.62216474e+03]
 [-2.99239282e+00]
 [-2.35889310e+00]
 [ 6.42614925e+00]
 [ 2.28949828e-01]
 [ 3.42623882e-02]
 [ 9.31941315e-01]
 [-2.79093981e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80716481e-18]]
2018-07-13 08:28:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:20
[[-5.35368634e+03]
 [-3.08352348e+03]
 [-3.55770473e+03]
 [-2.93368746e+00]
 [-2.32511598e+00]
 [ 6.46572612e+00]
 [ 2.33812665e-01]
 [ 3.57191582e-02]
 [ 9.30733193e-01]
 [-2.78911282e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80737710e-18]]
[[ 6.17141077e-03  5.93460694e-03 -3.69505844e-04  3.61347271e-05
   2.41282195e-05 -4.20089780e-05]
 [ 5.93460694e-03  6.03361397e-03 -3.56905289e-04  3.32861946e-05
   2.65555875e-05 -4.12947593e-05]
 [-3.69505844e-04 -3.56905289e-04  2.35063033e-04 -1.70514363e-06
  -9.46958426e-07  6.18464292e-06]
 [ 3.61347271e-05  3.32861946e-05 -1.70514363e-06  2.64978744e-07
   1.45628991e-07 -2.22242744e-07]
 [ 2.41282195e-05  2.65555875e-05 -9.46958426e-07  1.45628991e-07
   1.81578925e-07 -1.50492556e-07]
 [-4.20089780e-05 -4.12947593e-05  6.18464292e-06 -2.22242744e-07
  -1.50492556e-07  3.94111116e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.32404644e+03],
       [-3.06010477e+03],
       [-3.62216983e+03],
       [-2.99232757e+00],
       [-2.35890400e+00],
       [ 6.42602526e+00]]), 'covar': array([[ 4.86556318e-04,  4.50073917e-04,  1.38412705e-04,
         2.73389933e-06,  1.68915973e-06, -1.33554357e-06],
       [ 4.50073917e-04,  4.81271934e-04,  1.39241112e-04,
         2.50381795e-06,  1.87751161e-06, -1.31693889e-06],
       [ 1.38412705e-04,  1.39241112e-04,  9.49865810e-05,
         7.72239165e-07,  5.28628829e-07, -1.92296961e-07],
       [ 2.73389933e-06,  2.50381795e-06,  7.72239165e-07,
         1.61508687e-08,  9.37383920e-09, -7.43078774e-09],
       [ 1.68915973e-06,  1.87751161e-06,  5.28628829e-07,
         9.37383920e-09,  8.27927356e-09, -4.86789326e-09],
       [-1.33554357e-06, -1.31693889e-06, -1.92296961e-07,
        -7.43078774e-09, -4.86789326e-09,  7.08870862e-09]])}
[[-5.32404644e+03]
 [-3.06010477e+03]
 [-3.62216983e+03]
 [-2.99232757e+00]
 [-2.35890400e+00]
 [ 6.42602526e+00]]
2018-07-13 08:28:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:20
[[-5.35367658e+03]
 [-3.08352508e+03]
 [-3.55771111e+03]
 [-2.93362212e+00]
 [-2.32512677e+00]
 [ 6.46560202e+00]]
[[ 5.43000920e-04  4.92983874e-04  1.32095403e-04  2.90699028e-06
   1.78735009e-06 -1.40015723e-06]
 [ 4.92983874e-04  5.19711576e-04  1.30928642e-04  2.60842651e-06
   1.96447027e-06 -1.35646500e-06]
 [ 1.32095403e-04  1.30928642e-04  9.18751530e-05  7.01675408e-07
   4.81523100e-07 -1.18773614e-07]
 [ 2.90699028e-06  2.60842651e-06  7.01675408e-07  1.63658181e-08
   9.43635435e-09 -7.40566683e-09]
 [ 1.78735009e-06  1.96447027e-06  4.81523100e-07  9.43635435e-09
   8.40473529e-09 -4.84286940e-09]
 [-1.40015723e-06 -1.35646500e-06 -1.18773614e-07 -7.40566683e-09
  -4.84286940e-09  7.13654072e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.35367658e+03],
       [-3.08352508e+03],
       [-3.55771111e+03],
       [-2.93362212e+00],
       [-2.32512677e+00],
       [ 6.46560202e+00]]), 'covar': array([[ 5.43000920e-04,  4.92983874e-04,  1.32095403e-04,
         2.90699028e-06,  1.78735009e-06, -1.40015723e-06],
       [ 4.92983874e-04,  5.19711576e-04,  1.30928642e-04,
         2.60842651e-06,  1.96447027e-06, -1.35646500e-06],
       [ 1.32095403e-04,  1.30928642e-04,  9.18751530e-05,
         7.01675408e-07,  4.81523100e-07, -1.18773614e-07],
       [ 2.90699028e-06,  2.60842651e-06,  7.01675408e-07,
         1.63658181e-08,  9.43635435e-09, -7.40566683e-09],
       [ 1.78735009e-06,  1.96447027e-06,  4.81523100e-07,
         9.43635435e-09,  8.40473529e-09, -4.84286940e-09],
       [-1.40015723e-06, -1.35646500e-06, -1.18773614e-07,
        -7.40566683e-09, -4.84286940e-09,  7.13654072e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[1.20289227e-06],
       [1.77089824e-05],
       [3.41115810e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.35368634e+03],
       [-3.08352348e+03],
       [-3.55770473e+03],
       [-2.93368746e+00],
       [-2.32511598e+00],
       [ 6.46572612e+00],
       [ 2.33812665e-01],
       [ 3.57191582e-02],
       [ 9.30733193e-01],
       [-2.78911282e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80737710e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.17141077e-03,  5.93460694e-03, -3.69505844e-04,
         3.61347271e-05,  2.41282195e-05, -4.20089780e-05],
       [ 5.93460694e-03,  6.03361397e-03, -3.56905289e-04,
         3.32861946e-05,  2.65555875e-05, -4.12947593e-05],
       [-3.69505844e-04, -3.56905289e-04,  2.35063033e-04,
        -1.70514363e-06, -9.46958426e-07,  6.18464292e-06],
       [ 3.61347271e-05,  3.32861946e-05, -1.70514363e-06,
         2.64978744e-07,  1.45628991e-07, -2.22242744e-07],
       [ 2.41282195e-05,  2.65555875e-05, -9.46958426e-07,
         1.45628991e-07,  1.81578925e-07, -1.50492556e-07],
       [-4.20089780e-05, -4.12947593e-05,  6.18464292e-06,
        -2.22242744e-07, -1.50492556e-07,  3.94111116e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[9.26472123e-06],
       [1.26271921e-05],
       [5.07598674e-02]])}}
Yi [[-2.36278735]
 [ 0.09846588]
 [12.024736  ]]
posterior
[[-5.35368634e+03]
 [-3.08352348e+03]
 [-3.55770473e+03]
 [-2.93368746e+00]
 [-2.32511598e+00]
 [ 6.46572612e+00]
 [ 2.33812665e-01]
 [ 3.57191582e-02]
 [ 9.30733193e-01]
 [-2.78911282e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80737710e-18]]
[[-5.35368689e+03]
 [-3.08352611e+03]
 [-3.55770525e+03]
 [-2.93368237e+00]
 [-2.32514114e+00]
 [ 6.46572601e+00]
 [ 2.33812665e-01]
 [ 3.57191582e-02]
 [ 9.30733193e-01]
 [-2.78911282e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80737710e-18]]
[[ 5.88676047e-03  5.68436956e-03 -4.72292765e-04  3.41091885e-05
   2.29674939e-05 -4.21965103e-05]
 [ 5.68436956e-03  5.74339104e-03 -4.61598854e-04  3.17887321e-05
   2.47789203e-05 -4.15191786e-05]
 [-4.72292765e-04 -4.61598854e-04  1.95015092e-04 -2.37878724e-06
  -1.52043918e-06  6.10465410e-06]
 [ 3.41091885e-05  3.17887321e-05 -2.37878724e-06  2.49423371e-07
   1.40418615e-07 -2.23337312e-07]
 [ 2.29674939e-05  2.47789203e-05 -1.52043918e-06  1.40418615e-07
   1.68702874e-07 -1.51898826e-07]
 [-4.21965103e-05 -4.15191786e-05  6.10465410e-06 -2.23337312e-07
  -1.51898826e-07  3.93935046e-07]]
[[-2.36279407]
 [ 0.09846818]
 [11.87885594]]
[[ 6.72254522e-06]
 [-2.30688520e-06]
 [ 1.45880060e-01]]


 Corrector Step
2018-07-13 08:28:20
[[-5.35368689e+03]
 [-3.08352611e+03]
 [-3.55770525e+03]
 [-2.93368237e+00]
 [-2.32514114e+00]
 [ 6.46572601e+00]
 [ 2.33812665e-01]
 [ 3.57191582e-02]
 [ 9.30733193e-01]
 [-2.78911282e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80737710e-18]]
[[ 5.88676047e-03  5.68436956e-03 -4.72292765e-04  3.41091885e-05
   2.29674939e-05 -4.21965103e-05]
 [ 5.68436956e-03  5.74339104e-03 -4.61598854e-04  3.17887321e-05
   2.47789203e-05 -4.15191786e-05]
 [-4.72292765e-04 -4.61598854e-04  1.95015092e-04 -2.37878724e-06
  -1.52043918e-06  6.10465410e-06]
 [ 3.41091885e-05  3.17887321e-05 -2.37878724e-06  2.49423371e-07
   1.40418615e-07 -2.23337312e-07]
 [ 2.29674939e-05  2.47789203e-05 -1.52043918e-06  1.40418615e-07
   1.68702874e-07 -1.51898826e-07]
 [-4.21965103e-05 -4.15191786e-05  6.10465410e-06 -2.23337312e-07
  -1.51898826e-07  3.93935046e-07]]
266979294.0109056
post
cubesat_nadir
Ybar_post [[-2.3627926 ]
 [ 0.09846745]
 [11.87885101]]
resids [[ 5.24776958e-06]
 [-1.57580970e-06]
 [ 1.45884990e-01]]
posterior
[[-5.35367658e+03]
 [-3.08352508e+03]
 [-3.55771111e+03]
 [-2.93362212e+00]
 [-2.32512677e+00]
 [ 6.46560202e+00]]
[[-5.35367576e+03]
 [-3.08352414e+03]
 [-3.55771060e+03]
 [-2.93361777e+00]
 [-2.32512322e+00]
 [ 6.46560080e+00]]
[[ 4.84726927e-04  4.38141157e-04  1.01500388e-04  2.59606825e-06
   1.58786027e-06 -1.31281979e-06]
 [ 4.38141157e-04  4.63592738e-04  1.00721007e-04  2.31774553e-06
   1.75544995e-06 -1.27188472e-06]
 [ 1.01500388e-04  1.00721007e-04  7.53682853e-05  5.39041947e-07
   3.70108730e-07 -7.21710687e-08]
 [ 2.59606825e-06  2.31774553e-06  5.39041947e-07  1.47060579e-08
   8.38110317e-09 -6.94069993e-09]
 [ 1.58786027e-06  1.75544995e-06  3.70108730e-07  8.38110317e-09
   7.62133914e-09 -4.53262112e-09]
 [-1.31281979e-06 -1.27188472e-06 -7.21710687e-08 -6.94069993e-09
  -4.53262112e-09  7.00438148e-09]]
[[-2.36278605]
 [ 0.09846243]
 [11.47618842]]
[[-1.29427950e-06]
 [ 3.44123773e-06]
 [ 5.48547582e-01]]


 Corrector Step
2018-07-13 08:28:20
[[-5.35367576e+03]
 [-3.08352414e+03]
 [-3.55771060e+03]
 [-2.93361777e+00]
 [-2.32512322e+00]
 [ 6.46560080e+00]]
[[ 4.84726927e-04  4.38141157e-04  1.01500388e-04  2.59606825e-06
   1.58786027e-06 -1.31281979e-06]
 [ 4.38141157e-04  4.63592738e-04  1.00721007e-04  2.31774553e-06
   1.75544995e-06 -1.27188472e-06]
 [ 1.01500388e-04  1.00721007e-04  7.53682853e-05  5.39041947e-07
   3.70108730e-07 -7.21710687e-08]
 [ 2.59606825e-06  2.31774553e-06  5.39041947e-07  1.47060579e-08
   8.38110317e-09 -6.94069993e-09]
 [ 1.58786027e-06  1.75544995e-06  3.70108730e-07  8.38110317e-09
   7.62133914e-09 -4.53262112e-09]
 [-1.31281979e-06 -1.27188472e-06 -7.21710687e-08 -6.94069993e-09
  -4.53262112e-09  7.00438148e-09]]
273.1347841177548
post
sphere_lamr_small
Ybar_post [[-2.36278617]
 [ 0.09846306]
 [11.47618623]]
resids [[-1.17826711e-06]
 [ 2.81679931e-06]
 [ 5.48549775e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [266979294.0109056, 273.1347841177548]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.35368689e+03],
       [-3.08352611e+03],
       [-3.55770525e+03],
       [-2.93368237e+00],
       [-2.32514114e+00],
       [ 6.46572601e+00]]), 'est_covars': array([[ 5.88676047e-03,  5.68436956e-03, -4.72292765e-04,
         3.41091885e-05,  2.29674939e-05, -4.21965103e-05],
       [ 5.68436956e-03,  5.74339104e-03, -4.61598854e-04,
         3.17887321e-05,  2.47789203e-05, -4.15191786e-05],
       [-4.72292765e-04, -4.61598854e-04,  1.95015092e-04,
        -2.37878724e-06, -1.52043918e-06,  6.10465410e-06],
       [ 3.41091885e-05,  3.17887321e-05, -2.37878724e-06,
         2.49423371e-07,  1.40418615e-07, -2.23337312e-07],
       [ 2.29674939e-05,  2.47789203e-05, -1.52043918e-06,
         1.40418615e-07,  1.68702874e-07, -1.51898826e-07],
       [-4.21965103e-05, -4.15191786e-05,  6.10465410e-06,
        -2.23337312e-07, -1.51898826e-07,  3.93935046e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.35367576e+03],
       [-3.08352414e+03],
       [-3.55771060e+03],
       [-2.93361777e+00],
       [-2.32512322e+00],
       [ 6.46560080e+00]]), 'covar': array([[ 4.84726927e-04,  4.38141157e-04,  1.01500388e-04,
         2.59606825e-06,  1.58786027e-06, -1.31281979e-06],
       [ 4.38141157e-04,  4.63592738e-04,  1.00721007e-04,
         2.31774553e-06,  1.75544995e-06, -1.27188472e-06],
       [ 1.01500388e-04,  1.00721007e-04,  7.53682853e-05,
         5.39041947e-07,  3.70108730e-07, -7.21710687e-08],
       [ 2.59606825e-06,  2.31774553e-06,  5.39041947e-07,
         1.47060579e-08,  8.38110317e-09, -6.94069993e-09],
       [ 1.58786027e-06,  1.75544995e-06,  3.70108730e-07,
         8.38110317e-09,  7.62133914e-09, -4.53262112e-09],
       [-1.31281979e-06, -1.27188472e-06, -7.21710687e-08,
        -6.94069993e-09, -4.53262112e-09,  7.00438148e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.17826711e-06],
       [ 2.81679931e-06],
       [ 5.48549775e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.35368689e+03],
       [-3.08352611e+03],
       [-3.55770525e+03],
       [-2.93368237e+00],
       [-2.32514114e+00],
       [ 6.46572601e+00],
       [ 2.33812665e-01],
       [ 3.57191582e-02],
       [ 9.30733193e-01],
       [-2.78911282e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80737710e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.88676047e-03,  5.68436956e-03, -4.72292765e-04,
         3.41091885e-05,  2.29674939e-05, -4.21965103e-05],
       [ 5.68436956e-03,  5.74339104e-03, -4.61598854e-04,
         3.17887321e-05,  2.47789203e-05, -4.15191786e-05],
       [-4.72292765e-04, -4.61598854e-04,  1.95015092e-04,
        -2.37878724e-06, -1.52043918e-06,  6.10465410e-06],
       [ 3.41091885e-05,  3.17887321e-05, -2.37878724e-06,
         2.49423371e-07,  1.40418615e-07, -2.23337312e-07],
       [ 2.29674939e-05,  2.47789203e-05, -1.52043918e-06,
         1.40418615e-07,  1.68702874e-07, -1.51898826e-07],
       [-4.21965103e-05, -4.15191786e-05,  6.10465410e-06,
        -2.23337312e-07, -1.51898826e-07,  3.93935046e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 5.24776958e-06],
       [-1.57580970e-06],
       [ 1.45884990e-01]])}}
Current time:  2018-07-13 08:28:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.35368689e+03],
       [-3.08352611e+03],
       [-3.55770525e+03],
       [-2.93368237e+00],
       [-2.32514114e+00],
       [ 6.46572601e+00],
       [ 2.33812665e-01],
       [ 3.57191582e-02],
       [ 9.30733193e-01],
       [-2.78911282e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80737710e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.88676047e-03,  5.68436956e-03, -4.72292765e-04,
         3.41091885e-05,  2.29674939e-05, -4.21965103e-05],
       [ 5.68436956e-03,  5.74339104e-03, -4.61598854e-04,
         3.17887321e-05,  2.47789203e-05, -4.15191786e-05],
       [-4.72292765e-04, -4.61598854e-04,  1.95015092e-04,
        -2.37878724e-06, -1.52043918e-06,  6.10465410e-06],
       [ 3.41091885e-05,  3.17887321e-05, -2.37878724e-06,
         2.49423371e-07,  1.40418615e-07, -2.23337312e-07],
       [ 2.29674939e-05,  2.47789203e-05, -1.52043918e-06,
         1.40418615e-07,  1.68702874e-07, -1.51898826e-07],
       [-4.21965103e-05, -4.15191786e-05,  6.10465410e-06,
        -2.23337312e-07, -1.51898826e-07,  3.93935046e-07]])}
[[-5.35368689e+03]
 [-3.08352611e+03]
 [-3.55770525e+03]
 [-2.93368237e+00]
 [-2.32514114e+00]
 [ 6.46572601e+00]
 [ 2.33812665e-01]
 [ 3.57191582e-02]
 [ 9.30733193e-01]
 [-2.78911282e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80737710e-18]]
2018-07-13 08:28:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:30
[[-5.38272872e+03]
 [-3.10660743e+03]
 [-3.49285310e+03]
 [-2.87464659e+00]
 [-2.29110376e+00]
 [ 6.50459518e+00]
 [ 2.38669127e-01]
 [ 3.71749545e-02]
 [ 9.29499697e-01]
 [-2.78720979e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80758938e-18]]
[[ 6.59522565e-03  6.24670762e-03 -9.39842776e-04  3.67627117e-05
   2.44084718e-05 -4.43087856e-05]
 [ 6.24670762e-03  6.25646393e-03 -9.06629113e-04  3.32980906e-05
   2.65478135e-05 -4.29188557e-05]
 [-9.39842776e-04 -9.06629113e-04  3.56577251e-04 -4.62168658e-06
  -3.04048767e-06  1.00712684e-05]
 [ 3.67627117e-05  3.32980906e-05 -4.62168658e-06  2.60582656e-07
   1.41049626e-07 -2.23347583e-07]
 [ 2.44084718e-05  2.65478135e-05 -3.04048767e-06  1.41049626e-07
   1.78935405e-07 -1.51624787e-07]
 [-4.43087856e-05 -4.29188557e-05  1.00712684e-05 -2.23347583e-07
  -1.51624787e-07  4.02222476e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.35367576e+03],
       [-3.08352414e+03],
       [-3.55771060e+03],
       [-2.93361777e+00],
       [-2.32512322e+00],
       [ 6.46560080e+00]]), 'covar': array([[ 4.84726927e-04,  4.38141157e-04,  1.01500388e-04,
         2.59606825e-06,  1.58786027e-06, -1.31281979e-06],
       [ 4.38141157e-04,  4.63592738e-04,  1.00721007e-04,
         2.31774553e-06,  1.75544995e-06, -1.27188472e-06],
       [ 1.01500388e-04,  1.00721007e-04,  7.53682853e-05,
         5.39041947e-07,  3.70108730e-07, -7.21710687e-08],
       [ 2.59606825e-06,  2.31774553e-06,  5.39041947e-07,
         1.47060579e-08,  8.38110317e-09, -6.94069993e-09],
       [ 1.58786027e-06,  1.75544995e-06,  3.70108730e-07,
         8.38110317e-09,  7.62133914e-09, -4.53262112e-09],
       [-1.31281979e-06, -1.27188472e-06, -7.21710687e-08,
        -6.94069993e-09, -4.53262112e-09,  7.00438148e-09]])}
[[-5.35367576e+03]
 [-3.08352414e+03]
 [-3.55771060e+03]
 [-2.93361777e+00]
 [-2.32512322e+00]
 [ 6.46560080e+00]]
2018-07-13 08:28:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:30
[[-5.38271700e+03]
 [-3.10660524e+03]
 [-3.49285954e+03]
 [-2.87458176e+00]
 [-2.29108572e+00]
 [ 6.50447029e+00]]
[[ 5.38234259e-04  4.78142128e-04  9.31550575e-05  2.75425316e-06
   1.67597295e-06 -1.37285428e-06]
 [ 4.78142128e-04  4.99581670e-04  9.13671560e-05  2.41182695e-06
   1.83561389e-06 -1.30836107e-06]
 [ 9.31550575e-05  9.13671560e-05  7.46964018e-05  4.72536141e-07
   3.26039553e-07 -2.52009019e-10]
 [ 2.75425316e-06  2.41182695e-06  4.72536141e-07  1.49106989e-08
   8.43839120e-09 -6.91713536e-09]
 [ 1.67597295e-06  1.83561389e-06  3.26039553e-07  8.43839120e-09
   7.74426412e-09 -4.50933277e-09]
 [-1.37285428e-06 -1.30836107e-06 -2.52009019e-10 -6.91713536e-09
  -4.50933277e-09  7.05318179e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.38271700e+03],
       [-3.10660524e+03],
       [-3.49285954e+03],
       [-2.87458176e+00],
       [-2.29108572e+00],
       [ 6.50447029e+00]]), 'covar': array([[ 5.38234259e-04,  4.78142128e-04,  9.31550575e-05,
         2.75425316e-06,  1.67597295e-06, -1.37285428e-06],
       [ 4.78142128e-04,  4.99581670e-04,  9.13671560e-05,
         2.41182695e-06,  1.83561389e-06, -1.30836107e-06],
       [ 9.31550575e-05,  9.13671560e-05,  7.46964018e-05,
         4.72536141e-07,  3.26039553e-07, -2.52009019e-10],
       [ 2.75425316e-06,  2.41182695e-06,  4.72536141e-07,
         1.49106989e-08,  8.43839120e-09, -6.91713536e-09],
       [ 1.67597295e-06,  1.83561389e-06,  3.26039553e-07,
         8.43839120e-09,  7.74426412e-09, -4.50933277e-09],
       [-1.37285428e-06, -1.30836107e-06, -2.52009019e-10,
        -6.91713536e-09, -4.50933277e-09,  7.05318179e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.17826711e-06],
       [ 2.81679931e-06],
       [ 5.48549775e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.38272872e+03],
       [-3.10660743e+03],
       [-3.49285310e+03],
       [-2.87464659e+00],
       [-2.29110376e+00],
       [ 6.50459518e+00],
       [ 2.38669127e-01],
       [ 3.71749545e-02],
       [ 9.29499697e-01],
       [-2.78720979e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80758938e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.59522565e-03,  6.24670762e-03, -9.39842776e-04,
         3.67627117e-05,  2.44084718e-05, -4.43087856e-05],
       [ 6.24670762e-03,  6.25646393e-03, -9.06629113e-04,
         3.32980906e-05,  2.65478135e-05, -4.29188557e-05],
       [-9.39842776e-04, -9.06629113e-04,  3.56577251e-04,
        -4.62168658e-06, -3.04048767e-06,  1.00712684e-05],
       [ 3.67627117e-05,  3.32980906e-05, -4.62168658e-06,
         2.60582656e-07,  1.41049626e-07, -2.23347583e-07],
       [ 2.44084718e-05,  2.65478135e-05, -3.04048767e-06,
         1.41049626e-07,  1.78935405e-07, -1.51624787e-07],
       [-4.43087856e-05, -4.29188557e-05,  1.00712684e-05,
        -2.23347583e-07, -1.51624787e-07,  4.02222476e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 5.24776958e-06],
       [-1.57580970e-06],
       [ 1.45884990e-01]])}}
Yi [[-2.37009846]
 [ 0.15676676]
 [12.15584627]]
posterior
[[-5.38272872e+03]
 [-3.10660743e+03]
 [-3.49285310e+03]
 [-2.87464659e+00]
 [-2.29110376e+00]
 [ 6.50459518e+00]
 [ 2.38669127e-01]
 [ 3.71749545e-02]
 [ 9.29499697e-01]
 [-2.78720979e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80758938e-18]]
[[-5.38271900e+03]
 [-3.10661006e+03]
 [-3.49285218e+03]
 [-2.87453512e+00]
 [-2.29118252e+00]
 [ 6.50459195e+00]
 [ 2.38669127e-01]
 [ 3.71749545e-02]
 [ 9.29499697e-01]
 [-2.78720979e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80758938e-18]]
[[ 6.30954098e-03  6.00200999e-03 -1.02000892e-03  3.47612866e-05
   2.32868318e-05 -4.44629932e-05]
 [ 6.00200999e-03  5.97515472e-03 -9.87280187e-04  3.18671073e-05
   2.48213815e-05 -4.31087216e-05]
 [-1.02000892e-03 -9.87280187e-04  3.32071335e-04 -5.13597734e-06
  -3.48322548e-06  1.00182191e-05]
 [ 3.47612866e-05  3.18671073e-05 -5.13597734e-06  2.45442127e-07
   1.36216377e-07 -2.24199961e-07]
 [ 2.32868318e-05  2.48213815e-05 -3.48322548e-06  1.36216377e-07
   1.66356350e-07 -1.52847479e-07]
 [-4.44629932e-05 -4.31087216e-05  1.00182191e-05 -2.24199961e-07
  -1.52847479e-07  4.02090679e-07]]
[[-2.3701368 ]
 [ 0.15676027]
 [12.13150024]]
[[3.83338131e-05]
 [6.49044221e-06]
 [2.43460217e-02]]


 Corrector Step
2018-07-13 08:28:30
[[-5.38271900e+03]
 [-3.10661006e+03]
 [-3.49285218e+03]
 [-2.87453512e+00]
 [-2.29118252e+00]
 [ 6.50459195e+00]
 [ 2.38669127e-01]
 [ 3.71749545e-02]
 [ 9.29499697e-01]
 [-2.78720979e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80758938e-18]]
[[ 6.30954098e-03  6.00200999e-03 -1.02000892e-03  3.47612866e-05
   2.32868318e-05 -4.44629932e-05]
 [ 6.00200999e-03  5.97515472e-03 -9.87280187e-04  3.18671073e-05
   2.48213815e-05 -4.31087216e-05]
 [-1.02000892e-03 -9.87280187e-04  3.32071335e-04 -5.13597734e-06
  -3.48322548e-06  1.00182191e-05]
 [ 3.47612866e-05  3.18671073e-05 -5.13597734e-06  2.45442127e-07
   1.36216377e-07 -2.24199961e-07]
 [ 2.32868318e-05  2.48213815e-05 -3.48322548e-06  1.36216377e-07
   1.66356350e-07 -1.52847479e-07]
 [-4.44629932e-05 -4.31087216e-05  1.00182191e-05 -2.24199961e-07
  -1.52847479e-07  4.02090679e-07]]
287573457.28534335
post
cubesat_nadir
Ybar_post [[-2.37012843]
 [ 0.15676191]
 [12.13143927]]
resids [[2.99673463e-05]
 [4.85682112e-06]
 [2.44069987e-02]]
posterior
[[-5.38271700e+03]
 [-3.10660524e+03]
 [-3.49285954e+03]
 [-2.87458176e+00]
 [-2.29108572e+00]
 [ 6.50447029e+00]]
[[-5.38271244e+03]
 [-3.10660359e+03]
 [-3.49285818e+03]
 [-2.87455729e+00]
 [-2.29108269e+00]
 [ 6.50446515e+00]]
[[ 4.83306350e-04  4.27591837e-04  6.85913508e-05  2.47403050e-06
   1.49782102e-06 -1.29453862e-06]
 [ 4.27591837e-04  4.48462067e-04  6.74933329e-05  2.15608519e-06
   1.65040162e-06 -1.23400637e-06]
 [ 6.85913508e-05  6.74933329e-05  6.33619631e-05  3.47813052e-07
   2.40508718e-07  3.53994159e-08]
 [ 2.47403050e-06  2.15608519e-06  3.47813052e-07  1.34800992e-08
   7.53945378e-09 -6.51866201e-09]
 [ 1.49782102e-06  1.65040162e-06  2.40508718e-07  7.53945378e-09
   7.06816313e-09 -4.24478138e-09]
 [-1.29453862e-06 -1.23400637e-06  3.53994159e-08 -6.51866201e-09
  -4.24478138e-09  6.94038861e-09]]
[[-2.37013036]
 [ 0.15675567]
 [11.60966253]]
[[3.18965115e-05]
 [1.10893131e-05]
 [5.46183733e-01]]


 Corrector Step
2018-07-13 08:28:30
[[-5.38271244e+03]
 [-3.10660359e+03]
 [-3.49285818e+03]
 [-2.87455729e+00]
 [-2.29108269e+00]
 [ 6.50446515e+00]]
[[ 4.83306350e-04  4.27591837e-04  6.85913508e-05  2.47403050e-06
   1.49782102e-06 -1.29453862e-06]
 [ 4.27591837e-04  4.48462067e-04  6.74933329e-05  2.15608519e-06
   1.65040162e-06 -1.23400637e-06]
 [ 6.85913508e-05  6.74933329e-05  6.33619631e-05  3.47813052e-07
   2.40508718e-07  3.53994159e-08]
 [ 2.47403050e-06  2.15608519e-06  3.47813052e-07  1.34800992e-08
   7.53945378e-09 -6.51866201e-09]
 [ 1.49782102e-06  1.65040162e-06  2.40508718e-07  7.53945378e-09
   7.06816313e-09 -4.24478138e-09]
 [-1.29453862e-06 -1.23400637e-06  3.53994159e-08 -6.51866201e-09
  -4.24478138e-09  6.94038861e-09]]
128.66433034689297
post
sphere_lamr_small
Ybar_post [[-2.37012849]
 [ 0.15675762]
 [11.60965337]]
resids [[3.00280283e-05]
 [9.13928041e-06]
 [5.46192898e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [287573457.28534335, 128.66433034689297]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.38271900e+03],
       [-3.10661006e+03],
       [-3.49285218e+03],
       [-2.87453512e+00],
       [-2.29118252e+00],
       [ 6.50459195e+00]]), 'est_covars': array([[ 6.30954098e-03,  6.00200999e-03, -1.02000892e-03,
         3.47612866e-05,  2.32868318e-05, -4.44629932e-05],
       [ 6.00200999e-03,  5.97515472e-03, -9.87280187e-04,
         3.18671073e-05,  2.48213815e-05, -4.31087216e-05],
       [-1.02000892e-03, -9.87280187e-04,  3.32071335e-04,
        -5.13597734e-06, -3.48322548e-06,  1.00182191e-05],
       [ 3.47612866e-05,  3.18671073e-05, -5.13597734e-06,
         2.45442127e-07,  1.36216377e-07, -2.24199961e-07],
       [ 2.32868318e-05,  2.48213815e-05, -3.48322548e-06,
         1.36216377e-07,  1.66356350e-07, -1.52847479e-07],
       [-4.44629932e-05, -4.31087216e-05,  1.00182191e-05,
        -2.24199961e-07, -1.52847479e-07,  4.02090679e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.38271244e+03],
       [-3.10660359e+03],
       [-3.49285818e+03],
       [-2.87455729e+00],
       [-2.29108269e+00],
       [ 6.50446515e+00]]), 'covar': array([[ 4.83306350e-04,  4.27591837e-04,  6.85913508e-05,
         2.47403050e-06,  1.49782102e-06, -1.29453862e-06],
       [ 4.27591837e-04,  4.48462067e-04,  6.74933329e-05,
         2.15608519e-06,  1.65040162e-06, -1.23400637e-06],
       [ 6.85913508e-05,  6.74933329e-05,  6.33619631e-05,
         3.47813052e-07,  2.40508718e-07,  3.53994159e-08],
       [ 2.47403050e-06,  2.15608519e-06,  3.47813052e-07,
         1.34800992e-08,  7.53945378e-09, -6.51866201e-09],
       [ 1.49782102e-06,  1.65040162e-06,  2.40508718e-07,
         7.53945378e-09,  7.06816313e-09, -4.24478138e-09],
       [-1.29453862e-06, -1.23400637e-06,  3.53994159e-08,
        -6.51866201e-09, -4.24478138e-09,  6.94038861e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[3.00280283e-05],
       [9.13928041e-06],
       [5.46192898e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.38271900e+03],
       [-3.10661006e+03],
       [-3.49285218e+03],
       [-2.87453512e+00],
       [-2.29118252e+00],
       [ 6.50459195e+00],
       [ 2.38669127e-01],
       [ 3.71749545e-02],
       [ 9.29499697e-01],
       [-2.78720979e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80758938e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.30954098e-03,  6.00200999e-03, -1.02000892e-03,
         3.47612866e-05,  2.32868318e-05, -4.44629932e-05],
       [ 6.00200999e-03,  5.97515472e-03, -9.87280187e-04,
         3.18671073e-05,  2.48213815e-05, -4.31087216e-05],
       [-1.02000892e-03, -9.87280187e-04,  3.32071335e-04,
        -5.13597734e-06, -3.48322548e-06,  1.00182191e-05],
       [ 3.47612866e-05,  3.18671073e-05, -5.13597734e-06,
         2.45442127e-07,  1.36216377e-07, -2.24199961e-07],
       [ 2.32868318e-05,  2.48213815e-05, -3.48322548e-06,
         1.36216377e-07,  1.66356350e-07, -1.52847479e-07],
       [-4.44629932e-05, -4.31087216e-05,  1.00182191e-05,
        -2.24199961e-07, -1.52847479e-07,  4.02090679e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[2.99673463e-05],
       [4.85682112e-06],
       [2.44069987e-02]])}}
Current time:  2018-07-13 08:28:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.38271900e+03],
       [-3.10661006e+03],
       [-3.49285218e+03],
       [-2.87453512e+00],
       [-2.29118252e+00],
       [ 6.50459195e+00],
       [ 2.38669127e-01],
       [ 3.71749545e-02],
       [ 9.29499697e-01],
       [-2.78720979e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80758938e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.30954098e-03,  6.00200999e-03, -1.02000892e-03,
         3.47612866e-05,  2.32868318e-05, -4.44629932e-05],
       [ 6.00200999e-03,  5.97515472e-03, -9.87280187e-04,
         3.18671073e-05,  2.48213815e-05, -4.31087216e-05],
       [-1.02000892e-03, -9.87280187e-04,  3.32071335e-04,
        -5.13597734e-06, -3.48322548e-06,  1.00182191e-05],
       [ 3.47612866e-05,  3.18671073e-05, -5.13597734e-06,
         2.45442127e-07,  1.36216377e-07, -2.24199961e-07],
       [ 2.32868318e-05,  2.48213815e-05, -3.48322548e-06,
         1.36216377e-07,  1.66356350e-07, -1.52847479e-07],
       [-4.44629932e-05, -4.31087216e-05,  1.00182191e-05,
        -2.24199961e-07, -1.52847479e-07,  4.02090679e-07]])}
[[-5.38271900e+03]
 [-3.10661006e+03]
 [-3.49285218e+03]
 [-2.87453512e+00]
 [-2.29118252e+00]
 [ 6.50459195e+00]
 [ 2.38669127e-01]
 [ 3.71749545e-02]
 [ 9.29499697e-01]
 [-2.78720979e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80758938e-18]]
2018-07-13 08:28:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:40
[[-5.41116769e+03]
 [-3.12935050e+03]
 [-3.42761493e+03]
 [-2.81517512e+00]
 [-2.25688832e+00]
 [ 6.54274928e+00]
 [ 2.43519083e-01]
 [ 3.86297373e-02]
 [ 9.28240860e-01]
 [-2.78523078e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80780167e-18]]
[[ 7.03069787e-03  6.56792747e-03 -1.53788545e-03  3.73769937e-05
   2.46863987e-05 -4.65757775e-05]
 [ 6.56792747e-03  6.48884195e-03 -1.46790600e-03  3.33349986e-05
   2.65668398e-05 -4.45117533e-05]
 [-1.53788545e-03 -1.46790600e-03  5.72602127e-04 -7.39606570e-06
  -5.01539408e-06  1.40546625e-05]
 [ 3.73769937e-05  3.33349986e-05 -7.39606570e-06  2.56570118e-07
   1.36830434e-07 -2.24203711e-07]
 [ 2.46863987e-05  2.65668398e-05 -5.01539408e-06  1.36830434e-07
   1.76579266e-07 -1.52568542e-07]
 [-4.65757775e-05 -4.45117533e-05  1.40546625e-05 -2.24203711e-07
  -1.52568542e-07  4.10290798e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.38271244e+03],
       [-3.10660359e+03],
       [-3.49285818e+03],
       [-2.87455729e+00],
       [-2.29108269e+00],
       [ 6.50446515e+00]]), 'covar': array([[ 4.83306350e-04,  4.27591837e-04,  6.85913508e-05,
         2.47403050e-06,  1.49782102e-06, -1.29453862e-06],
       [ 4.27591837e-04,  4.48462067e-04,  6.74933329e-05,
         2.15608519e-06,  1.65040162e-06, -1.23400637e-06],
       [ 6.85913508e-05,  6.74933329e-05,  6.33619631e-05,
         3.47813052e-07,  2.40508718e-07,  3.53994159e-08],
       [ 2.47403050e-06,  2.15608519e-06,  3.47813052e-07,
         1.34800992e-08,  7.53945378e-09, -6.51866201e-09],
       [ 1.49782102e-06,  1.65040162e-06,  2.40508718e-07,
         7.53945378e-09,  7.06816313e-09, -4.24478138e-09],
       [-1.29453862e-06, -1.23400637e-06,  3.53994159e-08,
        -6.51866201e-09, -4.24478138e-09,  6.94038861e-09]])}
[[-5.38271244e+03]
 [-3.10660359e+03]
 [-3.49285818e+03]
 [-2.87455729e+00]
 [-2.29108269e+00]
 [ 6.50446515e+00]]
2018-07-13 08:28:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:40
[[-5.41116124e+03]
 [-3.12934303e+03]
 [-3.42762213e+03]
 [-2.81519711e+00]
 [-2.25678853e+00]
 [ 6.54262244e+00]]
[[ 5.34438780e-04  4.65058827e-04  5.85501742e-05  2.61962447e-06
   1.57746843e-06 -1.35072227e-06]
 [ 4.65058827e-04  4.82267108e-04  5.71925485e-05  2.24118318e-06
   1.72485603e-06 -1.26796776e-06]
 [ 5.85501742e-05  5.71925485e-05  6.47775499e-05  2.84714789e-07
   1.99029803e-07  1.06038261e-07]
 [ 2.61962447e-06  2.24118318e-06  2.84714789e-07  1.36760883e-08
   7.59243243e-09 -6.49666250e-09]
 [ 1.57746843e-06  1.72485603e-06  1.99029803e-07  7.59243243e-09
   7.18900656e-09 -4.22308946e-09]
 [-1.35072227e-06 -1.26796776e-06  1.06038261e-07 -6.49666250e-09
  -4.22308946e-09  6.99042556e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.41116124e+03],
       [-3.12934303e+03],
       [-3.42762213e+03],
       [-2.81519711e+00],
       [-2.25678853e+00],
       [ 6.54262244e+00]]), 'covar': array([[ 5.34438780e-04,  4.65058827e-04,  5.85501742e-05,
         2.61962447e-06,  1.57746843e-06, -1.35072227e-06],
       [ 4.65058827e-04,  4.82267108e-04,  5.71925485e-05,
         2.24118318e-06,  1.72485603e-06, -1.26796776e-06],
       [ 5.85501742e-05,  5.71925485e-05,  6.47775499e-05,
         2.84714789e-07,  1.99029803e-07,  1.06038261e-07],
       [ 2.61962447e-06,  2.24118318e-06,  2.84714789e-07,
         1.36760883e-08,  7.59243243e-09, -6.49666250e-09],
       [ 1.57746843e-06,  1.72485603e-06,  1.99029803e-07,
         7.59243243e-09,  7.18900656e-09, -4.22308946e-09],
       [-1.35072227e-06, -1.26796776e-06,  1.06038261e-07,
        -6.49666250e-09, -4.22308946e-09,  6.99042556e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[3.00280283e-05],
       [9.13928041e-06],
       [5.46192898e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.41116769e+03],
       [-3.12935050e+03],
       [-3.42761493e+03],
       [-2.81517512e+00],
       [-2.25688832e+00],
       [ 6.54274928e+00],
       [ 2.43519083e-01],
       [ 3.86297373e-02],
       [ 9.28240860e-01],
       [-2.78523078e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80780167e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.03069787e-03,  6.56792747e-03, -1.53788545e-03,
         3.73769937e-05,  2.46863987e-05, -4.65757775e-05],
       [ 6.56792747e-03,  6.48884195e-03, -1.46790600e-03,
         3.33349986e-05,  2.65668398e-05, -4.45117533e-05],
       [-1.53788545e-03, -1.46790600e-03,  5.72602127e-04,
        -7.39606570e-06, -5.01539408e-06,  1.40546625e-05],
       [ 3.73769937e-05,  3.33349986e-05, -7.39606570e-06,
         2.56570118e-07,  1.36830434e-07, -2.24203711e-07],
       [ 2.46863987e-05,  2.65668398e-05, -5.01539408e-06,
         1.36830434e-07,  1.76579266e-07, -1.52568542e-07],
       [-4.65757775e-05, -4.45117533e-05,  1.40546625e-05,
        -2.24203711e-07, -1.52568542e-07,  4.10290798e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[2.99673463e-05],
       [4.85682112e-06],
       [2.44069987e-02]])}}
Yi [[-2.37684083]
 [ 0.21067584]
 [12.46185608]]
posterior
[[-5.41116769e+03]
 [-3.12935050e+03]
 [-3.42761493e+03]
 [-2.81517512e+00]
 [-2.25688832e+00]
 [ 6.54274928e+00]
 [ 2.43519083e-01]
 [ 3.86297373e-02]
 [ 9.28240860e-01]
 [-2.78523078e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80780167e-18]]
[[-5.41116967e+03]
 [-3.12934843e+03]
 [-3.42761478e+03]
 [-2.81520302e+00]
 [-2.25685618e+00]
 [ 6.54275230e+00]
 [ 2.43519083e-01]
 [ 3.86297373e-02]
 [ 9.28240860e-01]
 [-2.78523078e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80780167e-18]]
[[ 6.74292886e-03  6.32732559e-03 -1.59787629e-03  3.53906478e-05
   2.35977394e-05 -4.66987058e-05]
 [ 6.32732559e-03  6.21442780e-03 -1.52788138e-03  3.19575781e-05
   2.48812273e-05 -4.46705747e-05]
 [-1.59787629e-03 -1.52788138e-03  5.58772507e-04 -7.77220029e-06
  -5.34629301e-06  1.40214018e-05]
 [ 3.53906478e-05  3.19575781e-05 -7.77220029e-06  2.41763065e-07
   1.32315315e-07 -2.24835778e-07]
 [ 2.35977394e-05  2.48812273e-05 -5.34629301e-06  1.32315315e-07
   1.64252572e-07 -1.53627204e-07]
 [-4.66987058e-05 -4.46705747e-05  1.40214018e-05 -2.24835778e-07
  -1.53627204e-07  4.10193421e-07]]
[[-2.37682852]
 [ 0.21067555]
 [12.39003611]]
[[-1.23103845e-05]
 [ 2.98692224e-07]
 [ 7.18199706e-02]]


 Corrector Step
2018-07-13 08:28:40
[[-5.41116967e+03]
 [-3.12934843e+03]
 [-3.42761478e+03]
 [-2.81520302e+00]
 [-2.25685618e+00]
 [ 6.54275230e+00]
 [ 2.43519083e-01]
 [ 3.86297373e-02]
 [ 9.28240860e-01]
 [-2.78523078e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80780167e-18]]
[[ 6.74292886e-03  6.32732559e-03 -1.59787629e-03  3.53906478e-05
   2.35977394e-05 -4.66987058e-05]
 [ 6.32732559e-03  6.21442780e-03 -1.52788138e-03  3.19575781e-05
   2.48812273e-05 -4.46705747e-05]
 [-1.59787629e-03 -1.52788138e-03  5.58772507e-04 -7.77220029e-06
  -5.34629301e-06  1.40214018e-05]
 [ 3.53906478e-05  3.19575781e-05 -7.77220029e-06  2.41763065e-07
   1.32315315e-07 -2.24835778e-07]
 [ 2.35977394e-05  2.48812273e-05 -5.34629301e-06  1.32315315e-07
   1.64252572e-07 -1.53627204e-07]
 [-4.66987058e-05 -4.46705747e-05  1.40214018e-05 -2.24835778e-07
  -1.53627204e-07  4.10193421e-07]]
570384462.0001796
post
cubesat_nadir
Ybar_post [[-2.37683125]
 [ 0.21067568]
 [12.39005643]]
resids [[-9.58618265e-06]
 [ 1.61073304e-07]
 [ 7.17996485e-02]]
posterior
[[-5.41116124e+03]
 [-3.12934303e+03]
 [-3.42762213e+03]
 [-2.81519711e+00]
 [-2.25678853e+00]
 [ 6.54262244e+00]]
[[-5.41116062e+03]
 [-3.12934142e+03]
 [-3.42762161e+03]
 [-2.81519460e+00]
 [-2.25678183e+00]
 [ 6.54262123e+00]]
[[ 4.82725144e-04  4.18513717e-04  3.89586965e-05  2.36671365e-06
   1.41832391e-06 -1.28054784e-06]
 [ 4.18513717e-04  4.35678137e-04  3.84235628e-05  2.01586116e-06
   1.56032899e-06 -1.20262637e-06]
 [ 3.89586965e-05  3.84235628e-05  5.70807760e-05  1.89459674e-07
   1.33590527e-07  1.33150777e-07]
 [ 2.36671365e-06  2.01586116e-06  1.89459674e-07  1.24380642e-08
   6.82459936e-09 -6.15454070e-09]
 [ 1.41832391e-06  1.56032899e-06  1.33590527e-07  6.82459936e-09
   6.60274317e-09 -3.99724790e-09]
 [-1.28054784e-06 -1.20262637e-06  1.33150777e-07 -6.15454070e-09
  -3.99724790e-09  6.89418729e-09]]
[[-2.37682927]
 [ 0.21067099]
 [11.7434752 ]]
[[-1.15653264e-05]
 [ 4.85844755e-06]
 [ 7.18380878e-01]]


 Corrector Step
2018-07-13 08:28:40
[[-5.41116062e+03]
 [-3.12934142e+03]
 [-3.42762161e+03]
 [-2.81519460e+00]
 [-2.25678183e+00]
 [ 6.54262123e+00]]
[[ 4.82725144e-04  4.18513717e-04  3.89586965e-05  2.36671365e-06
   1.41832391e-06 -1.28054784e-06]
 [ 4.18513717e-04  4.35678137e-04  3.84235628e-05  2.01586116e-06
   1.56032899e-06 -1.20262637e-06]
 [ 3.89586965e-05  3.84235628e-05  5.70807760e-05  1.89459674e-07
   1.33590527e-07  1.33150777e-07]
 [ 2.36671365e-06  2.01586116e-06  1.89459674e-07  1.24380642e-08
   6.82459936e-09 -6.15454070e-09]
 [ 1.41832391e-06  1.56032899e-06  1.33590527e-07  6.82459936e-09
   6.60274317e-09 -3.99724790e-09]
 [-1.28054784e-06 -1.20262637e-06  1.33150777e-07 -6.15454070e-09
  -3.99724790e-09  6.89418729e-09]]
0.005262058942330768
post
sphere_lamr_small
Ybar_post [[-2.37683011]
 [ 0.21067176]
 [11.74347373]]
resids [[-1.07177235e-05]
 [ 4.08737691e-06]
 [ 7.18382349e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [570384462.0001796, 0.005262058942330768]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.41116967e+03],
       [-3.12934843e+03],
       [-3.42761478e+03],
       [-2.81520302e+00],
       [-2.25685618e+00],
       [ 6.54275230e+00]]), 'est_covars': array([[ 6.74292886e-03,  6.32732559e-03, -1.59787629e-03,
         3.53906478e-05,  2.35977394e-05, -4.66987058e-05],
       [ 6.32732559e-03,  6.21442780e-03, -1.52788138e-03,
         3.19575781e-05,  2.48812273e-05, -4.46705747e-05],
       [-1.59787629e-03, -1.52788138e-03,  5.58772507e-04,
        -7.77220029e-06, -5.34629301e-06,  1.40214018e-05],
       [ 3.53906478e-05,  3.19575781e-05, -7.77220029e-06,
         2.41763065e-07,  1.32315315e-07, -2.24835778e-07],
       [ 2.35977394e-05,  2.48812273e-05, -5.34629301e-06,
         1.32315315e-07,  1.64252572e-07, -1.53627204e-07],
       [-4.66987058e-05, -4.46705747e-05,  1.40214018e-05,
        -2.24835778e-07, -1.53627204e-07,  4.10193421e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.41116062e+03],
       [-3.12934142e+03],
       [-3.42762161e+03],
       [-2.81519460e+00],
       [-2.25678183e+00],
       [ 6.54262123e+00]]), 'covar': array([[ 4.82725144e-04,  4.18513717e-04,  3.89586965e-05,
         2.36671365e-06,  1.41832391e-06, -1.28054784e-06],
       [ 4.18513717e-04,  4.35678137e-04,  3.84235628e-05,
         2.01586116e-06,  1.56032899e-06, -1.20262637e-06],
       [ 3.89586965e-05,  3.84235628e-05,  5.70807760e-05,
         1.89459674e-07,  1.33590527e-07,  1.33150777e-07],
       [ 2.36671365e-06,  2.01586116e-06,  1.89459674e-07,
         1.24380642e-08,  6.82459936e-09, -6.15454070e-09],
       [ 1.41832391e-06,  1.56032899e-06,  1.33590527e-07,
         6.82459936e-09,  6.60274317e-09, -3.99724790e-09],
       [-1.28054784e-06, -1.20262637e-06,  1.33150777e-07,
        -6.15454070e-09, -3.99724790e-09,  6.89418729e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.07177235e-05],
       [ 4.08737691e-06],
       [ 7.18382349e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.41116967e+03],
       [-3.12934843e+03],
       [-3.42761478e+03],
       [-2.81520302e+00],
       [-2.25685618e+00],
       [ 6.54275230e+00],
       [ 2.43519083e-01],
       [ 3.86297373e-02],
       [ 9.28240860e-01],
       [-2.78523078e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80780167e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.74292886e-03,  6.32732559e-03, -1.59787629e-03,
         3.53906478e-05,  2.35977394e-05, -4.66987058e-05],
       [ 6.32732559e-03,  6.21442780e-03, -1.52788138e-03,
         3.19575781e-05,  2.48812273e-05, -4.46705747e-05],
       [-1.59787629e-03, -1.52788138e-03,  5.58772507e-04,
        -7.77220029e-06, -5.34629301e-06,  1.40214018e-05],
       [ 3.53906478e-05,  3.19575781e-05, -7.77220029e-06,
         2.41763065e-07,  1.32315315e-07, -2.24835778e-07],
       [ 2.35977394e-05,  2.48812273e-05, -5.34629301e-06,
         1.32315315e-07,  1.64252572e-07, -1.53627204e-07],
       [-4.66987058e-05, -4.46705747e-05,  1.40214018e-05,
        -2.24835778e-07, -1.53627204e-07,  4.10193421e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-9.58618265e-06],
       [ 1.61073304e-07],
       [ 7.17996485e-02]])}}
Current time:  2018-07-13 08:28:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.41116967e+03],
       [-3.12934843e+03],
       [-3.42761478e+03],
       [-2.81520302e+00],
       [-2.25685618e+00],
       [ 6.54275230e+00],
       [ 2.43519083e-01],
       [ 3.86297373e-02],
       [ 9.28240860e-01],
       [-2.78523078e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80780167e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.74292886e-03,  6.32732559e-03, -1.59787629e-03,
         3.53906478e-05,  2.35977394e-05, -4.66987058e-05],
       [ 6.32732559e-03,  6.21442780e-03, -1.52788138e-03,
         3.19575781e-05,  2.48812273e-05, -4.46705747e-05],
       [-1.59787629e-03, -1.52788138e-03,  5.58772507e-04,
        -7.77220029e-06, -5.34629301e-06,  1.40214018e-05],
       [ 3.53906478e-05,  3.19575781e-05, -7.77220029e-06,
         2.41763065e-07,  1.32315315e-07, -2.24835778e-07],
       [ 2.35977394e-05,  2.48812273e-05, -5.34629301e-06,
         1.32315315e-07,  1.64252572e-07, -1.53627204e-07],
       [-4.66987058e-05, -4.46705747e-05,  1.40214018e-05,
        -2.24835778e-07, -1.53627204e-07,  4.10193421e-07]])}
[[-5.41116967e+03]
 [-3.12934843e+03]
 [-3.42761478e+03]
 [-2.81520302e+00]
 [-2.25685618e+00]
 [ 6.54275230e+00]
 [ 2.43519083e-01]
 [ 3.86297373e-02]
 [ 9.28240860e-01]
 [-2.78523078e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80780167e-18]]
2018-07-13 08:28:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:50
[[-5.43902320e+03]
 [-3.15174453e+03]
 [-3.36199918e+03]
 [-2.75552530e+00]
 [-2.22230917e+00]
 [ 6.58019263e+00]
 [ 2.48362400e-01]
 [ 4.00834669e-02]
 [ 9.26956718e-01]
 [-2.78317583e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80801396e-18]]
[[ 7.47673651e-03  6.89675049e-03 -2.16417538e-03  3.79719553e-05
   2.49590656e-05 -4.88100889e-05]
 [ 6.89675049e-03  6.72904943e-03 -2.04284424e-03  3.33872792e-05
   2.66057129e-05 -4.60749016e-05]
 [-2.16417538e-03 -2.04284424e-03  8.80303773e-04 -1.00468164e-05
  -6.88868777e-06  1.81260491e-05]
 [ 3.79719553e-05  3.33872792e-05 -1.00468164e-05  2.52864794e-07
   1.32915573e-07 -2.24833604e-07]
 [ 2.49590656e-05  2.66057129e-05 -6.88868777e-06  1.32915573e-07
   1.74467578e-07 -1.53343652e-07]
 [-4.88100889e-05 -4.60749016e-05  1.81260491e-05 -2.24833604e-07
  -1.53343652e-07  4.18306188e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.41116062e+03],
       [-3.12934142e+03],
       [-3.42762161e+03],
       [-2.81519460e+00],
       [-2.25678183e+00],
       [ 6.54262123e+00]]), 'covar': array([[ 4.82725144e-04,  4.18513717e-04,  3.89586965e-05,
         2.36671365e-06,  1.41832391e-06, -1.28054784e-06],
       [ 4.18513717e-04,  4.35678137e-04,  3.84235628e-05,
         2.01586116e-06,  1.56032899e-06, -1.20262637e-06],
       [ 3.89586965e-05,  3.84235628e-05,  5.70807760e-05,
         1.89459674e-07,  1.33590527e-07,  1.33150777e-07],
       [ 2.36671365e-06,  2.01586116e-06,  1.89459674e-07,
         1.24380642e-08,  6.82459936e-09, -6.15454070e-09],
       [ 1.41832391e-06,  1.56032899e-06,  1.33590527e-07,
         6.82459936e-09,  6.60274317e-09, -3.99724790e-09],
       [-1.28054784e-06, -1.20262637e-06,  1.33150777e-07,
        -6.15454070e-09, -3.99724790e-09,  6.89418729e-09]])}
[[-5.41116062e+03]
 [-3.12934142e+03]
 [-3.42762161e+03]
 [-2.81519460e+00]
 [-2.25678183e+00]
 [ 6.54262123e+00]]
2018-07-13 08:28:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:28:50
[[-5.43901446e+03]
 [-3.15173662e+03]
 [-3.36200769e+03]
 [-2.75551684e+00]
 [-2.22223492e+00]
 [ 6.58006191e+00]]
[[ 5.31398434e-04  4.53604173e-04  2.74826818e-05  2.50135430e-06
   1.49064060e-06 -1.33300033e-06]
 [ 4.53604173e-04  4.67594440e-04  2.73585492e-05  2.09329482e-06
   1.62992309e-06 -1.23435040e-06]
 [ 2.74826818e-05  2.73585492e-05  6.04610366e-05  1.29320887e-07
   9.43398849e-08  2.02888738e-07]
 [ 2.50135430e-06  2.09329482e-06  1.29320887e-07  1.26267371e-08
   6.87391540e-09 -6.13383128e-09]
 [ 1.49064060e-06  1.62992309e-06  9.43398849e-08  6.87391540e-09
   6.72179554e-09 -3.97680390e-09]
 [-1.33300033e-06 -1.23435040e-06  2.02888738e-07 -6.13383128e-09
  -3.97680390e-09  6.94533779e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.43901446e+03],
       [-3.15173662e+03],
       [-3.36200769e+03],
       [-2.75551684e+00],
       [-2.22223492e+00],
       [ 6.58006191e+00]]), 'covar': array([[ 5.31398434e-04,  4.53604173e-04,  2.74826818e-05,
         2.50135430e-06,  1.49064060e-06, -1.33300033e-06],
       [ 4.53604173e-04,  4.67594440e-04,  2.73585492e-05,
         2.09329482e-06,  1.62992309e-06, -1.23435040e-06],
       [ 2.74826818e-05,  2.73585492e-05,  6.04610366e-05,
         1.29320887e-07,  9.43398849e-08,  2.02888738e-07],
       [ 2.50135430e-06,  2.09329482e-06,  1.29320887e-07,
         1.26267371e-08,  6.87391540e-09, -6.13383128e-09],
       [ 1.49064060e-06,  1.62992309e-06,  9.43398849e-08,
         6.87391540e-09,  6.72179554e-09, -3.97680390e-09],
       [-1.33300033e-06, -1.23435040e-06,  2.02888738e-07,
        -6.13383128e-09, -3.97680390e-09,  6.94533779e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.07177235e-05],
       [ 4.08737691e-06],
       [ 7.18382349e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.43902320e+03],
       [-3.15174453e+03],
       [-3.36199918e+03],
       [-2.75552530e+00],
       [-2.22230917e+00],
       [ 6.58019263e+00],
       [ 2.48362400e-01],
       [ 4.00834669e-02],
       [ 9.26956718e-01],
       [-2.78317583e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80801396e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.47673651e-03,  6.89675049e-03, -2.16417538e-03,
         3.79719553e-05,  2.49590656e-05, -4.88100889e-05],
       [ 6.89675049e-03,  6.72904943e-03, -2.04284424e-03,
         3.33872792e-05,  2.66057129e-05, -4.60749016e-05],
       [-2.16417538e-03, -2.04284424e-03,  8.80303773e-04,
        -1.00468164e-05, -6.88868777e-06,  1.81260491e-05],
       [ 3.79719553e-05,  3.33872792e-05, -1.00468164e-05,
         2.52864794e-07,  1.32915573e-07, -2.24833604e-07],
       [ 2.49590656e-05,  2.66057129e-05, -6.88868777e-06,
         1.32915573e-07,  1.74467578e-07, -1.53343652e-07],
       [-4.88100889e-05, -4.60749016e-05,  1.81260491e-05,
        -2.24833604e-07, -1.53343652e-07,  4.18306188e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-9.58618265e-06],
       [ 1.61073304e-07],
       [ 7.17996485e-02]])}}
Yi [[-2.38296716]
 [ 0.26052835]
 [12.7630744 ]]
posterior
[[-5.43902320e+03]
 [-3.15174453e+03]
 [-3.36199918e+03]
 [-2.75552530e+00]
 [-2.22230917e+00]
 [ 6.58019263e+00]
 [ 2.48362400e-01]
 [ 4.00834669e-02]
 [ 9.26956718e-01]
 [-2.78317583e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80801396e-18]]
[[-5.43902055e+03]
 [-3.15173990e+03]
 [-3.36199844e+03]
 [-2.75551628e+00]
 [-2.22227334e+00]
 [ 6.58019682e+00]
 [ 2.48362400e-01]
 [ 4.00834669e-02]
 [ 9.26956718e-01]
 [-2.78317583e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80801396e-18]]
[[ 7.18565374e-03  6.65900659e-03 -2.20609274e-03  3.59931551e-05
   2.38979163e-05 -4.89034268e-05]
 [ 6.65900659e-03  6.45991734e-03 -2.08481968e-03  3.20543650e-05
   2.49529716e-05 -4.62052846e-05]
 [-2.20609274e-03 -2.08481968e-03  8.73460272e-04 -1.03025476e-05
  -7.12268534e-06  1.81068907e-05]
 [ 3.59931551e-05  3.20543650e-05 -1.03025476e-05  2.38342034e-07
   1.28672565e-07 -2.25263842e-07]
 [ 2.38979163e-05  2.49529716e-05 -7.12268534e-06  1.28672565e-07
   1.62355773e-07 -1.54252182e-07]
 [-4.89034268e-05 -4.62052846e-05  1.81068907e-05 -2.25263842e-07
  -1.54252182e-07  4.18235171e-07]]
[[-2.38296086]
 [ 0.26052161]
 [12.65212059]]
[[-6.30468783e-06]
 [ 6.74426112e-06]
 [ 1.10953812e-01]]


 Corrector Step
2018-07-13 08:28:50
[[-5.43902055e+03]
 [-3.15173990e+03]
 [-3.36199844e+03]
 [-2.75551628e+00]
 [-2.22227334e+00]
 [ 6.58019682e+00]
 [ 2.48362400e-01]
 [ 4.00834669e-02]
 [ 9.26956718e-01]
 [-2.78317583e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80801396e-18]]
[[ 7.18565374e-03  6.65900659e-03 -2.20609274e-03  3.59931551e-05
   2.38979163e-05 -4.89034268e-05]
 [ 6.65900659e-03  6.45991734e-03 -2.08481968e-03  3.20543650e-05
   2.49529716e-05 -4.62052846e-05]
 [-2.20609274e-03 -2.08481968e-03  8.73460272e-04 -1.03025476e-05
  -7.12268534e-06  1.81068907e-05]
 [ 3.59931551e-05  3.20543650e-05 -1.03025476e-05  2.38342034e-07
   1.28672565e-07 -2.25263842e-07]
 [ 2.38979163e-05  2.49529716e-05 -7.12268534e-06  1.28672565e-07
   1.62355773e-07 -1.54252182e-07]
 [-4.89034268e-05 -4.62052846e-05  1.81068907e-05 -2.25263842e-07
  -1.54252182e-07  4.18235171e-07]]
421251076.9909664
post
cubesat_nadir
Ybar_post [[-2.38296228]
 [ 0.26052339]
 [12.65212836]]
resids [[-4.87960720e-06]
 [ 4.96461828e-06]
 [ 1.10946039e-01]]
posterior
[[-5.43901446e+03]
 [-3.15173662e+03]
 [-3.36200769e+03]
 [-2.75551684e+00]
 [-2.22223492e+00]
 [ 6.58006191e+00]]
[[-5.43901197e+03]
 [-3.15173368e+03]
 [-3.36200670e+03]
 [-2.75550551e+00]
 [-2.22222431e+00]
 [ 6.58005853e+00]]
[[ 4.82749848e-04  4.10747167e-04  1.19663169e-05  2.27261573e-06
   1.34827944e-06 -1.27014864e-06]
 [ 4.10747167e-04  4.25043294e-04  1.26756150e-05  1.89425908e-06
   1.48318316e-06 -1.17689476e-06]
 [ 1.19663169e-05  1.26756150e-05  5.52978269e-05  5.68876325e-08
   4.44262453e-08  2.23376089e-07]
 [ 2.27261573e-06  1.89425908e-06  5.68876325e-08  1.15499679e-08
   6.21554433e-09 -5.83938699e-09]
 [ 1.34827944e-06  1.48318316e-06  4.44262453e-08  6.21554433e-09
   6.21037091e-09 -3.78360265e-09]
 [-1.27014864e-06 -1.17689476e-06  2.23376089e-07 -5.83938699e-09
  -3.78360265e-09  6.86322845e-09]]
[[-2.38296053]
 [ 0.26051706]
 [11.87641501]]
[[-6.63251338e-06]
 [ 1.12853900e-05]
 [ 8.86659387e-01]]


 Corrector Step
2018-07-13 08:28:50
[[-5.43901197e+03]
 [-3.15173368e+03]
 [-3.36200670e+03]
 [-2.75550551e+00]
 [-2.22222431e+00]
 [ 6.58005853e+00]]
[[ 4.82749848e-04  4.10747167e-04  1.19663169e-05  2.27261573e-06
   1.34827944e-06 -1.27014864e-06]
 [ 4.10747167e-04  4.25043294e-04  1.26756150e-05  1.89425908e-06
   1.48318316e-06 -1.17689476e-06]
 [ 1.19663169e-05  1.26756150e-05  5.52978269e-05  5.68876325e-08
   4.44262453e-08  2.23376089e-07]
 [ 2.27261573e-06  1.89425908e-06  5.68876325e-08  1.15499679e-08
   6.21554433e-09 -5.83938699e-09]
 [ 1.34827944e-06  1.48318316e-06  4.44262453e-08  6.21554433e-09
   6.21037091e-09 -3.78360265e-09]
 [-1.27014864e-06 -1.17689476e-06  2.23376089e-07 -5.83938699e-09
  -3.78360265e-09  6.86322845e-09]]
7.2033123454954055e-09
post
sphere_lamr_small
Ybar_post [[-2.38296102]
 [ 0.26051877]
 [11.87640962]]
resids [[-6.13819187e-06]
 [ 9.58033328e-06]
 [ 8.86664783e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [421251076.9909664, 7.2033123454954055e-09]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.43902055e+03],
       [-3.15173990e+03],
       [-3.36199844e+03],
       [-2.75551628e+00],
       [-2.22227334e+00],
       [ 6.58019682e+00]]), 'est_covars': array([[ 7.18565374e-03,  6.65900659e-03, -2.20609274e-03,
         3.59931551e-05,  2.38979163e-05, -4.89034268e-05],
       [ 6.65900659e-03,  6.45991734e-03, -2.08481968e-03,
         3.20543650e-05,  2.49529716e-05, -4.62052846e-05],
       [-2.20609274e-03, -2.08481968e-03,  8.73460272e-04,
        -1.03025476e-05, -7.12268534e-06,  1.81068907e-05],
       [ 3.59931551e-05,  3.20543650e-05, -1.03025476e-05,
         2.38342034e-07,  1.28672565e-07, -2.25263842e-07],
       [ 2.38979163e-05,  2.49529716e-05, -7.12268534e-06,
         1.28672565e-07,  1.62355773e-07, -1.54252182e-07],
       [-4.89034268e-05, -4.62052846e-05,  1.81068907e-05,
        -2.25263842e-07, -1.54252182e-07,  4.18235171e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.43901197e+03],
       [-3.15173368e+03],
       [-3.36200670e+03],
       [-2.75550551e+00],
       [-2.22222431e+00],
       [ 6.58005853e+00]]), 'covar': array([[ 4.82749848e-04,  4.10747167e-04,  1.19663169e-05,
         2.27261573e-06,  1.34827944e-06, -1.27014864e-06],
       [ 4.10747167e-04,  4.25043294e-04,  1.26756150e-05,
         1.89425908e-06,  1.48318316e-06, -1.17689476e-06],
       [ 1.19663169e-05,  1.26756150e-05,  5.52978269e-05,
         5.68876325e-08,  4.44262453e-08,  2.23376089e-07],
       [ 2.27261573e-06,  1.89425908e-06,  5.68876325e-08,
         1.15499679e-08,  6.21554433e-09, -5.83938699e-09],
       [ 1.34827944e-06,  1.48318316e-06,  4.44262453e-08,
         6.21554433e-09,  6.21037091e-09, -3.78360265e-09],
       [-1.27014864e-06, -1.17689476e-06,  2.23376089e-07,
        -5.83938699e-09, -3.78360265e-09,  6.86322845e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-6.13819187e-06],
       [ 9.58033328e-06],
       [ 8.86664783e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.43902055e+03],
       [-3.15173990e+03],
       [-3.36199844e+03],
       [-2.75551628e+00],
       [-2.22227334e+00],
       [ 6.58019682e+00],
       [ 2.48362400e-01],
       [ 4.00834669e-02],
       [ 9.26956718e-01],
       [-2.78317583e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80801396e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.18565374e-03,  6.65900659e-03, -2.20609274e-03,
         3.59931551e-05,  2.38979163e-05, -4.89034268e-05],
       [ 6.65900659e-03,  6.45991734e-03, -2.08481968e-03,
         3.20543650e-05,  2.49529716e-05, -4.62052846e-05],
       [-2.20609274e-03, -2.08481968e-03,  8.73460272e-04,
        -1.03025476e-05, -7.12268534e-06,  1.81068907e-05],
       [ 3.59931551e-05,  3.20543650e-05, -1.03025476e-05,
         2.38342034e-07,  1.28672565e-07, -2.25263842e-07],
       [ 2.38979163e-05,  2.49529716e-05, -7.12268534e-06,
         1.28672565e-07,  1.62355773e-07, -1.54252182e-07],
       [-4.89034268e-05, -4.62052846e-05,  1.81068907e-05,
        -2.25263842e-07, -1.54252182e-07,  4.18235171e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-4.87960720e-06],
       [ 4.96461828e-06],
       [ 1.10946039e-01]])}}
Current time:  2018-07-13 08:29:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.43902055e+03],
       [-3.15173990e+03],
       [-3.36199844e+03],
       [-2.75551628e+00],
       [-2.22227334e+00],
       [ 6.58019682e+00],
       [ 2.48362400e-01],
       [ 4.00834669e-02],
       [ 9.26956718e-01],
       [-2.78317583e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80801396e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.18565374e-03,  6.65900659e-03, -2.20609274e-03,
         3.59931551e-05,  2.38979163e-05, -4.89034268e-05],
       [ 6.65900659e-03,  6.45991734e-03, -2.08481968e-03,
         3.20543650e-05,  2.49529716e-05, -4.62052846e-05],
       [-2.20609274e-03, -2.08481968e-03,  8.73460272e-04,
        -1.03025476e-05, -7.12268534e-06,  1.81068907e-05],
       [ 3.59931551e-05,  3.20543650e-05, -1.03025476e-05,
         2.38342034e-07,  1.28672565e-07, -2.25263842e-07],
       [ 2.38979163e-05,  2.49529716e-05, -7.12268534e-06,
         1.28672565e-07,  1.62355773e-07, -1.54252182e-07],
       [-4.89034268e-05, -4.62052846e-05,  1.81068907e-05,
        -2.25263842e-07, -1.54252182e-07,  4.18235171e-07]])}
[[-5.43902055e+03]
 [-3.15173990e+03]
 [-3.36199844e+03]
 [-2.75551628e+00]
 [-2.22227334e+00]
 [ 6.58019682e+00]
 [ 2.48362400e-01]
 [ 4.00834669e-02]
 [ 9.26956718e-01]
 [-2.78317583e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80801396e-18]]
2018-07-13 08:28:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:00
[[-5.46627604e+03]
 [-3.17378886e+03]
 [-3.29601218e+03]
 [-2.69552736e+00]
 [-2.18747714e+00]
 [ 6.61691715e+00]
 [ 2.53198946e-01]
 [ 4.15361038e-02]
 [ 9.25647305e-01]
 [-2.78104501e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80822625e-18]]
[[ 7.93072999e-03  7.23211263e-03 -2.82012358e-03  3.85425881e-05
   2.52235605e-05 -5.10095938e-05]
 [ 7.23211263e-03  6.97577898e-03 -2.63289282e-03  3.34488387e-05
   2.66588018e-05 -4.76092961e-05]
 [-2.82012358e-03 -2.63289282e-03  1.27715468e-03 -1.25897029e-05
  -8.67387120e-06  2.22795819e-05]
 [ 3.85425881e-05  3.34488387e-05 -1.25897029e-05  2.49421745e-07
   1.29261766e-07 -2.25255839e-07]
 [ 2.52235605e-05  2.66588018e-05 -8.67387120e-06  1.29261766e-07
   1.72564563e-07 -1.53963927e-07]
 [-5.10095938e-05 -4.76092961e-05  2.22795819e-05 -2.25255839e-07
  -1.53963927e-07  4.26257234e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.43901197e+03],
       [-3.15173368e+03],
       [-3.36200670e+03],
       [-2.75550551e+00],
       [-2.22222431e+00],
       [ 6.58005853e+00]]), 'covar': array([[ 4.82749848e-04,  4.10747167e-04,  1.19663169e-05,
         2.27261573e-06,  1.34827944e-06, -1.27014864e-06],
       [ 4.10747167e-04,  4.25043294e-04,  1.26756150e-05,
         1.89425908e-06,  1.48318316e-06, -1.17689476e-06],
       [ 1.19663169e-05,  1.26756150e-05,  5.52978269e-05,
         5.68876325e-08,  4.44262453e-08,  2.23376089e-07],
       [ 2.27261573e-06,  1.89425908e-06,  5.68876325e-08,
         1.15499679e-08,  6.21554433e-09, -5.83938699e-09],
       [ 1.34827944e-06,  1.48318316e-06,  4.44262453e-08,
         6.21554433e-09,  6.21037091e-09, -3.78360265e-09],
       [-1.27014864e-06, -1.17689476e-06,  2.23376089e-07,
        -5.83938699e-09, -3.78360265e-09,  6.86322845e-09]])}
[[-5.43901197e+03]
 [-3.15173368e+03]
 [-3.36200670e+03]
 [-2.75550551e+00]
 [-2.22222431e+00]
 [ 6.58005853e+00]]
2018-07-13 08:28:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:00
[[-5.46626730e+03]
 [-3.17378207e+03]
 [-3.29602190e+03]
 [-2.69551663e+00]
 [-2.18742824e+00]
 [ 6.61677874e+00]]
[[ 5.29467958e-04  4.43875724e-04 -6.98005614e-07  2.39807770e-06
   1.41444612e-06 -1.31959381e-06]
 [ 4.43875724e-04  4.55371364e-04  1.01953687e-06  1.96520050e-06
   1.54871940e-06 -1.20661956e-06]
 [-6.98005614e-07  1.01953687e-06  6.04527577e-05 -5.98991082e-10
   7.11673859e-09  2.92152808e-07]
 [ 2.39807770e-06  1.96520050e-06 -5.98991082e-10  1.17325361e-08
   6.26187859e-09 -5.81967997e-09]
 [ 1.41444612e-06  1.54871940e-06  7.11673859e-09  6.26187859e-09
   6.32796258e-09 -3.76431860e-09]
 [-1.31959381e-06 -1.20661956e-06  2.92152808e-07 -5.81967997e-09
  -3.76431860e-09  6.91436620e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 28, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.46626730e+03],
       [-3.17378207e+03],
       [-3.29602190e+03],
       [-2.69551663e+00],
       [-2.18742824e+00],
       [ 6.61677874e+00]]), 'covar': array([[ 5.29467958e-04,  4.43875724e-04, -6.98005614e-07,
         2.39807770e-06,  1.41444612e-06, -1.31959381e-06],
       [ 4.43875724e-04,  4.55371364e-04,  1.01953687e-06,
         1.96520050e-06,  1.54871940e-06, -1.20661956e-06],
       [-6.98005614e-07,  1.01953687e-06,  6.04527577e-05,
        -5.98991082e-10,  7.11673859e-09,  2.92152808e-07],
       [ 2.39807770e-06,  1.96520050e-06, -5.98991082e-10,
         1.17325361e-08,  6.26187859e-09, -5.81967997e-09],
       [ 1.41444612e-06,  1.54871940e-06,  7.11673859e-09,
         6.26187859e-09,  6.32796258e-09, -3.76431860e-09],
       [-1.31959381e-06, -1.20661956e-06,  2.92152808e-07,
        -5.81967997e-09, -3.76431860e-09,  6.91436620e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-6.13819187e-06],
       [ 9.58033328e-06],
       [ 8.86664783e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 28, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.46627604e+03],
       [-3.17378886e+03],
       [-3.29601218e+03],
       [-2.69552736e+00],
       [-2.18747714e+00],
       [ 6.61691715e+00],
       [ 2.53198946e-01],
       [ 4.15361038e-02],
       [ 9.25647305e-01],
       [-2.78104501e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80822625e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.93072999e-03,  7.23211263e-03, -2.82012358e-03,
         3.85425881e-05,  2.52235605e-05, -5.10095938e-05],
       [ 7.23211263e-03,  6.97577898e-03, -2.63289282e-03,
         3.34488387e-05,  2.66588018e-05, -4.76092961e-05],
       [-2.82012358e-03, -2.63289282e-03,  1.27715468e-03,
        -1.25897029e-05, -8.67387120e-06,  2.22795819e-05],
       [ 3.85425881e-05,  3.34488387e-05, -1.25897029e-05,
         2.49421745e-07,  1.29261766e-07, -2.25255839e-07],
       [ 2.52235605e-05,  2.66588018e-05, -8.67387120e-06,
         1.29261766e-07,  1.72564563e-07, -1.53963927e-07],
       [-5.10095938e-05, -4.76092961e-05,  2.22795819e-05,
        -2.25255839e-07, -1.53963927e-07,  4.26257234e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-4.87960720e-06],
       [ 4.96461828e-06],
       [ 1.10946039e-01]])}}
Yi [[-2.3885781 ]
 [ 0.30664   ]
 [12.87071797]]
posterior
[[-5.46627604e+03]
 [-3.17378886e+03]
 [-3.29601218e+03]
 [-2.69552736e+00]
 [-2.18747714e+00]
 [ 6.61691715e+00]
 [ 2.53198946e-01]
 [ 4.15361038e-02]
 [ 9.25647305e-01]
 [-2.78104501e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80822625e-18]]
[[-5.46626908e+03]
 [-3.17378418e+03]
 [-3.29601170e+03]
 [-2.69547757e+00]
 [-2.18746199e+00]
 [ 6.61691748e+00]
 [ 2.53198946e-01]
 [ 4.15361038e-02]
 [ 9.25647305e-01]
 [-2.78104501e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80822625e-18]]
[[ 7.63618366e-03  6.99627956e-03 -2.84513375e-03  3.65682764e-05
   2.41857957e-05 -5.10753278e-05]
 [ 6.99627956e-03  6.71044464e-03 -2.65874105e-03  3.21516581e-05
   2.50324697e-05 -4.77139072e-05]
 [-2.84513375e-03 -2.65874105e-03  1.27457913e-03 -1.27357866e-05
  -8.82255993e-06  2.22699141e-05]
 [ 3.65682764e-05  3.21516581e-05 -1.27357866e-05  2.35136983e-07
   1.25253856e-07 -2.25504199e-07]
 [ 2.41857957e-05  2.50324697e-05 -8.82255993e-06  1.25253856e-07
   1.60638630e-07 -1.54736360e-07]
 [-5.10753278e-05 -4.77139072e-05  2.22699141e-05 -2.25504199e-07
  -1.54736360e-07  4.26205301e-07]]
[[-2.38858378]
 [ 0.30663003]
 [12.91532397]]
[[ 5.67924419e-06]
 [ 9.96854648e-06]
 [-4.46060062e-02]]


 Corrector Step
2018-07-13 08:29:00
[[-5.46626908e+03]
 [-3.17378418e+03]
 [-3.29601170e+03]
 [-2.69547757e+00]
 [-2.18746199e+00]
 [ 6.61691748e+00]
 [ 2.53198946e-01]
 [ 4.15361038e-02]
 [ 9.25647305e-01]
 [-2.78104501e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80822625e-18]]
[[ 7.63618366e-03  6.99627956e-03 -2.84513375e-03  3.65682764e-05
   2.41857957e-05 -5.10753278e-05]
 [ 6.99627956e-03  6.71044464e-03 -2.65874105e-03  3.21516581e-05
   2.50324697e-05 -4.77139072e-05]
 [-2.84513375e-03 -2.65874105e-03  1.27457913e-03 -1.27357866e-05
  -8.82255993e-06  2.22699141e-05]
 [ 3.65682764e-05  3.21516581e-05 -1.27357866e-05  2.35136983e-07
   1.25253856e-07 -2.25504199e-07]
 [ 2.41857957e-05  2.50324697e-05 -8.82255993e-06  1.25253856e-07
   1.60638630e-07 -1.54736360e-07]
 [-5.10753278e-05 -4.77139072e-05  2.22699141e-05 -2.25504199e-07
  -1.54736360e-07  4.26205301e-07]]
690183387.9458798
post
cubesat_nadir
Ybar_post [[-2.38858265]
 [ 0.3066325 ]
 [12.91530774]]
resids [[ 4.54549859e-06]
 [ 7.49394735e-06]
 [-4.45897733e-02]]
posterior
[[-5.46626730e+03]
 [-3.17378207e+03]
 [-3.29602190e+03]
 [-2.69551663e+00]
 [-2.18742824e+00]
 [ 6.61677874e+00]]
[[-5.46626335e+03]
 [-3.17377882e+03]
 [-3.29602085e+03]
 [-2.69549864e+00]
 [-2.18741793e+00]
 [ 6.61677409e+00]]
[[ 4.83639816e-04  4.04335509e-04 -1.28799518e-05  2.19042587e-06
   1.28673216e-06 -1.26315597e-06]
 [ 4.04335509e-04  4.16357257e-04 -1.03946043e-05  1.78865442e-06
   1.41714487e-06 -1.15593560e-06]
 [-1.28799518e-05 -1.03946043e-05  5.70478864e-05 -5.53143385e-08
  -3.07761949e-08  3.07521954e-07]
 [ 2.19042587e-06  1.78865442e-06 -5.53143385e-08  1.07902498e-08
   5.69460613e-09 -5.56501644e-09]
 [ 1.28673216e-06  1.41714487e-06 -3.07761949e-08  5.69460613e-09
   5.87871179e-09 -3.59835247e-09]
 [-1.26315597e-06 -1.15593560e-06  3.07521954e-07 -5.56501644e-09
  -3.59835247e-09  6.84405395e-09]]
[[-2.38858283]
 [ 0.30662504]
 [12.00755215]]
[[4.72556988e-06]
 [1.49567102e-05]
 [8.63165820e-01]]


 Corrector Step
2018-07-13 08:29:00
[[-5.46626335e+03]
 [-3.17377882e+03]
 [-3.29602085e+03]
 [-2.69549864e+00]
 [-2.18741793e+00]
 [ 6.61677409e+00]]
[[ 4.83639816e-04  4.04335509e-04 -1.28799518e-05  2.19042587e-06
   1.28673216e-06 -1.26315597e-06]
 [ 4.04335509e-04  4.16357257e-04 -1.03946043e-05  1.78865442e-06
   1.41714487e-06 -1.15593560e-06]
 [-1.28799518e-05 -1.03946043e-05  5.70478864e-05 -5.53143385e-08
  -3.07761949e-08  3.07521954e-07]
 [ 2.19042587e-06  1.78865442e-06 -5.53143385e-08  1.07902498e-08
   5.69460613e-09 -5.56501644e-09]
 [ 1.28673216e-06  1.41714487e-06 -3.07761949e-08  5.69460613e-09
   5.87871179e-09 -3.59835247e-09]
 [-1.26315597e-06 -1.15593560e-06  3.07521954e-07 -5.56501644e-09
  -3.59835247e-09  6.84405395e-09]]
5.363958665965285e-08
post
sphere_lamr_small
Ybar_post [[-2.38858264]
 [ 0.30662718]
 [12.00754548]]
resids [[4.53790924e-06]
 [1.28192206e-05]
 [8.63172490e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [690183387.9458798, 5.363958665965285e-08]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.46626908e+03],
       [-3.17378418e+03],
       [-3.29601170e+03],
       [-2.69547757e+00],
       [-2.18746199e+00],
       [ 6.61691748e+00]]), 'est_covars': array([[ 7.63618366e-03,  6.99627956e-03, -2.84513375e-03,
         3.65682764e-05,  2.41857957e-05, -5.10753278e-05],
       [ 6.99627956e-03,  6.71044464e-03, -2.65874105e-03,
         3.21516581e-05,  2.50324697e-05, -4.77139072e-05],
       [-2.84513375e-03, -2.65874105e-03,  1.27457913e-03,
        -1.27357866e-05, -8.82255993e-06,  2.22699141e-05],
       [ 3.65682764e-05,  3.21516581e-05, -1.27357866e-05,
         2.35136983e-07,  1.25253856e-07, -2.25504199e-07],
       [ 2.41857957e-05,  2.50324697e-05, -8.82255993e-06,
         1.25253856e-07,  1.60638630e-07, -1.54736360e-07],
       [-5.10753278e-05, -4.77139072e-05,  2.22699141e-05,
        -2.25504199e-07, -1.54736360e-07,  4.26205301e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.46626335e+03],
       [-3.17377882e+03],
       [-3.29602085e+03],
       [-2.69549864e+00],
       [-2.18741793e+00],
       [ 6.61677409e+00]]), 'covar': array([[ 4.83639816e-04,  4.04335509e-04, -1.28799518e-05,
         2.19042587e-06,  1.28673216e-06, -1.26315597e-06],
       [ 4.04335509e-04,  4.16357257e-04, -1.03946043e-05,
         1.78865442e-06,  1.41714487e-06, -1.15593560e-06],
       [-1.28799518e-05, -1.03946043e-05,  5.70478864e-05,
        -5.53143385e-08, -3.07761949e-08,  3.07521954e-07],
       [ 2.19042587e-06,  1.78865442e-06, -5.53143385e-08,
         1.07902498e-08,  5.69460613e-09, -5.56501644e-09],
       [ 1.28673216e-06,  1.41714487e-06, -3.07761949e-08,
         5.69460613e-09,  5.87871179e-09, -3.59835247e-09],
       [-1.26315597e-06, -1.15593560e-06,  3.07521954e-07,
        -5.56501644e-09, -3.59835247e-09,  6.84405395e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[4.53790924e-06],
       [1.28192206e-05],
       [8.63172490e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.46626908e+03],
       [-3.17378418e+03],
       [-3.29601170e+03],
       [-2.69547757e+00],
       [-2.18746199e+00],
       [ 6.61691748e+00],
       [ 2.53198946e-01],
       [ 4.15361038e-02],
       [ 9.25647305e-01],
       [-2.78104501e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80822625e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.63618366e-03,  6.99627956e-03, -2.84513375e-03,
         3.65682764e-05,  2.41857957e-05, -5.10753278e-05],
       [ 6.99627956e-03,  6.71044464e-03, -2.65874105e-03,
         3.21516581e-05,  2.50324697e-05, -4.77139072e-05],
       [-2.84513375e-03, -2.65874105e-03,  1.27457913e-03,
        -1.27357866e-05, -8.82255993e-06,  2.22699141e-05],
       [ 3.65682764e-05,  3.21516581e-05, -1.27357866e-05,
         2.35136983e-07,  1.25253856e-07, -2.25504199e-07],
       [ 2.41857957e-05,  2.50324697e-05, -8.82255993e-06,
         1.25253856e-07,  1.60638630e-07, -1.54736360e-07],
       [-5.10753278e-05, -4.77139072e-05,  2.22699141e-05,
        -2.25504199e-07, -1.54736360e-07,  4.26205301e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 4.54549859e-06],
       [ 7.49394735e-06],
       [-4.45897733e-02]])}}
Current time:  2018-07-13 08:29:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.46626908e+03],
       [-3.17378418e+03],
       [-3.29601170e+03],
       [-2.69547757e+00],
       [-2.18746199e+00],
       [ 6.61691748e+00],
       [ 2.53198946e-01],
       [ 4.15361038e-02],
       [ 9.25647305e-01],
       [-2.78104501e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80822625e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.63618366e-03,  6.99627956e-03, -2.84513375e-03,
         3.65682764e-05,  2.41857957e-05, -5.10753278e-05],
       [ 6.99627956e-03,  6.71044464e-03, -2.65874105e-03,
         3.21516581e-05,  2.50324697e-05, -4.77139072e-05],
       [-2.84513375e-03, -2.65874105e-03,  1.27457913e-03,
        -1.27357866e-05, -8.82255993e-06,  2.22699141e-05],
       [ 3.65682764e-05,  3.21516581e-05, -1.27357866e-05,
         2.35136983e-07,  1.25253856e-07, -2.25504199e-07],
       [ 2.41857957e-05,  2.50324697e-05, -8.82255993e-06,
         1.25253856e-07,  1.60638630e-07, -1.54736360e-07],
       [-5.10753278e-05, -4.77139072e-05,  2.22699141e-05,
        -2.25504199e-07, -1.54736360e-07,  4.26205301e-07]])}
[[-5.46626908e+03]
 [-3.17378418e+03]
 [-3.29601170e+03]
 [-2.69547757e+00]
 [-2.18746199e+00]
 [ 6.61691748e+00]
 [ 2.53198946e-01]
 [ 4.15361038e-02]
 [ 9.25647305e-01]
 [-2.78104501e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80822625e-18]]
2018-07-13 08:29:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:10
[[-5.49292243e+03]
 [-3.19548376e+03]
 [-3.22966189e+03]
 [-2.63518396e+00]
 [-2.15242054e+00]
 [ 6.65291282e+00]
 [ 2.58028589e-01]
 [ 4.29876083e-02]
 [ 9.24312656e-01]
 [-2.77883837e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80843853e-18]]
[[ 8.39261983e-03  7.57293092e-03 -3.50517287e-03  3.90884530e-05
   2.54782884e-05 -5.31747314e-05]
 [ 7.57293092e-03  7.22773213e-03 -3.23890995e-03  3.35134379e-05
   2.67216098e-05 -4.91158073e-05]
 [-3.50517287e-03 -3.23890995e-03  1.76219301e-03 -1.50334654e-05
  -1.03811483e-05  2.65086691e-05]
 [ 3.90884530e-05  3.35134379e-05 -1.50334654e-05  2.46198611e-07
   1.25834448e-07 -2.25491576e-07]
 [ 2.54782884e-05  2.67216098e-05 -1.03811483e-05  1.25834448e-07
   1.70842499e-07 -1.54444201e-07]
 [-5.31747314e-05 -4.91158073e-05  2.65086691e-05 -2.25491576e-07
  -1.54444201e-07  4.34136481e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.46626335e+03],
       [-3.17377882e+03],
       [-3.29602085e+03],
       [-2.69549864e+00],
       [-2.18741793e+00],
       [ 6.61677409e+00]]), 'covar': array([[ 4.83639816e-04,  4.04335509e-04, -1.28799518e-05,
         2.19042587e-06,  1.28673216e-06, -1.26315597e-06],
       [ 4.04335509e-04,  4.16357257e-04, -1.03946043e-05,
         1.78865442e-06,  1.41714487e-06, -1.15593560e-06],
       [-1.28799518e-05, -1.03946043e-05,  5.70478864e-05,
        -5.53143385e-08, -3.07761949e-08,  3.07521954e-07],
       [ 2.19042587e-06,  1.78865442e-06, -5.53143385e-08,
         1.07902498e-08,  5.69460613e-09, -5.56501644e-09],
       [ 1.28673216e-06,  1.41714487e-06, -3.07761949e-08,
         5.69460613e-09,  5.87871179e-09, -3.59835247e-09],
       [-1.26315597e-06, -1.15593560e-06,  3.07521954e-07,
        -5.56501644e-09, -3.59835247e-09,  6.84405395e-09]])}
[[-5.46626335e+03]
 [-3.17377882e+03]
 [-3.29602085e+03]
 [-2.69549864e+00]
 [-2.18741793e+00]
 [ 6.61677409e+00]]
2018-07-13 08:29:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:10
[[-5.49291699e+03]
 [-3.19547800e+03]
 [-3.22967262e+03]
 [-2.63520504e+00]
 [-2.15237646e+00]
 [ 6.65276911e+00]]
[[ 5.28670682e-04  4.35715085e-04 -2.66103513e-05  2.30806095e-06
   1.34766687e-06 -1.31004742e-06]
 [ 4.35715085e-04  4.45318221e-04 -2.25772940e-05  1.85406608e-06
   1.47925164e-06 -1.18393716e-06]
 [-2.66103513e-05 -2.25772940e-05  6.39021223e-05 -1.10541563e-07
  -6.64315064e-08  3.75739668e-07]
 [ 2.30806095e-06  1.85406608e-06 -1.10541563e-07  1.09677474e-08
   5.73848681e-09 -5.54641202e-09]
 [ 1.34766687e-06  1.47925164e-06 -6.64315064e-08  5.73848681e-09
   5.99510405e-09 -3.58017818e-09]
 [-1.31004742e-06 -1.18393716e-06  3.75739668e-07 -5.54641202e-09
  -3.58017818e-09  6.89589800e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.49291699e+03],
       [-3.19547800e+03],
       [-3.22967262e+03],
       [-2.63520504e+00],
       [-2.15237646e+00],
       [ 6.65276911e+00]]), 'covar': array([[ 5.28670682e-04,  4.35715085e-04, -2.66103513e-05,
         2.30806095e-06,  1.34766687e-06, -1.31004742e-06],
       [ 4.35715085e-04,  4.45318221e-04, -2.25772940e-05,
         1.85406608e-06,  1.47925164e-06, -1.18393716e-06],
       [-2.66103513e-05, -2.25772940e-05,  6.39021223e-05,
        -1.10541563e-07, -6.64315064e-08,  3.75739668e-07],
       [ 2.30806095e-06,  1.85406608e-06, -1.10541563e-07,
         1.09677474e-08,  5.73848681e-09, -5.54641202e-09],
       [ 1.34766687e-06,  1.47925164e-06, -6.64315064e-08,
         5.73848681e-09,  5.99510405e-09, -3.58017818e-09],
       [-1.31004742e-06, -1.18393716e-06,  3.75739668e-07,
        -5.54641202e-09, -3.58017818e-09,  6.89589800e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[4.53790924e-06],
       [1.28192206e-05],
       [8.63172490e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.49292243e+03],
       [-3.19548376e+03],
       [-3.22966189e+03],
       [-2.63518396e+00],
       [-2.15242054e+00],
       [ 6.65291282e+00],
       [ 2.58028589e-01],
       [ 4.29876083e-02],
       [ 9.24312656e-01],
       [-2.77883837e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80843853e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.39261983e-03,  7.57293092e-03, -3.50517287e-03,
         3.90884530e-05,  2.54782884e-05, -5.31747314e-05],
       [ 7.57293092e-03,  7.22773213e-03, -3.23890995e-03,
         3.35134379e-05,  2.67216098e-05, -4.91158073e-05],
       [-3.50517287e-03, -3.23890995e-03,  1.76219301e-03,
        -1.50334654e-05, -1.03811483e-05,  2.65086691e-05],
       [ 3.90884530e-05,  3.35134379e-05, -1.50334654e-05,
         2.46198611e-07,  1.25834448e-07, -2.25491576e-07],
       [ 2.54782884e-05,  2.67216098e-05, -1.03811483e-05,
         1.25834448e-07,  1.70842499e-07, -1.54444201e-07],
       [-5.31747314e-05, -4.91158073e-05,  2.65086691e-05,
        -2.25491576e-07, -1.54444201e-07,  4.34136481e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 4.54549859e-06],
       [ 7.49394735e-06],
       [-4.45897733e-02]])}}
Yi [[-2.39376762]
 [ 0.34929672]
 [13.16125162]]
posterior
[[-5.49292243e+03]
 [-3.19548376e+03]
 [-3.22966189e+03]
 [-2.63518396e+00]
 [-2.15242054e+00]
 [ 6.65291282e+00]
 [ 2.58028589e-01]
 [ 4.29876083e-02]
 [ 9.24312656e-01]
 [-2.77883837e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80843853e-18]]
[[-5.49294446e+03]
 [-3.19549795e+03]
 [-3.22966243e+03]
 [-2.63534091e+00]
 [-2.15246350e+00]
 [ 6.65291166e+00]
 [ 2.58028589e-01]
 [ 4.29876083e-02]
 [ 9.24312656e-01]
 [-2.77883837e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80843853e-18]]
[[ 8.09357506e-03  7.33793660e-03 -3.51441584e-03  3.71122951e-05
   2.44599414e-05 -5.32140777e-05]
 [ 7.33793660e-03  6.96494430e-03 -3.25018099e-03  3.22445172e-05
   2.51163309e-05 -4.91965685e-05]
 [-3.51441584e-03 -3.25018099e-03  1.76169243e-03 -1.50800086e-05
  -1.04539539e-05  2.65047622e-05]
 [ 3.71122951e-05  3.22445172e-05 -1.50800086e-05  2.32107370e-07
   1.22031109e-07 -2.25570864e-07]
 [ 2.44599414e-05  2.51163309e-05 -1.04539539e-05  1.22031109e-07
   1.59078972e-07 -1.55092252e-07]
 [-5.32140777e-05 -4.91965685e-05  2.65047622e-05 -2.25570864e-07
  -1.55092252e-07  4.34097579e-07]]
[[-2.39374861]
 [ 0.34932797]
 [13.17749023]]
[[-1.90098048e-05]
 [-3.12438164e-05]
 [-1.62386168e-02]]


 Corrector Step
2018-07-13 08:29:10
[[-5.49294446e+03]
 [-3.19549795e+03]
 [-3.22966243e+03]
 [-2.63534091e+00]
 [-2.15246350e+00]
 [ 6.65291166e+00]
 [ 2.58028589e-01]
 [ 4.29876083e-02]
 [ 9.24312656e-01]
 [-2.77883837e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80843853e-18]]
[[ 8.09357506e-03  7.33793660e-03 -3.51441584e-03  3.71122951e-05
   2.44599414e-05 -5.32140777e-05]
 [ 7.33793660e-03  6.96494430e-03 -3.25018099e-03  3.22445172e-05
   2.51163309e-05 -4.91965685e-05]
 [-3.51441584e-03 -3.25018099e-03  1.76169243e-03 -1.50800086e-05
  -1.04539539e-05  2.65047622e-05]
 [ 3.71122951e-05  3.22445172e-05 -1.50800086e-05  2.32107370e-07
   1.22031109e-07 -2.25570864e-07]
 [ 2.44599414e-05  2.51163309e-05 -1.04539539e-05  1.22031109e-07
   1.59078972e-07 -1.55092252e-07]
 [-5.32140777e-05 -4.91965685e-05  2.65047622e-05 -2.25570864e-07
  -1.55092252e-07  4.34097579e-07]]
343702616.648556
post
cubesat_nadir
Ybar_post [[-2.39375256]
 [ 0.34932049]
 [13.17754502]]
resids [[-1.50614165e-05]
 [-2.37628304e-05]
 [-1.62934067e-02]]
posterior
[[-5.49291699e+03]
 [-3.19547800e+03]
 [-3.22967262e+03]
 [-2.63520504e+00]
 [-2.15237646e+00]
 [ 6.65276911e+00]]
[[-5.49292436e+03]
 [-3.19548305e+03]
 [-3.22967400e+03]
 [-2.63523791e+00]
 [-2.15239099e+00]
 [ 6.65277749e+00]]
[[ 4.85417754e-04  3.99151870e-04 -3.60630665e-05  2.11875876e-06
   1.23272067e-06 -1.25924178e-06]
 [ 3.99151870e-04  4.09397734e-04 -3.13742062e-05  1.69677175e-06
   1.36060112e-06 -1.13909732e-06]
 [-3.60630665e-05 -3.13742062e-05  6.17065927e-05 -1.51473614e-07
  -9.50077600e-08  3.87147255e-07]
 [ 2.11875876e-06  1.69677175e-06 -1.51473614e-07  1.01377549e-08
   5.24710767e-09 -5.32508472e-09]
 [ 1.23272067e-06  1.36060112e-06 -9.50077600e-08  5.24710767e-09
   5.59755795e-09 -3.43705115e-09]
 [-1.25924178e-06 -1.13909732e-06  3.87147255e-07 -5.32508472e-09
  -3.43705115e-09  6.83550630e-09]]
[[-2.39374906]
 [ 0.34932205]
 [12.13622904]]
[[-1.85627700e-05]
 [-2.53280554e-05]
 [ 1.02502258e+00]]


 Corrector Step
2018-07-13 08:29:10
[[-5.49292436e+03]
 [-3.19548305e+03]
 [-3.22967400e+03]
 [-2.63523791e+00]
 [-2.15239099e+00]
 [ 6.65277749e+00]]
[[ 4.85417754e-04  3.99151870e-04 -3.60630665e-05  2.11875876e-06
   1.23272067e-06 -1.25924178e-06]
 [ 3.99151870e-04  4.09397734e-04 -3.13742062e-05  1.69677175e-06
   1.36060112e-06 -1.13909732e-06]
 [-3.60630665e-05 -3.13742062e-05  6.17065927e-05 -1.51473614e-07
  -9.50077600e-08  3.87147255e-07]
 [ 2.11875876e-06  1.69677175e-06 -1.51473614e-07  1.01377549e-08
   5.24710767e-09 -5.32508472e-09]
 [ 1.23272067e-06  1.36060112e-06 -9.50077600e-08  5.24710767e-09
   5.59755795e-09 -3.43705115e-09]
 [-1.25924178e-06 -1.13909732e-06  3.87147255e-07 -5.32508472e-09
  -3.43705115e-09  6.83550630e-09]]
7.0833044294436185e-15
post
sphere_lamr_small
Ybar_post [[-2.39375022]
 [ 0.34931859]
 [12.13624247]]
resids [[-1.74022951e-05]
 [-2.18667501e-05]
 [ 1.02500915e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [343702616.648556, 7.0833044294436185e-15]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.49294446e+03],
       [-3.19549795e+03],
       [-3.22966243e+03],
       [-2.63534091e+00],
       [-2.15246350e+00],
       [ 6.65291166e+00]]), 'est_covars': array([[ 8.09357506e-03,  7.33793660e-03, -3.51441584e-03,
         3.71122951e-05,  2.44599414e-05, -5.32140777e-05],
       [ 7.33793660e-03,  6.96494430e-03, -3.25018099e-03,
         3.22445172e-05,  2.51163309e-05, -4.91965685e-05],
       [-3.51441584e-03, -3.25018099e-03,  1.76169243e-03,
        -1.50800086e-05, -1.04539539e-05,  2.65047622e-05],
       [ 3.71122951e-05,  3.22445172e-05, -1.50800086e-05,
         2.32107370e-07,  1.22031109e-07, -2.25570864e-07],
       [ 2.44599414e-05,  2.51163309e-05, -1.04539539e-05,
         1.22031109e-07,  1.59078972e-07, -1.55092252e-07],
       [-5.32140777e-05, -4.91965685e-05,  2.65047622e-05,
        -2.25570864e-07, -1.55092252e-07,  4.34097579e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.49292436e+03],
       [-3.19548305e+03],
       [-3.22967400e+03],
       [-2.63523791e+00],
       [-2.15239099e+00],
       [ 6.65277749e+00]]), 'covar': array([[ 4.85417754e-04,  3.99151870e-04, -3.60630665e-05,
         2.11875876e-06,  1.23272067e-06, -1.25924178e-06],
       [ 3.99151870e-04,  4.09397734e-04, -3.13742062e-05,
         1.69677175e-06,  1.36060112e-06, -1.13909732e-06],
       [-3.60630665e-05, -3.13742062e-05,  6.17065927e-05,
        -1.51473614e-07, -9.50077600e-08,  3.87147255e-07],
       [ 2.11875876e-06,  1.69677175e-06, -1.51473614e-07,
         1.01377549e-08,  5.24710767e-09, -5.32508472e-09],
       [ 1.23272067e-06,  1.36060112e-06, -9.50077600e-08,
         5.24710767e-09,  5.59755795e-09, -3.43705115e-09],
       [-1.25924178e-06, -1.13909732e-06,  3.87147255e-07,
        -5.32508472e-09, -3.43705115e-09,  6.83550630e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.74022951e-05],
       [-2.18667501e-05],
       [ 1.02500915e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.49294446e+03],
       [-3.19549795e+03],
       [-3.22966243e+03],
       [-2.63534091e+00],
       [-2.15246350e+00],
       [ 6.65291166e+00],
       [ 2.58028589e-01],
       [ 4.29876083e-02],
       [ 9.24312656e-01],
       [-2.77883837e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80843853e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.09357506e-03,  7.33793660e-03, -3.51441584e-03,
         3.71122951e-05,  2.44599414e-05, -5.32140777e-05],
       [ 7.33793660e-03,  6.96494430e-03, -3.25018099e-03,
         3.22445172e-05,  2.51163309e-05, -4.91965685e-05],
       [-3.51441584e-03, -3.25018099e-03,  1.76169243e-03,
        -1.50800086e-05, -1.04539539e-05,  2.65047622e-05],
       [ 3.71122951e-05,  3.22445172e-05, -1.50800086e-05,
         2.32107370e-07,  1.22031109e-07, -2.25570864e-07],
       [ 2.44599414e-05,  2.51163309e-05, -1.04539539e-05,
         1.22031109e-07,  1.59078972e-07, -1.55092252e-07],
       [-5.32140777e-05, -4.91965685e-05,  2.65047622e-05,
        -2.25570864e-07, -1.55092252e-07,  4.34097579e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.50614165e-05],
       [-2.37628304e-05],
       [-1.62934067e-02]])}}
Current time:  2018-07-13 08:29:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.49294446e+03],
       [-3.19549795e+03],
       [-3.22966243e+03],
       [-2.63534091e+00],
       [-2.15246350e+00],
       [ 6.65291166e+00],
       [ 2.58028589e-01],
       [ 4.29876083e-02],
       [ 9.24312656e-01],
       [-2.77883837e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80843853e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.09357506e-03,  7.33793660e-03, -3.51441584e-03,
         3.71122951e-05,  2.44599414e-05, -5.32140777e-05],
       [ 7.33793660e-03,  6.96494430e-03, -3.25018099e-03,
         3.22445172e-05,  2.51163309e-05, -4.91965685e-05],
       [-3.51441584e-03, -3.25018099e-03,  1.76169243e-03,
        -1.50800086e-05, -1.04539539e-05,  2.65047622e-05],
       [ 3.71122951e-05,  3.22445172e-05, -1.50800086e-05,
         2.32107370e-07,  1.22031109e-07, -2.25570864e-07],
       [ 2.44599414e-05,  2.51163309e-05, -1.04539539e-05,
         1.22031109e-07,  1.59078972e-07, -1.55092252e-07],
       [-5.32140777e-05, -4.91965685e-05,  2.65047622e-05,
        -2.25570864e-07, -1.55092252e-07,  4.34097579e-07]])}
[[-5.49294446e+03]
 [-3.19549795e+03]
 [-3.22966243e+03]
 [-2.63534091e+00]
 [-2.15246350e+00]
 [ 6.65291166e+00]
 [ 2.58028589e-01]
 [ 4.29876083e-02]
 [ 9.24312656e-01]
 [-2.77883837e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80843853e-18]]
2018-07-13 08:29:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:20
[[-5.51899504e+03]
 [-3.21684630e+03]
 [-3.16295632e+03]
 [-2.57474952e+00]
 [-2.11718067e+00]
 [ 6.68817742e+00]
 [ 2.62851198e-01]
 [ 4.44379409e-02]
 [ 9.22952808e-01]
 [-2.77655598e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80865082e-18]]
[[ 8.86052783e-03  7.91797015e-03 -4.21931888e-03  3.96052156e-05
   2.57213759e-05 -5.53047690e-05]
 [ 7.91797015e-03  7.48378670e-03 -3.86149248e-03  3.35758747e-05
   2.67905087e-05 -5.05948373e-05]
 [-4.21931888e-03 -3.86149248e-03  2.33464411e-03 -1.73864768e-05
  -1.20186715e-05  3.08080895e-05]
 [ 3.96052156e-05  3.35758747e-05 -1.73864768e-05  2.43154418e-07
   1.22605363e-07 -2.25554726e-07]
 [ 2.57213759e-05  2.67905087e-05 -1.20186715e-05  1.22605363e-07
   1.69279328e-07 -1.54796758e-07]
 [-5.53047690e-05 -5.05948373e-05  3.08080895e-05 -2.25554726e-07
  -1.54796758e-07  4.41936839e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.49292436e+03],
       [-3.19548305e+03],
       [-3.22967400e+03],
       [-2.63523791e+00],
       [-2.15239099e+00],
       [ 6.65277749e+00]]), 'covar': array([[ 4.85417754e-04,  3.99151870e-04, -3.60630665e-05,
         2.11875876e-06,  1.23272067e-06, -1.25924178e-06],
       [ 3.99151870e-04,  4.09397734e-04, -3.13742062e-05,
         1.69677175e-06,  1.36060112e-06, -1.13909732e-06],
       [-3.60630665e-05, -3.13742062e-05,  6.17065927e-05,
        -1.51473614e-07, -9.50077600e-08,  3.87147255e-07],
       [ 2.11875876e-06,  1.69677175e-06, -1.51473614e-07,
         1.01377549e-08,  5.24710767e-09, -5.32508472e-09],
       [ 1.23272067e-06,  1.36060112e-06, -9.50077600e-08,
         5.24710767e-09,  5.59755795e-09, -3.43705115e-09],
       [-1.25924178e-06, -1.13909732e-06,  3.87147255e-07,
        -5.32508472e-09, -3.43705115e-09,  6.83550630e-09]])}
[[-5.49292436e+03]
 [-3.19548305e+03]
 [-3.22967400e+03]
 [-2.63523791e+00]
 [-2.15239099e+00]
 [ 6.65277749e+00]]
2018-07-13 08:29:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:20
[[-5.51897399e+03]
 [-3.21683068e+03]
 [-3.16296932e+03]
 [-2.57464629e+00]
 [-2.11710800e+00]
 [ 6.68804389e+00]]
[[ 5.28904507e-04  4.29039377e-04 -5.06600037e-05  2.22967148e-06
   1.28914447e-06 -1.30358419e-06]
 [ 4.29039377e-04  4.37206635e-04 -4.40184089e-05  1.75748499e-06
   1.41982992e-06 -1.16559127e-06]
 [-5.06600037e-05 -4.40184089e-05  7.01213387e-05 -2.04687854e-07
  -1.29184441e-07  4.54729160e-07]
 [ 2.22967148e-06  1.75748499e-06 -2.04687854e-07  1.03110491e-08
   5.28898453e-09 -5.30717760e-09]
 [ 1.28914447e-06  1.41982992e-06 -1.29184441e-07  5.28898453e-09
   5.71295530e-09 -3.41959090e-09]
 [-1.30358419e-06 -1.16559127e-06  4.54729160e-07 -5.30717760e-09
  -3.41959090e-09  6.88734301e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.51897399e+03],
       [-3.21683068e+03],
       [-3.16296932e+03],
       [-2.57464629e+00],
       [-2.11710800e+00],
       [ 6.68804389e+00]]), 'covar': array([[ 5.28904507e-04,  4.29039377e-04, -5.06600037e-05,
         2.22967148e-06,  1.28914447e-06, -1.30358419e-06],
       [ 4.29039377e-04,  4.37206635e-04, -4.40184089e-05,
         1.75748499e-06,  1.41982992e-06, -1.16559127e-06],
       [-5.06600037e-05, -4.40184089e-05,  7.01213387e-05,
        -2.04687854e-07, -1.29184441e-07,  4.54729160e-07],
       [ 2.22967148e-06,  1.75748499e-06, -2.04687854e-07,
         1.03110491e-08,  5.28898453e-09, -5.30717760e-09],
       [ 1.28914447e-06,  1.41982992e-06, -1.29184441e-07,
         5.28898453e-09,  5.71295530e-09, -3.41959090e-09],
       [-1.30358419e-06, -1.16559127e-06,  4.54729160e-07,
        -5.30717760e-09, -3.41959090e-09,  6.88734301e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.74022951e-05],
       [-2.18667501e-05],
       [ 1.02500915e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.51899504e+03],
       [-3.21684630e+03],
       [-3.16295632e+03],
       [-2.57474952e+00],
       [-2.11718067e+00],
       [ 6.68817742e+00],
       [ 2.62851198e-01],
       [ 4.44379409e-02],
       [ 9.22952808e-01],
       [-2.77655598e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80865082e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.86052783e-03,  7.91797015e-03, -4.21931888e-03,
         3.96052156e-05,  2.57213759e-05, -5.53047690e-05],
       [ 7.91797015e-03,  7.48378670e-03, -3.86149248e-03,
         3.35758747e-05,  2.67905087e-05, -5.05948373e-05],
       [-4.21931888e-03, -3.86149248e-03,  2.33464411e-03,
        -1.73864768e-05, -1.20186715e-05,  3.08080895e-05],
       [ 3.96052156e-05,  3.35758747e-05, -1.73864768e-05,
         2.43154418e-07,  1.22605363e-07, -2.25554726e-07],
       [ 2.57213759e-05,  2.67905087e-05, -1.20186715e-05,
         1.22605363e-07,  1.69279328e-07, -1.54796758e-07],
       [-5.53047690e-05, -5.05948373e-05,  3.08080895e-05,
        -2.25554726e-07, -1.54796758e-07,  4.41936839e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.50614165e-05],
       [-2.37628304e-05],
       [-1.62934067e-02]])}}
Yi [[-2.39851149]
 [ 0.38890183]
 [13.49373416]]
posterior
[[-5.51899504e+03]
 [-3.21684630e+03]
 [-3.16295632e+03]
 [-2.57474952e+00]
 [-2.11718067e+00]
 [ 6.68817742e+00]
 [ 2.62851198e-01]
 [ 4.44379409e-02]
 [ 9.22952808e-01]
 [-2.77655598e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80865082e-18]]
[[-5.51900568e+03]
 [-3.21685550e+03]
 [-3.16295609e+03]
 [-2.57481520e+00]
 [-2.11722555e+00]
 [ 6.68817710e+00]
 [ 2.62851198e-01]
 [ 4.44379409e-02]
 [ 9.22952808e-01]
 [-2.77655598e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80865082e-18]]
[[ 8.55649987e-03  7.68309693e-03 -4.21364727e-03  3.76242020e-05
   2.47195126e-05 -5.53192103e-05]
 [ 7.68309693e-03  7.22259516e-03 -3.85939159e-03  3.23301173e-05
   2.52020847e-05 -5.06536219e-05]
 [-4.21364727e-03 -3.85939159e-03  2.33446307e-03 -1.73414152e-05
  -1.20233103e-05  3.08068586e-05]
 [ 3.76242020e-05  3.23301173e-05 -1.73414152e-05  2.29230129e-07
   1.18984460e-07 -2.25479295e-07]
 [ 2.47195126e-05  2.52020847e-05 -1.20233103e-05  1.18984460e-07
   1.57659505e-07 -1.55331280e-07]
 [-5.53192103e-05 -5.06536219e-05  3.08068586e-05 -2.25479295e-07
  -1.55331280e-07  4.41905800e-07]]
[[-2.39850962]
 [ 0.38891871]
 [13.43674397]]
[[-1.87057647e-06]
 [-1.68802143e-05]
 [ 5.69901831e-02]]


 Corrector Step
2018-07-13 08:29:20
[[-5.51900568e+03]
 [-3.21685550e+03]
 [-3.16295609e+03]
 [-2.57481520e+00]
 [-2.11722555e+00]
 [ 6.68817710e+00]
 [ 2.62851198e-01]
 [ 4.44379409e-02]
 [ 9.22952808e-01]
 [-2.77655598e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80865082e-18]]
[[ 8.55649987e-03  7.68309693e-03 -4.21364727e-03  3.76242020e-05
   2.47195126e-05 -5.53192103e-05]
 [ 7.68309693e-03  7.22259516e-03 -3.85939159e-03  3.23301173e-05
   2.52020847e-05 -5.06536219e-05]
 [-4.21364727e-03 -3.85939159e-03  2.33446307e-03 -1.73414152e-05
  -1.20233103e-05  3.08068586e-05]
 [ 3.76242020e-05  3.23301173e-05 -1.73414152e-05  2.29230129e-07
   1.18984460e-07 -2.25479295e-07]
 [ 2.47195126e-05  2.52020847e-05 -1.20233103e-05  1.18984460e-07
   1.57659505e-07 -1.55331280e-07]
 [-5.53192103e-05 -5.06536219e-05  3.08068586e-05 -2.25479295e-07
  -1.55331280e-07  4.41905800e-07]]
592715343.815487
post
cubesat_nadir
Ybar_post [[-2.39851004]
 [ 0.38891478]
 [13.43675602]]
resids [[-1.44961491e-06]
 [-1.29571442e-05]
 [ 5.69781374e-02]]
posterior
[[-5.51897399e+03]
 [-3.21683068e+03]
 [-3.16296932e+03]
 [-2.57464629e+00]
 [-2.11710800e+00]
 [ 6.68804389e+00]]
[[-5.51897800e+03]
 [-3.21683393e+03]
 [-3.16296997e+03]
 [-2.57466333e+00]
 [-2.11711786e+00]
 [ 6.68804858e+00]]
[[ 4.87967262e-04  3.95120020e-04 -5.78717083e-05  2.05627115e-06
   1.18525638e-06 -1.25768249e-06]
 [ 3.95120020e-04  4.03980329e-04 -5.07066807e-05  1.61665356e-06
   1.31217697e-06 -1.12575757e-06]
 [-5.78717083e-05 -5.07066807e-05  6.87516562e-05 -2.34839225e-07
  -1.50488716e-07  4.63066033e-07]
 [ 2.05627115e-06  1.61665356e-06 -2.34839225e-07  9.57498906e-09
   4.86091441e-09 -5.11374864e-09]
 [ 1.18525638e-06  1.31217697e-06 -1.50488716e-07  4.86091441e-09
   5.35843605e-09 -3.29551815e-09]
 [-1.25768249e-06 -1.12575757e-06  4.63066033e-07 -5.11374864e-09
  -3.29551815e-09  6.83524124e-09]]
[[-2.39850736]
 [ 0.38891707]
 [12.26201081]]
[[-4.13555297e-06]
 [-1.52410866e-05]
 [ 1.23172334e+00]]


 Corrector Step
2018-07-13 08:29:20
[[-5.51897800e+03]
 [-3.21683393e+03]
 [-3.16296997e+03]
 [-2.57466333e+00]
 [-2.11711786e+00]
 [ 6.68804858e+00]]
[[ 4.87967262e-04  3.95120020e-04 -5.78717083e-05  2.05627115e-06
   1.18525638e-06 -1.25768249e-06]
 [ 3.95120020e-04  4.03980329e-04 -5.07066807e-05  1.61665356e-06
   1.31217697e-06 -1.12575757e-06]
 [-5.78717083e-05 -5.07066807e-05  6.87516562e-05 -2.34839225e-07
  -1.50488716e-07  4.63066033e-07]
 [ 2.05627115e-06  1.61665356e-06 -2.34839225e-07  9.57498906e-09
   4.86091441e-09 -5.11374864e-09]
 [ 1.18525638e-06  1.31217697e-06 -1.50488716e-07  4.86091441e-09
   5.35843605e-09 -3.29551815e-09]
 [-1.25768249e-06 -1.12575757e-06  4.63066033e-07 -5.11374864e-09
  -3.29551815e-09  6.83524124e-09]]
9.259497870160275e-25
post
sphere_lamr_small
Ybar_post [[-2.39850768]
 [ 0.38891511]
 [12.2620181 ]]
resids [[-3.81194895e-06]
 [-1.32806563e-05]
 [ 1.23171606e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [592715343.815487, 9.259497870160275e-25]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.51900568e+03],
       [-3.21685550e+03],
       [-3.16295609e+03],
       [-2.57481520e+00],
       [-2.11722555e+00],
       [ 6.68817710e+00]]), 'est_covars': array([[ 8.55649987e-03,  7.68309693e-03, -4.21364727e-03,
         3.76242020e-05,  2.47195126e-05, -5.53192103e-05],
       [ 7.68309693e-03,  7.22259516e-03, -3.85939159e-03,
         3.23301173e-05,  2.52020847e-05, -5.06536219e-05],
       [-4.21364727e-03, -3.85939159e-03,  2.33446307e-03,
        -1.73414152e-05, -1.20233103e-05,  3.08068586e-05],
       [ 3.76242020e-05,  3.23301173e-05, -1.73414152e-05,
         2.29230129e-07,  1.18984460e-07, -2.25479295e-07],
       [ 2.47195126e-05,  2.52020847e-05, -1.20233103e-05,
         1.18984460e-07,  1.57659505e-07, -1.55331280e-07],
       [-5.53192103e-05, -5.06536219e-05,  3.08068586e-05,
        -2.25479295e-07, -1.55331280e-07,  4.41905800e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.51897800e+03],
       [-3.21683393e+03],
       [-3.16296997e+03],
       [-2.57466333e+00],
       [-2.11711786e+00],
       [ 6.68804858e+00]]), 'covar': array([[ 4.87967262e-04,  3.95120020e-04, -5.78717083e-05,
         2.05627115e-06,  1.18525638e-06, -1.25768249e-06],
       [ 3.95120020e-04,  4.03980329e-04, -5.07066807e-05,
         1.61665356e-06,  1.31217697e-06, -1.12575757e-06],
       [-5.78717083e-05, -5.07066807e-05,  6.87516562e-05,
        -2.34839225e-07, -1.50488716e-07,  4.63066033e-07],
       [ 2.05627115e-06,  1.61665356e-06, -2.34839225e-07,
         9.57498906e-09,  4.86091441e-09, -5.11374864e-09],
       [ 1.18525638e-06,  1.31217697e-06, -1.50488716e-07,
         4.86091441e-09,  5.35843605e-09, -3.29551815e-09],
       [-1.25768249e-06, -1.12575757e-06,  4.63066033e-07,
        -5.11374864e-09, -3.29551815e-09,  6.83524124e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.81194895e-06],
       [-1.32806563e-05],
       [ 1.23171606e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.51900568e+03],
       [-3.21685550e+03],
       [-3.16295609e+03],
       [-2.57481520e+00],
       [-2.11722555e+00],
       [ 6.68817710e+00],
       [ 2.62851198e-01],
       [ 4.44379409e-02],
       [ 9.22952808e-01],
       [-2.77655598e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80865082e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.55649987e-03,  7.68309693e-03, -4.21364727e-03,
         3.76242020e-05,  2.47195126e-05, -5.53192103e-05],
       [ 7.68309693e-03,  7.22259516e-03, -3.85939159e-03,
         3.23301173e-05,  2.52020847e-05, -5.06536219e-05],
       [-4.21364727e-03, -3.85939159e-03,  2.33446307e-03,
        -1.73414152e-05, -1.20233103e-05,  3.08068586e-05],
       [ 3.76242020e-05,  3.23301173e-05, -1.73414152e-05,
         2.29230129e-07,  1.18984460e-07, -2.25479295e-07],
       [ 2.47195126e-05,  2.52020847e-05, -1.20233103e-05,
         1.18984460e-07,  1.57659505e-07, -1.55331280e-07],
       [-5.53192103e-05, -5.06536219e-05,  3.08068586e-05,
        -2.25479295e-07, -1.55331280e-07,  4.41905800e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.44961491e-06],
       [-1.29571442e-05],
       [ 5.69781374e-02]])}}
Current time:  2018-07-13 08:29:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.51900568e+03],
       [-3.21685550e+03],
       [-3.16295609e+03],
       [-2.57481520e+00],
       [-2.11722555e+00],
       [ 6.68817710e+00],
       [ 2.62851198e-01],
       [ 4.44379409e-02],
       [ 9.22952808e-01],
       [-2.77655598e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80865082e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.55649987e-03,  7.68309693e-03, -4.21364727e-03,
         3.76242020e-05,  2.47195126e-05, -5.53192103e-05],
       [ 7.68309693e-03,  7.22259516e-03, -3.85939159e-03,
         3.23301173e-05,  2.52020847e-05, -5.06536219e-05],
       [-4.21364727e-03, -3.85939159e-03,  2.33446307e-03,
        -1.73414152e-05, -1.20233103e-05,  3.08068586e-05],
       [ 3.76242020e-05,  3.23301173e-05, -1.73414152e-05,
         2.29230129e-07,  1.18984460e-07, -2.25479295e-07],
       [ 2.47195126e-05,  2.52020847e-05, -1.20233103e-05,
         1.18984460e-07,  1.57659505e-07, -1.55331280e-07],
       [-5.53192103e-05, -5.06536219e-05,  3.08068586e-05,
        -2.25479295e-07, -1.55331280e-07,  4.41905800e-07]])}
[[-5.51900568e+03]
 [-3.21685550e+03]
 [-3.16295609e+03]
 [-2.57481520e+00]
 [-2.11722555e+00]
 [ 6.68817710e+00]
 [ 2.62851198e-01]
 [ 4.44379409e-02]
 [ 9.22952808e-01]
 [-2.77655598e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80865082e-18]]
2018-07-13 08:29:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:30
[[-5.54444932e+03]
 [-3.23785029e+03]
 [-3.09590103e+03]
 [-2.51393272e+00]
 [-2.08170498e+00]
 [ 6.72270904e+00]
 [ 2.67666640e-01]
 [ 4.58870620e-02]
 [ 9.21567799e-01]
 [-2.77419788e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80886311e-18]]
[[ 9.33380640e-03  8.26634274e-03 -4.96219229e-03  4.00915576e-05
   2.59519981e-05 -5.73996283e-05]
 [ 8.26634274e-03  7.74300623e-03 -4.50098134e-03  3.36330068e-05
   2.68628852e-05 -5.20469601e-05]
 [-4.96219229e-03 -4.50098134e-03  2.99407938e-03 -1.96552389e-05
  -1.35930721e-05  3.51731578e-05]
 [ 4.00915576e-05  3.36330068e-05 -1.96552389e-05  2.40265619e-07
   1.19554372e-07 -2.25460962e-07]
 [ 2.59519981e-05  2.68628852e-05 -1.35930721e-05  1.19554372e-07
   1.67857623e-07 -1.55033330e-07]
 [-5.73996283e-05 -5.20469601e-05  3.51731578e-05 -2.25460962e-07
  -1.55033330e-07  4.49652341e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.51897800e+03],
       [-3.21683393e+03],
       [-3.16296997e+03],
       [-2.57466333e+00],
       [-2.11711786e+00],
       [ 6.68804858e+00]]), 'covar': array([[ 4.87967262e-04,  3.95120020e-04, -5.78717083e-05,
         2.05627115e-06,  1.18525638e-06, -1.25768249e-06],
       [ 3.95120020e-04,  4.03980329e-04, -5.07066807e-05,
         1.61665356e-06,  1.31217697e-06, -1.12575757e-06],
       [-5.78717083e-05, -5.07066807e-05,  6.87516562e-05,
        -2.34839225e-07, -1.50488716e-07,  4.63066033e-07],
       [ 2.05627115e-06,  1.61665356e-06, -2.34839225e-07,
         9.57498906e-09,  4.86091441e-09, -5.11374864e-09],
       [ 1.18525638e-06,  1.31217697e-06, -1.50488716e-07,
         4.86091441e-09,  5.35843605e-09, -3.29551815e-09],
       [-1.25768249e-06, -1.12575757e-06,  4.63066033e-07,
        -5.11374864e-09, -3.29551815e-09,  6.83524124e-09]])}
[[-5.51897800e+03]
 [-3.21683393e+03]
 [-3.16296997e+03]
 [-2.57466333e+00]
 [-2.11711786e+00]
 [ 6.68804858e+00]]
2018-07-13 08:29:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:30
[[-5.54442039e+03]
 [-3.23782755e+03]
 [-3.09591618e+03]
 [-2.51378049e+00]
 [-2.08159718e+00]
 [ 6.72258149e+00]]
[[ 5.30138626e-04  4.23700789e-04 -7.32601398e-05  2.16138250e-06
   1.23781042e-06 -1.29997560e-06]
 [ 4.23700789e-04  4.30867047e-04 -6.37384952e-05  1.67328419e-06
   1.36899847e-06 -1.15090989e-06]
 [-7.32601398e-05 -6.37384952e-05  7.86889530e-05 -2.86304818e-07
  -1.83374907e-07  5.30246381e-07]
 [ 2.16138250e-06  1.67328419e-06 -2.86304818e-07  9.74462205e-09
   4.90105594e-09 -5.09683619e-09]
 [ 1.23781042e-06  1.36899847e-06 -1.83374907e-07  4.90105594e-09
   5.47301031e-09 -3.27889558e-09]
 [-1.29997560e-06 -1.15090989e-06  5.30246381e-07 -5.09683619e-09
  -3.27889558e-09  6.88687787e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.54442039e+03],
       [-3.23782755e+03],
       [-3.09591618e+03],
       [-2.51378049e+00],
       [-2.08159718e+00],
       [ 6.72258149e+00]]), 'covar': array([[ 5.30138626e-04,  4.23700789e-04, -7.32601398e-05,
         2.16138250e-06,  1.23781042e-06, -1.29997560e-06],
       [ 4.23700789e-04,  4.30867047e-04, -6.37384952e-05,
         1.67328419e-06,  1.36899847e-06, -1.15090989e-06],
       [-7.32601398e-05, -6.37384952e-05,  7.86889530e-05,
        -2.86304818e-07, -1.83374907e-07,  5.30246381e-07],
       [ 2.16138250e-06,  1.67328419e-06, -2.86304818e-07,
         9.74462205e-09,  4.90105594e-09, -5.09683619e-09],
       [ 1.23781042e-06,  1.36899847e-06, -1.83374907e-07,
         4.90105594e-09,  5.47301031e-09, -3.27889558e-09],
       [-1.29997560e-06, -1.15090989e-06,  5.30246381e-07,
        -5.09683619e-09, -3.27889558e-09,  6.88687787e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.81194895e-06],
       [-1.32806563e-05],
       [ 1.23171606e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.54444932e+03],
       [-3.23785029e+03],
       [-3.09590103e+03],
       [-2.51393272e+00],
       [-2.08170498e+00],
       [ 6.72270904e+00],
       [ 2.67666640e-01],
       [ 4.58870620e-02],
       [ 9.21567799e-01],
       [-2.77419788e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80886311e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.33380640e-03,  8.26634274e-03, -4.96219229e-03,
         4.00915576e-05,  2.59519981e-05, -5.73996283e-05],
       [ 8.26634274e-03,  7.74300623e-03, -4.50098134e-03,
         3.36330068e-05,  2.68628852e-05, -5.20469601e-05],
       [-4.96219229e-03, -4.50098134e-03,  2.99407938e-03,
        -1.96552389e-05, -1.35930721e-05,  3.51731578e-05],
       [ 4.00915576e-05,  3.36330068e-05, -1.96552389e-05,
         2.40265619e-07,  1.19554372e-07, -2.25460962e-07],
       [ 2.59519981e-05,  2.68628852e-05, -1.35930721e-05,
         1.19554372e-07,  1.67857623e-07, -1.55033330e-07],
       [-5.73996283e-05, -5.20469601e-05,  3.51731578e-05,
        -2.25460962e-07, -1.55033330e-07,  4.49652341e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.44961491e-06],
       [-1.29571442e-05],
       [ 5.69781374e-02]])}}
Yi [[-2.40289389]
 [ 0.42567302]
 [13.76295147]]
posterior
[[-5.54444932e+03]
 [-3.23785029e+03]
 [-3.09590103e+03]
 [-2.51393272e+00]
 [-2.08170498e+00]
 [ 6.72270904e+00]
 [ 2.67666640e-01]
 [ 4.58870620e-02]
 [ 9.21567799e-01]
 [-2.77419788e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80886311e-18]]
[[-5.54447245e+03]
 [-3.23787273e+03]
 [-3.09589950e+03]
 [-2.51406402e+00]
 [-2.08182764e+00]
 [ 6.72270804e+00]
 [ 2.67666640e-01]
 [ 4.58870620e-02]
 [ 9.21567799e-01]
 [-2.77419788e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80886311e-18]]
[[ 9.02389976e-03  8.03076194e-03 -4.94218909e-03  3.81011903e-05
   2.49636160e-05 -5.73895851e-05]
 [ 8.03076194e-03  7.48249589e-03 -4.48639707e-03  3.24052774e-05
   2.52873703e-05 -5.20848297e-05]
 [-4.94218909e-03 -4.48639707e-03  2.99277273e-03 -1.95246304e-05
  -1.35356053e-05  3.51720198e-05]
 [ 3.81011903e-05  3.24052774e-05 -1.95246304e-05  2.26482933e-07
   1.16093822e-07 -2.25237553e-07]
 [ 2.49636160e-05  2.52873703e-05 -1.35356053e-05  1.16093822e-07
   1.56363419e-07 -1.55462375e-07]
 [-5.73895851e-05 -5.20848297e-05  3.51720198e-05 -2.25237553e-07
  -1.55462375e-07  4.49624704e-07]]
[[-2.40289751]
 [ 0.42571177]
 [13.69111824]]
[[ 3.61221262e-06]
 [-3.87492960e-05]
 [ 7.18332281e-02]]


 Corrector Step
2018-07-13 08:29:30
[[-5.54447245e+03]
 [-3.23787273e+03]
 [-3.09589950e+03]
 [-2.51406402e+00]
 [-2.08182764e+00]
 [ 6.72270804e+00]
 [ 2.67666640e-01]
 [ 4.58870620e-02]
 [ 9.21567799e-01]
 [-2.77419788e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80886311e-18]]
[[ 9.02389976e-03  8.03076194e-03 -4.94218909e-03  3.81011903e-05
   2.49636160e-05 -5.73895851e-05]
 [ 8.03076194e-03  7.48249589e-03 -4.48639707e-03  3.24052774e-05
   2.52873703e-05 -5.20848297e-05]
 [-4.94218909e-03 -4.48639707e-03  2.99277273e-03 -1.95246304e-05
  -1.35356053e-05  3.51720198e-05]
 [ 3.81011903e-05  3.24052774e-05 -1.95246304e-05  2.26482933e-07
   1.16093822e-07 -2.25237553e-07]
 [ 2.49636160e-05  2.52873703e-05 -1.35356053e-05  1.16093822e-07
   1.56363419e-07 -1.55462375e-07]
 [-5.73895851e-05 -5.20848297e-05  3.51720198e-05 -2.25237553e-07
  -1.55462375e-07  4.49624704e-07]]
241373313.08864817
post
cubesat_nadir
Ybar_post [[-2.40289675]
 [ 0.425703  ]
 [13.69112259]]
resids [[ 2.85734433e-06]
 [-2.99811278e-05]
 [ 7.18288775e-02]]
posterior
[[-5.54442039e+03]
 [-3.23782755e+03]
 [-3.09591618e+03]
 [-2.51378049e+00]
 [-2.08159718e+00]
 [ 6.72258149e+00]]
[[-5.54442978e+03]
 [-3.23783611e+03]
 [-3.09591754e+03]
 [-2.51381851e+00]
 [-2.08162378e+00]
 [ 6.72259208e+00]]
[[ 4.91272934e-04  3.92119969e-04 -7.86271616e-05  2.00175905e-06
   1.14350530e-06 -1.25834121e-06]
 [ 3.92119969e-04  3.99965562e-04 -6.87271137e-05  1.54653042e-06
   1.27067536e-06 -1.11537104e-06]
 [-7.86271616e-05 -6.87271137e-05  7.78726397e-05 -3.07994118e-07
  -1.98995847e-07  5.36200268e-07]
 [ 2.00175905e-06  1.54653042e-06 -3.07994118e-07  9.08737894e-09
   4.52595440e-09 -4.92680338e-09]
 [ 1.14350530e-06  1.27067536e-06 -1.98995847e-07  4.52595440e-09
   5.15436933e-09 -3.17079997e-09]
 [-1.25834121e-06 -1.11537104e-06  5.36200268e-07 -4.92680338e-09
  -3.17079997e-09  6.84172034e-09]]
[[-2.4028953 ]
 [ 0.42571276]
 [12.38457417]]
[[ 1.40684076e-06]
 [-3.97402232e-05]
 [ 1.37837729e+00]]


 Corrector Step
2018-07-13 08:29:30
[[-5.54442978e+03]
 [-3.23783611e+03]
 [-3.09591754e+03]
 [-2.51381851e+00]
 [-2.08162378e+00]
 [ 6.72259208e+00]]
[[ 4.91272934e-04  3.92119969e-04 -7.86271616e-05  2.00175905e-06
   1.14350530e-06 -1.25834121e-06]
 [ 3.92119969e-04  3.99965562e-04 -6.87271137e-05  1.54653042e-06
   1.27067536e-06 -1.11537104e-06]
 [-7.86271616e-05 -6.87271137e-05  7.78726397e-05 -3.07994118e-07
  -1.98995847e-07  5.36200268e-07]
 [ 2.00175905e-06  1.54653042e-06 -3.07994118e-07  9.08737894e-09
   4.52595440e-09 -4.92680338e-09]
 [ 1.14350530e-06  1.27067536e-06 -1.98995847e-07  4.52595440e-09
   5.15436933e-09 -3.17079997e-09]
 [-1.25834121e-06 -1.11537104e-06  5.36200268e-07 -4.92680338e-09
  -3.17079997e-09  6.84172034e-09]]
1.6718271766461504e-33
post
sphere_lamr_small
Ybar_post [[-2.40289541]
 [ 0.42570799]
 [12.38458947]]
resids [[ 1.51809985e-06]
 [-3.49770925e-05]
 [ 1.37836200e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [241373313.08864817, 1.6718271766461504e-33]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.54447245e+03],
       [-3.23787273e+03],
       [-3.09589950e+03],
       [-2.51406402e+00],
       [-2.08182764e+00],
       [ 6.72270804e+00]]), 'est_covars': array([[ 9.02389976e-03,  8.03076194e-03, -4.94218909e-03,
         3.81011903e-05,  2.49636160e-05, -5.73895851e-05],
       [ 8.03076194e-03,  7.48249589e-03, -4.48639707e-03,
         3.24052774e-05,  2.52873703e-05, -5.20848297e-05],
       [-4.94218909e-03, -4.48639707e-03,  2.99277273e-03,
        -1.95246304e-05, -1.35356053e-05,  3.51720198e-05],
       [ 3.81011903e-05,  3.24052774e-05, -1.95246304e-05,
         2.26482933e-07,  1.16093822e-07, -2.25237553e-07],
       [ 2.49636160e-05,  2.52873703e-05, -1.35356053e-05,
         1.16093822e-07,  1.56363419e-07, -1.55462375e-07],
       [-5.73895851e-05, -5.20848297e-05,  3.51720198e-05,
        -2.25237553e-07, -1.55462375e-07,  4.49624704e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.54442978e+03],
       [-3.23783611e+03],
       [-3.09591754e+03],
       [-2.51381851e+00],
       [-2.08162378e+00],
       [ 6.72259208e+00]]), 'covar': array([[ 4.91272934e-04,  3.92119969e-04, -7.86271616e-05,
         2.00175905e-06,  1.14350530e-06, -1.25834121e-06],
       [ 3.92119969e-04,  3.99965562e-04, -6.87271137e-05,
         1.54653042e-06,  1.27067536e-06, -1.11537104e-06],
       [-7.86271616e-05, -6.87271137e-05,  7.78726397e-05,
        -3.07994118e-07, -1.98995847e-07,  5.36200268e-07],
       [ 2.00175905e-06,  1.54653042e-06, -3.07994118e-07,
         9.08737894e-09,  4.52595440e-09, -4.92680338e-09],
       [ 1.14350530e-06,  1.27067536e-06, -1.98995847e-07,
         4.52595440e-09,  5.15436933e-09, -3.17079997e-09],
       [-1.25834121e-06, -1.11537104e-06,  5.36200268e-07,
        -4.92680338e-09, -3.17079997e-09,  6.84172034e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.51809985e-06],
       [-3.49770925e-05],
       [ 1.37836200e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.54447245e+03],
       [-3.23787273e+03],
       [-3.09589950e+03],
       [-2.51406402e+00],
       [-2.08182764e+00],
       [ 6.72270804e+00],
       [ 2.67666640e-01],
       [ 4.58870620e-02],
       [ 9.21567799e-01],
       [-2.77419788e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80886311e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.02389976e-03,  8.03076194e-03, -4.94218909e-03,
         3.81011903e-05,  2.49636160e-05, -5.73895851e-05],
       [ 8.03076194e-03,  7.48249589e-03, -4.48639707e-03,
         3.24052774e-05,  2.52873703e-05, -5.20848297e-05],
       [-4.94218909e-03, -4.48639707e-03,  2.99277273e-03,
        -1.95246304e-05, -1.35356053e-05,  3.51720198e-05],
       [ 3.81011903e-05,  3.24052774e-05, -1.95246304e-05,
         2.26482933e-07,  1.16093822e-07, -2.25237553e-07],
       [ 2.49636160e-05,  2.52873703e-05, -1.35356053e-05,
         1.16093822e-07,  1.56363419e-07, -1.55462375e-07],
       [-5.73895851e-05, -5.20848297e-05,  3.51720198e-05,
        -2.25237553e-07, -1.55462375e-07,  4.49624704e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.85734433e-06],
       [-2.99811278e-05],
       [ 7.18288775e-02]])}}
Current time:  2018-07-13 08:29:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.54447245e+03],
       [-3.23787273e+03],
       [-3.09589950e+03],
       [-2.51406402e+00],
       [-2.08182764e+00],
       [ 6.72270804e+00],
       [ 2.67666640e-01],
       [ 4.58870620e-02],
       [ 9.21567799e-01],
       [-2.77419788e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80886311e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.02389976e-03,  8.03076194e-03, -4.94218909e-03,
         3.81011903e-05,  2.49636160e-05, -5.73895851e-05],
       [ 8.03076194e-03,  7.48249589e-03, -4.48639707e-03,
         3.24052774e-05,  2.52873703e-05, -5.20848297e-05],
       [-4.94218909e-03, -4.48639707e-03,  2.99277273e-03,
        -1.95246304e-05, -1.35356053e-05,  3.51720198e-05],
       [ 3.81011903e-05,  3.24052774e-05, -1.95246304e-05,
         2.26482933e-07,  1.16093822e-07, -2.25237553e-07],
       [ 2.49636160e-05,  2.52873703e-05, -1.35356053e-05,
         1.16093822e-07,  1.56363419e-07, -1.55462375e-07],
       [-5.73895851e-05, -5.20848297e-05,  3.51720198e-05,
        -2.25237553e-07, -1.55462375e-07,  4.49624704e-07]])}
[[-5.54447245e+03]
 [-3.23787273e+03]
 [-3.09589950e+03]
 [-2.51406402e+00]
 [-2.08182764e+00]
 [ 6.72270804e+00]
 [ 2.67666640e-01]
 [ 4.58870620e-02]
 [ 9.21567799e-01]
 [-2.77419788e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80886311e-18]]
2018-07-13 08:29:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:40
[[-5.56930746e+03]
 [-3.25851233e+03]
 [-3.02850269e+03]
 [-2.45289704e+00]
 [-2.04607342e+00]
 [ 6.75650223e+00]
 [ 2.72474786e-01]
 [ 4.73349321e-02]
 [ 9.20157666e-01]
 [-2.77176416e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80907539e-18]]
[[ 9.81008749e-03  8.61686131e-03 -5.73324232e-03  4.05446941e-05
   2.61685695e-05 -5.94573827e-05]
 [ 8.61686131e-03  8.00450793e-03 -5.15736756e-03  3.36816467e-05
   2.69361708e-05 -5.34718938e-05]
 [-5.73324232e-03 -5.15736756e-03  3.74038146e-03 -2.18443534e-05
  -1.51094091e-05  3.95995718e-05]
 [ 4.05446941e-05  3.36816467e-05 -2.18443534e-05  2.37509833e-07
   1.16661343e-07 -2.25218693e-07]
 [ 2.61685695e-05  2.69361708e-05 -1.51094091e-05  1.16661343e-07
   1.66560336e-07 -1.55162677e-07]
 [-5.94573827e-05 -5.34718938e-05  3.95995718e-05 -2.25218693e-07
  -1.55162677e-07  4.57277382e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.54442978e+03],
       [-3.23783611e+03],
       [-3.09591754e+03],
       [-2.51381851e+00],
       [-2.08162378e+00],
       [ 6.72259208e+00]]), 'covar': array([[ 4.91272934e-04,  3.92119969e-04, -7.86271616e-05,
         2.00175905e-06,  1.14350530e-06, -1.25834121e-06],
       [ 3.92119969e-04,  3.99965562e-04, -6.87271137e-05,
         1.54653042e-06,  1.27067536e-06, -1.11537104e-06],
       [-7.86271616e-05, -6.87271137e-05,  7.78726397e-05,
        -3.07994118e-07, -1.98995847e-07,  5.36200268e-07],
       [ 2.00175905e-06,  1.54653042e-06, -3.07994118e-07,
         9.08737894e-09,  4.52595440e-09, -4.92680338e-09],
       [ 1.14350530e-06,  1.27067536e-06, -1.98995847e-07,
         4.52595440e-09,  5.15436933e-09, -3.17079997e-09],
       [-1.25834121e-06, -1.11537104e-06,  5.36200268e-07,
        -4.92680338e-09, -3.17079997e-09,  6.84172034e-09]])}
[[-5.54442978e+03]
 [-3.23783611e+03]
 [-3.09591754e+03]
 [-2.51381851e+00]
 [-2.08162378e+00]
 [ 6.72259208e+00]]
2018-07-13 08:29:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:40
[[-5.56926214e+03]
 [-3.25847373e+03]
 [-3.02852191e+03]
 [-2.45265105e+00]
 [-2.04586933e+00]
 [ 6.75638735e+00]]
[[ 5.32508176e-04  4.19576428e-04 -9.46431759e-05  2.10190225e-06
   1.19281884e-06 -1.29879546e-06]
 [ 4.19576428e-04  4.25932425e-04 -8.21279256e-05  1.59966048e-06
   1.32536539e-06 -1.13944983e-06]
 [-9.46431759e-05 -8.21279256e-05  8.93124682e-05 -3.57917265e-07
  -2.30731523e-07  6.03016647e-07]
 [ 2.10190225e-06  1.59966048e-06 -3.57917265e-07  9.25399606e-09
   4.56471436e-09 -4.91066590e-09]
 [ 1.19281884e-06  1.32536539e-06 -2.30731523e-07  4.56471436e-09
   5.26824598e-09 -3.15497632e-09]
 [-1.29879546e-06 -1.13944983e-06  6.03016647e-07 -4.91066590e-09
  -3.15497632e-09  6.89313264e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.56926214e+03],
       [-3.25847373e+03],
       [-3.02852191e+03],
       [-2.45265105e+00],
       [-2.04586933e+00],
       [ 6.75638735e+00]]), 'covar': array([[ 5.32508176e-04,  4.19576428e-04, -9.46431759e-05,
         2.10190225e-06,  1.19281884e-06, -1.29879546e-06],
       [ 4.19576428e-04,  4.25932425e-04, -8.21279256e-05,
         1.59966048e-06,  1.32536539e-06, -1.13944983e-06],
       [-9.46431759e-05, -8.21279256e-05,  8.93124682e-05,
        -3.57917265e-07, -2.30731523e-07,  6.03016647e-07],
       [ 2.10190225e-06,  1.59966048e-06, -3.57917265e-07,
         9.25399606e-09,  4.56471436e-09, -4.91066590e-09],
       [ 1.19281884e-06,  1.32536539e-06, -2.30731523e-07,
         4.56471436e-09,  5.26824598e-09, -3.15497632e-09],
       [-1.29879546e-06, -1.13944983e-06,  6.03016647e-07,
        -4.91066590e-09, -3.15497632e-09,  6.89313264e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.51809985e-06],
       [-3.49770925e-05],
       [ 1.37836200e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.56930746e+03],
       [-3.25851233e+03],
       [-3.02850269e+03],
       [-2.45289704e+00],
       [-2.04607342e+00],
       [ 6.75650223e+00],
       [ 2.72474786e-01],
       [ 4.73349321e-02],
       [ 9.20157666e-01],
       [-2.77176416e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80907539e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.81008749e-03,  8.61686131e-03, -5.73324232e-03,
         4.05446941e-05,  2.61685695e-05, -5.94573827e-05],
       [ 8.61686131e-03,  8.00450793e-03, -5.15736756e-03,
         3.36816467e-05,  2.69361708e-05, -5.34718938e-05],
       [-5.73324232e-03, -5.15736756e-03,  3.74038146e-03,
        -2.18443534e-05, -1.51094091e-05,  3.95995718e-05],
       [ 4.05446941e-05,  3.36816467e-05, -2.18443534e-05,
         2.37509833e-07,  1.16661343e-07, -2.25218693e-07],
       [ 2.61685695e-05,  2.69361708e-05, -1.51094091e-05,
         1.16661343e-07,  1.66560336e-07, -1.55162677e-07],
       [-5.94573827e-05, -5.34718938e-05,  3.95995718e-05,
        -2.25218693e-07, -1.55162677e-07,  4.57277382e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.85734433e-06],
       [-2.99811278e-05],
       [ 7.18288775e-02]])}}
Yi [[-2.40693213]
 [ 0.45998807]
 [13.96879441]]
posterior
[[-5.56930746e+03]
 [-3.25851233e+03]
 [-3.02850269e+03]
 [-2.45289704e+00]
 [-2.04607342e+00]
 [ 6.75650223e+00]
 [ 2.72474786e-01]
 [ 4.73349321e-02]
 [ 9.20157666e-01]
 [-2.77176416e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80907539e-18]]
[[-5.56929332e+03]
 [-3.25850561e+03]
 [-3.02850413e+03]
 [-2.45279396e+00]
 [-2.04606856e+00]
 [ 6.75649911e+00]
 [ 2.72474786e-01]
 [ 4.73349321e-02]
 [ 9.20157666e-01]
 [-2.77176416e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80907539e-18]]
[[ 9.49407013e-03  8.38003219e-03 -5.69938673e-03  3.85436128e-05
   2.51912680e-05 -5.94237112e-05]
 [ 8.38003219e-03  7.74394926e-03 -5.13103921e-03  3.24683616e-05
   2.53703812e-05 -5.34900087e-05]
 [-5.69938673e-03 -5.13103921e-03  3.73673181e-03 -2.16333129e-05
  -1.49951568e-05  3.95963165e-05]
 [ 3.85436128e-05  3.24683616e-05 -2.16333129e-05  2.23851352e-07
   1.13345431e-07 -2.24856595e-07]
 [ 2.51912680e-05  2.53703812e-05 -1.49951568e-05  1.13345431e-07
   1.55177562e-07 -1.55493942e-07]
 [-5.94237112e-05 -5.34900087e-05  3.95963165e-05 -2.24856595e-07
  -1.55493942e-07  4.57249314e-07]]
[[-2.40694964]
 [ 0.45997063]
 [13.9389081 ]]
[[1.75125786e-05]
 [1.74352239e-05]
 [2.98863133e-02]]


 Corrector Step
2018-07-13 08:29:40
[[-5.56929332e+03]
 [-3.25850561e+03]
 [-3.02850413e+03]
 [-2.45279396e+00]
 [-2.04606856e+00]
 [ 6.75649911e+00]
 [ 2.72474786e-01]
 [ 4.73349321e-02]
 [ 9.20157666e-01]
 [-2.77176416e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80907539e-18]]
[[ 9.49407013e-03  8.38003219e-03 -5.69938673e-03  3.85436128e-05
   2.51912680e-05 -5.94237112e-05]
 [ 8.38003219e-03  7.74394926e-03 -5.13103921e-03  3.24683616e-05
   2.53703812e-05 -5.34900087e-05]
 [-5.69938673e-03 -5.13103921e-03  3.73673181e-03 -2.16333129e-05
  -1.49951568e-05  3.95963165e-05]
 [ 3.85436128e-05  3.24683616e-05 -2.16333129e-05  2.23851352e-07
   1.13345431e-07 -2.24856595e-07]
 [ 2.51912680e-05  2.53703812e-05 -1.49951568e-05  1.13345431e-07
   1.55177562e-07 -1.55493942e-07]
 [-5.94237112e-05 -5.34900087e-05  3.95963165e-05 -2.24856595e-07
  -1.55493942e-07  4.57249314e-07]]
539902143.944358
post
cubesat_nadir
Ybar_post [[-2.40694609]
 [ 0.45997443]
 [13.93885547]]
resids [[1.39619065e-05]
 [1.36320848e-05]
 [2.99389384e-02]]
posterior
[[-5.56926214e+03]
 [-3.25847373e+03]
 [-3.02852191e+03]
 [-2.45265105e+00]
 [-2.04586933e+00]
 [ 6.75638735e+00]]
[[-5.56925884e+03]
 [-3.25847231e+03]
 [-3.02852164e+03]
 [-2.45263717e+00]
 [-2.04586659e+00]
 [ 6.75638458e+00]]
[[ 4.95433208e-04  3.90051553e-04 -9.84973634e-05  1.95411827e-06
   1.10678517e-06 -1.26084205e-06]
 [ 3.90051553e-04  3.97061146e-04 -8.57424689e-05  1.48499577e-06
   1.23502257e-06 -1.10759689e-06]
 [-9.84973634e-05 -8.57424689e-05  8.88563139e-05 -3.72972719e-07
  -2.41896282e-07  6.07127784e-07]
 [ 1.95411827e-06  1.48499577e-06 -3.72972719e-07  8.66321020e-09
   4.23409473e-09 -4.76029933e-09]
 [ 1.10678517e-06  1.23502257e-06 -2.41896282e-07  4.23409473e-09
   4.97968146e-09 -3.06027056e-09]
 [-1.26084205e-06 -1.10759689e-06  6.07127784e-07 -4.76029933e-09
  -3.06027056e-09  6.85378479e-09]]
[[-2.40694818]
 [ 0.45997711]
 [12.50375938]]
[[1.60522648e-05]
 [1.09532188e-05]
 [1.46503503e+00]]


 Corrector Step
2018-07-13 08:29:40
[[-5.56925884e+03]
 [-3.25847231e+03]
 [-3.02852164e+03]
 [-2.45263717e+00]
 [-2.04586659e+00]
 [ 6.75638458e+00]]
[[ 4.95433208e-04  3.90051553e-04 -9.84973634e-05  1.95411827e-06
   1.10678517e-06 -1.26084205e-06]
 [ 3.90051553e-04  3.97061146e-04 -8.57424689e-05  1.48499577e-06
   1.23502257e-06 -1.10759689e-06]
 [-9.84973634e-05 -8.57424689e-05  8.88563139e-05 -3.72972719e-07
  -2.41896282e-07  6.07127784e-07]
 [ 1.95411827e-06  1.48499577e-06 -3.72972719e-07  8.66321020e-09
   4.23409473e-09 -4.76029933e-09]
 [ 1.10678517e-06  1.23502257e-06 -2.41896282e-07  4.23409473e-09
   4.97968146e-09 -3.06027056e-09]
 [-1.26084205e-06 -1.10759689e-06  6.07127784e-07 -4.76029933e-09
  -3.06027056e-09  6.85378479e-09]]
1.814829388357924e-38
post
sphere_lamr_small
Ybar_post [[-2.40694735]
 [ 0.45997838]
 [12.50375485]]
resids [[1.52257699e-05]
 [9.68949950e-06]
 [1.46503956e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [539902143.944358, 1.814829388357924e-38]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.56929332e+03],
       [-3.25850561e+03],
       [-3.02850413e+03],
       [-2.45279396e+00],
       [-2.04606856e+00],
       [ 6.75649911e+00]]), 'est_covars': array([[ 9.49407013e-03,  8.38003219e-03, -5.69938673e-03,
         3.85436128e-05,  2.51912680e-05, -5.94237112e-05],
       [ 8.38003219e-03,  7.74394926e-03, -5.13103921e-03,
         3.24683616e-05,  2.53703812e-05, -5.34900087e-05],
       [-5.69938673e-03, -5.13103921e-03,  3.73673181e-03,
        -2.16333129e-05, -1.49951568e-05,  3.95963165e-05],
       [ 3.85436128e-05,  3.24683616e-05, -2.16333129e-05,
         2.23851352e-07,  1.13345431e-07, -2.24856595e-07],
       [ 2.51912680e-05,  2.53703812e-05, -1.49951568e-05,
         1.13345431e-07,  1.55177562e-07, -1.55493942e-07],
       [-5.94237112e-05, -5.34900087e-05,  3.95963165e-05,
        -2.24856595e-07, -1.55493942e-07,  4.57249314e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.56925884e+03],
       [-3.25847231e+03],
       [-3.02852164e+03],
       [-2.45263717e+00],
       [-2.04586659e+00],
       [ 6.75638458e+00]]), 'covar': array([[ 4.95433208e-04,  3.90051553e-04, -9.84973634e-05,
         1.95411827e-06,  1.10678517e-06, -1.26084205e-06],
       [ 3.90051553e-04,  3.97061146e-04, -8.57424689e-05,
         1.48499577e-06,  1.23502257e-06, -1.10759689e-06],
       [-9.84973634e-05, -8.57424689e-05,  8.88563139e-05,
        -3.72972719e-07, -2.41896282e-07,  6.07127784e-07],
       [ 1.95411827e-06,  1.48499577e-06, -3.72972719e-07,
         8.66321020e-09,  4.23409473e-09, -4.76029933e-09],
       [ 1.10678517e-06,  1.23502257e-06, -2.41896282e-07,
         4.23409473e-09,  4.97968146e-09, -3.06027056e-09],
       [-1.26084205e-06, -1.10759689e-06,  6.07127784e-07,
        -4.76029933e-09, -3.06027056e-09,  6.85378479e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[1.52257699e-05],
       [9.68949950e-06],
       [1.46503956e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.56929332e+03],
       [-3.25850561e+03],
       [-3.02850413e+03],
       [-2.45279396e+00],
       [-2.04606856e+00],
       [ 6.75649911e+00],
       [ 2.72474786e-01],
       [ 4.73349321e-02],
       [ 9.20157666e-01],
       [-2.77176416e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80907539e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.49407013e-03,  8.38003219e-03, -5.69938673e-03,
         3.85436128e-05,  2.51912680e-05, -5.94237112e-05],
       [ 8.38003219e-03,  7.74394926e-03, -5.13103921e-03,
         3.24683616e-05,  2.53703812e-05, -5.34900087e-05],
       [-5.69938673e-03, -5.13103921e-03,  3.73673181e-03,
        -2.16333129e-05, -1.49951568e-05,  3.95963165e-05],
       [ 3.85436128e-05,  3.24683616e-05, -2.16333129e-05,
         2.23851352e-07,  1.13345431e-07, -2.24856595e-07],
       [ 2.51912680e-05,  2.53703812e-05, -1.49951568e-05,
         1.13345431e-07,  1.55177562e-07, -1.55493942e-07],
       [-5.94237112e-05, -5.34900087e-05,  3.95963165e-05,
        -2.24856595e-07, -1.55493942e-07,  4.57249314e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.39619065e-05],
       [1.36320848e-05],
       [2.99389384e-02]])}}
Current time:  2018-07-13 08:29:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.56929332e+03],
       [-3.25850561e+03],
       [-3.02850413e+03],
       [-2.45279396e+00],
       [-2.04606856e+00],
       [ 6.75649911e+00],
       [ 2.72474786e-01],
       [ 4.73349321e-02],
       [ 9.20157666e-01],
       [-2.77176416e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80907539e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.49407013e-03,  8.38003219e-03, -5.69938673e-03,
         3.85436128e-05,  2.51912680e-05, -5.94237112e-05],
       [ 8.38003219e-03,  7.74394926e-03, -5.13103921e-03,
         3.24683616e-05,  2.53703812e-05, -5.34900087e-05],
       [-5.69938673e-03, -5.13103921e-03,  3.73673181e-03,
        -2.16333129e-05, -1.49951568e-05,  3.95963165e-05],
       [ 3.85436128e-05,  3.24683616e-05, -2.16333129e-05,
         2.23851352e-07,  1.13345431e-07, -2.24856595e-07],
       [ 2.51912680e-05,  2.53703812e-05, -1.49951568e-05,
         1.13345431e-07,  1.55177562e-07, -1.55493942e-07],
       [-5.94237112e-05, -5.34900087e-05,  3.95963165e-05,
        -2.24856595e-07, -1.55493942e-07,  4.57249314e-07]])}
[[-5.56929332e+03]
 [-3.25850561e+03]
 [-3.02850413e+03]
 [-2.45279396e+00]
 [-2.04606856e+00]
 [ 6.75649911e+00]
 [ 2.72474786e-01]
 [ 4.73349321e-02]
 [ 9.20157666e-01]
 [-2.77176416e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80907539e-18]]
2018-07-13 08:29:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:50
[[-5.59351423e+03]
 [-3.27878651e+03]
 [-2.96077319e+03]
 [-2.39134884e+00]
 [-2.01008425e+00]
 [ 6.78955248e+00]
 [ 2.77275503e-01]
 [ 4.87815118e-02]
 [ 9.18722447e-01]
 [-2.76925487e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80928768e-18]]
[[ 1.02888780e-02  8.96877436e-03 -6.53184196e-03  4.09646058e-05
   2.63704392e-05 -6.14774576e-05]
 [ 8.96877436e-03  8.26749272e-03 -5.83067197e-03  3.37197926e-05
   2.70084171e-05 -5.48695013e-05]
 [-6.53184196e-03 -5.83067197e-03  4.57336557e-03 -2.39579388e-05
  -1.65722640e-05  4.40836362e-05]
 [ 4.09646058e-05  3.37197926e-05 -2.39579388e-05  2.34872065e-07
   1.13912094e-07 -2.24838492e-07]
 [ 2.63704392e-05  2.70084171e-05 -1.65722640e-05  1.13912094e-07
   1.65374303e-07 -1.55193304e-07]
 [-6.14774576e-05 -5.48695013e-05  4.40836362e-05 -2.24838492e-07
  -1.55193304e-07  4.64807050e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.56925884e+03],
       [-3.25847231e+03],
       [-3.02852164e+03],
       [-2.45263717e+00],
       [-2.04586659e+00],
       [ 6.75638458e+00]]), 'covar': array([[ 4.95433208e-04,  3.90051553e-04, -9.84973634e-05,
         1.95411827e-06,  1.10678517e-06, -1.26084205e-06],
       [ 3.90051553e-04,  3.97061146e-04, -8.57424689e-05,
         1.48499577e-06,  1.23502257e-06, -1.10759689e-06],
       [-9.84973634e-05, -8.57424689e-05,  8.88563139e-05,
        -3.72972719e-07, -2.41896282e-07,  6.07127784e-07],
       [ 1.95411827e-06,  1.48499577e-06, -3.72972719e-07,
         8.66321020e-09,  4.23409473e-09, -4.76029933e-09],
       [ 1.10678517e-06,  1.23502257e-06, -2.41896282e-07,
         4.23409473e-09,  4.97968146e-09, -3.06027056e-09],
       [-1.26084205e-06, -1.10759689e-06,  6.07127784e-07,
        -4.76029933e-09, -3.06027056e-09,  6.85378479e-09]])}
[[-5.56925884e+03]
 [-3.25847231e+03]
 [-3.02852164e+03]
 [-2.45263717e+00]
 [-2.04586659e+00]
 [ 6.75638458e+00]]
2018-07-13 08:29:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:29:50
[[-5.59347812e+03]
 [-3.27875109e+03]
 [-2.96079187e+03]
 [-2.39119165e+00]
 [-2.00988223e+00]
 [ 6.78943841e+00]]
[[ 5.35508211e-04  4.16510169e-04 -1.15255373e-04  2.04990967e-06
   1.15311027e-06 -1.29970819e-06]
 [ 4.16510169e-04  4.22377981e-04 -9.94800506e-05  1.53504815e-06
   1.28792544e-06 -1.13076049e-06]
 [-1.15255373e-04 -9.94800506e-05  1.01670940e-04 -4.21558436e-07
  -2.72700119e-07  6.73637246e-07]
 [ 2.04990967e-06  1.53504815e-06 -4.21558436e-07  8.82730707e-09
   4.27170188e-09 -4.74482148e-09]
 [ 1.15311027e-06  1.28792544e-06 -2.72700119e-07  4.27170188e-09
   5.09292188e-09 -3.04512715e-09]
 [-1.29970819e-06 -1.13076049e-06  6.73637246e-07 -4.74482148e-09
  -3.04512715e-09  6.90513080e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.59347812e+03],
       [-3.27875109e+03],
       [-2.96079187e+03],
       [-2.39119165e+00],
       [-2.00988223e+00],
       [ 6.78943841e+00]]), 'covar': array([[ 5.35508211e-04,  4.16510169e-04, -1.15255373e-04,
         2.04990967e-06,  1.15311027e-06, -1.29970819e-06],
       [ 4.16510169e-04,  4.22377981e-04, -9.94800506e-05,
         1.53504815e-06,  1.28792544e-06, -1.13076049e-06],
       [-1.15255373e-04, -9.94800506e-05,  1.01670940e-04,
        -4.21558436e-07, -2.72700119e-07,  6.73637246e-07],
       [ 2.04990967e-06,  1.53504815e-06, -4.21558436e-07,
         8.82730707e-09,  4.27170188e-09, -4.74482148e-09],
       [ 1.15311027e-06,  1.28792544e-06, -2.72700119e-07,
         4.27170188e-09,  5.09292188e-09, -3.04512715e-09],
       [-1.29970819e-06, -1.13076049e-06,  6.73637246e-07,
        -4.74482148e-09, -3.04512715e-09,  6.90513080e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[1.52257699e-05],
       [9.68949950e-06],
       [1.46503956e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.59351423e+03],
       [-3.27878651e+03],
       [-2.96077319e+03],
       [-2.39134884e+00],
       [-2.01008425e+00],
       [ 6.78955248e+00],
       [ 2.77275503e-01],
       [ 4.87815118e-02],
       [ 9.18722447e-01],
       [-2.76925487e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80928768e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.02888780e-02,  8.96877436e-03, -6.53184196e-03,
         4.09646058e-05,  2.63704392e-05, -6.14774576e-05],
       [ 8.96877436e-03,  8.26749272e-03, -5.83067197e-03,
         3.37197926e-05,  2.70084171e-05, -5.48695013e-05],
       [-6.53184196e-03, -5.83067197e-03,  4.57336557e-03,
        -2.39579388e-05, -1.65722640e-05,  4.40836362e-05],
       [ 4.09646058e-05,  3.37197926e-05, -2.39579388e-05,
         2.34872065e-07,  1.13912094e-07, -2.24838492e-07],
       [ 2.63704392e-05,  2.70084171e-05, -1.65722640e-05,
         1.13912094e-07,  1.65374303e-07, -1.55193304e-07],
       [-6.14774576e-05, -5.48695013e-05,  4.40836362e-05,
        -2.24838492e-07, -1.55193304e-07,  4.64807050e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.39619065e-05],
       [1.36320848e-05],
       [2.99389384e-02]])}}
Yi [[-2.41068015]
 [ 0.4919302 ]
 [14.34864737]]
posterior
[[-5.59351423e+03]
 [-3.27878651e+03]
 [-2.96077319e+03]
 [-2.39134884e+00]
 [-2.01008425e+00]
 [ 6.78955248e+00]
 [ 2.77275503e-01]
 [ 4.87815118e-02]
 [ 9.18722447e-01]
 [-2.76925487e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80928768e-18]]
[[-5.59353181e+03]
 [-3.27880728e+03]
 [-2.96077019e+03]
 [-2.39143148e+00]
 [-2.01021361e+00]
 [ 6.78955412e+00]
 [ 2.77275503e-01]
 [ 4.87815118e-02]
 [ 9.18722447e-01]
 [-2.76925487e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80928768e-18]]
[[ 9.96602357e-03  8.72996342e-03 -6.48429496e-03  3.89493811e-05
   2.54014012e-05 -6.14200422e-05]
 [ 8.72996342e-03  8.00610616e-03 -5.79300327e-03  3.25168084e-05
   2.54490186e-05 -5.48682203e-05]
 [-6.48429496e-03 -5.79300327e-03  4.56627710e-03 -2.36696843e-05
  -1.64047514e-05  4.40762436e-05]
 [ 3.89493811e-05  3.25168084e-05 -2.36696843e-05  2.21316652e-07
   1.10723491e-07 -2.24340866e-07]
 [ 2.54014012e-05  2.54490186e-05 -1.64047514e-05  1.10723491e-07
   1.54087178e-07 -1.55431073e-07]
 [-6.14200422e-05 -5.48682203e-05  4.40762436e-05 -2.24340866e-07
  -1.55431073e-07  4.64774983e-07]]
[[-2.41069418]
 [ 0.49196213]
 [14.17843628]]
[[ 1.40344956e-05]
 [-3.19251112e-05]
 [ 1.70211089e-01]]


 Corrector Step
2018-07-13 08:29:50
[[-5.59353181e+03]
 [-3.27880728e+03]
 [-2.96077019e+03]
 [-2.39143148e+00]
 [-2.01021361e+00]
 [ 6.78955412e+00]
 [ 2.77275503e-01]
 [ 4.87815118e-02]
 [ 9.18722447e-01]
 [-2.76925487e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80928768e-18]]
[[ 9.96602357e-03  8.72996342e-03 -6.48429496e-03  3.89493811e-05
   2.54014012e-05 -6.14200422e-05]
 [ 8.72996342e-03  8.00610616e-03 -5.79300327e-03  3.25168084e-05
   2.54490186e-05 -5.48682203e-05]
 [-6.48429496e-03 -5.79300327e-03  4.56627710e-03 -2.36696843e-05
  -1.64047514e-05  4.40762436e-05]
 [ 3.89493811e-05  3.25168084e-05 -2.36696843e-05  2.21316652e-07
   1.10723491e-07 -2.24340866e-07]
 [ 2.54014012e-05  2.54490186e-05 -1.64047514e-05  1.10723491e-07
   1.54087178e-07 -1.55431073e-07]
 [-6.14200422e-05 -5.48682203e-05  4.40762436e-05 -2.24340866e-07
  -1.55431073e-07  4.64774983e-07]]
88946122.33287716
post
cubesat_nadir
Ybar_post [[-2.41069136]
 [ 0.49195529]
 [14.17840713]]
resids [[ 1.12139398e-05]
 [-2.50924170e-05]
 [ 1.70240240e-01]]
posterior
[[-5.59347812e+03]
 [-3.27875109e+03]
 [-2.96079187e+03]
 [-2.39119165e+00]
 [-2.00988223e+00]
 [ 6.78943841e+00]]
[[-5.59348566e+03]
 [-3.27875925e+03]
 [-2.96079256e+03]
 [-2.39121961e+00]
 [-2.00990806e+00]
 [ 6.78944675e+00]]
[[ 5.00079777e-04  3.88819196e-04 -1.17831732e-04  1.91252726e-06
   1.07432463e-06 -1.26497050e-06]
 [ 3.88819196e-04  3.95258041e-04 -1.01964141e-04  1.43078774e-06
   1.20439143e-06 -1.10206192e-06]
 [-1.17831732e-04 -1.01964141e-04  1.01443171e-04 -4.31281078e-07
  -2.80315194e-07  6.76296232e-07]
 [ 1.91252726e-06  1.43078774e-06 -4.31281078e-07  8.29279791e-09
   3.97869137e-09 -4.61099866e-09]
 [ 1.07432463e-06  1.20439143e-06 -2.80315194e-07  3.97869137e-09
   4.82970432e-09 -2.96167394e-09]
 [-1.26497050e-06 -1.10206192e-06  6.76296232e-07 -4.61099866e-09
  -2.96167394e-09  6.87063282e-09]]
[[-2.41069588]
 [ 0.49196716]
 [12.6194551 ]]
[[ 1.57332280e-05]
 [-3.69542531e-05]
 [ 1.72919227e+00]]


 Corrector Step
2018-07-13 08:29:50
[[-5.59348566e+03]
 [-3.27875925e+03]
 [-2.96079256e+03]
 [-2.39121961e+00]
 [-2.00990806e+00]
 [ 6.78944675e+00]]
[[ 5.00079777e-04  3.88819196e-04 -1.17831732e-04  1.91252726e-06
   1.07432463e-06 -1.26497050e-06]
 [ 3.88819196e-04  3.95258041e-04 -1.01964141e-04  1.43078774e-06
   1.20439143e-06 -1.10206192e-06]
 [-1.17831732e-04 -1.01964141e-04  1.01443171e-04 -4.31281078e-07
  -2.80315194e-07  6.76296232e-07]
 [ 1.91252726e-06  1.43078774e-06 -4.31281078e-07  8.29279791e-09
   3.97869137e-09 -4.61099866e-09]
 [ 1.07432463e-06  1.20439143e-06 -2.80315194e-07  3.97869137e-09
   4.82970432e-09 -2.96167394e-09]
 [-1.26497050e-06 -1.10206192e-06  6.76296232e-07 -4.61099866e-09
  -2.96167394e-09  6.87063282e-09]]
3.389437054086314e-57
post
sphere_lamr_small
Ybar_post [[-2.41069518]
 [ 0.49196321]
 [12.6194656 ]]
resids [[ 1.50353357e-05]
 [-3.30101467e-05]
 [ 1.72918177e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [88946122.33287716, 3.389437054086314e-57]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.59353181e+03],
       [-3.27880728e+03],
       [-2.96077019e+03],
       [-2.39143148e+00],
       [-2.01021361e+00],
       [ 6.78955412e+00]]), 'est_covars': array([[ 9.96602357e-03,  8.72996342e-03, -6.48429496e-03,
         3.89493811e-05,  2.54014012e-05, -6.14200422e-05],
       [ 8.72996342e-03,  8.00610616e-03, -5.79300327e-03,
         3.25168084e-05,  2.54490186e-05, -5.48682203e-05],
       [-6.48429496e-03, -5.79300327e-03,  4.56627710e-03,
        -2.36696843e-05, -1.64047514e-05,  4.40762436e-05],
       [ 3.89493811e-05,  3.25168084e-05, -2.36696843e-05,
         2.21316652e-07,  1.10723491e-07, -2.24340866e-07],
       [ 2.54014012e-05,  2.54490186e-05, -1.64047514e-05,
         1.10723491e-07,  1.54087178e-07, -1.55431073e-07],
       [-6.14200422e-05, -5.48682203e-05,  4.40762436e-05,
        -2.24340866e-07, -1.55431073e-07,  4.64774983e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.59348566e+03],
       [-3.27875925e+03],
       [-2.96079256e+03],
       [-2.39121961e+00],
       [-2.00990806e+00],
       [ 6.78944675e+00]]), 'covar': array([[ 5.00079777e-04,  3.88819196e-04, -1.17831732e-04,
         1.91252726e-06,  1.07432463e-06, -1.26497050e-06],
       [ 3.88819196e-04,  3.95258041e-04, -1.01964141e-04,
         1.43078774e-06,  1.20439143e-06, -1.10206192e-06],
       [-1.17831732e-04, -1.01964141e-04,  1.01443171e-04,
        -4.31281078e-07, -2.80315194e-07,  6.76296232e-07],
       [ 1.91252726e-06,  1.43078774e-06, -4.31281078e-07,
         8.29279791e-09,  3.97869137e-09, -4.61099866e-09],
       [ 1.07432463e-06,  1.20439143e-06, -2.80315194e-07,
         3.97869137e-09,  4.82970432e-09, -2.96167394e-09],
       [-1.26497050e-06, -1.10206192e-06,  6.76296232e-07,
        -4.61099866e-09, -2.96167394e-09,  6.87063282e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.50353357e-05],
       [-3.30101467e-05],
       [ 1.72918177e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.59353181e+03],
       [-3.27880728e+03],
       [-2.96077019e+03],
       [-2.39143148e+00],
       [-2.01021361e+00],
       [ 6.78955412e+00],
       [ 2.77275503e-01],
       [ 4.87815118e-02],
       [ 9.18722447e-01],
       [-2.76925487e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80928768e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.96602357e-03,  8.72996342e-03, -6.48429496e-03,
         3.89493811e-05,  2.54014012e-05, -6.14200422e-05],
       [ 8.72996342e-03,  8.00610616e-03, -5.79300327e-03,
         3.25168084e-05,  2.54490186e-05, -5.48682203e-05],
       [-6.48429496e-03, -5.79300327e-03,  4.56627710e-03,
        -2.36696843e-05, -1.64047514e-05,  4.40762436e-05],
       [ 3.89493811e-05,  3.25168084e-05, -2.36696843e-05,
         2.21316652e-07,  1.10723491e-07, -2.24340866e-07],
       [ 2.54014012e-05,  2.54490186e-05, -1.64047514e-05,
         1.10723491e-07,  1.54087178e-07, -1.55431073e-07],
       [-6.14200422e-05, -5.48682203e-05,  4.40762436e-05,
        -2.24340866e-07, -1.55431073e-07,  4.64774983e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.12139398e-05],
       [-2.50924170e-05],
       [ 1.70240240e-01]])}}
Current time:  2018-07-13 08:30:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.59353181e+03],
       [-3.27880728e+03],
       [-2.96077019e+03],
       [-2.39143148e+00],
       [-2.01021361e+00],
       [ 6.78955412e+00],
       [ 2.77275503e-01],
       [ 4.87815118e-02],
       [ 9.18722447e-01],
       [-2.76925487e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80928768e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.96602357e-03,  8.72996342e-03, -6.48429496e-03,
         3.89493811e-05,  2.54014012e-05, -6.14200422e-05],
       [ 8.72996342e-03,  8.00610616e-03, -5.79300327e-03,
         3.25168084e-05,  2.54490186e-05, -5.48682203e-05],
       [-6.48429496e-03, -5.79300327e-03,  4.56627710e-03,
        -2.36696843e-05, -1.64047514e-05,  4.40762436e-05],
       [ 3.89493811e-05,  3.25168084e-05, -2.36696843e-05,
         2.21316652e-07,  1.10723491e-07, -2.24340866e-07],
       [ 2.54014012e-05,  2.54490186e-05, -1.64047514e-05,
         1.10723491e-07,  1.54087178e-07, -1.55431073e-07],
       [-6.14200422e-05, -5.48682203e-05,  4.40762436e-05,
        -2.24340866e-07, -1.55431073e-07,  4.64774983e-07]])}
[[-5.59353181e+03]
 [-3.27880728e+03]
 [-2.96077019e+03]
 [-2.39143148e+00]
 [-2.01021361e+00]
 [ 6.78955412e+00]
 [ 2.77275503e-01]
 [ 4.87815118e-02]
 [ 9.18722447e-01]
 [-2.76925487e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80928768e-18]]
2018-07-13 08:29:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:00
[[-5.61713755e+03]
 [-3.29872841e+03]
 [-2.89271238e+03]
 [-2.32971537e+00]
 [-1.97400338e+00]
 [ 6.82186218e+00]
 [ 2.82068661e-01]
 [ 5.02267615e-02]
 [ 9.17262181e-01]
 [-2.76667009e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80949997e-18]]
[[ 1.07689489e-02  9.32117135e-03 -7.35693588e-03  4.13492020e-05
   2.65563174e-05 -6.34581317e-05]
 [ 9.32117135e-03  8.53118822e-03 -6.52044330e-03  3.37449147e-05
   2.70774622e-05 -5.62390726e-05]
 [-7.35693588e-03 -6.52044330e-03  5.49311688e-03 -2.59980596e-05
  -1.79843611e-05  4.86214792e-05]
 [ 4.13492020e-05  3.37449147e-05 -2.59980596e-05  2.32333616e-07
   1.11290903e-07 -2.24325394e-07]
 [ 2.65563174e-05  2.70774622e-05 -1.79843611e-05  1.11290903e-07
   1.64284689e-07 -1.55130621e-07]
 [-6.34581317e-05 -5.62390726e-05  4.86214792e-05 -2.24325394e-07
  -1.55130621e-07  4.72237386e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.59348566e+03],
       [-3.27875925e+03],
       [-2.96079256e+03],
       [-2.39121961e+00],
       [-2.00990806e+00],
       [ 6.78944675e+00]]), 'covar': array([[ 5.00079777e-04,  3.88819196e-04, -1.17831732e-04,
         1.91252726e-06,  1.07432463e-06, -1.26497050e-06],
       [ 3.88819196e-04,  3.95258041e-04, -1.01964141e-04,
         1.43078774e-06,  1.20439143e-06, -1.10206192e-06],
       [-1.17831732e-04, -1.01964141e-04,  1.01443171e-04,
        -4.31281078e-07, -2.80315194e-07,  6.76296232e-07],
       [ 1.91252726e-06,  1.43078774e-06, -4.31281078e-07,
         8.29279791e-09,  3.97869137e-09, -4.61099866e-09],
       [ 1.07432463e-06,  1.20439143e-06, -2.80315194e-07,
         3.97869137e-09,  4.82970432e-09, -2.96167394e-09],
       [-1.26497050e-06, -1.10206192e-06,  6.76296232e-07,
        -4.61099866e-09, -2.96167394e-09,  6.87063282e-09]])}
[[-5.59348566e+03]
 [-3.27875925e+03]
 [-2.96079256e+03]
 [-2.39121961e+00]
 [-2.00990806e+00]
 [ 6.78944675e+00]]
2018-07-13 08:29:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:00
[[-5.61708909e+03]
 [-3.29867735e+03]
 [-2.89273584e+03]
 [-2.32950280e+00]
 [-1.97369763e+00]
 [ 6.82175537e+00]]
[[ 5.39887820e-04  4.14494486e-04 -1.35104805e-04  2.00459291e-06
   1.11827233e-06 -1.30255922e-06]
 [ 4.14494486e-04  4.19901021e-04 -1.16018748e-04  1.47824489e-06
   1.25579352e-06 -1.12424196e-06]
 [-1.35104805e-04 -1.16018748e-04  1.15651273e-04 -4.78654382e-07
  -3.10233392e-07  7.42574630e-07]
 [ 2.00459291e-06  1.47824489e-06 -4.78654382e-07  8.45474408e-09
   4.01538054e-09 -4.59623945e-09]
 [ 1.11827233e-06  1.25579352e-06 -3.10233392e-07  4.01538054e-09
   4.94249799e-09 -2.94717541e-09]
 [-1.30255922e-06 -1.12424196e-06  7.42574630e-07 -4.59623945e-09
  -2.94717541e-09  6.92162511e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 29, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.61708909e+03],
       [-3.29867735e+03],
       [-2.89273584e+03],
       [-2.32950280e+00],
       [-1.97369763e+00],
       [ 6.82175537e+00]]), 'covar': array([[ 5.39887820e-04,  4.14494486e-04, -1.35104805e-04,
         2.00459291e-06,  1.11827233e-06, -1.30255922e-06],
       [ 4.14494486e-04,  4.19901021e-04, -1.16018748e-04,
         1.47824489e-06,  1.25579352e-06, -1.12424196e-06],
       [-1.35104805e-04, -1.16018748e-04,  1.15651273e-04,
        -4.78654382e-07, -3.10233392e-07,  7.42574630e-07],
       [ 2.00459291e-06,  1.47824489e-06, -4.78654382e-07,
         8.45474408e-09,  4.01538054e-09, -4.59623945e-09],
       [ 1.11827233e-06,  1.25579352e-06, -3.10233392e-07,
         4.01538054e-09,  4.94249799e-09, -2.94717541e-09],
       [-1.30255922e-06, -1.12424196e-06,  7.42574630e-07,
        -4.59623945e-09, -2.94717541e-09,  6.92162511e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.50353357e-05],
       [-3.30101467e-05],
       [ 1.72918177e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 29, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.61713755e+03],
       [-3.29872841e+03],
       [-2.89271238e+03],
       [-2.32971537e+00],
       [-1.97400338e+00],
       [ 6.82186218e+00],
       [ 2.82068661e-01],
       [ 5.02267615e-02],
       [ 9.17262181e-01],
       [-2.76667009e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80949997e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.07689489e-02,  9.32117135e-03, -7.35693588e-03,
         4.13492020e-05,  2.65563174e-05, -6.34581317e-05],
       [ 9.32117135e-03,  8.53118822e-03, -6.52044330e-03,
         3.37449147e-05,  2.70774622e-05, -5.62390726e-05],
       [-7.35693588e-03, -6.52044330e-03,  5.49311688e-03,
        -2.59980596e-05, -1.79843611e-05,  4.86214792e-05],
       [ 4.13492020e-05,  3.37449147e-05, -2.59980596e-05,
         2.32333616e-07,  1.11290903e-07, -2.24325394e-07],
       [ 2.65563174e-05,  2.70774622e-05, -1.79843611e-05,
         1.11290903e-07,  1.64284689e-07, -1.55130621e-07],
       [-6.34581317e-05, -5.62390726e-05,  4.86214792e-05,
        -2.24325394e-07, -1.55130621e-07,  4.72237386e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.12139398e-05],
       [-2.50924170e-05],
       [ 1.70240240e-01]])}}
Yi [[-2.41417089]
 [ 0.52188421]
 [14.31900684]]
posterior
[[-5.61713755e+03]
 [-3.29872841e+03]
 [-2.89271238e+03]
 [-2.32971537e+00]
 [-1.97400338e+00]
 [ 6.82186218e+00]
 [ 2.82068661e-01]
 [ 5.02267615e-02]
 [ 9.17262181e-01]
 [-2.76667009e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80949997e-18]]
[[-5.61714055e+03]
 [-3.29872774e+03]
 [-2.89271206e+03]
 [-2.32974375e+00]
 [-1.97398436e+00]
 [ 6.82186299e+00]
 [ 2.82068661e-01]
 [ 5.02267615e-02]
 [ 9.17262181e-01]
 [-2.76667009e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80949997e-18]]
[[ 1.04388217e-02  9.07991400e-03 -7.29593547e-03  3.93184314e-05
   2.55938861e-05 -6.33778311e-05]
 [ 9.07991400e-03  8.26846271e-03 -6.47186683e-03  3.25499033e-05
   2.55223771e-05 -5.62194718e-05]
 [-7.29593547e-03 -6.47186683e-03  5.48164695e-03 -2.56362397e-05
  -1.77671739e-05  4.86082931e-05]
 [ 3.93184314e-05  3.25499033e-05 -2.56362397e-05  2.18874139e-07
   1.08219630e-07 -2.23701275e-07]
 [ 2.55938861e-05  2.55223771e-05 -1.77671739e-05  1.08219630e-07
   1.53083574e-07 -1.55282301e-07]
 [-6.33778311e-05 -5.62194718e-05  4.86082931e-05 -2.23701275e-07
  -1.55282301e-07  4.72198365e-07]]
[[-2.4141615 ]
 [ 0.52188622]
 [14.40829182]]
[[-9.38206383e-06]
 [-2.01511097e-06]
 [-8.92849792e-02]]


 Corrector Step
2018-07-13 08:30:00
[[-5.61714055e+03]
 [-3.29872774e+03]
 [-2.89271206e+03]
 [-2.32974375e+00]
 [-1.97398436e+00]
 [ 6.82186299e+00]
 [ 2.82068661e-01]
 [ 5.02267615e-02]
 [ 9.17262181e-01]
 [-2.76667009e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80949997e-18]]
[[ 1.04388217e-02  9.07991400e-03 -7.29593547e-03  3.93184314e-05
   2.55938861e-05 -6.33778311e-05]
 [ 9.07991400e-03  8.26846271e-03 -6.47186683e-03  3.25499033e-05
   2.55223771e-05 -5.62194718e-05]
 [-7.29593547e-03 -6.47186683e-03  5.48164695e-03 -2.56362397e-05
  -1.77671739e-05  4.86082931e-05]
 [ 3.93184314e-05  3.25499033e-05 -2.56362397e-05  2.18874139e-07
   1.08219630e-07 -2.23701275e-07]
 [ 2.55938861e-05  2.55223771e-05 -1.77671739e-05  1.08219630e-07
   1.53083574e-07 -1.55282301e-07]
 [-6.33778311e-05 -5.62194718e-05  4.86082931e-05 -2.23701275e-07
  -1.55282301e-07  4.72198365e-07]]
541498897.4079822
post
cubesat_nadir
Ybar_post [[-2.41416343]
 [ 0.52188582]
 [14.40832126]]
resids [[-7.45822391e-06]
 [-1.61156470e-06]
 [-8.93144245e-02]]
posterior
[[-5.61708909e+03]
 [-3.29867735e+03]
 [-2.89273584e+03]
 [-2.32950280e+00]
 [-1.97369763e+00]
 [ 6.82175537e+00]]
[[-5.61709206e+03]
 [-3.29867945e+03]
 [-2.89273591e+03]
 [-2.32951409e+00]
 [-1.97370323e+00]
 [ 6.82175839e+00]]
[[ 5.05799954e-04  3.88392590e-04 -1.36618026e-04  1.87603096e-06
   1.04573184e-06 -1.27055487e-06]
 [ 3.88392590e-04  3.94307000e-04 -1.17575117e-04  1.38294360e-06
   1.17810420e-06 -1.09826101e-06]
 [-1.36618026e-04 -1.17575117e-04  1.15555884e-04 -4.84138668e-07
  -3.15023998e-07  7.44099867e-07]
 [ 1.87603096e-06  1.38294360e-06 -4.84138668e-07  7.96811406e-09
   3.75420182e-09 -4.47636163e-09]
 [ 1.04573184e-06  1.17810420e-06 -3.15023998e-07  3.75420182e-09
   4.70068221e-09 -2.87324598e-09]
 [-1.27055487e-06 -1.09826101e-06  7.44099867e-07 -4.47636163e-09
  -2.87324598e-09  6.89118892e-09]]
[[-2.41416594]
 [ 0.52189575]
 [12.73168087]]
[[-4.94151779e-06]
 [-1.15444036e-05]
 [ 1.58732597e+00]]


 Corrector Step
2018-07-13 08:30:00
[[-5.61709206e+03]
 [-3.29867945e+03]
 [-2.89273591e+03]
 [-2.32951409e+00]
 [-1.97370323e+00]
 [ 6.82175839e+00]]
[[ 5.05799954e-04  3.88392590e-04 -1.36618026e-04  1.87603096e-06
   1.04573184e-06 -1.27055487e-06]
 [ 3.88392590e-04  3.94307000e-04 -1.17575117e-04  1.38294360e-06
   1.17810420e-06 -1.09826101e-06]
 [-1.36618026e-04 -1.17575117e-04  1.15555884e-04 -4.84138668e-07
  -3.15023998e-07  7.44099867e-07]
 [ 1.87603096e-06  1.38294360e-06 -4.84138668e-07  7.96811406e-09
   3.75420182e-09 -4.47636163e-09]
 [ 1.04573184e-06  1.17810420e-06 -3.15023998e-07  3.75420182e-09
   4.70068221e-09 -2.87324598e-09]
 [-1.27055487e-06 -1.09826101e-06  7.44099867e-07 -4.47636163e-09
  -2.87324598e-09  6.89118892e-09]]
1.7097895382569063e-46
post
sphere_lamr_small
Ybar_post [[-2.41416631]
 [ 0.52189456]
 [12.73168434]]
resids [[-4.57457075e-06]
 [-1.03539317e-05]
 [ 1.58732250e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [541498897.4079822, 1.7097895382569063e-46]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.61714055e+03],
       [-3.29872774e+03],
       [-2.89271206e+03],
       [-2.32974375e+00],
       [-1.97398436e+00],
       [ 6.82186299e+00]]), 'est_covars': array([[ 1.04388217e-02,  9.07991400e-03, -7.29593547e-03,
         3.93184314e-05,  2.55938861e-05, -6.33778311e-05],
       [ 9.07991400e-03,  8.26846271e-03, -6.47186683e-03,
         3.25499033e-05,  2.55223771e-05, -5.62194718e-05],
       [-7.29593547e-03, -6.47186683e-03,  5.48164695e-03,
        -2.56362397e-05, -1.77671739e-05,  4.86082931e-05],
       [ 3.93184314e-05,  3.25499033e-05, -2.56362397e-05,
         2.18874139e-07,  1.08219630e-07, -2.23701275e-07],
       [ 2.55938861e-05,  2.55223771e-05, -1.77671739e-05,
         1.08219630e-07,  1.53083574e-07, -1.55282301e-07],
       [-6.33778311e-05, -5.62194718e-05,  4.86082931e-05,
        -2.23701275e-07, -1.55282301e-07,  4.72198365e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.61709206e+03],
       [-3.29867945e+03],
       [-2.89273591e+03],
       [-2.32951409e+00],
       [-1.97370323e+00],
       [ 6.82175839e+00]]), 'covar': array([[ 5.05799954e-04,  3.88392590e-04, -1.36618026e-04,
         1.87603096e-06,  1.04573184e-06, -1.27055487e-06],
       [ 3.88392590e-04,  3.94307000e-04, -1.17575117e-04,
         1.38294360e-06,  1.17810420e-06, -1.09826101e-06],
       [-1.36618026e-04, -1.17575117e-04,  1.15555884e-04,
        -4.84138668e-07, -3.15023998e-07,  7.44099867e-07],
       [ 1.87603096e-06,  1.38294360e-06, -4.84138668e-07,
         7.96811406e-09,  3.75420182e-09, -4.47636163e-09],
       [ 1.04573184e-06,  1.17810420e-06, -3.15023998e-07,
         3.75420182e-09,  4.70068221e-09, -2.87324598e-09],
       [-1.27055487e-06, -1.09826101e-06,  7.44099867e-07,
        -4.47636163e-09, -2.87324598e-09,  6.89118892e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-4.57457075e-06],
       [-1.03539317e-05],
       [ 1.58732250e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.61714055e+03],
       [-3.29872774e+03],
       [-2.89271206e+03],
       [-2.32974375e+00],
       [-1.97398436e+00],
       [ 6.82186299e+00],
       [ 2.82068661e-01],
       [ 5.02267615e-02],
       [ 9.17262181e-01],
       [-2.76667009e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80949997e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.04388217e-02,  9.07991400e-03, -7.29593547e-03,
         3.93184314e-05,  2.55938861e-05, -6.33778311e-05],
       [ 9.07991400e-03,  8.26846271e-03, -6.47186683e-03,
         3.25499033e-05,  2.55223771e-05, -5.62194718e-05],
       [-7.29593547e-03, -6.47186683e-03,  5.48164695e-03,
        -2.56362397e-05, -1.77671739e-05,  4.86082931e-05],
       [ 3.93184314e-05,  3.25499033e-05, -2.56362397e-05,
         2.18874139e-07,  1.08219630e-07, -2.23701275e-07],
       [ 2.55938861e-05,  2.55223771e-05, -1.77671739e-05,
         1.08219630e-07,  1.53083574e-07, -1.55282301e-07],
       [-6.33778311e-05, -5.62194718e-05,  4.86082931e-05,
        -2.23701275e-07, -1.55282301e-07,  4.72198365e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-7.45822391e-06],
       [-1.61156470e-06],
       [-8.93144245e-02]])}}
Current time:  2018-07-13 08:30:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.61714055e+03],
       [-3.29872774e+03],
       [-2.89271206e+03],
       [-2.32974375e+00],
       [-1.97398436e+00],
       [ 6.82186299e+00],
       [ 2.82068661e-01],
       [ 5.02267615e-02],
       [ 9.17262181e-01],
       [-2.76667009e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80949997e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.04388217e-02,  9.07991400e-03, -7.29593547e-03,
         3.93184314e-05,  2.55938861e-05, -6.33778311e-05],
       [ 9.07991400e-03,  8.26846271e-03, -6.47186683e-03,
         3.25499033e-05,  2.55223771e-05, -5.62194718e-05],
       [-7.29593547e-03, -6.47186683e-03,  5.48164695e-03,
        -2.56362397e-05, -1.77671739e-05,  4.86082931e-05],
       [ 3.93184314e-05,  3.25499033e-05, -2.56362397e-05,
         2.18874139e-07,  1.08219630e-07, -2.23701275e-07],
       [ 2.55938861e-05,  2.55223771e-05, -1.77671739e-05,
         1.08219630e-07,  1.53083574e-07, -1.55282301e-07],
       [-6.33778311e-05, -5.62194718e-05,  4.86082931e-05,
        -2.23701275e-07, -1.55282301e-07,  4.72198365e-07]])}
[[-5.61714055e+03]
 [-3.29872774e+03]
 [-2.89271206e+03]
 [-2.32974375e+00]
 [-1.97398436e+00]
 [ 6.82186299e+00]
 [ 2.82068661e-01]
 [ 5.02267615e-02]
 [ 9.17262181e-01]
 [-2.76667009e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80949997e-18]]
2018-07-13 08:30:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:10
[[-5.64012814e+03]
 [-3.31828549e+03]
 [-2.82433491e+03]
 [-2.26776305e+00]
 [-1.93755222e+00]
 [ 6.85342161e+00]
 [ 2.86854129e-01]
 [ 5.16706420e-02]
 [ 9.15776909e-01]
 [-2.76400988e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80971225e-18]]
[[ 1.12488217e-02  9.67310333e-03 -8.20776847e-03  4.16982267e-05
   2.67257365e-05 -6.53992434e-05]
 [ 9.67310333e-03  8.79490622e-03 -7.22640801e-03  3.37561096e-05
   2.71421695e-05 -5.75809238e-05]
 [-8.20776847e-03 -7.22640801e-03  6.49969797e-03 -2.79674802e-05
  -1.93487138e-05  5.32094215e-05]
 [ 4.16982267e-05  3.37561096e-05 -2.79674802e-05  2.29889520e-07
   1.08789172e-07 -2.23690467e-07]
 [ 2.67257365e-05  2.71421695e-05 -1.93487138e-05  1.08789172e-07
   1.63282722e-07 -1.54983203e-07]
 [-6.53992434e-05 -5.75809238e-05  5.32094215e-05 -2.23690467e-07
  -1.54983203e-07  4.79565073e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.61709206e+03],
       [-3.29867945e+03],
       [-2.89273591e+03],
       [-2.32951409e+00],
       [-1.97370323e+00],
       [ 6.82175839e+00]]), 'covar': array([[ 5.05799954e-04,  3.88392590e-04, -1.36618026e-04,
         1.87603096e-06,  1.04573184e-06, -1.27055487e-06],
       [ 3.88392590e-04,  3.94307000e-04, -1.17575117e-04,
         1.38294360e-06,  1.17810420e-06, -1.09826101e-06],
       [-1.36618026e-04, -1.17575117e-04,  1.15555884e-04,
        -4.84138668e-07, -3.15023998e-07,  7.44099867e-07],
       [ 1.87603096e-06,  1.38294360e-06, -4.84138668e-07,
         7.96811406e-09,  3.75420182e-09, -4.47636163e-09],
       [ 1.04573184e-06,  1.17810420e-06, -3.15023998e-07,
         3.75420182e-09,  4.70068221e-09, -2.87324598e-09],
       [-1.27055487e-06, -1.09826101e-06,  7.44099867e-07,
        -4.47636163e-09, -2.87324598e-09,  6.89118892e-09]])}
[[-5.61709206e+03]
 [-3.29867945e+03]
 [-2.89273591e+03]
 [-2.32951409e+00]
 [-1.97370323e+00]
 [ 6.82175839e+00]]
2018-07-13 08:30:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:10
[[-5.64007731e+03]
 [-3.31823425e+03]
 [-2.82435987e+03]
 [-2.26753262e+00]
 [-1.93727079e+00]
 [ 6.85331779e+00]]
[[ 5.44341045e-04  4.13284220e-04 -1.54552567e-04  1.96488101e-06
   1.08736884e-06 -1.30681170e-06]
 [ 4.13284220e-04  4.18583510e-04 -1.31930827e-04  1.42813515e-06
   1.22819880e-06 -1.11997041e-06]
 [-1.54552567e-04 -1.31930827e-04  1.31102307e-04 -5.30439482e-07
  -3.44198016e-07  8.10202977e-07]
 [ 1.96488101e-06  1.42813515e-06 -5.30439482e-07  8.12827835e-09
   3.79015386e-09 -4.46229644e-09]
 [ 1.08736884e-06  1.22819880e-06 -3.44198016e-07  3.79015386e-09
   4.81305954e-09 -2.85928790e-09]
 [-1.30681170e-06 -1.11997041e-06  8.10202977e-07 -4.46229644e-09
  -2.85928790e-09  6.94261599e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.64007731e+03],
       [-3.31823425e+03],
       [-2.82435987e+03],
       [-2.26753262e+00],
       [-1.93727079e+00],
       [ 6.85331779e+00]]), 'covar': array([[ 5.44341045e-04,  4.13284220e-04, -1.54552567e-04,
         1.96488101e-06,  1.08736884e-06, -1.30681170e-06],
       [ 4.13284220e-04,  4.18583510e-04, -1.31930827e-04,
         1.42813515e-06,  1.22819880e-06, -1.11997041e-06],
       [-1.54552567e-04, -1.31930827e-04,  1.31102307e-04,
        -5.30439482e-07, -3.44198016e-07,  8.10202977e-07],
       [ 1.96488101e-06,  1.42813515e-06, -5.30439482e-07,
         8.12827835e-09,  3.79015386e-09, -4.46229644e-09],
       [ 1.08736884e-06,  1.22819880e-06, -3.44198016e-07,
         3.79015386e-09,  4.81305954e-09, -2.85928790e-09],
       [-1.30681170e-06, -1.11997041e-06,  8.10202977e-07,
        -4.46229644e-09, -2.85928790e-09,  6.94261599e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-4.57457075e-06],
       [-1.03539317e-05],
       [ 1.58732250e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.64012814e+03],
       [-3.31828549e+03],
       [-2.82433491e+03],
       [-2.26776305e+00],
       [-1.93755222e+00],
       [ 6.85342161e+00],
       [ 2.86854129e-01],
       [ 5.16706420e-02],
       [ 9.15776909e-01],
       [-2.76400988e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80971225e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.12488217e-02,  9.67310333e-03, -8.20776847e-03,
         4.16982267e-05,  2.67257365e-05, -6.53992434e-05],
       [ 9.67310333e-03,  8.79490622e-03, -7.22640801e-03,
         3.37561096e-05,  2.71421695e-05, -5.75809238e-05],
       [-8.20776847e-03, -7.22640801e-03,  6.49969797e-03,
        -2.79674802e-05, -1.93487138e-05,  5.32094215e-05],
       [ 4.16982267e-05,  3.37561096e-05, -2.79674802e-05,
         2.29889520e-07,  1.08789172e-07, -2.23690467e-07],
       [ 2.67257365e-05,  2.71421695e-05, -1.93487138e-05,
         1.08789172e-07,  1.63282722e-07, -1.54983203e-07],
       [-6.53992434e-05, -5.75809238e-05,  5.32094215e-05,
        -2.23690467e-07, -1.54983203e-07,  4.79565073e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-7.45822391e-06],
       [-1.61156470e-06],
       [-8.93144245e-02]])}}
Yi [[-2.41735208]
 [ 0.55000865]
 [14.57117359]]
posterior
[[-5.64012814e+03]
 [-3.31828549e+03]
 [-2.82433491e+03]
 [-2.26776305e+00]
 [-1.93755222e+00]
 [ 6.85342161e+00]
 [ 2.86854129e-01]
 [ 5.16706420e-02]
 [ 9.15776909e-01]
 [-2.76400988e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80971225e-18]]
[[-5.64009210e+03]
 [-3.31826358e+03]
 [-2.82434266e+03]
 [-2.26753110e+00]
 [-1.93749073e+00]
 [ 6.85340813e+00]
 [ 2.86854129e-01]
 [ 5.16706420e-02]
 [ 9.15776909e-01]
 [-2.76400988e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80971225e-18]]
[[ 1.09110591e-02  9.42891237e-03 -8.13333385e-03  3.96505312e-05
   2.57678231e-05 -6.52958743e-05]
 [ 9.42891237e-03  8.53025313e-03 -7.16712058e-03  3.25665019e-05
   2.55887682e-05 -5.75430092e-05]
 [-8.13333385e-03 -7.16712058e-03  6.48293988e-03 -2.75343390e-05
  -1.90841859e-05  5.31887678e-05]
 [ 3.96505312e-05  3.25665019e-05 -2.75343390e-05  2.16515305e-07
   1.05822832e-07 -2.22942886e-07]
 [ 2.57678231e-05  2.55887682e-05 -1.90841859e-05  1.05822832e-07
   1.52155066e-07 -1.55050335e-07]
 [-6.52958743e-05 -5.75430092e-05  5.31887678e-05 -2.22942886e-07
  -1.55050335e-07  4.79516265e-07]]
[[-2.41737974]
 [ 0.54996186]
 [14.62721658]]
[[ 2.76570880e-05]
 [ 4.67897016e-05]
 [-5.60429843e-02]]


 Corrector Step
2018-07-13 08:30:10
[[-5.64009210e+03]
 [-3.31826358e+03]
 [-2.82434266e+03]
 [-2.26753110e+00]
 [-1.93749073e+00]
 [ 6.85340813e+00]
 [ 2.86854129e-01]
 [ 5.16706420e-02]
 [ 9.15776909e-01]
 [-2.76400988e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80971225e-18]]
[[ 1.09110591e-02  9.42891237e-03 -8.13333385e-03  3.96505312e-05
   2.57678231e-05 -6.52958743e-05]
 [ 9.42891237e-03  8.53025313e-03 -7.16712058e-03  3.25665019e-05
   2.55887682e-05 -5.75430092e-05]
 [-8.13333385e-03 -7.16712058e-03  6.48293988e-03 -2.75343390e-05
  -1.90841859e-05  5.31887678e-05]
 [ 3.96505312e-05  3.25665019e-05 -2.75343390e-05  2.16515305e-07
   1.05822832e-07 -2.22942886e-07]
 [ 2.57678231e-05  2.55887682e-05 -1.90841859e-05  1.05822832e-07
   1.52155066e-07 -1.55050335e-07]
 [-6.52958743e-05 -5.75430092e-05  5.31887678e-05 -2.22942886e-07
  -1.55050335e-07  4.79516265e-07]]
99107708.04415625
post
cubesat_nadir
Ybar_post [[-2.41737433]
 [ 0.54997134]
 [14.62710454]]
resids [[ 2.22515887e-05]
 [ 3.73093087e-05]
 [-5.59309512e-02]]
posterior
[[-5.64007731e+03]
 [-3.31823425e+03]
 [-2.82435987e+03]
 [-2.26753262e+00]
 [-1.93727079e+00]
 [ 6.85331779e+00]]
[[-5.64006766e+03]
 [-3.31822899e+03]
 [-2.82435975e+03]
 [-2.26749600e+00]
 [-1.93725880e+00]
 [ 6.85330988e+00]]
[[ 5.11551301e-04  3.88614151e-04 -1.55153172e-04  1.84423034e-06
   1.02034674e-06 -1.27723241e-06]
 [ 3.88614151e-04  3.94295255e-04 -1.32713543e-04  1.34059479e-06
   1.15549818e-06 -1.09631220e-06]
 [-1.55153172e-04 -1.32713543e-04  1.31072182e-04 -5.32462624e-07
  -3.46712398e-07  8.10825795e-07]
 [ 1.84423034e-06  1.34059479e-06 -5.32462624e-07  7.68251535e-09
   3.55612167e-09 -4.35425122e-09]
 [ 1.02034674e-06  1.15549818e-06 -3.46712398e-07  3.55612167e-09
   4.58943087e-09 -2.79336890e-09]
 [-1.27723241e-06 -1.09631220e-06  8.10825795e-07 -4.35425122e-09
  -2.79336890e-09  6.91558852e-09]]
[[-2.41738328]
 [ 0.54997212]
 [12.8404479 ]]
[[3.12035644e-05]
 [3.65228016e-05]
 [1.73072569e+00]]


 Corrector Step
2018-07-13 08:30:10
[[-5.64006766e+03]
 [-3.31822899e+03]
 [-2.82435975e+03]
 [-2.26749600e+00]
 [-1.93725880e+00]
 [ 6.85330988e+00]]
[[ 5.11551301e-04  3.88614151e-04 -1.55153172e-04  1.84423034e-06
   1.02034674e-06 -1.27723241e-06]
 [ 3.88614151e-04  3.94295255e-04 -1.32713543e-04  1.34059479e-06
   1.15549818e-06 -1.09631220e-06]
 [-1.55153172e-04 -1.32713543e-04  1.31072182e-04 -5.32462624e-07
  -3.46712398e-07  8.10825795e-07]
 [ 1.84423034e-06  1.34059479e-06 -5.32462624e-07  7.68251535e-09
   3.55612167e-09 -4.35425122e-09]
 [ 1.02034674e-06  1.15549818e-06 -3.46712398e-07  3.55612167e-09
   4.58943087e-09 -2.79336890e-09]
 [-1.27723241e-06 -1.09631220e-06  8.10825795e-07 -4.35425122e-09
  -2.79336890e-09  6.91558852e-09]]
1.480778509649475e-57
post
sphere_lamr_small
Ybar_post [[-2.41738149]
 [ 0.54997572]
 [12.84043588]]
resids [[2.94138320e-05]
 [3.29273098e-05]
 [1.73073771e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [99107708.04415625, 1.480778509649475e-57]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.64009210e+03],
       [-3.31826358e+03],
       [-2.82434266e+03],
       [-2.26753110e+00],
       [-1.93749073e+00],
       [ 6.85340813e+00]]), 'est_covars': array([[ 1.09110591e-02,  9.42891237e-03, -8.13333385e-03,
         3.96505312e-05,  2.57678231e-05, -6.52958743e-05],
       [ 9.42891237e-03,  8.53025313e-03, -7.16712058e-03,
         3.25665019e-05,  2.55887682e-05, -5.75430092e-05],
       [-8.13333385e-03, -7.16712058e-03,  6.48293988e-03,
        -2.75343390e-05, -1.90841859e-05,  5.31887678e-05],
       [ 3.96505312e-05,  3.25665019e-05, -2.75343390e-05,
         2.16515305e-07,  1.05822832e-07, -2.22942886e-07],
       [ 2.57678231e-05,  2.55887682e-05, -1.90841859e-05,
         1.05822832e-07,  1.52155066e-07, -1.55050335e-07],
       [-6.52958743e-05, -5.75430092e-05,  5.31887678e-05,
        -2.22942886e-07, -1.55050335e-07,  4.79516265e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.64006766e+03],
       [-3.31822899e+03],
       [-2.82435975e+03],
       [-2.26749600e+00],
       [-1.93725880e+00],
       [ 6.85330988e+00]]), 'covar': array([[ 5.11551301e-04,  3.88614151e-04, -1.55153172e-04,
         1.84423034e-06,  1.02034674e-06, -1.27723241e-06],
       [ 3.88614151e-04,  3.94295255e-04, -1.32713543e-04,
         1.34059479e-06,  1.15549818e-06, -1.09631220e-06],
       [-1.55153172e-04, -1.32713543e-04,  1.31072182e-04,
        -5.32462624e-07, -3.46712398e-07,  8.10825795e-07],
       [ 1.84423034e-06,  1.34059479e-06, -5.32462624e-07,
         7.68251535e-09,  3.55612167e-09, -4.35425122e-09],
       [ 1.02034674e-06,  1.15549818e-06, -3.46712398e-07,
         3.55612167e-09,  4.58943087e-09, -2.79336890e-09],
       [-1.27723241e-06, -1.09631220e-06,  8.10825795e-07,
        -4.35425122e-09, -2.79336890e-09,  6.91558852e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[2.94138320e-05],
       [3.29273098e-05],
       [1.73073771e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.64009210e+03],
       [-3.31826358e+03],
       [-2.82434266e+03],
       [-2.26753110e+00],
       [-1.93749073e+00],
       [ 6.85340813e+00],
       [ 2.86854129e-01],
       [ 5.16706420e-02],
       [ 9.15776909e-01],
       [-2.76400988e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80971225e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.09110591e-02,  9.42891237e-03, -8.13333385e-03,
         3.96505312e-05,  2.57678231e-05, -6.52958743e-05],
       [ 9.42891237e-03,  8.53025313e-03, -7.16712058e-03,
         3.25665019e-05,  2.55887682e-05, -5.75430092e-05],
       [-8.13333385e-03, -7.16712058e-03,  6.48293988e-03,
        -2.75343390e-05, -1.90841859e-05,  5.31887678e-05],
       [ 3.96505312e-05,  3.25665019e-05, -2.75343390e-05,
         2.16515305e-07,  1.05822832e-07, -2.22942886e-07],
       [ 2.57678231e-05,  2.55887682e-05, -1.90841859e-05,
         1.05822832e-07,  1.52155066e-07, -1.55050335e-07],
       [-6.52958743e-05, -5.75430092e-05,  5.31887678e-05,
        -2.22942886e-07, -1.55050335e-07,  4.79516265e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.22515887e-05],
       [ 3.73093087e-05],
       [-5.59309512e-02]])}}
Current time:  2018-07-13 08:30:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.64009210e+03],
       [-3.31826358e+03],
       [-2.82434266e+03],
       [-2.26753110e+00],
       [-1.93749073e+00],
       [ 6.85340813e+00],
       [ 2.86854129e-01],
       [ 5.16706420e-02],
       [ 9.15776909e-01],
       [-2.76400988e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80971225e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.09110591e-02,  9.42891237e-03, -8.13333385e-03,
         3.96505312e-05,  2.57678231e-05, -6.52958743e-05],
       [ 9.42891237e-03,  8.53025313e-03, -7.16712058e-03,
         3.25665019e-05,  2.55887682e-05, -5.75430092e-05],
       [-8.13333385e-03, -7.16712058e-03,  6.48293988e-03,
        -2.75343390e-05, -1.90841859e-05,  5.31887678e-05],
       [ 3.96505312e-05,  3.25665019e-05, -2.75343390e-05,
         2.16515305e-07,  1.05822832e-07, -2.22942886e-07],
       [ 2.57678231e-05,  2.55887682e-05, -1.90841859e-05,
         1.05822832e-07,  1.52155066e-07, -1.55050335e-07],
       [-6.52958743e-05, -5.75430092e-05,  5.31887678e-05,
        -2.22942886e-07, -1.55050335e-07,  4.79516265e-07]])}
[[-5.64009210e+03]
 [-3.31826358e+03]
 [-2.82434266e+03]
 [-2.26753110e+00]
 [-1.93749073e+00]
 [ 6.85340813e+00]
 [ 2.86854129e-01]
 [ 5.16706420e-02]
 [ 9.15776909e-01]
 [-2.76400988e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80971225e-18]]
2018-07-13 08:30:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:20
[[-5.66245621e+03]
 [-3.33745537e+03]
 [-2.75565392e+03]
 [-2.20529205e+00]
 [-1.90084010e+00]
 [ 6.88421504e+00]
 [ 2.91631777e-01]
 [ 5.31131138e-02]
 [ 9.14266671e-01]
 [-2.76127432e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80992454e-18]]
[[ 1.17275599e-02  1.00237602e-02 -9.08330725e-03  4.20114198e-05
   2.68780265e-05 -6.72987380e-05]
 [ 1.00237602e-02  9.05790368e-03 -7.94807016e-03  3.37521192e-05
   2.72009158e-05 -5.88937711e-05]
 [-9.08330725e-03 -7.94807016e-03  7.59309848e-03 -2.98676976e-05
  -2.06670237e-05  5.78442399e-05]
 [ 4.20114198e-05  3.37521192e-05 -2.98676976e-05  2.27531077e-07
   1.06395866e-07 -2.22938451e-07]
 [ 2.68780265e-05  2.72009158e-05 -2.06670237e-05  1.06395866e-07
   1.62356726e-07 -1.54753744e-07]
 [-6.72987380e-05 -5.88937711e-05  5.78442399e-05 -2.22938451e-07
  -1.54753744e-07  4.86786227e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.64006766e+03],
       [-3.31822899e+03],
       [-2.82435975e+03],
       [-2.26749600e+00],
       [-1.93725880e+00],
       [ 6.85330988e+00]]), 'covar': array([[ 5.11551301e-04,  3.88614151e-04, -1.55153172e-04,
         1.84423034e-06,  1.02034674e-06, -1.27723241e-06],
       [ 3.88614151e-04,  3.94295255e-04, -1.32713543e-04,
         1.34059479e-06,  1.15549818e-06, -1.09631220e-06],
       [-1.55153172e-04, -1.32713543e-04,  1.31072182e-04,
        -5.32462624e-07, -3.46712398e-07,  8.10825795e-07],
       [ 1.84423034e-06,  1.34059479e-06, -5.32462624e-07,
         7.68251535e-09,  3.55612167e-09, -4.35425122e-09],
       [ 1.02034674e-06,  1.15549818e-06, -3.46712398e-07,
         3.55612167e-09,  4.58943087e-09, -2.79336890e-09],
       [-1.27723241e-06, -1.09631220e-06,  8.10825795e-07,
        -4.35425122e-09, -2.79336890e-09,  6.91558852e-09]])}
[[-5.64006766e+03]
 [-3.31822899e+03]
 [-2.82435975e+03]
 [-2.26749600e+00]
 [-1.93725880e+00]
 [ 6.85330988e+00]]
2018-07-13 08:30:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:20
[[-5.66243161e+03]
 [-3.33741837e+03]
 [-2.75567193e+03]
 [-2.20525646e+00]
 [-1.90060813e+00]
 [ 6.88411715e+00]]
[[ 5.49300297e-04  4.12663356e-04 -1.73639865e-04  1.93023478e-06
   1.06004568e-06 -1.31188673e-06]
 [ 4.12663356e-04  4.17960182e-04 -1.47362954e-04  1.38379169e-06
   1.20446030e-06 -1.11687517e-06]
 [-1.73639865e-04 -1.47362954e-04  1.47957829e-04 -5.77805693e-07
  -3.75206808e-07  8.76820786e-07]
 [ 1.93023478e-06  1.38379169e-06 -5.77805693e-07  7.84120731e-09
   3.59148826e-09 -4.34079182e-09]
 [ 1.06004568e-06  1.20446030e-06 -3.75206808e-07  3.59148826e-09
   4.70149515e-09 -2.77987220e-09]
 [-1.31188673e-06 -1.11687517e-06  8.76820786e-07 -4.34079182e-09
  -2.77987220e-09  6.96567829e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.66243161e+03],
       [-3.33741837e+03],
       [-2.75567193e+03],
       [-2.20525646e+00],
       [-1.90060813e+00],
       [ 6.88411715e+00]]), 'covar': array([[ 5.49300297e-04,  4.12663356e-04, -1.73639865e-04,
         1.93023478e-06,  1.06004568e-06, -1.31188673e-06],
       [ 4.12663356e-04,  4.17960182e-04, -1.47362954e-04,
         1.38379169e-06,  1.20446030e-06, -1.11687517e-06],
       [-1.73639865e-04, -1.47362954e-04,  1.47957829e-04,
        -5.77805693e-07, -3.75206808e-07,  8.76820786e-07],
       [ 1.93023478e-06,  1.38379169e-06, -5.77805693e-07,
         7.84120731e-09,  3.59148826e-09, -4.34079182e-09],
       [ 1.06004568e-06,  1.20446030e-06, -3.75206808e-07,
         3.59148826e-09,  4.70149515e-09, -2.77987220e-09],
       [-1.31188673e-06, -1.11687517e-06,  8.76820786e-07,
        -4.34079182e-09, -2.77987220e-09,  6.96567829e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[2.94138320e-05],
       [3.29273098e-05],
       [1.73073771e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.66245621e+03],
       [-3.33745537e+03],
       [-2.75565392e+03],
       [-2.20529205e+00],
       [-1.90084010e+00],
       [ 6.88421504e+00],
       [ 2.91631777e-01],
       [ 5.31131138e-02],
       [ 9.14266671e-01],
       [-2.76127432e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80992454e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.17275599e-02,  1.00237602e-02, -9.08330725e-03,
         4.20114198e-05,  2.68780265e-05, -6.72987380e-05],
       [ 1.00237602e-02,  9.05790368e-03, -7.94807016e-03,
         3.37521192e-05,  2.72009158e-05, -5.88937711e-05],
       [-9.08330725e-03, -7.94807016e-03,  7.59309848e-03,
        -2.98676976e-05, -2.06670237e-05,  5.78442399e-05],
       [ 4.20114198e-05,  3.37521192e-05, -2.98676976e-05,
         2.27531077e-07,  1.06395866e-07, -2.22938451e-07],
       [ 2.68780265e-05,  2.72009158e-05, -2.06670237e-05,
         1.06395866e-07,  1.62356726e-07, -1.54753744e-07],
       [-6.72987380e-05, -5.88937711e-05,  5.78442399e-05,
        -2.22938451e-07, -1.54753744e-07,  4.86786227e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 2.22515887e-05],
       [ 3.73093087e-05],
       [-5.59309512e-02]])}}
Yi [[-2.42034943]
 [ 0.57640569]
 [14.98311626]]
posterior
[[-5.66245621e+03]
 [-3.33745537e+03]
 [-2.75565392e+03]
 [-2.20529205e+00]
 [-1.90084010e+00]
 [ 6.88421504e+00]
 [ 2.91631777e-01]
 [ 5.31131138e-02]
 [ 9.14266671e-01]
 [-2.76127432e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80992454e-18]]
[[-5.66243398e+03]
 [-3.33743846e+03]
 [-2.75565947e+03]
 [-2.20516178e+00]
 [-1.90076841e+00]
 [ 6.88420928e+00]
 [ 2.91631777e-01]
 [ 5.31131138e-02]
 [ 9.14266671e-01]
 [-2.76127432e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80992454e-18]]
[[ 1.13816167e-02  9.77612141e-03 -8.99526885e-03  3.99445219e-05
   2.59227644e-05 -6.71719127e-05]
 [ 9.77612141e-03  8.79081204e-03 -7.87812494e-03  3.25651400e-05
   2.56470930e-05 -5.88376513e-05]
 [-8.99526885e-03 -7.87812494e-03  7.57014447e-03 -2.93643100e-05
  -2.03569102e-05  5.78144712e-05]
 [ 3.99445219e-05  3.25651400e-05 -2.93643100e-05  2.14228772e-07
   1.03522187e-07 -2.22068422e-07]
 [ 2.59227644e-05  2.56470930e-05 -2.03569102e-05  1.03522187e-07
   1.51291922e-07 -1.54739901e-07]
 [-6.71719127e-05 -5.88376513e-05  5.78144712e-05 -2.22068422e-07
  -1.54739901e-07  4.86724589e-07]]
[[-2.4203569 ]
 [ 0.57637355]
 [14.83390808]]
[[7.47420374e-06]
 [3.21416849e-05]
 [1.49208180e-01]]


 Corrector Step
2018-07-13 08:30:20
[[-5.66243398e+03]
 [-3.33743846e+03]
 [-2.75565947e+03]
 [-2.20516178e+00]
 [-1.90076841e+00]
 [ 6.88420928e+00]
 [ 2.91631777e-01]
 [ 5.31131138e-02]
 [ 9.14266671e-01]
 [-2.76127432e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80992454e-18]]
[[ 1.13816167e-02  9.77612141e-03 -8.99526885e-03  3.99445219e-05
   2.59227644e-05 -6.71719127e-05]
 [ 9.77612141e-03  8.79081204e-03 -7.87812494e-03  3.25651400e-05
   2.56470930e-05 -5.88376513e-05]
 [-8.99526885e-03 -7.87812494e-03  7.57014447e-03 -2.93643100e-05
  -2.03569102e-05  5.78144712e-05]
 [ 3.99445219e-05  3.25651400e-05 -2.93643100e-05  2.14228772e-07
   1.03522187e-07 -2.22068422e-07]
 [ 2.59227644e-05  2.56470930e-05 -2.03569102e-05  1.03522187e-07
   1.51291922e-07 -1.54739901e-07]
 [-6.71719127e-05 -5.88376513e-05  5.78144712e-05 -2.22068422e-07
  -1.54739901e-07  4.86724589e-07]]
135207922.01749733
post
cubesat_nadir
Ybar_post [[-2.42035549]
 [ 0.57637993]
 [14.83386875]]
resids [[6.06703667e-06]
 [2.57569790e-05]
 [1.49247508e-01]]
posterior
[[-5.66243161e+03]
 [-3.33741837e+03]
 [-2.75567193e+03]
 [-2.20525646e+00]
 [-1.90060813e+00]
 [ 6.88411715e+00]]
[[-5.66242503e+03]
 [-3.33741430e+03]
 [-2.75567193e+03]
 [-2.20523237e+00]
 [-1.90059820e+00]
 [ 6.88411199e+00]]
[[ 5.17682261e-04  3.89291118e-04 -1.73459310e-04  1.81652489e-06
   9.97897376e-07 -1.28447213e-06]
 [ 3.89291118e-04  3.94835120e-04 -1.47497436e-04  1.30304092e-06
   1.13609818e-06 -1.09527955e-06]
 [-1.73459310e-04 -1.47497436e-04  1.47944508e-04 -5.77004962e-07
  -3.75879225e-07  8.76725137e-07]
 [ 1.81652489e-06  1.30304092e-06 -5.77004962e-07  7.43039852e-09
   3.38064886e-09 -4.24295081e-09]
 [ 9.97897376e-07  1.13609818e-06 -3.75879225e-07  3.38064886e-09
   4.49337230e-09 -2.72088475e-09]
 [-1.28447213e-06 -1.09527955e-06  8.76725137e-07 -4.24295081e-09
  -2.72088475e-09  6.94160526e-09]]
[[-2.42036527]
 [ 0.57637857]
 [12.94581509]]
[[1.58486563e-05]
 [2.71199936e-05]
 [2.03730117e+00]]


 Corrector Step
2018-07-13 08:30:20
[[-5.66242503e+03]
 [-3.33741430e+03]
 [-2.75567193e+03]
 [-2.20523237e+00]
 [-1.90059820e+00]
 [ 6.88411199e+00]]
[[ 5.17682261e-04  3.89291118e-04 -1.73459310e-04  1.81652489e-06
   9.97897376e-07 -1.28447213e-06]
 [ 3.89291118e-04  3.94835120e-04 -1.47497436e-04  1.30304092e-06
   1.13609818e-06 -1.09527955e-06]
 [-1.73459310e-04 -1.47497436e-04  1.47944508e-04 -5.77004962e-07
  -3.75879225e-07  8.76725137e-07]
 [ 1.81652489e-06  1.30304092e-06 -5.77004962e-07  7.43039852e-09
   3.38064886e-09 -4.24295081e-09]
 [ 9.97897376e-07  1.13609818e-06 -3.75879225e-07  3.38064886e-09
   4.49337230e-09 -2.72088475e-09]
 [-1.28447213e-06 -1.09527955e-06  8.76725137e-07 -4.24295081e-09
  -2.72088475e-09  6.94160526e-09]]
3.442150438893172e-82
post
sphere_lamr_small
Ybar_post [[-2.42036432]
 [ 0.57638109]
 [12.94580831]]
resids [[1.48988618e-05]
 [2.46032140e-05]
 [2.03730795e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [135207922.01749733, 3.442150438893172e-82]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.66243398e+03],
       [-3.33743846e+03],
       [-2.75565947e+03],
       [-2.20516178e+00],
       [-1.90076841e+00],
       [ 6.88420928e+00]]), 'est_covars': array([[ 1.13816167e-02,  9.77612141e-03, -8.99526885e-03,
         3.99445219e-05,  2.59227644e-05, -6.71719127e-05],
       [ 9.77612141e-03,  8.79081204e-03, -7.87812494e-03,
         3.25651400e-05,  2.56470930e-05, -5.88376513e-05],
       [-8.99526885e-03, -7.87812494e-03,  7.57014447e-03,
        -2.93643100e-05, -2.03569102e-05,  5.78144712e-05],
       [ 3.99445219e-05,  3.25651400e-05, -2.93643100e-05,
         2.14228772e-07,  1.03522187e-07, -2.22068422e-07],
       [ 2.59227644e-05,  2.56470930e-05, -2.03569102e-05,
         1.03522187e-07,  1.51291922e-07, -1.54739901e-07],
       [-6.71719127e-05, -5.88376513e-05,  5.78144712e-05,
        -2.22068422e-07, -1.54739901e-07,  4.86724589e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.66242503e+03],
       [-3.33741430e+03],
       [-2.75567193e+03],
       [-2.20523237e+00],
       [-1.90059820e+00],
       [ 6.88411199e+00]]), 'covar': array([[ 5.17682261e-04,  3.89291118e-04, -1.73459310e-04,
         1.81652489e-06,  9.97897376e-07, -1.28447213e-06],
       [ 3.89291118e-04,  3.94835120e-04, -1.47497436e-04,
         1.30304092e-06,  1.13609818e-06, -1.09527955e-06],
       [-1.73459310e-04, -1.47497436e-04,  1.47944508e-04,
        -5.77004962e-07, -3.75879225e-07,  8.76725137e-07],
       [ 1.81652489e-06,  1.30304092e-06, -5.77004962e-07,
         7.43039852e-09,  3.38064886e-09, -4.24295081e-09],
       [ 9.97897376e-07,  1.13609818e-06, -3.75879225e-07,
         3.38064886e-09,  4.49337230e-09, -2.72088475e-09],
       [-1.28447213e-06, -1.09527955e-06,  8.76725137e-07,
        -4.24295081e-09, -2.72088475e-09,  6.94160526e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[1.48988618e-05],
       [2.46032140e-05],
       [2.03730795e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.66243398e+03],
       [-3.33743846e+03],
       [-2.75565947e+03],
       [-2.20516178e+00],
       [-1.90076841e+00],
       [ 6.88420928e+00],
       [ 2.91631777e-01],
       [ 5.31131138e-02],
       [ 9.14266671e-01],
       [-2.76127432e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80992454e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.13816167e-02,  9.77612141e-03, -8.99526885e-03,
         3.99445219e-05,  2.59227644e-05, -6.71719127e-05],
       [ 9.77612141e-03,  8.79081204e-03, -7.87812494e-03,
         3.25651400e-05,  2.56470930e-05, -5.88376513e-05],
       [-8.99526885e-03, -7.87812494e-03,  7.57014447e-03,
        -2.93643100e-05, -2.03569102e-05,  5.78144712e-05],
       [ 3.99445219e-05,  3.25651400e-05, -2.93643100e-05,
         2.14228772e-07,  1.03522187e-07, -2.22068422e-07],
       [ 2.59227644e-05,  2.56470930e-05, -2.03569102e-05,
         1.03522187e-07,  1.51291922e-07, -1.54739901e-07],
       [-6.71719127e-05, -5.88376513e-05,  5.78144712e-05,
        -2.22068422e-07, -1.54739901e-07,  4.86724589e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[6.06703667e-06],
       [2.57569790e-05],
       [1.49247508e-01]])}}
Current time:  2018-07-13 08:30:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.66243398e+03],
       [-3.33743846e+03],
       [-2.75565947e+03],
       [-2.20516178e+00],
       [-1.90076841e+00],
       [ 6.88420928e+00],
       [ 2.91631777e-01],
       [ 5.31131138e-02],
       [ 9.14266671e-01],
       [-2.76127432e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.80992454e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.13816167e-02,  9.77612141e-03, -8.99526885e-03,
         3.99445219e-05,  2.59227644e-05, -6.71719127e-05],
       [ 9.77612141e-03,  8.79081204e-03, -7.87812494e-03,
         3.25651400e-05,  2.56470930e-05, -5.88376513e-05],
       [-8.99526885e-03, -7.87812494e-03,  7.57014447e-03,
        -2.93643100e-05, -2.03569102e-05,  5.78144712e-05],
       [ 3.99445219e-05,  3.25651400e-05, -2.93643100e-05,
         2.14228772e-07,  1.03522187e-07, -2.22068422e-07],
       [ 2.59227644e-05,  2.56470930e-05, -2.03569102e-05,
         1.03522187e-07,  1.51291922e-07, -1.54739901e-07],
       [-6.71719127e-05, -5.88376513e-05,  5.78144712e-05,
        -2.22068422e-07, -1.54739901e-07,  4.86724589e-07]])}
[[-5.66243398e+03]
 [-3.33743846e+03]
 [-2.75565947e+03]
 [-2.20516178e+00]
 [-1.90076841e+00]
 [ 6.88420928e+00]
 [ 2.91631777e-01]
 [ 5.31131138e-02]
 [ 9.14266671e-01]
 [-2.76127432e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.80992454e-18]]
2018-07-13 08:30:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:30
[[-5.68417339e+03]
 [-3.35626193e+03]
 [-2.68666638e+03]
 [-2.14267125e+00]
 [-1.86390340e+00]
 [ 6.91426042e+00]
 [ 2.96401475e-01]
 [ 5.45541376e-02]
 [ 9.12731507e-01]
 [-2.75846348e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81013683e-18]]
[[ 1.22036476e-02  1.03722559e-02 -9.98222573e-03  4.22875147e-05
   2.70124261e-05 -6.91551828e-05]
 [ 1.03722559e-02  9.31957043e-03 -8.68466470e-03  3.37314527e-05
   2.72524226e-05 -6.01769457e-05]
 [-9.98222573e-03 -8.68466470e-03  8.77338856e-03 -3.16990010e-05
  -2.19405332e-05  6.25223296e-05]
 [ 4.22875147e-05  3.37314527e-05 -3.16990010e-05  2.25246809e-07
   1.04099938e-07 -2.22072472e-07]
 [ 2.70124261e-05  2.72524226e-05 -2.19405332e-05  1.04099938e-07
   1.61496894e-07 -1.54447023e-07]
 [-6.91551828e-05 -6.01769457e-05  6.25223296e-05 -2.22072472e-07
  -1.54447023e-07  4.93897868e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.66242503e+03],
       [-3.33741430e+03],
       [-2.75567193e+03],
       [-2.20523237e+00],
       [-1.90059820e+00],
       [ 6.88411199e+00]]), 'covar': array([[ 5.17682261e-04,  3.89291118e-04, -1.73459310e-04,
         1.81652489e-06,  9.97897376e-07, -1.28447213e-06],
       [ 3.89291118e-04,  3.94835120e-04, -1.47497436e-04,
         1.30304092e-06,  1.13609818e-06, -1.09527955e-06],
       [-1.73459310e-04, -1.47497436e-04,  1.47944508e-04,
        -5.77004962e-07, -3.75879225e-07,  8.76725137e-07],
       [ 1.81652489e-06,  1.30304092e-06, -5.77004962e-07,
         7.43039852e-09,  3.38064886e-09, -4.24295081e-09],
       [ 9.97897376e-07,  1.13609818e-06, -3.75879225e-07,
         3.38064886e-09,  4.49337230e-09, -2.72088475e-09],
       [-1.28447213e-06, -1.09527955e-06,  8.76725137e-07,
        -4.24295081e-09, -2.72088475e-09,  6.94160526e-09]])}
[[-5.66242503e+03]
 [-3.33741430e+03]
 [-2.75567193e+03]
 [-2.20523237e+00]
 [-1.90059820e+00]
 [ 6.88411199e+00]]
2018-07-13 08:30:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:30
[[-5.68416498e+03]
 [-3.35623617e+03]
 [-2.68667979e+03]
 [-2.14274153e+00]
 [-1.86373323e+00]
 [ 6.91416337e+00]]
[[ 5.54877082e-04  4.12681697e-04 -1.92425626e-04  1.90008239e-06
   1.03593999e-06 -1.31790157e-06]
 [ 4.12681697e-04  4.18039835e-04 -1.62463803e-04  1.34443375e-06
   1.18409343e-06 -1.11501074e-06]
 [-1.92425626e-04 -1.62463803e-04  1.66181101e-04 -6.21464581e-07
  -4.03740997e-07  9.42668126e-07]
 [ 1.90008239e-06  1.34443375e-06 -6.21464581e-07  7.58791420e-09
   3.41559924e-09 -4.23000204e-09]
 [ 1.03593999e-06  1.18409343e-06 -4.03740997e-07  3.41559924e-09
   4.60521504e-09 -2.70784831e-09]
 [-1.31790157e-06 -1.11501074e-06  9.42668126e-07 -4.23000204e-09
  -2.70784831e-09  6.99096725e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.68416498e+03],
       [-3.35623617e+03],
       [-2.68667979e+03],
       [-2.14274153e+00],
       [-1.86373323e+00],
       [ 6.91416337e+00]]), 'covar': array([[ 5.54877082e-04,  4.12681697e-04, -1.92425626e-04,
         1.90008239e-06,  1.03593999e-06, -1.31790157e-06],
       [ 4.12681697e-04,  4.18039835e-04, -1.62463803e-04,
         1.34443375e-06,  1.18409343e-06, -1.11501074e-06],
       [-1.92425626e-04, -1.62463803e-04,  1.66181101e-04,
        -6.21464581e-07, -4.03740997e-07,  9.42668126e-07],
       [ 1.90008239e-06,  1.34443375e-06, -6.21464581e-07,
         7.58791420e-09,  3.41559924e-09, -4.23000204e-09],
       [ 1.03593999e-06,  1.18409343e-06, -4.03740997e-07,
         3.41559924e-09,  4.60521504e-09, -2.70784831e-09],
       [-1.31790157e-06, -1.11501074e-06,  9.42668126e-07,
        -4.23000204e-09, -2.70784831e-09,  6.99096725e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[1.48988618e-05],
       [2.46032140e-05],
       [2.03730795e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.68417339e+03],
       [-3.35626193e+03],
       [-2.68666638e+03],
       [-2.14267125e+00],
       [-1.86390340e+00],
       [ 6.91426042e+00],
       [ 2.96401475e-01],
       [ 5.45541376e-02],
       [ 9.12731507e-01],
       [-2.75846348e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81013683e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.22036476e-02,  1.03722559e-02, -9.98222573e-03,
         4.22875147e-05,  2.70124261e-05, -6.91551828e-05],
       [ 1.03722559e-02,  9.31957043e-03, -8.68466470e-03,
         3.37314527e-05,  2.72524226e-05, -6.01769457e-05],
       [-9.98222573e-03, -8.68466470e-03,  8.77338856e-03,
        -3.16990010e-05, -2.19405332e-05,  6.25223296e-05],
       [ 4.22875147e-05,  3.37314527e-05, -3.16990010e-05,
         2.25246809e-07,  1.04099938e-07, -2.22072472e-07],
       [ 2.70124261e-05,  2.72524226e-05, -2.19405332e-05,
         1.04099938e-07,  1.61496894e-07, -1.54447023e-07],
       [-6.91551828e-05, -6.01769457e-05,  6.25223296e-05,
        -2.22072472e-07, -1.54447023e-07,  4.93897868e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[6.06703667e-06],
       [2.57569790e-05],
       [1.49247508e-01]])}}
Yi [[-2.4231211 ]
 [ 0.60128438]
 [14.96416997]]
posterior
[[-5.68417339e+03]
 [-3.35626193e+03]
 [-2.68666638e+03]
 [-2.14267125e+00]
 [-1.86390340e+00]
 [ 6.91426042e+00]
 [ 2.96401475e-01]
 [ 5.45541376e-02]
 [ 9.12731507e-01]
 [-2.75846348e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81013683e-18]]
[[-5.68416241e+03]
 [-3.35625320e+03]
 [-2.68666970e+03]
 [-2.14260995e+00]
 [-1.86386507e+00]
 [ 6.91425528e+00]
 [ 2.96401475e-01]
 [ 5.45541376e-02]
 [ 9.12731507e-01]
 [-2.75846348e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81013683e-18]]
[[ 1.18493705e-02  1.01208525e-02 -9.88054231e-03  4.02010971e-05
   2.60583905e-05 -6.90052199e-05]
 [ 1.01208525e-02  9.04963200e-03 -8.60416202e-03  3.25455064e-05
   2.56964214e-05 -6.01029921e-05]
 [-9.88054231e-03 -8.60416202e-03  8.74342617e-03 -3.11270899e-05
  -2.15866267e-05  6.24820775e-05]
 [ 4.02010971e-05  3.25455064e-05 -3.11270899e-05  2.12010889e-07
   1.01310366e-07 -2.21085465e-07]
 [ 2.60583905e-05  2.56964214e-05 -2.15866267e-05  1.01310366e-07
   1.50486870e-07 -1.54355524e-07]
 [-6.90052199e-05 -6.01029921e-05  6.24820775e-05 -2.21085465e-07
  -1.54355524e-07  4.93821139e-07]]
[[-2.42312342]
 [ 0.60126881]
 [15.02804565]]
[[ 2.31650629e-06]
 [ 1.55778791e-05]
 [-6.38756881e-02]]


 Corrector Step
2018-07-13 08:30:30
[[-5.68416241e+03]
 [-3.35625320e+03]
 [-2.68666970e+03]
 [-2.14260995e+00]
 [-1.86386507e+00]
 [ 6.91425528e+00]
 [ 2.96401475e-01]
 [ 5.45541376e-02]
 [ 9.12731507e-01]
 [-2.75846348e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81013683e-18]]
[[ 1.18493705e-02  1.01208525e-02 -9.88054231e-03  4.02010971e-05
   2.60583905e-05 -6.90052199e-05]
 [ 1.01208525e-02  9.04963200e-03 -8.60416202e-03  3.25455064e-05
   2.56964214e-05 -6.01029921e-05]
 [-9.88054231e-03 -8.60416202e-03  8.74342617e-03 -3.11270899e-05
  -2.15866267e-05  6.24820775e-05]
 [ 4.02010971e-05  3.25455064e-05 -3.11270899e-05  2.12010889e-07
   1.01310366e-07 -2.21085465e-07]
 [ 2.60583905e-05  2.56964214e-05 -2.15866267e-05  1.01310366e-07
   1.50486870e-07 -1.54355524e-07]
 [-6.90052199e-05 -6.01029921e-05  6.24820775e-05 -2.21085465e-07
  -1.54355524e-07  4.93821139e-07]]
597623929.7167395
post
cubesat_nadir
Ybar_post [[-2.42312297]
 [ 0.60127188]
 [15.02802877]]
resids [[ 1.87020259e-06]
 [ 1.25082307e-05]
 [-6.38588007e-02]]
posterior
[[-5.68416498e+03]
 [-3.35623617e+03]
 [-2.68667979e+03]
 [-2.14274153e+00]
 [-1.86373323e+00]
 [ 6.91416337e+00]]
[[-5.68416139e+03]
 [-3.35623432e+03]
 [-2.68667985e+03]
 [-2.14272845e+00]
 [-1.86372929e+00]
 [ 6.91416087e+00]]
[[ 5.24281367e-04  3.90468751e-04 -1.91576544e-04  1.79241202e-06
   9.78065649e-07 -1.29238872e-06]
 [ 3.90468751e-04  3.95943666e-04 -1.62052341e-04  1.26962522e-06
   1.11949817e-06 -1.09523029e-06]
 [-1.91576544e-04 -1.62052341e-04  1.66150485e-04 -6.18361111e-07
  -4.02910208e-07  9.42003230e-07]
 [ 1.79241202e-06  1.26962522e-06 -6.18361111e-07  7.20711462e-09
   3.22464708e-09 -4.14092731e-09]
 [ 9.78065649e-07  1.11949817e-06 -4.02910208e-07  3.22464708e-09
   4.41034487e-09 -2.65483145e-09]
 [-1.29238872e-06 -1.09523029e-06  9.42003230e-07 -4.14092731e-09
  -2.65483145e-09  6.96942754e-09]]
[[-2.42313322]
 [ 0.60127009]
 [13.04789519]]
[[1.21214704e-05]
 [1.42963792e-05]
 [1.91627477e+00]]


 Corrector Step
2018-07-13 08:30:30
[[-5.68416139e+03]
 [-3.35623432e+03]
 [-2.68667985e+03]
 [-2.14272845e+00]
 [-1.86372929e+00]
 [ 6.91416087e+00]]
[[ 5.24281367e-04  3.90468751e-04 -1.91576544e-04  1.79241202e-06
   9.78065649e-07 -1.29238872e-06]
 [ 3.90468751e-04  3.95943666e-04 -1.62052341e-04  1.26962522e-06
   1.11949817e-06 -1.09523029e-06]
 [-1.91576544e-04 -1.62052341e-04  1.66150485e-04 -6.18361111e-07
  -4.02910208e-07  9.42003230e-07]
 [ 1.79241202e-06  1.26962522e-06 -6.18361111e-07  7.20711462e-09
   3.22464708e-09 -4.14092731e-09]
 [ 9.78065649e-07  1.11949817e-06 -4.02910208e-07  3.22464708e-09
   4.41034487e-09 -2.65483145e-09]
 [-1.29238872e-06 -1.09523029e-06  9.42003230e-07 -4.14092731e-09
  -2.65483145e-09  6.96942754e-09]]
1.3873767042280535e-71
post
sphere_lamr_small
Ybar_post [[-2.42313255]
 [ 0.60127135]
 [13.0478921 ]]
resids [[1.14486436e-05]
 [1.30358379e-05]
 [1.91627787e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [597623929.7167395, 1.3873767042280535e-71]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.68416241e+03],
       [-3.35625320e+03],
       [-2.68666970e+03],
       [-2.14260995e+00],
       [-1.86386507e+00],
       [ 6.91425528e+00]]), 'est_covars': array([[ 1.18493705e-02,  1.01208525e-02, -9.88054231e-03,
         4.02010971e-05,  2.60583905e-05, -6.90052199e-05],
       [ 1.01208525e-02,  9.04963200e-03, -8.60416202e-03,
         3.25455064e-05,  2.56964214e-05, -6.01029921e-05],
       [-9.88054231e-03, -8.60416202e-03,  8.74342617e-03,
        -3.11270899e-05, -2.15866267e-05,  6.24820775e-05],
       [ 4.02010971e-05,  3.25455064e-05, -3.11270899e-05,
         2.12010889e-07,  1.01310366e-07, -2.21085465e-07],
       [ 2.60583905e-05,  2.56964214e-05, -2.15866267e-05,
         1.01310366e-07,  1.50486870e-07, -1.54355524e-07],
       [-6.90052199e-05, -6.01029921e-05,  6.24820775e-05,
        -2.21085465e-07, -1.54355524e-07,  4.93821139e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.68416139e+03],
       [-3.35623432e+03],
       [-2.68667985e+03],
       [-2.14272845e+00],
       [-1.86372929e+00],
       [ 6.91416087e+00]]), 'covar': array([[ 5.24281367e-04,  3.90468751e-04, -1.91576544e-04,
         1.79241202e-06,  9.78065649e-07, -1.29238872e-06],
       [ 3.90468751e-04,  3.95943666e-04, -1.62052341e-04,
         1.26962522e-06,  1.11949817e-06, -1.09523029e-06],
       [-1.91576544e-04, -1.62052341e-04,  1.66150485e-04,
        -6.18361111e-07, -4.02910208e-07,  9.42003230e-07],
       [ 1.79241202e-06,  1.26962522e-06, -6.18361111e-07,
         7.20711462e-09,  3.22464708e-09, -4.14092731e-09],
       [ 9.78065649e-07,  1.11949817e-06, -4.02910208e-07,
         3.22464708e-09,  4.41034487e-09, -2.65483145e-09],
       [-1.29238872e-06, -1.09523029e-06,  9.42003230e-07,
        -4.14092731e-09, -2.65483145e-09,  6.96942754e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[1.14486436e-05],
       [1.30358379e-05],
       [1.91627787e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.68416241e+03],
       [-3.35625320e+03],
       [-2.68666970e+03],
       [-2.14260995e+00],
       [-1.86386507e+00],
       [ 6.91425528e+00],
       [ 2.96401475e-01],
       [ 5.45541376e-02],
       [ 9.12731507e-01],
       [-2.75846348e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81013683e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.18493705e-02,  1.01208525e-02, -9.88054231e-03,
         4.02010971e-05,  2.60583905e-05, -6.90052199e-05],
       [ 1.01208525e-02,  9.04963200e-03, -8.60416202e-03,
         3.25455064e-05,  2.56964214e-05, -6.01029921e-05],
       [-9.88054231e-03, -8.60416202e-03,  8.74342617e-03,
        -3.11270899e-05, -2.15866267e-05,  6.24820775e-05],
       [ 4.02010971e-05,  3.25455064e-05, -3.11270899e-05,
         2.12010889e-07,  1.01310366e-07, -2.21085465e-07],
       [ 2.60583905e-05,  2.56964214e-05, -2.15866267e-05,
         1.01310366e-07,  1.50486870e-07, -1.54355524e-07],
       [-6.90052199e-05, -6.01029921e-05,  6.24820775e-05,
        -2.21085465e-07, -1.54355524e-07,  4.93821139e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.87020259e-06],
       [ 1.25082307e-05],
       [-6.38588007e-02]])}}
Current time:  2018-07-13 08:30:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.68416241e+03],
       [-3.35625320e+03],
       [-2.68666970e+03],
       [-2.14260995e+00],
       [-1.86386507e+00],
       [ 6.91425528e+00],
       [ 2.96401475e-01],
       [ 5.45541376e-02],
       [ 9.12731507e-01],
       [-2.75846348e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81013683e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.18493705e-02,  1.01208525e-02, -9.88054231e-03,
         4.02010971e-05,  2.60583905e-05, -6.90052199e-05],
       [ 1.01208525e-02,  9.04963200e-03, -8.60416202e-03,
         3.25455064e-05,  2.56964214e-05, -6.01029921e-05],
       [-9.88054231e-03, -8.60416202e-03,  8.74342617e-03,
        -3.11270899e-05, -2.15866267e-05,  6.24820775e-05],
       [ 4.02010971e-05,  3.25455064e-05, -3.11270899e-05,
         2.12010889e-07,  1.01310366e-07, -2.21085465e-07],
       [ 2.60583905e-05,  2.56964214e-05, -2.15866267e-05,
         1.01310366e-07,  1.50486870e-07, -1.54355524e-07],
       [-6.90052199e-05, -6.01029921e-05,  6.24820775e-05,
        -2.21085465e-07, -1.54355524e-07,  4.93821139e-07]])}
[[-5.68416241e+03]
 [-3.35625320e+03]
 [-2.68666970e+03]
 [-2.14260995e+00]
 [-1.86386507e+00]
 [ 6.91425528e+00]
 [ 2.96401475e-01]
 [ 5.45541376e-02]
 [ 9.12731507e-01]
 [-2.75846348e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81013683e-18]]
2018-07-13 08:30:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:40
[[-5.70527505e+03]
 [-3.37470649e+03]
 [-2.61738007e+03]
 [-2.07987494e+00]
 [-1.82678971e+00]
 [ 6.94354663e+00]
 [ 3.01163091e-01]
 [ 5.59936741e-02]
 [ 9.11171461e-01]
 [-2.75557743e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81034911e-18]]
[[ 1.26763666e-02  1.07179692e-02 -1.09033590e-02  4.25272394e-05
   2.71286485e-05 -7.09676792e-05]
 [ 1.07179692e-02  9.57939529e-03 -9.43562843e-03  3.36937215e-05
   2.72957569e-05 -6.14301636e-05]
 [-1.09033590e-02 -9.43562843e-03  1.00404855e-02 -3.34626124e-05
  -2.31706765e-05  6.72403447e-05]
 [ 4.25272394e-05  3.36937215e-05 -3.34626124e-05  2.23032900e-07
   1.01893995e-07 -2.21100306e-07]
 [ 2.71286485e-05  2.72957569e-05 -2.31706765e-05  1.01893995e-07
   1.60695946e-07 -1.54067819e-07]
 [-7.09676792e-05 -6.14301636e-05  6.72403447e-05 -2.21100306e-07
  -1.54067819e-07  5.00897608e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.68416139e+03],
       [-3.35623432e+03],
       [-2.68667985e+03],
       [-2.14272845e+00],
       [-1.86372929e+00],
       [ 6.91416087e+00]]), 'covar': array([[ 5.24281367e-04,  3.90468751e-04, -1.91576544e-04,
         1.79241202e-06,  9.78065649e-07, -1.29238872e-06],
       [ 3.90468751e-04,  3.95943666e-04, -1.62052341e-04,
         1.26962522e-06,  1.11949817e-06, -1.09523029e-06],
       [-1.91576544e-04, -1.62052341e-04,  1.66150485e-04,
        -6.18361111e-07, -4.02910208e-07,  9.42003230e-07],
       [ 1.79241202e-06,  1.26962522e-06, -6.18361111e-07,
         7.20711462e-09,  3.22464708e-09, -4.14092731e-09],
       [ 9.78065649e-07,  1.11949817e-06, -4.02910208e-07,
         3.22464708e-09,  4.41034487e-09, -2.65483145e-09],
       [-1.29238872e-06, -1.09523029e-06,  9.42003230e-07,
        -4.14092731e-09, -2.65483145e-09,  6.96942754e-09]])}
[[-5.68416139e+03]
 [-3.35623432e+03]
 [-2.68667985e+03]
 [-2.14272845e+00]
 [-1.86372929e+00]
 [ 6.91416087e+00]]
2018-07-13 08:30:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:40
[[-5.70527478e+03]
 [-3.37468637e+03]
 [-2.61739119e+03]
 [-2.07999349e+00]
 [-1.82665423e+00]
 [ 6.94345248e+00]]
[[ 5.61618377e-04  4.13393898e-04 -2.11102835e-04  1.87373015e-06
   1.01458740e-06 -1.32489336e-06]
 [ 4.13393898e-04  4.18809195e-04 -1.77269766e-04  1.30949537e-06
   1.16669207e-06 -1.11430064e-06]
 [-2.11102835e-04 -1.77269766e-04  1.85648691e-04 -6.62116651e-07
  -4.30259993e-07  1.00784581e-06]
 [ 1.87373015e-06  1.30949537e-06 -6.62116651e-07  7.36358026e-09
   3.25923885e-09 -4.12855196e-09]
 [ 1.01458740e-06  1.16669207e-06 -4.30259993e-07  3.25923885e-09
   4.52199021e-09 -2.64225659e-09]
 [-1.32489336e-06 -1.11430064e-06  1.00784581e-06 -4.12855196e-09
  -2.64225659e-09  7.01821576e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.70527478e+03],
       [-3.37468637e+03],
       [-2.61739119e+03],
       [-2.07999349e+00],
       [-1.82665423e+00],
       [ 6.94345248e+00]]), 'covar': array([[ 5.61618377e-04,  4.13393898e-04, -2.11102835e-04,
         1.87373015e-06,  1.01458740e-06, -1.32489336e-06],
       [ 4.13393898e-04,  4.18809195e-04, -1.77269766e-04,
         1.30949537e-06,  1.16669207e-06, -1.11430064e-06],
       [-2.11102835e-04, -1.77269766e-04,  1.85648691e-04,
        -6.62116651e-07, -4.30259993e-07,  1.00784581e-06],
       [ 1.87373015e-06,  1.30949537e-06, -6.62116651e-07,
         7.36358026e-09,  3.25923885e-09, -4.12855196e-09],
       [ 1.01458740e-06,  1.16669207e-06, -4.30259993e-07,
         3.25923885e-09,  4.52199021e-09, -2.64225659e-09],
       [-1.32489336e-06, -1.11430064e-06,  1.00784581e-06,
        -4.12855196e-09, -2.64225659e-09,  7.01821576e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[1.14486436e-05],
       [1.30358379e-05],
       [1.91627787e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.70527505e+03],
       [-3.37470649e+03],
       [-2.61738007e+03],
       [-2.07987494e+00],
       [-1.82678971e+00],
       [ 6.94354663e+00],
       [ 3.01163091e-01],
       [ 5.59936741e-02],
       [ 9.11171461e-01],
       [-2.75557743e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81034911e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.26763666e-02,  1.07179692e-02, -1.09033590e-02,
         4.25272394e-05,  2.71286485e-05, -7.09676792e-05],
       [ 1.07179692e-02,  9.57939529e-03, -9.43562843e-03,
         3.36937215e-05,  2.72957569e-05, -6.14301636e-05],
       [-1.09033590e-02, -9.43562843e-03,  1.00404855e-02,
        -3.34626124e-05, -2.31706765e-05,  6.72403447e-05],
       [ 4.25272394e-05,  3.36937215e-05, -3.34626124e-05,
         2.23032900e-07,  1.01893995e-07, -2.21100306e-07],
       [ 2.71286485e-05,  2.72957569e-05, -2.31706765e-05,
         1.01893995e-07,  1.60695946e-07, -1.54067819e-07],
       [-7.09676792e-05, -6.14301636e-05,  6.72403447e-05,
        -2.21100306e-07, -1.54067819e-07,  5.00897608e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.87020259e-06],
       [ 1.25082307e-05],
       [-6.38588007e-02]])}}
Yi [[-2.42570287]
 [ 0.62475698]
 [15.12409449]]
posterior
[[-5.70527505e+03]
 [-3.37470649e+03]
 [-2.61738007e+03]
 [-2.07987494e+00]
 [-1.82678971e+00]
 [ 6.94354663e+00]
 [ 3.01163091e-01]
 [ 5.59936741e-02]
 [ 9.11171461e-01]
 [-2.75557743e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81034911e-18]]
[[-5.70529958e+03]
 [-3.37472406e+03]
 [-2.61737236e+03]
 [-2.08001684e+00]
 [-1.82685751e+00]
 [ 6.94355700e+00]
 [ 3.01163091e-01]
 [ 5.59936741e-02]
 [ 9.11171461e-01]
 [-2.75557743e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81034911e-18]]
[[ 1.23134873e-02  1.04624923e-02 -1.07878888e-02  4.04205703e-05
   2.61746389e-05 -7.07947080e-05]
 [ 1.04624923e-02  9.30626886e-03 -9.34457299e-03  3.25074031e-05
   2.57361942e-05 -6.13386345e-05]
 [-1.07878888e-02 -9.34457299e-03  1.00027028e-02 -3.28233933e-05
  -2.27742358e-05  6.71882954e-05]
 [ 4.04205703e-05  3.25074031e-05 -3.28233933e-05  2.09857789e-07
   9.91813251e-08 -2.20000529e-07]
 [ 2.61746389e-05  2.57361942e-05 -2.27742358e-05  9.91813251e-08
   1.49734285e-07 -1.53901656e-07]
 [-7.07947080e-05 -6.13386345e-05  6.71882954e-05 -2.20000529e-07
  -1.53901656e-07  5.00803637e-07]]
[[-2.42569265]
 [ 0.62479048]
 [15.21589088]]
[[-1.02180024e-05]
 [-3.35069965e-05]
 [-9.17963966e-02]]


 Corrector Step
2018-07-13 08:30:40
[[-5.70529958e+03]
 [-3.37472406e+03]
 [-2.61737236e+03]
 [-2.08001684e+00]
 [-1.82685751e+00]
 [ 6.94355700e+00]
 [ 3.01163091e-01]
 [ 5.59936741e-02]
 [ 9.11171461e-01]
 [-2.75557743e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81034911e-18]]
[[ 1.23134873e-02  1.04624923e-02 -1.07878888e-02  4.04205703e-05
   2.61746389e-05 -7.07947080e-05]
 [ 1.04624923e-02  9.30626886e-03 -9.34457299e-03  3.25074031e-05
   2.57361942e-05 -6.13386345e-05]
 [-1.07878888e-02 -9.34457299e-03  1.00027028e-02 -3.28233933e-05
  -2.27742358e-05  6.71882954e-05]
 [ 4.04205703e-05  3.25074031e-05 -3.28233933e-05  2.09857789e-07
   9.91813251e-08 -2.20000529e-07]
 [ 2.61746389e-05  2.57361942e-05 -2.27742358e-05  9.91813251e-08
   1.49734285e-07 -1.53901656e-07]
 [-7.07947080e-05 -6.13386345e-05  6.71882954e-05 -2.20000529e-07
  -1.53901656e-07  5.00803637e-07]]
245443209.6353161
post
cubesat_nadir
Ybar_post [[-2.42569474]
 [ 0.62478414]
 [15.21594603]]
resids [[-8.12991005e-06]
 [-2.71605467e-05]
 [-9.18515461e-02]]
posterior
[[-5.70527478e+03]
 [-3.37468637e+03]
 [-2.61739119e+03]
 [-2.07999349e+00]
 [-1.82665423e+00]
 [ 6.94345248e+00]]
[[-5.70528169e+03]
 [-3.37469225e+03]
 [-2.61739080e+03]
 [-2.08001675e+00]
 [-1.82667033e+00]
 [ 6.94345855e+00]]
[[ 5.31833852e-04  3.92190740e-04 -2.09659024e-04  1.77120362e-06
   9.60472052e-07 -1.30100265e-06]
 [ 3.92190740e-04  3.97601728e-04 -1.76388984e-04  1.23985788e-06
   1.10535080e-06 -1.09609282e-06]
 [-2.09659024e-04 -1.76388984e-04  1.85575151e-04 -6.57066088e-07
  -4.28185583e-07  1.00671651e-06]
 [ 1.77120362e-06  1.23985788e-06 -6.57066088e-07  7.00882038e-09
   3.08546118e-09 -4.04697129e-09]
 [ 9.60472052e-07  1.10535080e-06 -4.28185583e-07  3.08546118e-09
   4.33850390e-09 -2.59436937e-09]
 [-1.30100265e-06 -1.09609282e-06  1.00671651e-06 -4.04697129e-09
  -2.59436937e-09  6.99881657e-09]]
[[-2.42570308]
 [ 0.62478986]
 [13.14679408]]
[[ 2.12810441e-07]
 [-3.28811477e-05]
 [ 1.97730041e+00]]


 Corrector Step
2018-07-13 08:30:40
[[-5.70528169e+03]
 [-3.37469225e+03]
 [-2.61739080e+03]
 [-2.08001675e+00]
 [-1.82667033e+00]
 [ 6.94345855e+00]]
[[ 5.31833852e-04  3.92190740e-04 -2.09659024e-04  1.77120362e-06
   9.60472052e-07 -1.30100265e-06]
 [ 3.92190740e-04  3.97601728e-04 -1.76388984e-04  1.23985788e-06
   1.10535080e-06 -1.09609282e-06]
 [-2.09659024e-04 -1.76388984e-04  1.85575151e-04 -6.57066088e-07
  -4.28185583e-07  1.00671651e-06]
 [ 1.77120362e-06  1.23985788e-06 -6.57066088e-07  7.00882038e-09
   3.08546118e-09 -4.04697129e-09]
 [ 9.60472052e-07  1.10535080e-06 -4.28185583e-07  3.08546118e-09
   4.33850390e-09 -2.59436937e-09]
 [-1.30100265e-06 -1.09609282e-06  1.00671651e-06 -4.04697129e-09
  -2.59436937e-09  6.99881657e-09]]
5.477809506263528e-77
post
sphere_lamr_small
Ybar_post [[-2.42570325]
 [ 0.62478703]
 [13.14680115]]
resids [[ 3.80686851e-07]
 [-3.00557405e-05]
 [ 1.97729334e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [245443209.6353161, 5.477809506263528e-77]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.70529958e+03],
       [-3.37472406e+03],
       [-2.61737236e+03],
       [-2.08001684e+00],
       [-1.82685751e+00],
       [ 6.94355700e+00]]), 'est_covars': array([[ 1.23134873e-02,  1.04624923e-02, -1.07878888e-02,
         4.04205703e-05,  2.61746389e-05, -7.07947080e-05],
       [ 1.04624923e-02,  9.30626886e-03, -9.34457299e-03,
         3.25074031e-05,  2.57361942e-05, -6.13386345e-05],
       [-1.07878888e-02, -9.34457299e-03,  1.00027028e-02,
        -3.28233933e-05, -2.27742358e-05,  6.71882954e-05],
       [ 4.04205703e-05,  3.25074031e-05, -3.28233933e-05,
         2.09857789e-07,  9.91813251e-08, -2.20000529e-07],
       [ 2.61746389e-05,  2.57361942e-05, -2.27742358e-05,
         9.91813251e-08,  1.49734285e-07, -1.53901656e-07],
       [-7.07947080e-05, -6.13386345e-05,  6.71882954e-05,
        -2.20000529e-07, -1.53901656e-07,  5.00803637e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.70528169e+03],
       [-3.37469225e+03],
       [-2.61739080e+03],
       [-2.08001675e+00],
       [-1.82667033e+00],
       [ 6.94345855e+00]]), 'covar': array([[ 5.31833852e-04,  3.92190740e-04, -2.09659024e-04,
         1.77120362e-06,  9.60472052e-07, -1.30100265e-06],
       [ 3.92190740e-04,  3.97601728e-04, -1.76388984e-04,
         1.23985788e-06,  1.10535080e-06, -1.09609282e-06],
       [-2.09659024e-04, -1.76388984e-04,  1.85575151e-04,
        -6.57066088e-07, -4.28185583e-07,  1.00671651e-06],
       [ 1.77120362e-06,  1.23985788e-06, -6.57066088e-07,
         7.00882038e-09,  3.08546118e-09, -4.04697129e-09],
       [ 9.60472052e-07,  1.10535080e-06, -4.28185583e-07,
         3.08546118e-09,  4.33850390e-09, -2.59436937e-09],
       [-1.30100265e-06, -1.09609282e-06,  1.00671651e-06,
        -4.04697129e-09, -2.59436937e-09,  6.99881657e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 3.80686851e-07],
       [-3.00557405e-05],
       [ 1.97729334e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.70529958e+03],
       [-3.37472406e+03],
       [-2.61737236e+03],
       [-2.08001684e+00],
       [-1.82685751e+00],
       [ 6.94355700e+00],
       [ 3.01163091e-01],
       [ 5.59936741e-02],
       [ 9.11171461e-01],
       [-2.75557743e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81034911e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.23134873e-02,  1.04624923e-02, -1.07878888e-02,
         4.04205703e-05,  2.61746389e-05, -7.07947080e-05],
       [ 1.04624923e-02,  9.30626886e-03, -9.34457299e-03,
         3.25074031e-05,  2.57361942e-05, -6.13386345e-05],
       [-1.07878888e-02, -9.34457299e-03,  1.00027028e-02,
        -3.28233933e-05, -2.27742358e-05,  6.71882954e-05],
       [ 4.04205703e-05,  3.25074031e-05, -3.28233933e-05,
         2.09857789e-07,  9.91813251e-08, -2.20000529e-07],
       [ 2.61746389e-05,  2.57361942e-05, -2.27742358e-05,
         9.91813251e-08,  1.49734285e-07, -1.53901656e-07],
       [-7.07947080e-05, -6.13386345e-05,  6.71882954e-05,
        -2.20000529e-07, -1.53901656e-07,  5.00803637e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.12991005e-06],
       [-2.71605467e-05],
       [-9.18515461e-02]])}}
Current time:  2018-07-13 08:30:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.70529958e+03],
       [-3.37472406e+03],
       [-2.61737236e+03],
       [-2.08001684e+00],
       [-1.82685751e+00],
       [ 6.94355700e+00],
       [ 3.01163091e-01],
       [ 5.59936741e-02],
       [ 9.11171461e-01],
       [-2.75557743e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81034911e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.23134873e-02,  1.04624923e-02, -1.07878888e-02,
         4.04205703e-05,  2.61746389e-05, -7.07947080e-05],
       [ 1.04624923e-02,  9.30626886e-03, -9.34457299e-03,
         3.25074031e-05,  2.57361942e-05, -6.13386345e-05],
       [-1.07878888e-02, -9.34457299e-03,  1.00027028e-02,
        -3.28233933e-05, -2.27742358e-05,  6.71882954e-05],
       [ 4.04205703e-05,  3.25074031e-05, -3.28233933e-05,
         2.09857789e-07,  9.91813251e-08, -2.20000529e-07],
       [ 2.61746389e-05,  2.57361942e-05, -2.27742358e-05,
         9.91813251e-08,  1.49734285e-07, -1.53901656e-07],
       [-7.07947080e-05, -6.13386345e-05,  6.71882954e-05,
        -2.20000529e-07, -1.53901656e-07,  5.00803637e-07]])}
[[-5.70529958e+03]
 [-3.37472406e+03]
 [-2.61737236e+03]
 [-2.08001684e+00]
 [-1.82685751e+00]
 [ 6.94355700e+00]
 [ 3.01163091e-01]
 [ 5.59936741e-02]
 [ 9.11171461e-01]
 [-2.75557743e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81034911e-18]]
2018-07-13 08:30:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:50
[[-5.72578512e+03]
 [-3.39280635e+03]
 [-2.54779341e+03]
 [-2.01704509e+00]
 [-1.78957644e+00]
 [ 6.97208502e+00]
 [ 3.05916498e-01]
 [ 5.74316842e-02]
 [ 9.09586574e-01]
 [-2.75261627e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81056140e-18]]
[[ 1.31447106e-02  1.10602031e-02 -1.18454575e-02  4.27308002e-05
   2.72265181e-05 -7.27352386e-05]
 [ 1.10602031e-02  9.83667760e-03 -1.02001882e-02  3.36384643e-05
   2.73300664e-05 -6.26526688e-05]
 [-1.18454575e-02 -1.02001882e-02  1.13944128e-02 -3.51592416e-05
  -2.43583472e-05  7.19951415e-05]
 [ 4.27308002e-05  3.36384643e-05 -3.51592416e-05  2.20885207e-07
   9.97717293e-08 -2.20028129e-07]
 [ 2.72265181e-05  2.73300664e-05 -2.43583472e-05  9.97717293e-08
   1.59947998e-07 -1.53620267e-07]
 [-7.27352386e-05 -6.26526688e-05  7.19951415e-05 -2.20028129e-07
  -1.53620267e-07  5.07783190e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.70528169e+03],
       [-3.37469225e+03],
       [-2.61739080e+03],
       [-2.08001675e+00],
       [-1.82667033e+00],
       [ 6.94345855e+00]]), 'covar': array([[ 5.31833852e-04,  3.92190740e-04, -2.09659024e-04,
         1.77120362e-06,  9.60472052e-07, -1.30100265e-06],
       [ 3.92190740e-04,  3.97601728e-04, -1.76388984e-04,
         1.23985788e-06,  1.10535080e-06, -1.09609282e-06],
       [-2.09659024e-04, -1.76388984e-04,  1.85575151e-04,
        -6.57066088e-07, -4.28185583e-07,  1.00671651e-06],
       [ 1.77120362e-06,  1.23985788e-06, -6.57066088e-07,
         7.00882038e-09,  3.08546118e-09, -4.04697129e-09],
       [ 9.60472052e-07,  1.10535080e-06, -4.28185583e-07,
         3.08546118e-09,  4.33850390e-09, -2.59436937e-09],
       [-1.30100265e-06, -1.09609282e-06,  1.00671651e-06,
        -4.04697129e-09, -2.59436937e-09,  6.99881657e-09]])}
[[-5.70528169e+03]
 [-3.37469225e+03]
 [-2.61739080e+03]
 [-2.08001675e+00]
 [-1.82667033e+00]
 [ 6.94345855e+00]]
2018-07-13 08:30:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:30:50
[[-5.72576685e+03]
 [-3.39277261e+03]
 [-2.54781303e+03]
 [-2.01704459e+00]
 [-1.78938928e+00]
 [ 6.97198682e+00]]
[[ 5.68388631e-04  4.14642599e-04 -2.29680183e-04  1.85059618e-06
   9.95669597e-07 -1.33251157e-06]
 [ 4.14642599e-04  4.20188177e-04 -1.91872835e-04  1.27836605e-06
   1.15184584e-06 -1.11456387e-06]
 [-2.29680183e-04 -1.91872835e-04  2.06377506e-04 -7.00140588e-07
  -4.55046376e-07  1.07250466e-06]
 [ 1.85059618e-06  1.27836605e-06 -7.00140588e-07  7.16449898e-09
   3.11983913e-09 -4.03512823e-09]
 [ 9.95669597e-07  1.15184584e-06 -4.55046376e-07  3.11983913e-09
   4.45003240e-09 -2.58221181e-09]
 [-1.33251157e-06 -1.11456387e-06  1.07250466e-06 -4.03512823e-09
  -2.58221181e-09  7.04701003e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.72576685e+03],
       [-3.39277261e+03],
       [-2.54781303e+03],
       [-2.01704459e+00],
       [-1.78938928e+00],
       [ 6.97198682e+00]]), 'covar': array([[ 5.68388631e-04,  4.14642599e-04, -2.29680183e-04,
         1.85059618e-06,  9.95669597e-07, -1.33251157e-06],
       [ 4.14642599e-04,  4.20188177e-04, -1.91872835e-04,
         1.27836605e-06,  1.15184584e-06, -1.11456387e-06],
       [-2.29680183e-04, -1.91872835e-04,  2.06377506e-04,
        -7.00140588e-07, -4.55046376e-07,  1.07250466e-06],
       [ 1.85059618e-06,  1.27836605e-06, -7.00140588e-07,
         7.16449898e-09,  3.11983913e-09, -4.03512823e-09],
       [ 9.95669597e-07,  1.15184584e-06, -4.55046376e-07,
         3.11983913e-09,  4.45003240e-09, -2.58221181e-09],
       [-1.33251157e-06, -1.11456387e-06,  1.07250466e-06,
        -4.03512823e-09, -2.58221181e-09,  7.04701003e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 3.80686851e-07],
       [-3.00557405e-05],
       [ 1.97729334e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.72578512e+03],
       [-3.39280635e+03],
       [-2.54779341e+03],
       [-2.01704509e+00],
       [-1.78957644e+00],
       [ 6.97208502e+00],
       [ 3.05916498e-01],
       [ 5.74316842e-02],
       [ 9.09586574e-01],
       [-2.75261627e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81056140e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.31447106e-02,  1.10602031e-02, -1.18454575e-02,
         4.27308002e-05,  2.72265181e-05, -7.27352386e-05],
       [ 1.10602031e-02,  9.83667760e-03, -1.02001882e-02,
         3.36384643e-05,  2.73300664e-05, -6.26526688e-05],
       [-1.18454575e-02, -1.02001882e-02,  1.13944128e-02,
        -3.51592416e-05, -2.43583472e-05,  7.19951415e-05],
       [ 4.27308002e-05,  3.36384643e-05, -3.51592416e-05,
         2.20885207e-07,  9.97717293e-08, -2.20028129e-07],
       [ 2.72265181e-05,  2.73300664e-05, -2.43583472e-05,
         9.97717293e-08,  1.59947998e-07, -1.53620267e-07],
       [-7.27352386e-05, -6.26526688e-05,  7.19951415e-05,
        -2.20028129e-07, -1.53620267e-07,  5.07783190e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-8.12991005e-06],
       [-2.71605467e-05],
       [-9.18515461e-02]])}}
Yi [[-2.42812662]
 [ 0.6470559 ]
 [15.40930504]]
posterior
[[-5.72578512e+03]
 [-3.39280635e+03]
 [-2.54779341e+03]
 [-2.01704509e+00]
 [-1.78957644e+00]
 [ 6.97208502e+00]
 [ 3.05916498e-01]
 [ 5.74316842e-02]
 [ 9.09586574e-01]
 [-2.75261627e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81056140e-18]]
[[-5.72579778e+03]
 [-3.39280005e+03]
 [-2.54779077e+03]
 [-2.01716524e+00]
 [-1.78946588e+00]
 [ 6.97209626e+00]
 [ 3.05916498e-01]
 [ 5.74316842e-02]
 [ 9.09586574e-01]
 [-2.75261627e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81056140e-18]]
[[ 1.27731237e-02  1.08004698e-02 -1.17161223e-02  4.06038726e-05
   2.62718114e-05 -7.25397040e-05]
 [ 1.08004698e-02  9.56018631e-03 -1.00986320e-02  3.24508824e-05
   2.57662767e-05 -6.25440752e-05]
 [-1.17161223e-02 -1.00986320e-02  1.13480669e-02 -3.44541476e-05
  -2.39208065e-05  7.19302029e-05]
 [ 4.06038726e-05  3.24508824e-05 -3.44541476e-05  2.07768302e-07
   9.71310645e-08 -2.18821115e-07]
 [ 2.62718114e-05  2.57662767e-05 -2.39208065e-05  9.71310645e-08
   1.49030234e-07 -1.53383658e-07]
 [-7.25397040e-05 -6.25440752e-05  7.19302029e-05 -2.18821115e-07
  -1.53383658e-07  5.07670302e-07]]
[[-2.42808115]
 [ 0.64705943]
 [15.40058637]]
[[-4.54656671e-05]
 [-3.53434095e-06]
 [ 8.71867778e-03]]


 Corrector Step
2018-07-13 08:30:50
[[-5.72579778e+03]
 [-3.39280005e+03]
 [-2.54779077e+03]
 [-2.01716524e+00]
 [-1.78946588e+00]
 [ 6.97209626e+00]
 [ 3.05916498e-01]
 [ 5.74316842e-02]
 [ 9.09586574e-01]
 [-2.75261627e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81056140e-18]]
[[ 1.27731237e-02  1.08004698e-02 -1.17161223e-02  4.06038726e-05
   2.62718114e-05 -7.25397040e-05]
 [ 1.08004698e-02  9.56018631e-03 -1.00986320e-02  3.24508824e-05
   2.57662767e-05 -6.25440752e-05]
 [-1.17161223e-02 -1.00986320e-02  1.13480669e-02 -3.44541476e-05
  -2.39208065e-05  7.19302029e-05]
 [ 4.06038726e-05  3.24508824e-05 -3.44541476e-05  2.07768302e-07
   9.71310645e-08 -2.18821115e-07]
 [ 2.62718114e-05  2.57662767e-05 -2.39208065e-05  9.71310645e-08
   1.49030234e-07 -1.53383658e-07]
 [-7.25397040e-05 -6.25440752e-05  7.19302029e-05 -2.18821115e-07
  -1.53383658e-07  5.07670302e-07]]
209727739.55415052
post
cubesat_nadir
Ybar_post [[-2.42809012]
 [ 0.64705881]
 [15.40076621]]
resids [[-3.65033848e-05]
 [-2.91400472e-06]
 [ 8.53883466e-03]]
posterior
[[-5.72576685e+03]
 [-3.39277261e+03]
 [-2.54781303e+03]
 [-2.01704459e+00]
 [-1.78938928e+00]
 [ 6.97198682e+00]]
[[-5.72577070e+03]
 [-3.39277204e+03]
 [-2.54781264e+03]
 [-2.01705931e+00]
 [-1.78938397e+00]
 [ 6.97198958e+00]]
[[ 5.39375530e-04  3.94346793e-04 -2.27712696e-04  1.75270472e-06
   9.44882430e-07 -1.31006929e-06]
 [ 3.94346793e-04  3.99753804e-04 -1.90588369e-04  1.21326582e-06
   1.09332494e-06 -1.09773255e-06]
 [-2.27712696e-04 -1.90588369e-04  2.06242716e-04 -6.93452439e-07
  -4.51941013e-07  1.07099938e-06]
 [ 1.75270472e-06  1.21326582e-06 -6.93452439e-07  6.83237862e-09
   2.96093760e-09 -3.96002030e-09]
 [ 9.44882430e-07  1.09332494e-06 -4.51941013e-07  2.96093760e-09
   4.27635839e-09 -2.53875313e-09]
 [-1.31006929e-06 -1.09773255e-06  1.07099938e-06 -3.96002030e-09
  -2.53875313e-09  7.02944462e-09]]
[[-2.42809042]
 [ 0.6470627 ]
 [13.24263358]]
[[-3.61971448e-05]
 [-6.79769525e-06]
 [ 2.16667146e+00]]


 Corrector Step
2018-07-13 08:30:50
[[-5.72577070e+03]
 [-3.39277204e+03]
 [-2.54781264e+03]
 [-2.01705931e+00]
 [-1.78938397e+00]
 [ 6.97198958e+00]]
[[ 5.39375530e-04  3.94346793e-04 -2.27712696e-04  1.75270472e-06
   9.44882430e-07 -1.31006929e-06]
 [ 3.94346793e-04  3.99753804e-04 -1.90588369e-04  1.21326582e-06
   1.09332494e-06 -1.09773255e-06]
 [-2.27712696e-04 -1.90588369e-04  2.06242716e-04 -6.93452439e-07
  -4.51941013e-07  1.07099938e-06]
 [ 1.75270472e-06  1.21326582e-06 -6.93452439e-07  6.83237862e-09
   2.96093760e-09 -3.96002030e-09]
 [ 9.44882430e-07  1.09332494e-06 -4.51941013e-07  2.96093760e-09
   4.27635839e-09 -2.53875313e-09]
 [-1.31006929e-06 -1.09773255e-06  1.07099938e-06 -3.96002030e-09
  -2.53875313e-09  7.02944462e-09]]
3.9032702401684465e-94
post
sphere_lamr_small
Ybar_post [[-2.42809247]
 [ 0.64706205]
 [13.2426384 ]]
resids [[-3.41504704e-05]
 [-6.14825188e-06]
 [ 2.16666665e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [209727739.55415052, 3.9032702401684465e-94]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.72579778e+03],
       [-3.39280005e+03],
       [-2.54779077e+03],
       [-2.01716524e+00],
       [-1.78946588e+00],
       [ 6.97209626e+00]]), 'est_covars': array([[ 1.27731237e-02,  1.08004698e-02, -1.17161223e-02,
         4.06038726e-05,  2.62718114e-05, -7.25397040e-05],
       [ 1.08004698e-02,  9.56018631e-03, -1.00986320e-02,
         3.24508824e-05,  2.57662767e-05, -6.25440752e-05],
       [-1.17161223e-02, -1.00986320e-02,  1.13480669e-02,
        -3.44541476e-05, -2.39208065e-05,  7.19302029e-05],
       [ 4.06038726e-05,  3.24508824e-05, -3.44541476e-05,
         2.07768302e-07,  9.71310645e-08, -2.18821115e-07],
       [ 2.62718114e-05,  2.57662767e-05, -2.39208065e-05,
         9.71310645e-08,  1.49030234e-07, -1.53383658e-07],
       [-7.25397040e-05, -6.25440752e-05,  7.19302029e-05,
        -2.18821115e-07, -1.53383658e-07,  5.07670302e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.72577070e+03],
       [-3.39277204e+03],
       [-2.54781264e+03],
       [-2.01705931e+00],
       [-1.78938397e+00],
       [ 6.97198958e+00]]), 'covar': array([[ 5.39375530e-04,  3.94346793e-04, -2.27712696e-04,
         1.75270472e-06,  9.44882430e-07, -1.31006929e-06],
       [ 3.94346793e-04,  3.99753804e-04, -1.90588369e-04,
         1.21326582e-06,  1.09332494e-06, -1.09773255e-06],
       [-2.27712696e-04, -1.90588369e-04,  2.06242716e-04,
        -6.93452439e-07, -4.51941013e-07,  1.07099938e-06],
       [ 1.75270472e-06,  1.21326582e-06, -6.93452439e-07,
         6.83237862e-09,  2.96093760e-09, -3.96002030e-09],
       [ 9.44882430e-07,  1.09332494e-06, -4.51941013e-07,
         2.96093760e-09,  4.27635839e-09, -2.53875313e-09],
       [-1.31006929e-06, -1.09773255e-06,  1.07099938e-06,
        -3.96002030e-09, -2.53875313e-09,  7.02944462e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.41504704e-05],
       [-6.14825188e-06],
       [ 2.16666665e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.72579778e+03],
       [-3.39280005e+03],
       [-2.54779077e+03],
       [-2.01716524e+00],
       [-1.78946588e+00],
       [ 6.97209626e+00],
       [ 3.05916498e-01],
       [ 5.74316842e-02],
       [ 9.09586574e-01],
       [-2.75261627e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81056140e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.27731237e-02,  1.08004698e-02, -1.17161223e-02,
         4.06038726e-05,  2.62718114e-05, -7.25397040e-05],
       [ 1.08004698e-02,  9.56018631e-03, -1.00986320e-02,
         3.24508824e-05,  2.57662767e-05, -6.25440752e-05],
       [-1.17161223e-02, -1.00986320e-02,  1.13480669e-02,
        -3.44541476e-05, -2.39208065e-05,  7.19302029e-05],
       [ 4.06038726e-05,  3.24508824e-05, -3.44541476e-05,
         2.07768302e-07,  9.71310645e-08, -2.18821115e-07],
       [ 2.62718114e-05,  2.57662767e-05, -2.39208065e-05,
         9.71310645e-08,  1.49030234e-07, -1.53383658e-07],
       [-7.25397040e-05, -6.25440752e-05,  7.19302029e-05,
        -2.18821115e-07, -1.53383658e-07,  5.07670302e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.65033848e-05],
       [-2.91400472e-06],
       [ 8.53883466e-03]])}}
Current time:  2018-07-13 08:31:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.72579778e+03],
       [-3.39280005e+03],
       [-2.54779077e+03],
       [-2.01716524e+00],
       [-1.78946588e+00],
       [ 6.97209626e+00],
       [ 3.05916498e-01],
       [ 5.74316842e-02],
       [ 9.09586574e-01],
       [-2.75261627e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81056140e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.27731237e-02,  1.08004698e-02, -1.17161223e-02,
         4.06038726e-05,  2.62718114e-05, -7.25397040e-05],
       [ 1.08004698e-02,  9.56018631e-03, -1.00986320e-02,
         3.24508824e-05,  2.57662767e-05, -6.25440752e-05],
       [-1.17161223e-02, -1.00986320e-02,  1.13480669e-02,
        -3.44541476e-05, -2.39208065e-05,  7.19302029e-05],
       [ 4.06038726e-05,  3.24508824e-05, -3.44541476e-05,
         2.07768302e-07,  9.71310645e-08, -2.18821115e-07],
       [ 2.62718114e-05,  2.57662767e-05, -2.39208065e-05,
         9.71310645e-08,  1.49030234e-07, -1.53383658e-07],
       [-7.25397040e-05, -6.25440752e-05,  7.19302029e-05,
        -2.18821115e-07, -1.53383658e-07,  5.07670302e-07]])}
[[-5.72579778e+03]
 [-3.39280005e+03]
 [-2.54779077e+03]
 [-2.01716524e+00]
 [-1.78946588e+00]
 [ 6.97209626e+00]
 [ 3.05916498e-01]
 [ 5.74316842e-02]
 [ 9.09586574e-01]
 [-2.75261627e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81056140e-18]]
2018-07-13 08:30:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:00
[[-5.74565338e+03]
 [-3.41050730e+03]
 [-2.47793036e+03]
 [-1.95396294e+00]
 [-1.75198292e+00]
 [ 6.99985717e+00]
 [ 3.10661564e-01]
 [ 5.88681285e-02]
 [ 9.07976889e-01]
 [-2.74958006e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81077369e-18]]
[[ 1.36080220e-02  1.13985632e-02 -1.28073278e-02  4.28992405e-05
   2.73063399e-05 -7.44575719e-05]
 [ 1.13985632e-02  1.00912662e-02 -1.09777107e-02  3.35660303e-05
   2.73554711e-05 -6.38446470e-05]
 [-1.28073278e-02 -1.09777107e-02  1.28350475e-02 -3.67899514e-05
  -2.55046990e-05  7.67836593e-05]
 [ 4.28992405e-05  3.35660303e-05 -3.67899514e-05  2.18802707e-07
   9.77293014e-08 -2.18863919e-07]
 [ 2.73063399e-05  2.73554711e-05 -2.55046990e-05  9.77293014e-08
   1.59249315e-07 -1.53110071e-07]
 [-7.44575719e-05 -6.38446470e-05  7.67836593e-05 -2.18863919e-07
  -1.53110071e-07  5.14553550e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.72577070e+03],
       [-3.39277204e+03],
       [-2.54781264e+03],
       [-2.01705931e+00],
       [-1.78938397e+00],
       [ 6.97198958e+00]]), 'covar': array([[ 5.39375530e-04,  3.94346793e-04, -2.27712696e-04,
         1.75270472e-06,  9.44882430e-07, -1.31006929e-06],
       [ 3.94346793e-04,  3.99753804e-04, -1.90588369e-04,
         1.21326582e-06,  1.09332494e-06, -1.09773255e-06],
       [-2.27712696e-04, -1.90588369e-04,  2.06242716e-04,
        -6.93452439e-07, -4.51941013e-07,  1.07099938e-06],
       [ 1.75270472e-06,  1.21326582e-06, -6.93452439e-07,
         6.83237862e-09,  2.96093760e-09, -3.96002030e-09],
       [ 9.44882430e-07,  1.09332494e-06, -4.51941013e-07,
         2.96093760e-09,  4.27635839e-09, -2.53875313e-09],
       [-1.31006929e-06, -1.09773255e-06,  1.07099938e-06,
        -3.96002030e-09, -2.53875313e-09,  7.02944462e-09]])}
[[-5.72577070e+03]
 [-3.39277204e+03]
 [-2.54781264e+03]
 [-2.01705931e+00]
 [-1.78938397e+00]
 [ 6.97198958e+00]]
2018-07-13 08:30:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:00
[[-5.74562521e+03]
 [-3.41047860e+03]
 [-2.47795334e+03]
 [-1.95385651e+00]
 [-1.75190078e+00]
 [ 6.99975146e+00]]
[[ 5.75318826e-04  4.16303349e-04 -2.48113522e-04  1.83061342e-06
   9.79058932e-07 -1.34043075e-06]
 [ 4.16303349e-04  4.22079562e-04 -2.06307617e-04  1.25062222e-06
   1.13925976e-06 -1.11557555e-06]
 [-2.48113522e-04 -2.06307617e-04  2.28315912e-04 -7.35948431e-07
  -4.78388737e-07  1.13668008e-06]
 [ 1.83061342e-06  1.25062222e-06 -7.35948431e-07  6.98753416e-09
   2.99523801e-09 -3.94873792e-09]
 [ 9.79058932e-07  1.13925976e-06 -4.78388737e-07  2.99523801e-09
   4.38783633e-09 -2.52703699e-09]
 [-1.34043075e-06 -1.11557555e-06  1.13668008e-06 -3.94873792e-09
  -2.52703699e-09  7.07687360e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 30, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.74562521e+03],
       [-3.41047860e+03],
       [-2.47795334e+03],
       [-1.95385651e+00],
       [-1.75190078e+00],
       [ 6.99975146e+00]]), 'covar': array([[ 5.75318826e-04,  4.16303349e-04, -2.48113522e-04,
         1.83061342e-06,  9.79058932e-07, -1.34043075e-06],
       [ 4.16303349e-04,  4.22079562e-04, -2.06307617e-04,
         1.25062222e-06,  1.13925976e-06, -1.11557555e-06],
       [-2.48113522e-04, -2.06307617e-04,  2.28315912e-04,
        -7.35948431e-07, -4.78388737e-07,  1.13668008e-06],
       [ 1.83061342e-06,  1.25062222e-06, -7.35948431e-07,
         6.98753416e-09,  2.99523801e-09, -3.94873792e-09],
       [ 9.79058932e-07,  1.13925976e-06, -4.78388737e-07,
         2.99523801e-09,  4.38783633e-09, -2.52703699e-09],
       [-1.34043075e-06, -1.11557555e-06,  1.13668008e-06,
        -3.94873792e-09, -2.52703699e-09,  7.07687360e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.41504704e-05],
       [-6.14825188e-06],
       [ 2.16666665e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 30, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.74565338e+03],
       [-3.41050730e+03],
       [-2.47793036e+03],
       [-1.95396294e+00],
       [-1.75198292e+00],
       [ 6.99985717e+00],
       [ 3.10661564e-01],
       [ 5.88681285e-02],
       [ 9.07976889e-01],
       [-2.74958006e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81077369e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.36080220e-02,  1.13985632e-02, -1.28073278e-02,
         4.28992405e-05,  2.73063399e-05, -7.44575719e-05],
       [ 1.13985632e-02,  1.00912662e-02, -1.09777107e-02,
         3.35660303e-05,  2.73554711e-05, -6.38446470e-05],
       [-1.28073278e-02, -1.09777107e-02,  1.28350475e-02,
        -3.67899514e-05, -2.55046990e-05,  7.67836593e-05],
       [ 4.28992405e-05,  3.35660303e-05, -3.67899514e-05,
         2.18802707e-07,  9.77293014e-08, -2.18863919e-07],
       [ 2.73063399e-05,  2.73554711e-05, -2.55046990e-05,
         9.77293014e-08,  1.59249315e-07, -1.53110071e-07],
       [-7.44575719e-05, -6.38446470e-05,  7.67836593e-05,
        -2.18863919e-07, -1.53110071e-07,  5.14553550e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.65033848e-05],
       [-2.91400472e-06],
       [ 8.53883466e-03]])}}
Yi [[-2.43032875]
 [ 0.66821777]
 [15.56333682]]
posterior
[[-5.74565338e+03]
 [-3.41050730e+03]
 [-2.47793036e+03]
 [-1.95396294e+00]
 [-1.75198292e+00]
 [ 6.99985717e+00]
 [ 3.10661564e-01]
 [ 5.88681285e-02]
 [ 9.07976889e-01]
 [-2.74958006e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81077369e-18]]
[[-5.74564968e+03]
 [-3.41049584e+03]
 [-2.47793294e+03]
 [-1.95396988e+00]
 [-1.75189045e+00]
 [ 6.99985717e+00]
 [ 3.10661564e-01]
 [ 5.88681285e-02]
 [ 9.07976889e-01]
 [-2.74958006e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81077369e-18]]
[[ 1.32273025e-02  1.11341048e-02 -1.26638141e-02  4.07508961e-05
   2.63491306e-05 -7.42389769e-05]
 [ 1.11341048e-02  9.81093372e-03 -1.08654612e-02  3.23754263e-05
   2.57855834e-05 -6.37185269e-05]
 [-1.26638141e-02 -1.08654612e-02  1.27792964e-02 -3.60194174e-05
  -2.50263081e-05  7.67044188e-05]
 [ 4.07508961e-05  3.23754263e-05 -3.60194174e-05  2.05737711e-07
   9.51530954e-08 -2.17550802e-07]
 [ 2.63491306e-05  2.57855834e-05 -2.50263081e-05  9.51530954e-08
   1.48367085e-07 -1.52801992e-07]
 [-7.42389769e-05 -6.37185269e-05  7.67044188e-05 -2.17550802e-07
  -1.52801992e-07  5.14419531e-07]]
[[-2.43030718]
 [ 0.66820532]
 [15.5823133 ]]
[[-2.15710521e-05]
 [ 1.24459662e-05]
 [-1.89764836e-02]]


 Corrector Step
2018-07-13 08:31:00
[[-5.74564968e+03]
 [-3.41049584e+03]
 [-2.47793294e+03]
 [-1.95396988e+00]
 [-1.75189045e+00]
 [ 6.99985717e+00]
 [ 3.10661564e-01]
 [ 5.88681285e-02]
 [ 9.07976889e-01]
 [-2.74958006e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81077369e-18]]
[[ 1.32273025e-02  1.11341048e-02 -1.26638141e-02  4.07508961e-05
   2.63491306e-05 -7.42389769e-05]
 [ 1.11341048e-02  9.81093372e-03 -1.08654612e-02  3.23754263e-05
   2.57855834e-05 -6.37185269e-05]
 [-1.26638141e-02 -1.08654612e-02  1.27792964e-02 -3.60194174e-05
  -2.50263081e-05  7.67044188e-05]
 [ 4.07508961e-05  3.23754263e-05 -3.60194174e-05  2.05737711e-07
   9.51530954e-08 -2.17550802e-07]
 [ 2.63491306e-05  2.57855834e-05 -2.50263081e-05  9.51530954e-08
   1.48367085e-07 -1.52801992e-07]
 [-7.42389769e-05 -6.37185269e-05  7.67044188e-05 -2.17550802e-07
  -1.52801992e-07  5.14419531e-07]]
561830919.8786517
post
cubesat_nadir
Ybar_post [[-2.43031139]
 [ 0.66820763]
 [15.58239503]]
resids [[-1.73635808e-05]
 [ 1.01399177e-05]
 [-1.90582168e-02]]
posterior
[[-5.74562521e+03]
 [-3.41047860e+03]
 [-2.47795334e+03]
 [-1.95385651e+00]
 [-1.75190078e+00]
 [ 6.99975146e+00]]
[[-5.74562484e+03]
 [-3.41047621e+03]
 [-2.47795327e+03]
 [-1.95385639e+00]
 [-1.75189237e+00]
 [ 6.99975121e+00]]
[[ 5.47003803e-04  3.96821293e-04 -2.45685034e-04  1.73682467e-06
   9.31207865e-07 -1.31928126e-06]
 [ 3.96821293e-04  4.02318851e-04 -2.04673877e-04  1.18951941e-06
   1.08318359e-06 -1.09995663e-06]
 [-2.45685034e-04 -2.04673877e-04  2.28107397e-04 -7.27884426e-07
  -4.74420114e-07  1.13487234e-06]
 [ 1.73682467e-06  1.18951941e-06 -7.27884426e-07  6.67502567e-09
   2.84922677e-09 -3.87925934e-09]
 [ 9.31207865e-07  1.08318359e-06 -4.74420114e-07  2.84922677e-09
   4.22263716e-09 -2.48740850e-09]
 [-1.31928126e-06 -1.09995663e-06  1.13487234e-06 -3.87925934e-09
  -2.48740850e-09  7.06089685e-09]]
[[-2.43030939]
 [ 0.66820889]
 [13.33552313]]
[[-1.93656802e-05]
 [ 8.87713808e-06]
 [ 2.22781369e+00]]


 Corrector Step
2018-07-13 08:31:00
[[-5.74562484e+03]
 [-3.41047621e+03]
 [-2.47795327e+03]
 [-1.95385639e+00]
 [-1.75189237e+00]
 [ 6.99975121e+00]]
[[ 5.47003803e-04  3.96821293e-04 -2.45685034e-04  1.73682467e-06
   9.31207865e-07 -1.31928126e-06]
 [ 3.96821293e-04  4.02318851e-04 -2.04673877e-04  1.18951941e-06
   1.08318359e-06 -1.09995663e-06]
 [-2.45685034e-04 -2.04673877e-04  2.28107397e-04 -7.27884426e-07
  -4.74420114e-07  1.13487234e-06]
 [ 1.73682467e-06  1.18951941e-06 -7.27884426e-07  6.67502567e-09
   2.84922677e-09 -3.87925934e-09]
 [ 9.31207865e-07  1.08318359e-06 -4.74420114e-07  2.84922677e-09
   4.22263716e-09 -2.48740850e-09]
 [-1.31928126e-06 -1.09995663e-06  1.13487234e-06 -3.87925934e-09
  -2.48740850e-09  7.06089685e-09]]
1.1804961615162846e-99
post
sphere_lamr_small
Ybar_post [[-2.43031049]
 [ 0.66820954]
 [13.33552363]]
resids [[-1.82648998e-05]
 [ 8.22870384e-06]
 [ 2.22781318e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [561830919.8786517, 1.1804961615162846e-99]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.74564968e+03],
       [-3.41049584e+03],
       [-2.47793294e+03],
       [-1.95396988e+00],
       [-1.75189045e+00],
       [ 6.99985717e+00]]), 'est_covars': array([[ 1.32273025e-02,  1.11341048e-02, -1.26638141e-02,
         4.07508961e-05,  2.63491306e-05, -7.42389769e-05],
       [ 1.11341048e-02,  9.81093372e-03, -1.08654612e-02,
         3.23754263e-05,  2.57855834e-05, -6.37185269e-05],
       [-1.26638141e-02, -1.08654612e-02,  1.27792964e-02,
        -3.60194174e-05, -2.50263081e-05,  7.67044188e-05],
       [ 4.07508961e-05,  3.23754263e-05, -3.60194174e-05,
         2.05737711e-07,  9.51530954e-08, -2.17550802e-07],
       [ 2.63491306e-05,  2.57855834e-05, -2.50263081e-05,
         9.51530954e-08,  1.48367085e-07, -1.52801992e-07],
       [-7.42389769e-05, -6.37185269e-05,  7.67044188e-05,
        -2.17550802e-07, -1.52801992e-07,  5.14419531e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.74562484e+03],
       [-3.41047621e+03],
       [-2.47795327e+03],
       [-1.95385639e+00],
       [-1.75189237e+00],
       [ 6.99975121e+00]]), 'covar': array([[ 5.47003803e-04,  3.96821293e-04, -2.45685034e-04,
         1.73682467e-06,  9.31207865e-07, -1.31928126e-06],
       [ 3.96821293e-04,  4.02318851e-04, -2.04673877e-04,
         1.18951941e-06,  1.08318359e-06, -1.09995663e-06],
       [-2.45685034e-04, -2.04673877e-04,  2.28107397e-04,
        -7.27884426e-07, -4.74420114e-07,  1.13487234e-06],
       [ 1.73682467e-06,  1.18951941e-06, -7.27884426e-07,
         6.67502567e-09,  2.84922677e-09, -3.87925934e-09],
       [ 9.31207865e-07,  1.08318359e-06, -4.74420114e-07,
         2.84922677e-09,  4.22263716e-09, -2.48740850e-09],
       [-1.31928126e-06, -1.09995663e-06,  1.13487234e-06,
        -3.87925934e-09, -2.48740850e-09,  7.06089685e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.82648998e-05],
       [ 8.22870384e-06],
       [ 2.22781318e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.74564968e+03],
       [-3.41049584e+03],
       [-2.47793294e+03],
       [-1.95396988e+00],
       [-1.75189045e+00],
       [ 6.99985717e+00],
       [ 3.10661564e-01],
       [ 5.88681285e-02],
       [ 9.07976889e-01],
       [-2.74958006e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81077369e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.32273025e-02,  1.11341048e-02, -1.26638141e-02,
         4.07508961e-05,  2.63491306e-05, -7.42389769e-05],
       [ 1.11341048e-02,  9.81093372e-03, -1.08654612e-02,
         3.23754263e-05,  2.57855834e-05, -6.37185269e-05],
       [-1.26638141e-02, -1.08654612e-02,  1.27792964e-02,
        -3.60194174e-05, -2.50263081e-05,  7.67044188e-05],
       [ 4.07508961e-05,  3.23754263e-05, -3.60194174e-05,
         2.05737711e-07,  9.51530954e-08, -2.17550802e-07],
       [ 2.63491306e-05,  2.57855834e-05, -2.50263081e-05,
         9.51530954e-08,  1.48367085e-07, -1.52801992e-07],
       [-7.42389769e-05, -6.37185269e-05,  7.67044188e-05,
        -2.17550802e-07, -1.52801992e-07,  5.14419531e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.73635808e-05],
       [ 1.01399177e-05],
       [-1.90582168e-02]])}}
Current time:  2018-07-13 08:31:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.74564968e+03],
       [-3.41049584e+03],
       [-2.47793294e+03],
       [-1.95396988e+00],
       [-1.75189045e+00],
       [ 6.99985717e+00],
       [ 3.10661564e-01],
       [ 5.88681285e-02],
       [ 9.07976889e-01],
       [-2.74958006e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81077369e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.32273025e-02,  1.11341048e-02, -1.26638141e-02,
         4.07508961e-05,  2.63491306e-05, -7.42389769e-05],
       [ 1.11341048e-02,  9.81093372e-03, -1.08654612e-02,
         3.23754263e-05,  2.57855834e-05, -6.37185269e-05],
       [-1.26638141e-02, -1.08654612e-02,  1.27792964e-02,
        -3.60194174e-05, -2.50263081e-05,  7.67044188e-05],
       [ 4.07508961e-05,  3.23754263e-05, -3.60194174e-05,
         2.05737711e-07,  9.51530954e-08, -2.17550802e-07],
       [ 2.63491306e-05,  2.57855834e-05, -2.50263081e-05,
         9.51530954e-08,  1.48367085e-07, -1.52801992e-07],
       [-7.42389769e-05, -6.37185269e-05,  7.67044188e-05,
        -2.17550802e-07, -1.52801992e-07,  5.14419531e-07]])}
[[-5.74564968e+03]
 [-3.41049584e+03]
 [-2.47793294e+03]
 [-1.95396988e+00]
 [-1.75189045e+00]
 [ 6.99985717e+00]
 [ 3.10661564e-01]
 [ 5.88681285e-02]
 [ 9.07976889e-01]
 [-2.74958006e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81077369e-18]]
2018-07-13 08:31:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:10
[[-5.76487235e+03]
 [-3.42782650e+03]
 [-2.40779869e+03]
 [-1.89054400e+00]
 [-1.71420954e+00]
 [ 7.02684840e+00]
 [ 3.15398161e-01]
 [ 6.03029679e-02]
 [ 9.06342451e-01]
 [-2.74646889e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81098598e-18]]
[[ 1.40648821e-02  1.17319183e-02 -1.37875144e-02  4.30321769e-05
   2.73672540e-05 -7.61328309e-05]
 [ 1.17319183e-02  1.03422351e-02 -1.17672655e-02  3.34755222e-05
   2.73706776e-05 -6.50044830e-05]
 [-1.37875144e-02 -1.17672655e-02  1.43622358e-02 -3.83549159e-05
  -2.66097591e-05  8.16025109e-05]
 [ 4.30321769e-05  3.34755222e-05 -3.83549159e-05  2.16780360e-07
   9.57600536e-08 -2.17610897e-07]
 [ 2.73672540e-05  2.73706776e-05 -2.66097591e-05  9.57600536e-08
   1.58592145e-07 -1.52537676e-07]
 [-7.61328309e-05 -6.50044830e-05  8.16025109e-05 -2.17610897e-07
  -1.52537676e-07  5.21206284e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.74562484e+03],
       [-3.41047621e+03],
       [-2.47795327e+03],
       [-1.95385639e+00],
       [-1.75189237e+00],
       [ 6.99975121e+00]]), 'covar': array([[ 5.47003803e-04,  3.96821293e-04, -2.45685034e-04,
         1.73682467e-06,  9.31207865e-07, -1.31928126e-06],
       [ 3.96821293e-04,  4.02318851e-04, -2.04673877e-04,
         1.18951941e-06,  1.08318359e-06, -1.09995663e-06],
       [-2.45685034e-04, -2.04673877e-04,  2.28107397e-04,
        -7.27884426e-07, -4.74420114e-07,  1.13487234e-06],
       [ 1.73682467e-06,  1.18951941e-06, -7.27884426e-07,
         6.67502567e-09,  2.84922677e-09, -3.87925934e-09],
       [ 9.31207865e-07,  1.08318359e-06, -4.74420114e-07,
         2.84922677e-09,  4.22263716e-09, -2.48740850e-09],
       [-1.31928126e-06, -1.09995663e-06,  1.13487234e-06,
        -3.87925934e-09, -2.48740850e-09,  7.06089685e-09]])}
[[-5.74562484e+03]
 [-3.41047621e+03]
 [-2.47795327e+03]
 [-1.95385639e+00]
 [-1.75189237e+00]
 [ 6.99975121e+00]]
2018-07-13 08:31:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:10
[[-5.76484615e+03]
 [-3.42780677e+03]
 [-2.40782017e+03]
 [-1.89043006e+00]
 [-1.71421140e+00]
 [ 7.02674356e+00]]
[[ 5.82824134e-04  4.18529013e-04 -2.66524587e-04  1.81333500e-06
   9.64280856e-07 -1.34848026e-06]
 [ 4.18529013e-04  4.24505833e-04 -2.20640119e-04  1.22589825e-06
   1.12860056e-06 -1.11711362e-06]
 [-2.66524587e-04 -2.20640119e-04  2.51460298e-04 -7.69849462e-07
  -5.00483150e-07  1.20048298e-06]
 [ 1.81333500e-06  1.22589825e-06 -7.69849462e-07  6.82970245e-09
   2.88340816e-09 -3.86839235e-09]
 [ 9.64280856e-07  1.12860056e-06 -5.00483150e-07  2.88340816e-09
   4.33405693e-09 -2.47615034e-09]
 [-1.34848026e-06 -1.11711362e-06  1.20048298e-06 -3.86839235e-09
  -2.47615034e-09  7.10789052e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.76484615e+03],
       [-3.42780677e+03],
       [-2.40782017e+03],
       [-1.89043006e+00],
       [-1.71421140e+00],
       [ 7.02674356e+00]]), 'covar': array([[ 5.82824134e-04,  4.18529013e-04, -2.66524587e-04,
         1.81333500e-06,  9.64280856e-07, -1.34848026e-06],
       [ 4.18529013e-04,  4.24505833e-04, -2.20640119e-04,
         1.22589825e-06,  1.12860056e-06, -1.11711362e-06],
       [-2.66524587e-04, -2.20640119e-04,  2.51460298e-04,
        -7.69849462e-07, -5.00483150e-07,  1.20048298e-06],
       [ 1.81333500e-06,  1.22589825e-06, -7.69849462e-07,
         6.82970245e-09,  2.88340816e-09, -3.86839235e-09],
       [ 9.64280856e-07,  1.12860056e-06, -5.00483150e-07,
         2.88340816e-09,  4.33405693e-09, -2.47615034e-09],
       [-1.34848026e-06, -1.11711362e-06,  1.20048298e-06,
        -3.86839235e-09, -2.47615034e-09,  7.10789052e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.82648998e-05],
       [ 8.22870384e-06],
       [ 2.22781318e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.76487235e+03],
       [-3.42782650e+03],
       [-2.40779869e+03],
       [-1.89054400e+00],
       [-1.71420954e+00],
       [ 7.02684840e+00],
       [ 3.15398161e-01],
       [ 6.03029679e-02],
       [ 9.06342451e-01],
       [-2.74646889e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81098598e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.40648821e-02,  1.17319183e-02, -1.37875144e-02,
         4.30321769e-05,  2.73672540e-05, -7.61328309e-05],
       [ 1.17319183e-02,  1.03422351e-02, -1.17672655e-02,
         3.34755222e-05,  2.73706776e-05, -6.50044830e-05],
       [-1.37875144e-02, -1.17672655e-02,  1.43622358e-02,
        -3.83549159e-05, -2.66097591e-05,  8.16025109e-05],
       [ 4.30321769e-05,  3.34755222e-05, -3.83549159e-05,
         2.16780360e-07,  9.57600536e-08, -2.17610897e-07],
       [ 2.73672540e-05,  2.73706776e-05, -2.66097591e-05,
         9.57600536e-08,  1.58592145e-07, -1.52537676e-07],
       [-7.61328309e-05, -6.50044830e-05,  8.16025109e-05,
        -2.17610897e-07, -1.52537676e-07,  5.21206284e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.73635808e-05],
       [ 1.01399177e-05],
       [-1.90582168e-02]])}}
Yi [[-2.43240294]
 [ 0.68836263]
 [15.57434629]]
posterior
[[-5.76487235e+03]
 [-3.42782650e+03]
 [-2.40779869e+03]
 [-1.89054400e+00]
 [-1.71420954e+00]
 [ 7.02684840e+00]
 [ 3.15398161e-01]
 [ 6.03029679e-02]
 [ 9.06342451e-01]
 [-2.74646889e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81098598e-18]]
[[-5.76485460e+03]
 [-3.42779874e+03]
 [-2.40780836e+03]
 [-1.89049421e+00]
 [-1.71402278e+00]
 [ 7.02683872e+00]
 [ 3.15398161e-01]
 [ 6.03029679e-02]
 [ 9.06342451e-01]
 [-2.74646889e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81098598e-18]]
[[ 1.36748031e-02  1.14625178e-02 -1.36295284e-02  4.08617004e-05
   2.64068213e-05 -7.58907488e-05]
 [ 1.14625178e-02  1.00578627e-02 -1.16441974e-02  3.22808077e-05
   2.57939263e-05 -6.48607979e-05]
 [-1.36295284e-02 -1.16441974e-02  1.42962465e-02 -3.75191304e-05
  -2.60911625e-05  8.15076138e-05]
 [ 4.08617004e-05  3.22808077e-05 -3.75191304e-05  2.03761367e-07
   9.32428127e-08 -2.16191859e-07]
 [ 2.64068213e-05  2.57939263e-05 -2.60911625e-05  9.32428127e-08
   1.47740426e-07 -1.52160637e-07]
 [-7.58907488e-05 -6.48607979e-05  8.15076138e-05 -2.16191859e-07
  -1.52160637e-07  5.21048791e-07]]
[[-2.43237039]
 [ 0.68832716]
 [15.76096296]]
[[-3.25486882e-05]
 [ 3.54707290e-05]
 [-1.86616674e-01]]


 Corrector Step
2018-07-13 08:31:10
[[-5.76485460e+03]
 [-3.42779874e+03]
 [-2.40780836e+03]
 [-1.89049421e+00]
 [-1.71402278e+00]
 [ 7.02683872e+00]
 [ 3.15398161e-01]
 [ 6.03029679e-02]
 [ 9.06342451e-01]
 [-2.74646889e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81098598e-18]]
[[ 1.36748031e-02  1.14625178e-02 -1.36295284e-02  4.08617004e-05
   2.64068213e-05 -7.58907488e-05]
 [ 1.14625178e-02  1.00578627e-02 -1.16441974e-02  3.22808077e-05
   2.57939263e-05 -6.48607979e-05]
 [-1.36295284e-02 -1.16441974e-02  1.42962465e-02 -3.75191304e-05
  -2.60911625e-05  8.15076138e-05]
 [ 4.08617004e-05  3.22808077e-05 -3.75191304e-05  2.03761367e-07
   9.32428127e-08 -2.16191859e-07]
 [ 2.64068213e-05  2.57939263e-05 -2.60911625e-05  9.32428127e-08
   1.47740426e-07 -1.52160637e-07]
 [-7.58907488e-05 -6.48607979e-05  8.15076138e-05 -2.16191859e-07
  -1.52160637e-07  5.21048791e-07]]
30887411.16559748
post
cubesat_nadir
Ybar_post [[-2.43237666]
 [ 0.68833357]
 [15.76108346]]
resids [[-2.62786449e-05]
 [ 2.90654189e-05]
 [-1.86737171e-01]]
posterior
[[-5.76484615e+03]
 [-3.42780677e+03]
 [-2.40782017e+03]
 [-1.89043006e+00]
 [-1.71421140e+00]
 [ 7.02674356e+00]]
[[-5.76484190e+03]
 [-3.42779956e+03]
 [-2.40782053e+03]
 [-1.89041853e+00]
 [-1.71418883e+00]
 [ 7.02674020e+00]]
[[ 5.55084765e-04  3.99749644e-04 -2.63679350e-04  1.72309896e-06
   9.19013743e-07 -1.32847761e-06]
 [ 3.99749644e-04  4.05317677e-04 -2.18698460e-04  1.16828246e-06
   1.07463919e-06 -1.10256565e-06]
 [-2.63679350e-04 -2.18698460e-04  2.51168409e-04 -7.60602215e-07
  -4.95784443e-07  1.19842883e-06]
 [ 1.72309896e-06  1.16828246e-06 -7.60602215e-07  6.53430166e-09
   2.74866252e-09 -3.80386370e-09]
 [ 9.19013743e-07  1.07463919e-06 -4.95784443e-07  2.74866252e-09
   4.17622414e-09 -2.43988476e-09]
 [-1.32847761e-06 -1.10256565e-06  1.19842883e-06 -3.80386370e-09
  -2.43988476e-09  7.09331006e-09]]
[[-2.43236899]
 [ 0.68832931]
 [13.42558384]]
[[-3.39493973e-05]
 [ 3.33249618e-05]
 [ 2.14876245e+00]]


 Corrector Step
2018-07-13 08:31:10
[[-5.76484190e+03]
 [-3.42779956e+03]
 [-2.40782053e+03]
 [-1.89041853e+00]
 [-1.71418883e+00]
 [ 7.02674020e+00]]
[[ 5.55084765e-04  3.99749644e-04 -2.63679350e-04  1.72309896e-06
   9.19013743e-07 -1.32847761e-06]
 [ 3.99749644e-04  4.05317677e-04 -2.18698460e-04  1.16828246e-06
   1.07463919e-06 -1.10256565e-06]
 [-2.63679350e-04 -2.18698460e-04  2.51168409e-04 -7.60602215e-07
  -4.95784443e-07  1.19842883e-06]
 [ 1.72309896e-06  1.16828246e-06 -7.60602215e-07  6.53430166e-09
   2.74866252e-09 -3.80386370e-09]
 [ 9.19013743e-07  1.07463919e-06 -4.95784443e-07  2.74866252e-09
   4.17622414e-09 -2.43988476e-09]
 [-1.32847761e-06 -1.10256565e-06  1.19842883e-06 -3.80386370e-09
  -2.43988476e-09  7.09331006e-09]]
9.105456478864952e-93
post
sphere_lamr_small
Ybar_post [[-2.43237081]
 [ 0.68833173]
 [13.42558097]]
resids [[-3.21335391e-05]
 [ 3.09081486e-05]
 [ 2.14876532e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [30887411.16559748, 9.105456478864952e-93]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.76485460e+03],
       [-3.42779874e+03],
       [-2.40780836e+03],
       [-1.89049421e+00],
       [-1.71402278e+00],
       [ 7.02683872e+00]]), 'est_covars': array([[ 1.36748031e-02,  1.14625178e-02, -1.36295284e-02,
         4.08617004e-05,  2.64068213e-05, -7.58907488e-05],
       [ 1.14625178e-02,  1.00578627e-02, -1.16441974e-02,
         3.22808077e-05,  2.57939263e-05, -6.48607979e-05],
       [-1.36295284e-02, -1.16441974e-02,  1.42962465e-02,
        -3.75191304e-05, -2.60911625e-05,  8.15076138e-05],
       [ 4.08617004e-05,  3.22808077e-05, -3.75191304e-05,
         2.03761367e-07,  9.32428127e-08, -2.16191859e-07],
       [ 2.64068213e-05,  2.57939263e-05, -2.60911625e-05,
         9.32428127e-08,  1.47740426e-07, -1.52160637e-07],
       [-7.58907488e-05, -6.48607979e-05,  8.15076138e-05,
        -2.16191859e-07, -1.52160637e-07,  5.21048791e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.76484190e+03],
       [-3.42779956e+03],
       [-2.40782053e+03],
       [-1.89041853e+00],
       [-1.71418883e+00],
       [ 7.02674020e+00]]), 'covar': array([[ 5.55084765e-04,  3.99749644e-04, -2.63679350e-04,
         1.72309896e-06,  9.19013743e-07, -1.32847761e-06],
       [ 3.99749644e-04,  4.05317677e-04, -2.18698460e-04,
         1.16828246e-06,  1.07463919e-06, -1.10256565e-06],
       [-2.63679350e-04, -2.18698460e-04,  2.51168409e-04,
        -7.60602215e-07, -4.95784443e-07,  1.19842883e-06],
       [ 1.72309896e-06,  1.16828246e-06, -7.60602215e-07,
         6.53430166e-09,  2.74866252e-09, -3.80386370e-09],
       [ 9.19013743e-07,  1.07463919e-06, -4.95784443e-07,
         2.74866252e-09,  4.17622414e-09, -2.43988476e-09],
       [-1.32847761e-06, -1.10256565e-06,  1.19842883e-06,
        -3.80386370e-09, -2.43988476e-09,  7.09331006e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.21335391e-05],
       [ 3.09081486e-05],
       [ 2.14876532e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.76485460e+03],
       [-3.42779874e+03],
       [-2.40780836e+03],
       [-1.89049421e+00],
       [-1.71402278e+00],
       [ 7.02683872e+00],
       [ 3.15398161e-01],
       [ 6.03029679e-02],
       [ 9.06342451e-01],
       [-2.74646889e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81098598e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.36748031e-02,  1.14625178e-02, -1.36295284e-02,
         4.08617004e-05,  2.64068213e-05, -7.58907488e-05],
       [ 1.14625178e-02,  1.00578627e-02, -1.16441974e-02,
         3.22808077e-05,  2.57939263e-05, -6.48607979e-05],
       [-1.36295284e-02, -1.16441974e-02,  1.42962465e-02,
        -3.75191304e-05, -2.60911625e-05,  8.15076138e-05],
       [ 4.08617004e-05,  3.22808077e-05, -3.75191304e-05,
         2.03761367e-07,  9.32428127e-08, -2.16191859e-07],
       [ 2.64068213e-05,  2.57939263e-05, -2.60911625e-05,
         9.32428127e-08,  1.47740426e-07, -1.52160637e-07],
       [-7.58907488e-05, -6.48607979e-05,  8.15076138e-05,
        -2.16191859e-07, -1.52160637e-07,  5.21048791e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.62786449e-05],
       [ 2.90654189e-05],
       [-1.86737171e-01]])}}
Current time:  2018-07-13 08:31:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.76485460e+03],
       [-3.42779874e+03],
       [-2.40780836e+03],
       [-1.89049421e+00],
       [-1.71402278e+00],
       [ 7.02683872e+00],
       [ 3.15398161e-01],
       [ 6.03029679e-02],
       [ 9.06342451e-01],
       [-2.74646889e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81098598e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.36748031e-02,  1.14625178e-02, -1.36295284e-02,
         4.08617004e-05,  2.64068213e-05, -7.58907488e-05],
       [ 1.14625178e-02,  1.00578627e-02, -1.16441974e-02,
         3.22808077e-05,  2.57939263e-05, -6.48607979e-05],
       [-1.36295284e-02, -1.16441974e-02,  1.42962465e-02,
        -3.75191304e-05, -2.60911625e-05,  8.15076138e-05],
       [ 4.08617004e-05,  3.22808077e-05, -3.75191304e-05,
         2.03761367e-07,  9.32428127e-08, -2.16191859e-07],
       [ 2.64068213e-05,  2.57939263e-05, -2.60911625e-05,
         9.32428127e-08,  1.47740426e-07, -1.52160637e-07],
       [-7.58907488e-05, -6.48607979e-05,  8.15076138e-05,
        -2.16191859e-07, -1.52160637e-07,  5.21048791e-07]])}
[[-5.76485460e+03]
 [-3.42779874e+03]
 [-2.40780836e+03]
 [-1.89049421e+00]
 [-1.71402278e+00]
 [ 7.02683872e+00]
 [ 3.15398161e-01]
 [ 6.03029679e-02]
 [ 9.06342451e-01]
 [-2.74646889e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81098598e-18]]
2018-07-13 08:31:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:20
[[-5.78344121e+03]
 [-3.44474942e+03]
 [-2.33740814e+03]
 [-1.82685128e+00]
 [-1.67614799e+00]
 [ 7.05305790e+00]
 [ 3.20126160e-01]
 [ 6.17361633e-02]
 [ 9.04683304e-01]
 [-2.74328284e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81119826e-18]]
[[ 1.45146403e-02  1.20600998e-02 -1.47845526e-02  4.31298808e-05
   2.74094832e-05 -7.77595487e-05]
 [ 1.20600998e-02  1.05896770e-02 -1.25678726e-02  3.33669641e-05
   2.73755558e-05 -6.61315539e-05]
 [-1.47845526e-02 -1.25678726e-02  1.59756967e-02 -3.98541181e-05
  -2.76740154e-05  8.64486983e-05]
 [ 4.31298808e-05  3.33669641e-05 -3.98541181e-05  2.14813511e-07
   9.38593193e-08 -2.16271560e-07]
 [ 2.74094832e-05  2.73755558e-05 -2.76740154e-05  9.38593193e-08
   1.57972031e-07 -1.51906939e-07]
 [-7.77595487e-05 -6.61315539e-05  8.64486983e-05 -2.16271560e-07
  -1.51906939e-07  5.27739167e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.76484190e+03],
       [-3.42779956e+03],
       [-2.40782053e+03],
       [-1.89041853e+00],
       [-1.71418883e+00],
       [ 7.02674020e+00]]), 'covar': array([[ 5.55084765e-04,  3.99749644e-04, -2.63679350e-04,
         1.72309896e-06,  9.19013743e-07, -1.32847761e-06],
       [ 3.99749644e-04,  4.05317677e-04, -2.18698460e-04,
         1.16828246e-06,  1.07463919e-06, -1.10256565e-06],
       [-2.63679350e-04, -2.18698460e-04,  2.51168409e-04,
        -7.60602215e-07, -4.95784443e-07,  1.19842883e-06],
       [ 1.72309896e-06,  1.16828246e-06, -7.60602215e-07,
         6.53430166e-09,  2.74866252e-09, -3.80386370e-09],
       [ 9.19013743e-07,  1.07463919e-06, -4.95784443e-07,
         2.74866252e-09,  4.17622414e-09, -2.43988476e-09],
       [-1.32847761e-06, -1.10256565e-06,  1.19842883e-06,
        -3.80386370e-09, -2.43988476e-09,  7.09331006e-09]])}
[[-5.76484190e+03]
 [-3.42779956e+03]
 [-2.40782053e+03]
 [-1.89041853e+00]
 [-1.71418883e+00]
 [ 7.02674020e+00]]
2018-07-13 08:31:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:20
[[-5.78342798e+03]
 [-3.44475214e+03]
 [-2.33742132e+03]
 [-1.82677569e+00]
 [-1.67631394e+00]
 [ 7.05295911e+00]]
[[ 5.90310953e-04  4.20981676e-04 -2.84898179e-04  1.79817006e-06
   9.51248057e-07 -1.35719126e-06]
 [ 4.20981676e-04  4.27285435e-04 -2.34866243e-04  1.20366430e-06
   1.11967564e-06 -1.11942094e-06]
 [-2.84898179e-04 -2.34866243e-04  2.75820189e-04 -8.02097256e-07
  -5.21499048e-07  1.26391498e-06]
 [ 1.79817006e-06  1.20366430e-06 -8.02097256e-07  6.68857248e-09
   2.78289192e-09 -3.79368987e-09]
 [ 9.51248057e-07  1.11967564e-06 -5.21499048e-07  2.78289192e-09
   4.28765585e-09 -2.42903697e-09]
 [-1.35719126e-06 -1.11942094e-06  1.26391498e-06 -3.79368987e-09
  -2.42903697e-09  7.13948647e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.78342798e+03],
       [-3.44475214e+03],
       [-2.33742132e+03],
       [-1.82677569e+00],
       [-1.67631394e+00],
       [ 7.05295911e+00]]), 'covar': array([[ 5.90310953e-04,  4.20981676e-04, -2.84898179e-04,
         1.79817006e-06,  9.51248057e-07, -1.35719126e-06],
       [ 4.20981676e-04,  4.27285435e-04, -2.34866243e-04,
         1.20366430e-06,  1.11967564e-06, -1.11942094e-06],
       [-2.84898179e-04, -2.34866243e-04,  2.75820189e-04,
        -8.02097256e-07, -5.21499048e-07,  1.26391498e-06],
       [ 1.79817006e-06,  1.20366430e-06, -8.02097256e-07,
         6.68857248e-09,  2.78289192e-09, -3.79368987e-09],
       [ 9.51248057e-07,  1.11967564e-06, -5.21499048e-07,
         2.78289192e-09,  4.28765585e-09, -2.42903697e-09],
       [-1.35719126e-06, -1.11942094e-06,  1.26391498e-06,
        -3.79368987e-09, -2.42903697e-09,  7.13948647e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.21335391e-05],
       [ 3.09081486e-05],
       [ 2.14876532e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.78344121e+03],
       [-3.44474942e+03],
       [-2.33740814e+03],
       [-1.82685128e+00],
       [-1.67614799e+00],
       [ 7.05305790e+00],
       [ 3.20126160e-01],
       [ 6.17361633e-02],
       [ 9.04683304e-01],
       [-2.74328284e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81119826e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.45146403e-02,  1.20600998e-02, -1.47845526e-02,
         4.31298808e-05,  2.74094832e-05, -7.77595487e-05],
       [ 1.20600998e-02,  1.05896770e-02, -1.25678726e-02,
         3.33669641e-05,  2.73755558e-05, -6.61315539e-05],
       [-1.47845526e-02, -1.25678726e-02,  1.59756967e-02,
        -3.98541181e-05, -2.76740154e-05,  8.64486983e-05],
       [ 4.31298808e-05,  3.33669641e-05, -3.98541181e-05,
         2.14813511e-07,  9.38593193e-08, -2.16271560e-07],
       [ 2.74094832e-05,  2.73755558e-05, -2.76740154e-05,
         9.38593193e-08,  1.57972031e-07, -1.51906939e-07],
       [-7.77595487e-05, -6.61315539e-05,  8.64486983e-05,
        -2.16271560e-07, -1.51906939e-07,  5.27739167e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.62786449e-05],
       [ 2.90654189e-05],
       [-1.86737171e-01]])}}
Yi [[-2.43431058]
 [ 0.70751793]
 [15.99720245]]
posterior
[[-5.78344121e+03]
 [-3.44474942e+03]
 [-2.33740814e+03]
 [-1.82685128e+00]
 [-1.67614799e+00]
 [ 7.05305790e+00]
 [ 3.20126160e-01]
 [ 6.17361633e-02]
 [ 9.04683304e-01]
 [-2.74328284e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81119826e-18]]
[[-5.78344619e+03]
 [-3.44474501e+03]
 [-2.33740709e+03]
 [-1.82690229e+00]
 [-1.67608756e+00]
 [ 7.05306363e+00]
 [ 3.20126160e-01]
 [ 6.17361633e-02]
 [ 9.04683304e-01]
 [-2.74328284e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81119826e-18]]
[[ 1.41148286e-02  1.17852753e-02 -1.46117444e-02  4.09364825e-05
   2.64443626e-05 -7.74936617e-05]
 [ 1.17852753e-02  1.03007333e-02 -1.24337595e-02  3.21665394e-05
   2.57902675e-05 -6.59700627e-05]
 [-1.46117444e-02 -1.24337595e-02  1.58986334e-02 -3.89532468e-05
  -2.71156895e-05  8.63368428e-05]
 [ 4.09364825e-05  3.21665394e-05 -3.89532468e-05  2.01836127e-07
   9.13961529e-08 -2.14748237e-07]
 [ 2.64443626e-05  2.57902675e-05 -2.71156895e-05  9.13961529e-08
   1.47146280e-07 -1.51461804e-07]
 [-7.74936617e-05 -6.59700627e-05  8.63368428e-05 -2.14748237e-07
  -1.51461804e-07  5.27556206e-07]]
[[-2.4342885 ]
 [ 0.70751739]
 [15.93682194]]
[[-2.20772225e-05]
 [ 5.43214860e-07]
 [ 6.03805149e-02]]


 Corrector Step
2018-07-13 08:31:20
[[-5.78344619e+03]
 [-3.44474501e+03]
 [-2.33740709e+03]
 [-1.82690229e+00]
 [-1.67608756e+00]
 [ 7.05306363e+00]
 [ 3.20126160e-01]
 [ 6.17361633e-02]
 [ 9.04683304e-01]
 [-2.74328284e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81119826e-18]]
[[ 1.41148286e-02  1.17852753e-02 -1.46117444e-02  4.09364825e-05
   2.64443626e-05 -7.74936617e-05]
 [ 1.17852753e-02  1.03007333e-02 -1.24337595e-02  3.21665394e-05
   2.57902675e-05 -6.59700627e-05]
 [-1.46117444e-02 -1.24337595e-02  1.58986334e-02 -3.89532468e-05
  -2.71156895e-05  8.63368428e-05]
 [ 4.09364825e-05  3.21665394e-05 -3.89532468e-05  2.01836127e-07
   9.13961529e-08 -2.14748237e-07]
 [ 2.64443626e-05  2.57902675e-05 -2.71156895e-05  9.13961529e-08
   1.47146280e-07 -1.51461804e-07]
 [-7.74936617e-05 -6.59700627e-05  8.63368428e-05 -2.14748237e-07
  -1.51461804e-07  5.27556206e-07]]
525253071.203334
post
cubesat_nadir
Ybar_post [[-2.4342928 ]
 [ 0.70751748]
 [15.93691793]]
resids [[-1.77825372e-05]
 [ 4.44015221e-07]
 [ 6.02845272e-02]]
posterior
[[-5.78342798e+03]
 [-3.44475214e+03]
 [-2.33742132e+03]
 [-1.82677569e+00]
 [-1.67631394e+00]
 [ 7.05295911e+00]]
[[-5.78342952e+03]
 [-3.44475025e+03]
 [-2.33742107e+03]
 [-1.82678212e+00]
 [-1.67630594e+00]
 [ 7.05296020e+00]]
[[ 5.63113989e-04  4.02847917e-04 -2.81681087e-04  1.71115043e-06
   9.08298297e-07 -1.33818047e-06]
 [ 4.02847917e-04  4.08599962e-04 -2.32656324e-04  1.14916967e-06
   1.06755764e-06 -1.10579878e-06]
 [-2.81681087e-04 -2.32656324e-04  2.75438989e-04 -7.91838534e-07
  -5.16187496e-07  1.26165683e-06]
 [ 1.71115043e-06  1.14916967e-06 -7.91838534e-07  6.40825818e-09
   2.65802523e-09 -3.73336897e-09]
 [ 9.08298297e-07  1.06755764e-06 -5.16187496e-07  2.65802523e-09
   4.13622280e-09 -2.39564451e-09]
 [-1.33818047e-06 -1.10579878e-06  1.26165683e-06 -3.73336897e-09
  -2.39564451e-09  7.12606167e-09]]
[[-2.43428156]
 [ 0.70751511]
 [13.5129385 ]]
[[-2.90211636e-05]
 [ 2.82309252e-06]
 [ 2.48426395e+00]]


 Corrector Step
2018-07-13 08:31:20
[[-5.78342952e+03]
 [-3.44475025e+03]
 [-2.33742107e+03]
 [-1.82678212e+00]
 [-1.67630594e+00]
 [ 7.05296020e+00]]
[[ 5.63113989e-04  4.02847917e-04 -2.81681087e-04  1.71115043e-06
   9.08298297e-07 -1.33818047e-06]
 [ 4.02847917e-04  4.08599962e-04 -2.32656324e-04  1.14916967e-06
   1.06755764e-06 -1.10579878e-06]
 [-2.81681087e-04 -2.32656324e-04  2.75438989e-04 -7.91838534e-07
  -5.16187496e-07  1.26165683e-06]
 [ 1.71115043e-06  1.14916967e-06 -7.91838534e-07  6.40825818e-09
   2.65802523e-09 -3.73336897e-09]
 [ 9.08298297e-07  1.06755764e-06 -5.16187496e-07  2.65802523e-09
   4.13622280e-09 -2.39564451e-09]
 [-1.33818047e-06 -1.10579878e-06  1.26165683e-06 -3.73336897e-09
  -2.39564451e-09  7.12606167e-09]]
4.945146453830914e-126
post
sphere_lamr_small
Ybar_post [[-2.43428319]
 [ 0.70751522]
 [13.51294114]]
resids [[-2.73876206e-05]
 [ 2.70825617e-06]
 [ 2.48426131e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [525253071.203334, 4.945146453830914e-126]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.78344619e+03],
       [-3.44474501e+03],
       [-2.33740709e+03],
       [-1.82690229e+00],
       [-1.67608756e+00],
       [ 7.05306363e+00]]), 'est_covars': array([[ 1.41148286e-02,  1.17852753e-02, -1.46117444e-02,
         4.09364825e-05,  2.64443626e-05, -7.74936617e-05],
       [ 1.17852753e-02,  1.03007333e-02, -1.24337595e-02,
         3.21665394e-05,  2.57902675e-05, -6.59700627e-05],
       [-1.46117444e-02, -1.24337595e-02,  1.58986334e-02,
        -3.89532468e-05, -2.71156895e-05,  8.63368428e-05],
       [ 4.09364825e-05,  3.21665394e-05, -3.89532468e-05,
         2.01836127e-07,  9.13961529e-08, -2.14748237e-07],
       [ 2.64443626e-05,  2.57902675e-05, -2.71156895e-05,
         9.13961529e-08,  1.47146280e-07, -1.51461804e-07],
       [-7.74936617e-05, -6.59700627e-05,  8.63368428e-05,
        -2.14748237e-07, -1.51461804e-07,  5.27556206e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.78342952e+03],
       [-3.44475025e+03],
       [-2.33742107e+03],
       [-1.82678212e+00],
       [-1.67630594e+00],
       [ 7.05296020e+00]]), 'covar': array([[ 5.63113989e-04,  4.02847917e-04, -2.81681087e-04,
         1.71115043e-06,  9.08298297e-07, -1.33818047e-06],
       [ 4.02847917e-04,  4.08599962e-04, -2.32656324e-04,
         1.14916967e-06,  1.06755764e-06, -1.10579878e-06],
       [-2.81681087e-04, -2.32656324e-04,  2.75438989e-04,
        -7.91838534e-07, -5.16187496e-07,  1.26165683e-06],
       [ 1.71115043e-06,  1.14916967e-06, -7.91838534e-07,
         6.40825818e-09,  2.65802523e-09, -3.73336897e-09],
       [ 9.08298297e-07,  1.06755764e-06, -5.16187496e-07,
         2.65802523e-09,  4.13622280e-09, -2.39564451e-09],
       [-1.33818047e-06, -1.10579878e-06,  1.26165683e-06,
        -3.73336897e-09, -2.39564451e-09,  7.12606167e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.73876206e-05],
       [ 2.70825617e-06],
       [ 2.48426131e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.78344619e+03],
       [-3.44474501e+03],
       [-2.33740709e+03],
       [-1.82690229e+00],
       [-1.67608756e+00],
       [ 7.05306363e+00],
       [ 3.20126160e-01],
       [ 6.17361633e-02],
       [ 9.04683304e-01],
       [-2.74328284e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81119826e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.41148286e-02,  1.17852753e-02, -1.46117444e-02,
         4.09364825e-05,  2.64443626e-05, -7.74936617e-05],
       [ 1.17852753e-02,  1.03007333e-02, -1.24337595e-02,
         3.21665394e-05,  2.57902675e-05, -6.59700627e-05],
       [-1.46117444e-02, -1.24337595e-02,  1.58986334e-02,
        -3.89532468e-05, -2.71156895e-05,  8.63368428e-05],
       [ 4.09364825e-05,  3.21665394e-05, -3.89532468e-05,
         2.01836127e-07,  9.13961529e-08, -2.14748237e-07],
       [ 2.64443626e-05,  2.57902675e-05, -2.71156895e-05,
         9.13961529e-08,  1.47146280e-07, -1.51461804e-07],
       [-7.74936617e-05, -6.59700627e-05,  8.63368428e-05,
        -2.14748237e-07, -1.51461804e-07,  5.27556206e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.77825372e-05],
       [ 4.44015221e-07],
       [ 6.02845272e-02]])}}
Current time:  2018-07-13 08:31:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.78344619e+03],
       [-3.44474501e+03],
       [-2.33740709e+03],
       [-1.82690229e+00],
       [-1.67608756e+00],
       [ 7.05306363e+00],
       [ 3.20126160e-01],
       [ 6.17361633e-02],
       [ 9.04683304e-01],
       [-2.74328284e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81119826e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.41148286e-02,  1.17852753e-02, -1.46117444e-02,
         4.09364825e-05,  2.64443626e-05, -7.74936617e-05],
       [ 1.17852753e-02,  1.03007333e-02, -1.24337595e-02,
         3.21665394e-05,  2.57902675e-05, -6.59700627e-05],
       [-1.46117444e-02, -1.24337595e-02,  1.58986334e-02,
        -3.89532468e-05, -2.71156895e-05,  8.63368428e-05],
       [ 4.09364825e-05,  3.21665394e-05, -3.89532468e-05,
         2.01836127e-07,  9.13961529e-08, -2.14748237e-07],
       [ 2.64443626e-05,  2.57902675e-05, -2.71156895e-05,
         9.13961529e-08,  1.47146280e-07, -1.51461804e-07],
       [-7.74936617e-05, -6.59700627e-05,  8.63368428e-05,
        -2.14748237e-07, -1.51461804e-07,  5.27556206e-07]])}
[[-5.78344619e+03]
 [-3.44474501e+03]
 [-2.33740709e+03]
 [-1.82690229e+00]
 [-1.67608756e+00]
 [ 7.05306363e+00]
 [ 3.20126160e-01]
 [ 6.17361633e-02]
 [ 9.04683304e-01]
 [-2.74328284e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81119826e-18]]
2018-07-13 08:31:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:30
[[-5.80139588e+03]
 [-3.46131571e+03]
 [-2.26674861e+03]
 [-1.76304984e+00]
 [-1.63802322e+00]
 [ 7.07850670e+00]
 [ 3.24845431e-01]
 [ 6.31676757e-02]
 [ 9.02999493e-01]
 [-2.74002201e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81141055e-18]]
[[ 1.49560602e-02  1.23816967e-02 -1.57971110e-02  4.31923085e-05
   2.74323664e-05 -7.93368159e-05]
 [ 1.23816967e-02  1.08320645e-02 -1.33788156e-02  3.32395044e-05
   2.73688067e-05 -6.72254557e-05]
 [-1.57971110e-02 -1.33788156e-02  1.76750420e-02 -4.12876501e-05
  -2.86978761e-05  9.13187651e-05]
 [ 4.31923085e-05  3.32395044e-05 -4.12876501e-05  2.12898807e-07
   9.20229116e-08 -2.14850043e-07]
 [ 2.74323664e-05  2.73688067e-05 -2.86978761e-05  9.20229116e-08
   1.57384930e-07 -1.51220351e-07]
 [-7.93368159e-05 -6.72254557e-05  9.13187651e-05 -2.14850043e-07
  -1.51220351e-07  5.34151230e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.78342952e+03],
       [-3.44475025e+03],
       [-2.33742107e+03],
       [-1.82678212e+00],
       [-1.67630594e+00],
       [ 7.05296020e+00]]), 'covar': array([[ 5.63113989e-04,  4.02847917e-04, -2.81681087e-04,
         1.71115043e-06,  9.08298297e-07, -1.33818047e-06],
       [ 4.02847917e-04,  4.08599962e-04, -2.32656324e-04,
         1.14916967e-06,  1.06755764e-06, -1.10579878e-06],
       [-2.81681087e-04, -2.32656324e-04,  2.75438989e-04,
        -7.91838534e-07, -5.16187496e-07,  1.26165683e-06],
       [ 1.71115043e-06,  1.14916967e-06, -7.91838534e-07,
         6.40825818e-09,  2.65802523e-09, -3.73336897e-09],
       [ 9.08298297e-07,  1.06755764e-06, -5.16187496e-07,
         2.65802523e-09,  4.13622280e-09, -2.39564451e-09],
       [-1.33818047e-06, -1.10579878e-06,  1.26165683e-06,
        -3.73336897e-09, -2.39564451e-09,  7.12606167e-09]])}
[[-5.78342952e+03]
 [-3.44475025e+03]
 [-2.33742107e+03]
 [-1.82678212e+00]
 [-1.67630594e+00]
 [ 7.05296020e+00]]
2018-07-13 08:31:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:30
[[-5.80137821e+03]
 [-3.46132311e+03]
 [-2.26676362e+03]
 [-1.76292968e+00]
 [-1.63824137e+00]
 [ 7.07840290e+00]]
[[ 5.98081648e-04  4.23756342e-04 -3.03329130e-04  1.78512212e-06
   9.39762536e-07 -1.36610015e-06]
 [ 4.23756342e-04  4.30397269e-04 -2.49086479e-04  1.18375956e-06
   1.11225060e-06 -1.12212262e-06]
 [-3.03329130e-04 -2.49086479e-04  3.01327103e-04 -8.32915631e-07
  -5.41623579e-07  1.32717546e-06]
 [ 1.78512212e-06  1.18375956e-06 -8.32915631e-07  6.56233075e-09
   2.69236187e-09 -3.72379236e-09]
 [ 9.39762536e-07  1.11225060e-06 -5.41623579e-07  2.69236187e-09
   4.24773122e-09 -2.38527941e-09]
 [-1.36610015e-06 -1.12212262e-06  1.32717546e-06 -3.72379236e-09
  -2.38527941e-09  7.17161553e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.80137821e+03],
       [-3.46132311e+03],
       [-2.26676362e+03],
       [-1.76292968e+00],
       [-1.63824137e+00],
       [ 7.07840290e+00]]), 'covar': array([[ 5.98081648e-04,  4.23756342e-04, -3.03329130e-04,
         1.78512212e-06,  9.39762536e-07, -1.36610015e-06],
       [ 4.23756342e-04,  4.30397269e-04, -2.49086479e-04,
         1.18375956e-06,  1.11225060e-06, -1.12212262e-06],
       [-3.03329130e-04, -2.49086479e-04,  3.01327103e-04,
        -8.32915631e-07, -5.41623579e-07,  1.32717546e-06],
       [ 1.78512212e-06,  1.18375956e-06, -8.32915631e-07,
         6.56233075e-09,  2.69236187e-09, -3.72379236e-09],
       [ 9.39762536e-07,  1.11225060e-06, -5.41623579e-07,
         2.69236187e-09,  4.24773122e-09, -2.38527941e-09],
       [-1.36610015e-06, -1.12212262e-06,  1.32717546e-06,
        -3.72379236e-09, -2.38527941e-09,  7.17161553e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.73876206e-05],
       [ 2.70825617e-06],
       [ 2.48426131e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.80139588e+03],
       [-3.46131571e+03],
       [-2.26674861e+03],
       [-1.76304984e+00],
       [-1.63802322e+00],
       [ 7.07850670e+00],
       [ 3.24845431e-01],
       [ 6.31676757e-02],
       [ 9.02999493e-01],
       [-2.74002201e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81141055e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.49560602e-02,  1.23816967e-02, -1.57971110e-02,
         4.31923085e-05,  2.74323664e-05, -7.93368159e-05],
       [ 1.23816967e-02,  1.08320645e-02, -1.33788156e-02,
         3.32395044e-05,  2.73688067e-05, -6.72254557e-05],
       [-1.57971110e-02, -1.33788156e-02,  1.76750420e-02,
        -4.12876501e-05, -2.86978761e-05,  9.13187651e-05],
       [ 4.31923085e-05,  3.32395044e-05, -4.12876501e-05,
         2.12898807e-07,  9.20229116e-08, -2.14850043e-07],
       [ 2.74323664e-05,  2.73688067e-05, -2.86978761e-05,
         9.20229116e-08,  1.57384930e-07, -1.51220351e-07],
       [-7.93368159e-05, -6.72254557e-05,  9.13187651e-05,
        -2.14850043e-07, -1.51220351e-07,  5.34151230e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.77825372e-05],
       [ 4.44015221e-07],
       [ 6.02845272e-02]])}}
Yi [[-2.43605377]
 [ 0.72579564]
 [15.95956942]]
posterior
[[-5.80139588e+03]
 [-3.46131571e+03]
 [-2.26674861e+03]
 [-1.76304984e+00]
 [-1.63802322e+00]
 [ 7.07850670e+00]
 [ 3.24845431e-01]
 [ 6.31676757e-02]
 [ 9.02999493e-01]
 [-2.74002201e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81141055e-18]]
[[-5.80142853e+03]
 [-3.46134863e+03]
 [-2.26673212e+03]
 [-1.76319513e+00]
 [-1.63819813e+00]
 [ 7.07852588e+00]
 [ 3.24845431e-01]
 [ 6.31676757e-02]
 [ 9.02999493e-01]
 [-2.74002201e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81141055e-18]]
[[ 1.45465757e-02  1.21015938e-02 -1.56092373e-02  4.09763292e-05
   2.64630654e-05 -7.90472025e-05]
 [ 1.21015938e-02  1.05387702e-02 -1.32335820e-02  3.20335866e-05
   2.57756808e-05 -6.70464241e-05]
 [-1.56092373e-02 -1.32335820e-02  1.75860707e-02 -4.03219899e-05
  -2.81003051e-05  9.11888282e-05]
 [ 4.09763292e-05  3.20335866e-05 -4.03219899e-05  1.99962064e-07
   8.96114260e-08 -2.13225350e-07]
 [ 2.64630654e-05  2.57756808e-05 -2.81003051e-05  8.96114260e-08
   1.46583645e-07 -1.50709893e-07]
 [-7.90472025e-05 -6.70464241e-05  9.11888282e-05 -2.13225350e-07
  -1.50709893e-07  5.33941231e-07]]
[[-2.43606654]
 [ 0.72584587]
 [16.10996246]]
[[ 1.27718522e-05]
 [-5.02328013e-05]
 [-1.50393043e-01]]


 Corrector Step
2018-07-13 08:31:30
[[-5.80142853e+03]
 [-3.46134863e+03]
 [-2.26673212e+03]
 [-1.76319513e+00]
 [-1.63819813e+00]
 [ 7.07852588e+00]
 [ 3.24845431e-01]
 [ 6.31676757e-02]
 [ 9.02999493e-01]
 [-2.74002201e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81141055e-18]]
[[ 1.45465757e-02  1.21015938e-02 -1.56092373e-02  4.09763292e-05
   2.64630654e-05 -7.90472025e-05]
 [ 1.21015938e-02  1.05387702e-02 -1.32335820e-02  3.20335866e-05
   2.57756808e-05 -6.70464241e-05]
 [-1.56092373e-02 -1.32335820e-02  1.75860707e-02 -4.03219899e-05
  -2.81003051e-05  9.11888282e-05]
 [ 4.09763292e-05  3.20335866e-05 -4.03219899e-05  1.99962064e-07
   8.96114260e-08 -2.13225350e-07]
 [ 2.64630654e-05  2.57756808e-05 -2.81003051e-05  8.96114260e-08
   1.46583645e-07 -1.50709893e-07]
 [-7.90472025e-05 -6.70464241e-05  9.11888282e-05 -2.13225350e-07
  -1.50709893e-07  5.33941231e-07]]
43284522.22838343
post
cubesat_nadir
Ybar_post [[-2.43606417]
 [ 0.72583712]
 [16.10992086]]
resids [[ 1.03987698e-05]
 [-4.14813651e-05]
 [-1.50351442e-01]]
posterior
[[-5.80137821e+03]
 [-3.46132311e+03]
 [-2.26676362e+03]
 [-1.76292968e+00]
 [-1.63824137e+00]
 [ 7.07840290e+00]]
[[-5.80138750e+03]
 [-3.46133101e+03]
 [-2.26676225e+03]
 [-1.76295797e+00]
 [-1.63826187e+00]
 [ 7.07840985e+00]]
[[ 5.71358760e-04  4.06204655e-04 -2.99766038e-04  1.70094418e-06
   8.98886184e-07 -1.34797204e-06]
 [ 4.06204655e-04  4.12154443e-04 -2.46632113e-04  1.13204338e-06
   1.06175121e-06 -1.10932888e-06]
 [-2.99766038e-04 -2.46632113e-04  3.00850063e-04 -8.21752490e-07
  -5.35771397e-07  1.32474320e-06]
 [ 1.70094418e-06  1.13204338e-06 -8.21752490e-07  6.29526723e-09
   2.57618241e-09 -3.66716022e-09]
 [ 8.98886184e-07  1.06175121e-06 -5.35771397e-07  2.57618241e-09
   4.10189671e-09 -2.35442522e-09]
 [-1.34797204e-06 -1.10932888e-06  1.32474320e-06 -3.66716022e-09
  -2.35442522e-09  7.15920039e-09]]
[[-2.43605578]
 [ 0.72584325]
 [13.59771538]]
[[ 2.01321386e-06]
 [-4.76101969e-05]
 [ 2.36185404e+00]]


 Corrector Step
2018-07-13 08:31:30
[[-5.80138750e+03]
 [-3.46133101e+03]
 [-2.26676225e+03]
 [-1.76295797e+00]
 [-1.63826187e+00]
 [ 7.07840985e+00]]
[[ 5.71358760e-04  4.06204655e-04 -2.99766038e-04  1.70094418e-06
   8.98886184e-07 -1.34797204e-06]
 [ 4.06204655e-04  4.12154443e-04 -2.46632113e-04  1.13204338e-06
   1.06175121e-06 -1.10932888e-06]
 [-2.99766038e-04 -2.46632113e-04  3.00850063e-04 -8.21752490e-07
  -5.35771397e-07  1.32474320e-06]
 [ 1.70094418e-06  1.13204338e-06 -8.21752490e-07  6.29526723e-09
   2.57618241e-09 -3.66716022e-09]
 [ 8.98886184e-07  1.06175121e-06 -5.35771397e-07  2.57618241e-09
   4.10189671e-09 -2.35442522e-09]
 [-1.34797204e-06 -1.10932888e-06  1.32474320e-06 -3.66716022e-09
  -2.35442522e-09  7.15920039e-09]]
1.241350060308385e-113
post
sphere_lamr_small
Ybar_post [[-2.43605574]
 [ 0.72583988]
 [13.59772403]]
resids [[ 1.97492917e-06]
 [-4.42430558e-05]
 [ 2.36184539e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [43284522.22838343, 1.241350060308385e-113]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.80142853e+03],
       [-3.46134863e+03],
       [-2.26673212e+03],
       [-1.76319513e+00],
       [-1.63819813e+00],
       [ 7.07852588e+00]]), 'est_covars': array([[ 1.45465757e-02,  1.21015938e-02, -1.56092373e-02,
         4.09763292e-05,  2.64630654e-05, -7.90472025e-05],
       [ 1.21015938e-02,  1.05387702e-02, -1.32335820e-02,
         3.20335866e-05,  2.57756808e-05, -6.70464241e-05],
       [-1.56092373e-02, -1.32335820e-02,  1.75860707e-02,
        -4.03219899e-05, -2.81003051e-05,  9.11888282e-05],
       [ 4.09763292e-05,  3.20335866e-05, -4.03219899e-05,
         1.99962064e-07,  8.96114260e-08, -2.13225350e-07],
       [ 2.64630654e-05,  2.57756808e-05, -2.81003051e-05,
         8.96114260e-08,  1.46583645e-07, -1.50709893e-07],
       [-7.90472025e-05, -6.70464241e-05,  9.11888282e-05,
        -2.13225350e-07, -1.50709893e-07,  5.33941231e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.80138750e+03],
       [-3.46133101e+03],
       [-2.26676225e+03],
       [-1.76295797e+00],
       [-1.63826187e+00],
       [ 7.07840985e+00]]), 'covar': array([[ 5.71358760e-04,  4.06204655e-04, -2.99766038e-04,
         1.70094418e-06,  8.98886184e-07, -1.34797204e-06],
       [ 4.06204655e-04,  4.12154443e-04, -2.46632113e-04,
         1.13204338e-06,  1.06175121e-06, -1.10932888e-06],
       [-2.99766038e-04, -2.46632113e-04,  3.00850063e-04,
        -8.21752490e-07, -5.35771397e-07,  1.32474320e-06],
       [ 1.70094418e-06,  1.13204338e-06, -8.21752490e-07,
         6.29526723e-09,  2.57618241e-09, -3.66716022e-09],
       [ 8.98886184e-07,  1.06175121e-06, -5.35771397e-07,
         2.57618241e-09,  4.10189671e-09, -2.35442522e-09],
       [-1.34797204e-06, -1.10932888e-06,  1.32474320e-06,
        -3.66716022e-09, -2.35442522e-09,  7.15920039e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.97492917e-06],
       [-4.42430558e-05],
       [ 2.36184539e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.80142853e+03],
       [-3.46134863e+03],
       [-2.26673212e+03],
       [-1.76319513e+00],
       [-1.63819813e+00],
       [ 7.07852588e+00],
       [ 3.24845431e-01],
       [ 6.31676757e-02],
       [ 9.02999493e-01],
       [-2.74002201e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81141055e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.45465757e-02,  1.21015938e-02, -1.56092373e-02,
         4.09763292e-05,  2.64630654e-05, -7.90472025e-05],
       [ 1.21015938e-02,  1.05387702e-02, -1.32335820e-02,
         3.20335866e-05,  2.57756808e-05, -6.70464241e-05],
       [-1.56092373e-02, -1.32335820e-02,  1.75860707e-02,
        -4.03219899e-05, -2.81003051e-05,  9.11888282e-05],
       [ 4.09763292e-05,  3.20335866e-05, -4.03219899e-05,
         1.99962064e-07,  8.96114260e-08, -2.13225350e-07],
       [ 2.64630654e-05,  2.57756808e-05, -2.81003051e-05,
         8.96114260e-08,  1.46583645e-07, -1.50709893e-07],
       [-7.90472025e-05, -6.70464241e-05,  9.11888282e-05,
        -2.13225350e-07, -1.50709893e-07,  5.33941231e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.03987698e-05],
       [-4.14813651e-05],
       [-1.50351442e-01]])}}
Current time:  2018-07-13 08:31:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.80142853e+03],
       [-3.46134863e+03],
       [-2.26673212e+03],
       [-1.76319513e+00],
       [-1.63819813e+00],
       [ 7.07852588e+00],
       [ 3.24845431e-01],
       [ 6.31676757e-02],
       [ 9.02999493e-01],
       [-2.74002201e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81141055e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.45465757e-02,  1.21015938e-02, -1.56092373e-02,
         4.09763292e-05,  2.64630654e-05, -7.90472025e-05],
       [ 1.21015938e-02,  1.05387702e-02, -1.32335820e-02,
         3.20335866e-05,  2.57756808e-05, -6.70464241e-05],
       [-1.56092373e-02, -1.32335820e-02,  1.75860707e-02,
        -4.03219899e-05, -2.81003051e-05,  9.11888282e-05],
       [ 4.09763292e-05,  3.20335866e-05, -4.03219899e-05,
         1.99962064e-07,  8.96114260e-08, -2.13225350e-07],
       [ 2.64630654e-05,  2.57756808e-05, -2.81003051e-05,
         8.96114260e-08,  1.46583645e-07, -1.50709893e-07],
       [-7.90472025e-05, -6.70464241e-05,  9.11888282e-05,
        -2.13225350e-07, -1.50709893e-07,  5.33941231e-07]])}
[[-5.80142853e+03]
 [-3.46134863e+03]
 [-2.26673212e+03]
 [-1.76319513e+00]
 [-1.63819813e+00]
 [ 7.07852588e+00]
 [ 3.24845431e-01]
 [ 6.31676757e-02]
 [ 9.02999493e-01]
 [-2.74002201e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81141055e-18]]
2018-07-13 08:31:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:40
[[-5.81874003e+03]
 [-3.47753959e+03]
 [-2.19582279e+03]
 [-1.69914075e+00]
 [-1.59994850e+00]
 [ 7.10318891e+00]
 [ 3.29555846e-01]
 [ 6.45974659e-02]
 [ 9.01291064e-01]
 [-2.73668648e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81162284e-18]]
[[ 1.53886443e-02  1.26966529e-02 -1.68235522e-02  4.32207025e-05
   2.74373796e-05 -8.08642634e-05]
 [ 1.26966529e-02  1.10697880e-02 -1.41991804e-02  3.30943314e-05
   2.73516849e-05 -6.82858128e-05]
 [-1.68235522e-02 -1.41991804e-02  1.94599542e-02 -4.26557512e-05
  -2.96817324e-05  9.62097795e-05]
 [ 4.32207025e-05  3.30943314e-05 -4.26557512e-05  2.11036295e-07
   9.02491551e-08 -2.13351680e-07]
 [ 2.74373796e-05  2.73516849e-05 -2.96817324e-05  9.02491551e-08
   1.56829890e-07 -1.50482264e-07]
 [-8.08642634e-05 -6.82858128e-05  9.62097795e-05 -2.13351680e-07
  -1.50482264e-07  5.40441481e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.80138750e+03],
       [-3.46133101e+03],
       [-2.26676225e+03],
       [-1.76295797e+00],
       [-1.63826187e+00],
       [ 7.07840985e+00]]), 'covar': array([[ 5.71358760e-04,  4.06204655e-04, -2.99766038e-04,
         1.70094418e-06,  8.98886184e-07, -1.34797204e-06],
       [ 4.06204655e-04,  4.12154443e-04, -2.46632113e-04,
         1.13204338e-06,  1.06175121e-06, -1.10932888e-06],
       [-2.99766038e-04, -2.46632113e-04,  3.00850063e-04,
        -8.21752490e-07, -5.35771397e-07,  1.32474320e-06],
       [ 1.70094418e-06,  1.13204338e-06, -8.21752490e-07,
         6.29526723e-09,  2.57618241e-09, -3.66716022e-09],
       [ 8.98886184e-07,  1.06175121e-06, -5.35771397e-07,
         2.57618241e-09,  4.10189671e-09, -2.35442522e-09],
       [-1.34797204e-06, -1.10932888e-06,  1.32474320e-06,
        -3.66716022e-09, -2.35442522e-09,  7.15920039e-09]])}
[[-5.80138750e+03]
 [-3.46133101e+03]
 [-2.26676225e+03]
 [-1.76295797e+00]
 [-1.63826187e+00]
 [ 7.07840985e+00]]
2018-07-13 08:31:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:40
[[-5.81869719e+03]
 [-3.47752270e+03]
 [-2.19585408e+03]
 [-1.69890319e+00]
 [-1.60001196e+00]
 [ 7.10307328e+00]]
[[ 6.06259524e-04  4.26941152e-04 -3.21875693e-04  1.77393983e-06
   9.29621857e-07 -1.37487230e-06]
 [ 4.26941152e-04  4.33900430e-04 -2.63337472e-04  1.16592575e-06
   1.10614098e-06 -1.12502751e-06]
 [-3.21875693e-04 -2.63337472e-04  3.28032676e-04 -8.62462733e-07
  -5.60930163e-07  1.39008969e-06]
 [ 1.77393983e-06  1.16592575e-06 -8.62462733e-07  6.44925641e-09
   2.61067853e-09 -3.65816452e-09]
 [ 9.29621857e-07  1.10614098e-06 -5.60930163e-07  2.61067853e-09
   4.21345787e-09 -2.34440059e-09]
 [-1.37487230e-06 -1.12502751e-06  1.39008969e-06 -3.65816452e-09
  -2.34440059e-09  7.20393205e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.81869719e+03],
       [-3.47752270e+03],
       [-2.19585408e+03],
       [-1.69890319e+00],
       [-1.60001196e+00],
       [ 7.10307328e+00]]), 'covar': array([[ 6.06259524e-04,  4.26941152e-04, -3.21875693e-04,
         1.77393983e-06,  9.29621857e-07, -1.37487230e-06],
       [ 4.26941152e-04,  4.33900430e-04, -2.63337472e-04,
         1.16592575e-06,  1.10614098e-06, -1.12502751e-06],
       [-3.21875693e-04, -2.63337472e-04,  3.28032676e-04,
        -8.62462733e-07, -5.60930163e-07,  1.39008969e-06],
       [ 1.77393983e-06,  1.16592575e-06, -8.62462733e-07,
         6.44925641e-09,  2.61067853e-09, -3.65816452e-09],
       [ 9.29621857e-07,  1.10614098e-06, -5.60930163e-07,
         2.61067853e-09,  4.21345787e-09, -2.34440059e-09],
       [-1.37487230e-06, -1.12502751e-06,  1.39008969e-06,
        -3.65816452e-09, -2.34440059e-09,  7.20393205e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.97492917e-06],
       [-4.42430558e-05],
       [ 2.36184539e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.81874003e+03],
       [-3.47753959e+03],
       [-2.19582279e+03],
       [-1.69914075e+00],
       [-1.59994850e+00],
       [ 7.10318891e+00],
       [ 3.29555846e-01],
       [ 6.45974659e-02],
       [ 9.01291064e-01],
       [-2.73668648e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81162284e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.53886443e-02,  1.26966529e-02, -1.68235522e-02,
         4.32207025e-05,  2.74373796e-05, -8.08642634e-05],
       [ 1.26966529e-02,  1.10697880e-02, -1.41991804e-02,
         3.30943314e-05,  2.73516849e-05, -6.82858128e-05],
       [-1.68235522e-02, -1.41991804e-02,  1.94599542e-02,
        -4.26557512e-05, -2.96817324e-05,  9.62097795e-05],
       [ 4.32207025e-05,  3.30943314e-05, -4.26557512e-05,
         2.11036295e-07,  9.02491551e-08, -2.13351680e-07],
       [ 2.74373796e-05,  2.73516849e-05, -2.96817324e-05,
         9.02491551e-08,  1.56829890e-07, -1.50482264e-07],
       [-8.08642634e-05, -6.82858128e-05,  9.62097795e-05,
        -2.13351680e-07, -1.50482264e-07,  5.40441481e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.03987698e-05],
       [-4.14813651e-05],
       [-1.50351442e-01]])}}
Yi [[-2.43771066]
 [ 0.74332226]
 [16.2437823 ]]
posterior
[[-5.81874003e+03]
 [-3.47753959e+03]
 [-2.19582279e+03]
 [-1.69914075e+00]
 [-1.59994850e+00]
 [ 7.10318891e+00]
 [ 3.29555846e-01]
 [ 6.45974659e-02]
 [ 9.01291064e-01]
 [-2.73668648e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81162284e-18]]
[[-5.81878420e+03]
 [-3.47757602e+03]
 [-2.19580034e+03]
 [-1.69935761e+00]
 [-1.60010898e+00]
 [ 7.10322037e+00]
 [ 3.29555846e-01]
 [ 6.45974659e-02]
 [ 9.01291064e-01]
 [-2.73668648e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81162284e-18]]
[[ 1.49693544e-02  1.24112092e-02 -1.66204151e-02  4.09820730e-05
   2.64637294e-05 -8.05509001e-05]
 [ 1.24112092e-02  1.07720900e-02 -1.40427739e-02  3.18827057e-05
   2.57504954e-05 -6.80896057e-05]
 [-1.66204151e-02 -1.40427739e-02  1.93583381e-02 -4.16260174e-05
  -2.90456671e-05  9.60607611e-05]
 [ 4.09820730e-05  3.18827057e-05 -4.16260174e-05  1.98139711e-07
   8.78860358e-08 -2.11627579e-07]
 [ 2.64637294e-05  2.57504954e-05 -2.90456671e-05  8.78860358e-08
   1.46051079e-07 -1.49910666e-07]
 [-8.05509001e-05 -6.80896057e-05  9.60607611e-05 -2.11627579e-07
  -1.49910666e-07  5.40202884e-07]]
[[-2.43770799]
 [ 0.74338216]
 [16.28040457]]
[[-2.66836777e-06]
 [-5.98979644e-05]
 [-3.66222659e-02]]


 Corrector Step
2018-07-13 08:31:40
[[-5.81878420e+03]
 [-3.47757602e+03]
 [-2.19580034e+03]
 [-1.69935761e+00]
 [-1.60010898e+00]
 [ 7.10322037e+00]
 [ 3.29555846e-01]
 [ 6.45974659e-02]
 [ 9.01291064e-01]
 [-2.73668648e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81162284e-18]]
[[ 1.49693544e-02  1.24112092e-02 -1.66204151e-02  4.09820730e-05
   2.64637294e-05 -8.05509001e-05]
 [ 1.24112092e-02  1.07720900e-02 -1.40427739e-02  3.18827057e-05
   2.57504954e-05 -6.80896057e-05]
 [-1.66204151e-02 -1.40427739e-02  1.93583381e-02 -4.16260174e-05
  -2.90456671e-05  9.60607611e-05]
 [ 4.09820730e-05  3.18827057e-05 -4.16260174e-05  1.98139711e-07
   8.78860358e-08 -2.11627579e-07]
 [ 2.64637294e-05  2.57504954e-05 -2.90456671e-05  8.78860358e-08
   1.46051079e-07 -1.49910666e-07]
 [-8.05509001e-05 -6.80896057e-05  9.60607611e-05 -2.11627579e-07
  -1.49910666e-07  5.40202884e-07]]
65674743.61267399
post
cubesat_nadir
Ybar_post [[-2.43770853]
 [ 0.74337186]
 [16.28043533]]
resids [[-2.12628591e-06]
 [-4.96025618e-05]
 [-3.66530293e-02]]
posterior
[[-5.81869719e+03]
 [-3.47752270e+03]
 [-2.19585408e+03]
 [-1.69890319e+00]
 [-1.60001196e+00]
 [ 7.10307328e+00]]
[[-5.81871030e+03]
 [-3.47753216e+03]
 [-2.19585201e+03]
 [-1.69894331e+00]
 [-1.60003475e+00]
 [ 7.10308249e+00]]
[[ 5.79929902e-04  4.09899080e-04 -3.17986751e-04  1.69224685e-06
   8.90588571e-07 -1.35753030e-06]
 [ 4.09899080e-04  4.16033882e-04 -2.60658437e-04  1.11666437e-06
   1.05704797e-06 -1.11297094e-06]
 [-3.17986751e-04 -2.60658437e-04  3.27454420e-04 -8.50482120e-07
  -5.54600580e-07  1.38750846e-06]
 [ 1.69224685e-06  1.11666437e-06 -8.50482120e-07  6.19387558e-09
   2.50217123e-09 -3.60479737e-09]
 [ 8.90588571e-07  1.05704797e-06 -5.54600580e-07  2.50217123e-09
   4.07253154e-09 -2.31579183e-09]
 [-1.35753030e-06 -1.11297094e-06  1.38750846e-06 -3.60479737e-09
  -2.31579183e-09  7.19240822e-09]]
[[-2.43769863]
 [ 0.74338511]
 [13.68003249]]
[[-1.20262970e-05]
 [-6.28483944e-05]
 [ 2.56374981e+00]]


 Corrector Step
2018-07-13 08:31:40
[[-5.81871030e+03]
 [-3.47753216e+03]
 [-2.19585201e+03]
 [-1.69894331e+00]
 [-1.60003475e+00]
 [ 7.10308249e+00]]
[[ 5.79929902e-04  4.09899080e-04 -3.17986751e-04  1.69224685e-06
   8.90588571e-07 -1.35753030e-06]
 [ 4.09899080e-04  4.16033882e-04 -2.60658437e-04  1.11666437e-06
   1.05704797e-06 -1.11297094e-06]
 [-3.17986751e-04 -2.60658437e-04  3.27454420e-04 -8.50482120e-07
  -5.54600580e-07  1.38750846e-06]
 [ 1.69224685e-06  1.11666437e-06 -8.50482120e-07  6.19387558e-09
   2.50217123e-09 -3.60479737e-09]
 [ 8.90588571e-07  1.05704797e-06 -5.54600580e-07  2.50217123e-09
   4.07253154e-09 -2.31579183e-09]
 [-1.35753030e-06 -1.11297094e-06  1.38750846e-06 -3.60479737e-09
  -2.31579183e-09  7.19240822e-09]]
7.437433639792108e-136
post
sphere_lamr_small
Ybar_post [[-2.43769948]
 [ 0.7433808 ]
 [13.6800437 ]]
resids [[-1.11832994e-05]
 [-5.85420632e-05]
 [ 2.56373860e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [65674743.61267399, 7.437433639792108e-136]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.81878420e+03],
       [-3.47757602e+03],
       [-2.19580034e+03],
       [-1.69935761e+00],
       [-1.60010898e+00],
       [ 7.10322037e+00]]), 'est_covars': array([[ 1.49693544e-02,  1.24112092e-02, -1.66204151e-02,
         4.09820730e-05,  2.64637294e-05, -8.05509001e-05],
       [ 1.24112092e-02,  1.07720900e-02, -1.40427739e-02,
         3.18827057e-05,  2.57504954e-05, -6.80896057e-05],
       [-1.66204151e-02, -1.40427739e-02,  1.93583381e-02,
        -4.16260174e-05, -2.90456671e-05,  9.60607611e-05],
       [ 4.09820730e-05,  3.18827057e-05, -4.16260174e-05,
         1.98139711e-07,  8.78860358e-08, -2.11627579e-07],
       [ 2.64637294e-05,  2.57504954e-05, -2.90456671e-05,
         8.78860358e-08,  1.46051079e-07, -1.49910666e-07],
       [-8.05509001e-05, -6.80896057e-05,  9.60607611e-05,
        -2.11627579e-07, -1.49910666e-07,  5.40202884e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.81871030e+03],
       [-3.47753216e+03],
       [-2.19585201e+03],
       [-1.69894331e+00],
       [-1.60003475e+00],
       [ 7.10308249e+00]]), 'covar': array([[ 5.79929902e-04,  4.09899080e-04, -3.17986751e-04,
         1.69224685e-06,  8.90588571e-07, -1.35753030e-06],
       [ 4.09899080e-04,  4.16033882e-04, -2.60658437e-04,
         1.11666437e-06,  1.05704797e-06, -1.11297094e-06],
       [-3.17986751e-04, -2.60658437e-04,  3.27454420e-04,
        -8.50482120e-07, -5.54600580e-07,  1.38750846e-06],
       [ 1.69224685e-06,  1.11666437e-06, -8.50482120e-07,
         6.19387558e-09,  2.50217123e-09, -3.60479737e-09],
       [ 8.90588571e-07,  1.05704797e-06, -5.54600580e-07,
         2.50217123e-09,  4.07253154e-09, -2.31579183e-09],
       [-1.35753030e-06, -1.11297094e-06,  1.38750846e-06,
        -3.60479737e-09, -2.31579183e-09,  7.19240822e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.11832994e-05],
       [-5.85420632e-05],
       [ 2.56373860e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.81878420e+03],
       [-3.47757602e+03],
       [-2.19580034e+03],
       [-1.69935761e+00],
       [-1.60010898e+00],
       [ 7.10322037e+00],
       [ 3.29555846e-01],
       [ 6.45974659e-02],
       [ 9.01291064e-01],
       [-2.73668648e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81162284e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.49693544e-02,  1.24112092e-02, -1.66204151e-02,
         4.09820730e-05,  2.64637294e-05, -8.05509001e-05],
       [ 1.24112092e-02,  1.07720900e-02, -1.40427739e-02,
         3.18827057e-05,  2.57504954e-05, -6.80896057e-05],
       [-1.66204151e-02, -1.40427739e-02,  1.93583381e-02,
        -4.16260174e-05, -2.90456671e-05,  9.60607611e-05],
       [ 4.09820730e-05,  3.18827057e-05, -4.16260174e-05,
         1.98139711e-07,  8.78860358e-08, -2.11627579e-07],
       [ 2.64637294e-05,  2.57504954e-05, -2.90456671e-05,
         8.78860358e-08,  1.46051079e-07, -1.49910666e-07],
       [-8.05509001e-05, -6.80896057e-05,  9.60607611e-05,
        -2.11627579e-07, -1.49910666e-07,  5.40202884e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.12628591e-06],
       [-4.96025618e-05],
       [-3.66530293e-02]])}}
Current time:  2018-07-13 08:31:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.81878420e+03],
       [-3.47757602e+03],
       [-2.19580034e+03],
       [-1.69935761e+00],
       [-1.60010898e+00],
       [ 7.10322037e+00],
       [ 3.29555846e-01],
       [ 6.45974659e-02],
       [ 9.01291064e-01],
       [-2.73668648e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81162284e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.49693544e-02,  1.24112092e-02, -1.66204151e-02,
         4.09820730e-05,  2.64637294e-05, -8.05509001e-05],
       [ 1.24112092e-02,  1.07720900e-02, -1.40427739e-02,
         3.18827057e-05,  2.57504954e-05, -6.80896057e-05],
       [-1.66204151e-02, -1.40427739e-02,  1.93583381e-02,
        -4.16260174e-05, -2.90456671e-05,  9.60607611e-05],
       [ 4.09820730e-05,  3.18827057e-05, -4.16260174e-05,
         1.98139711e-07,  8.78860358e-08, -2.11627579e-07],
       [ 2.64637294e-05,  2.57504954e-05, -2.90456671e-05,
         8.78860358e-08,  1.46051079e-07, -1.49910666e-07],
       [-8.05509001e-05, -6.80896057e-05,  9.60607611e-05,
        -2.11627579e-07, -1.49910666e-07,  5.40202884e-07]])}
[[-5.81878420e+03]
 [-3.47757602e+03]
 [-2.19580034e+03]
 [-1.69935761e+00]
 [-1.60010898e+00]
 [ 7.10322037e+00]
 [ 3.29555846e-01]
 [ 6.45974659e-02]
 [ 9.01291064e-01]
 [-2.73668648e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81162284e-18]]
2018-07-13 08:31:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:50
[[-5.83545645e+03]
 [-3.49338504e+03]
 [-2.12464804e+03]
 [-1.63510861e+00]
 [-1.56167858e+00]
 [ 7.12710018e+00]
 [ 3.34257277e-01]
 [ 6.60254951e-02]
 [ 8.99558065e-01]
 [-2.73327634e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81183512e-18]]
[[ 1.58112611e-02  1.30047709e-02 -1.78627680e-02  4.32158033e-05
   2.74249727e-05 -8.23413205e-05]
 [ 1.30047709e-02  1.13025992e-02 -1.50281425e-02  3.29321244e-05
   2.73244991e-05 -6.93126738e-05]
 [-1.78627680e-02 -1.50281425e-02  2.13299949e-02 -4.39592344e-05
  -3.06264694e-05  1.01118834e-04]
 [ 4.32158033e-05  3.29321244e-05 -4.39592344e-05  2.09226392e-07
   8.85353443e-08 -2.11780864e-07]
 [ 2.74249727e-05  2.73244991e-05 -3.06264694e-05  8.85353443e-08
   1.56305312e-07 -1.49698361e-07]
 [-8.23413205e-05 -6.93126738e-05  1.01118834e-04 -2.11780864e-07
  -1.49698361e-07  5.46610173e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.81871030e+03],
       [-3.47753216e+03],
       [-2.19585201e+03],
       [-1.69894331e+00],
       [-1.60003475e+00],
       [ 7.10308249e+00]]), 'covar': array([[ 5.79929902e-04,  4.09899080e-04, -3.17986751e-04,
         1.69224685e-06,  8.90588571e-07, -1.35753030e-06],
       [ 4.09899080e-04,  4.16033882e-04, -2.60658437e-04,
         1.11666437e-06,  1.05704797e-06, -1.11297094e-06],
       [-3.17986751e-04, -2.60658437e-04,  3.27454420e-04,
        -8.50482120e-07, -5.54600580e-07,  1.38750846e-06],
       [ 1.69224685e-06,  1.11666437e-06, -8.50482120e-07,
         6.19387558e-09,  2.50217123e-09, -3.60479737e-09],
       [ 8.90588571e-07,  1.05704797e-06, -5.54600580e-07,
         2.50217123e-09,  4.07253154e-09, -2.31579183e-09],
       [-1.35753030e-06, -1.11297094e-06,  1.38750846e-06,
        -3.60479737e-09, -2.31579183e-09,  7.19240822e-09]])}
[[-5.81871030e+03]
 [-3.47753216e+03]
 [-2.19585201e+03]
 [-1.69894331e+00]
 [-1.60003475e+00]
 [ 7.10308249e+00]]
2018-07-13 08:31:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 08:31:50
[[-5.83537868e+03]
 [-3.49334050e+03]
 [-2.12470105e+03]
 [-1.63469321e+00]
 [-1.56160370e+00]
 [ 7.12696408e+00]]
[[ 6.14496203e-04  4.30286412e-04 -3.40411712e-04  1.76441288e-06
   9.20751224e-07 -1.38392716e-06]
 [ 4.30286412e-04  4.37613309e-04 -2.77533370e-04  1.14995593e-06
   1.10123832e-06 -1.12836559e-06]
 [-3.40411712e-04 -2.77533370e-04  3.55884793e-04 -8.90850917e-07
  -5.79534927e-07  1.45290628e-06]
 [ 1.76441288e-06  1.14995593e-06 -8.90850917e-07  6.34793461e-09
   2.53689854e-09 -3.59634832e-09]
 [ 9.20751224e-07  1.10123832e-06 -5.79534927e-07  2.53689854e-09
   4.18420701e-09 -2.30613727e-09]
 [-1.38392716e-06 -1.12836559e-06  1.45290628e-06 -3.59634832e-09
  -2.30613727e-09  7.23610509e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.83537868e+03],
       [-3.49334050e+03],
       [-2.12470105e+03],
       [-1.63469321e+00],
       [-1.56160370e+00],
       [ 7.12696408e+00]]), 'covar': array([[ 6.14496203e-04,  4.30286412e-04, -3.40411712e-04,
         1.76441288e-06,  9.20751224e-07, -1.38392716e-06],
       [ 4.30286412e-04,  4.37613309e-04, -2.77533370e-04,
         1.14995593e-06,  1.10123832e-06, -1.12836559e-06],
       [-3.40411712e-04, -2.77533370e-04,  3.55884793e-04,
        -8.90850917e-07, -5.79534927e-07,  1.45290628e-06],
       [ 1.76441288e-06,  1.14995593e-06, -8.90850917e-07,
         6.34793461e-09,  2.53689854e-09, -3.59634832e-09],
       [ 9.20751224e-07,  1.10123832e-06, -5.79534927e-07,
         2.53689854e-09,  4.18420701e-09, -2.30613727e-09],
       [-1.38392716e-06, -1.12836559e-06,  1.45290628e-06,
        -3.59634832e-09, -2.30613727e-09,  7.23610509e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.11832994e-05],
       [-5.85420632e-05],
       [ 2.56373860e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.83545645e+03],
       [-3.49338504e+03],
       [-2.12464804e+03],
       [-1.63510861e+00],
       [-1.56167858e+00],
       [ 7.12710018e+00],
       [ 3.34257277e-01],
       [ 6.60254951e-02],
       [ 8.99558065e-01],
       [-2.73327634e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81183512e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.58112611e-02,  1.30047709e-02, -1.78627680e-02,
         4.32158033e-05,  2.74249727e-05, -8.23413205e-05],
       [ 1.30047709e-02,  1.13025992e-02, -1.50281425e-02,
         3.29321244e-05,  2.73244991e-05, -6.93126738e-05],
       [-1.78627680e-02, -1.50281425e-02,  2.13299949e-02,
        -4.39592344e-05, -3.06264694e-05,  1.01118834e-04],
       [ 4.32158033e-05,  3.29321244e-05, -4.39592344e-05,
         2.09226392e-07,  8.85353443e-08, -2.11780864e-07],
       [ 2.74249727e-05,  2.73244991e-05, -3.06264694e-05,
         8.85353443e-08,  1.56305312e-07, -1.49698361e-07],
       [-8.23413205e-05, -6.93126738e-05,  1.01118834e-04,
        -2.11780864e-07, -1.49698361e-07,  5.46610173e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.12628591e-06],
       [-4.96025618e-05],
       [-3.66530293e-02]])}}
Yi [[-2.43918677]
 [ 0.76019373]
 [16.39411842]]
posterior
[[-5.83545645e+03]
 [-3.49338504e+03]
 [-2.12464804e+03]
 [-1.63510861e+00]
 [-1.56167858e+00]
 [ 7.12710018e+00]
 [ 3.34257277e-01]
 [ 6.60254951e-02]
 [ 8.99558065e-01]
 [-2.73327634e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81183512e-18]]
[[-5.83544903e+03]
 [-3.49339638e+03]
 [-2.12464887e+03]
 [-1.63502063e+00]
 [-1.56180957e+00]
 [ 7.12709131e+00]
 [ 3.34257277e-01]
 [ 6.60254951e-02]
 [ 8.99558065e-01]
 [-2.73327634e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81183512e-18]]
[[ 1.53822570e-02  1.27137728e-02 -1.76440453e-02  4.09552319e-05
   2.64460172e-05 -8.20039959e-05]
 [ 1.27137728e-02  1.10002587e-02 -1.48603149e-02  3.17139018e-05
   2.57144753e-05 -6.90990157e-05]
 [-1.76440453e-02 -1.48603149e-02  2.12148440e-02 -4.28652565e-05
  -2.99519940e-05  1.00949458e-04]
 [ 4.09552319e-05  3.17139018e-05 -4.28652565e-05  1.96368005e-07
   8.62171416e-08 -2.09958612e-07]
 [ 2.64460172e-05  2.57144753e-05 -2.99519940e-05  8.62171416e-08
   1.45544567e-07 -1.49065830e-07]
 [-8.20039959e-05 -6.90990157e-05  1.00949458e-04 -2.09958612e-07
  -1.49065830e-07  5.46341209e-07]]
[[-2.43923059]
 [ 0.76019847]
 [16.44853616]]
[[ 4.38217267e-05]
 [-4.74300620e-06]
 [-5.44177346e-02]]


 Corrector Step
2018-07-13 08:31:50
[[-5.83544903e+03]
 [-3.49339638e+03]
 [-2.12464887e+03]
 [-1.63502063e+00]
 [-1.56180957e+00]
 [ 7.12709131e+00]
 [ 3.34257277e-01]
 [ 6.60254951e-02]
 [ 8.99558065e-01]
 [-2.73327634e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81183512e-18]]
[[ 1.53822570e-02  1.27137728e-02 -1.76440453e-02  4.09552319e-05
   2.64460172e-05 -8.20039959e-05]
 [ 1.27137728e-02  1.10002587e-02 -1.48603149e-02  3.17139018e-05
   2.57144753e-05 -6.90990157e-05]
 [-1.76440453e-02 -1.48603149e-02  2.12148440e-02 -4.28652565e-05
  -2.99519940e-05  1.00949458e-04]
 [ 4.09552319e-05  3.17139018e-05 -4.28652565e-05  1.96368005e-07
   8.62171416e-08 -2.09958612e-07]
 [ 2.64460172e-05  2.57144753e-05 -2.99519940e-05  8.62171416e-08
   1.45544567e-07 -1.49065830e-07]
 [-8.20039959e-05 -6.90990157e-05  1.00949458e-04 -2.09958612e-07
  -1.49065830e-07  5.46341209e-07]]
200516663.64276135
post
cubesat_nadir
Ybar_post [[-2.43922234]
 [ 0.7601977 ]
 [16.44832688]]
resids [[ 3.55739824e-05]
 [-3.96744898e-06]
 [-5.42084524e-02]]
posterior
[[-5.83537868e+03]
 [-3.49334050e+03]
 [-2.12470105e+03]
 [-1.63469321e+00]
 [-1.56160370e+00]
 [ 7.12696408e+00]]
[[-5.83537939e+03]
 [-3.49334486e+03]
 [-2.12470070e+03]
 [-1.63469329e+00]
 [-1.56161816e+00]
 [ 7.12696543e+00]]
[[ 5.88515353e-04  4.13707545e-04 -3.36222109e-04  1.68493158e-06
   8.83374879e-07 -1.36727321e-06]
 [ 4.13707545e-04  4.20075311e-04 -2.74652047e-04  1.10289189e-06
   1.05337549e-06 -1.11695943e-06]
 [-3.36222109e-04 -2.74652047e-04  3.55202962e-04 -8.78143139e-07
  -5.72790469e-07  1.45019736e-06]
 [ 1.68493158e-06  1.10289189e-06 -8.78143139e-07  6.10286409e-09
   2.43516624e-09 -3.54580922e-09]
 [ 8.83374879e-07  1.05337549e-06 -5.72790469e-07  2.43516624e-09
   4.04757828e-09 -2.27949079e-09]
 [-1.36727321e-06 -1.11695943e-06  1.45019736e-06 -3.54580922e-09
  -2.27949079e-09  7.22534226e-09]]
[[-2.43922055]
 [ 0.76020852]
 [13.75999832]]
[[ 3.37783440e-05]
 [-1.47863888e-05]
 [ 2.63412010e+00]]


 Corrector Step
2018-07-13 08:31:50
[[-5.83537939e+03]
 [-3.49334486e+03]
 [-2.12470070e+03]
 [-1.63469329e+00]
 [-1.56161816e+00]
 [ 7.12696543e+00]]
[[ 5.88515353e-04  4.13707545e-04 -3.36222109e-04  1.68493158e-06
   8.83374879e-07 -1.36727321e-06]
 [ 4.13707545e-04  4.20075311e-04 -2.74652047e-04  1.10289189e-06
   1.05337549e-06 -1.11695943e-06]
 [-3.36222109e-04 -2.74652047e-04  3.55202962e-04 -8.78143139e-07
  -5.72790469e-07  1.45019736e-06]
 [ 1.68493158e-06  1.10289189e-06 -8.78143139e-07  6.10286409e-09
   2.43516624e-09 -3.54580922e-09]
 [ 8.83374879e-07  1.05337549e-06 -5.72790469e-07  2.43516624e-09
   4.04757828e-09 -2.27949079e-09]
 [-1.36727321e-06 -1.11695943e-06  1.45019736e-06 -3.54580922e-09
  -2.27949079e-09  7.22534226e-09]]
7.277457948626233e-143
post
sphere_lamr_small
Ybar_post [[-2.43921883]
 [ 0.7602076 ]
 [13.759998  ]]
resids [[ 3.20575609e-05]
 [-1.38645038e-05]
 [ 2.63412042e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [200516663.64276135, 7.277457948626233e-143]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[-5.83544903e+03],
       [-3.49339638e+03],
       [-2.12464887e+03],
       [-1.63502063e+00],
       [-1.56180957e+00],
       [ 7.12709131e+00]]), 'est_covars': array([[ 1.53822570e-02,  1.27137728e-02, -1.76440453e-02,
         4.09552319e-05,  2.64460172e-05, -8.20039959e-05],
       [ 1.27137728e-02,  1.10002587e-02, -1.48603149e-02,
         3.17139018e-05,  2.57144753e-05, -6.90990157e-05],
       [-1.76440453e-02, -1.48603149e-02,  2.12148440e-02,
        -4.28652565e-05, -2.99519940e-05,  1.00949458e-04],
       [ 4.09552319e-05,  3.17139018e-05, -4.28652565e-05,
         1.96368005e-07,  8.62171416e-08, -2.09958612e-07],
       [ 2.64460172e-05,  2.57144753e-05, -2.99519940e-05,
         8.62171416e-08,  1.45544567e-07, -1.49065830e-07],
       [-8.20039959e-05, -6.90990157e-05,  1.00949458e-04,
        -2.09958612e-07, -1.49065830e-07,  5.46341209e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.83537939e+03],
       [-3.49334486e+03],
       [-2.12470070e+03],
       [-1.63469329e+00],
       [-1.56161816e+00],
       [ 7.12696543e+00]]), 'covar': array([[ 5.88515353e-04,  4.13707545e-04, -3.36222109e-04,
         1.68493158e-06,  8.83374879e-07, -1.36727321e-06],
       [ 4.13707545e-04,  4.20075311e-04, -2.74652047e-04,
         1.10289189e-06,  1.05337549e-06, -1.11695943e-06],
       [-3.36222109e-04, -2.74652047e-04,  3.55202962e-04,
        -8.78143139e-07, -5.72790469e-07,  1.45019736e-06],
       [ 1.68493158e-06,  1.10289189e-06, -8.78143139e-07,
         6.10286409e-09,  2.43516624e-09, -3.54580922e-09],
       [ 8.83374879e-07,  1.05337549e-06, -5.72790469e-07,
         2.43516624e-09,  4.04757828e-09, -2.27949079e-09],
       [-1.36727321e-06, -1.11695943e-06,  1.45019736e-06,
        -3.54580922e-09, -2.27949079e-09,  7.22534226e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 3.20575609e-05],
       [-1.38645038e-05],
       [ 2.63412042e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.83544903e+03],
       [-3.49339638e+03],
       [-2.12464887e+03],
       [-1.63502063e+00],
       [-1.56180957e+00],
       [ 7.12709131e+00],
       [ 3.34257277e-01],
       [ 6.60254951e-02],
       [ 8.99558065e-01],
       [-2.73327634e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81183512e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.53822570e-02,  1.27137728e-02, -1.76440453e-02,
         4.09552319e-05,  2.64460172e-05, -8.20039959e-05],
       [ 1.27137728e-02,  1.10002587e-02, -1.48603149e-02,
         3.17139018e-05,  2.57144753e-05, -6.90990157e-05],
       [-1.76440453e-02, -1.48603149e-02,  2.12148440e-02,
        -4.28652565e-05, -2.99519940e-05,  1.00949458e-04],
       [ 4.09552319e-05,  3.17139018e-05, -4.28652565e-05,
         1.96368005e-07,  8.62171416e-08, -2.09958612e-07],
       [ 2.64460172e-05,  2.57144753e-05, -2.99519940e-05,
         8.62171416e-08,  1.45544567e-07, -1.49065830e-07],
       [-8.20039959e-05, -6.90990157e-05,  1.00949458e-04,
        -2.09958612e-07, -1.49065830e-07,  5.46341209e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 3.55739824e-05],
       [-3.96744898e-06],
       [-5.42084524e-02]])}}
Current time:  2018-07-13 19:32:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[-5.83544903e+03],
       [-3.49339638e+03],
       [-2.12464887e+03],
       [-1.63502063e+00],
       [-1.56180957e+00],
       [ 7.12709131e+00],
       [ 3.34257277e-01],
       [ 6.60254951e-02],
       [ 8.99558065e-01],
       [-2.73327634e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-1.81183512e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.53822570e-02,  1.27137728e-02, -1.76440453e-02,
         4.09552319e-05,  2.64460172e-05, -8.20039959e-05],
       [ 1.27137728e-02,  1.10002587e-02, -1.48603149e-02,
         3.17139018e-05,  2.57144753e-05, -6.90990157e-05],
       [-1.76440453e-02, -1.48603149e-02,  2.12148440e-02,
        -4.28652565e-05, -2.99519940e-05,  1.00949458e-04],
       [ 4.09552319e-05,  3.17139018e-05, -4.28652565e-05,
         1.96368005e-07,  8.62171416e-08, -2.09958612e-07],
       [ 2.64460172e-05,  2.57144753e-05, -2.99519940e-05,
         8.62171416e-08,  1.45544567e-07, -1.49065830e-07],
       [-8.20039959e-05, -6.90990157e-05,  1.00949458e-04,
        -2.09958612e-07, -1.49065830e-07,  5.46341209e-07]])}
[[-5.83544903e+03]
 [-3.49339638e+03]
 [-2.12464887e+03]
 [-1.63502063e+00]
 [-1.56180957e+00]
 [ 7.12709131e+00]
 [ 3.34257277e-01]
 [ 6.60254951e-02]
 [ 8.99558065e-01]
 [-2.73327634e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-1.81183512e-18]]
2018-07-13 08:31:50
delta_t 39620.0


 Predictor Step
2018-07-13 19:32:10
[[ 5.17809465e+03]
 [ 3.47779874e+03]
 [-3.45287639e+03]
 [-3.28682248e+00]
 [-1.55070176e+00]
 [-6.52567273e+00]
 [ 7.79726146e-01]
 [ 2.46279036e-01]
 [-5.59428079e-01]
 [ 1.35698187e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65291595e-18]]
[[ 2.64831736e+03  1.26958976e+03  4.99647040e+03  4.40043749e+00
   2.94553783e+00 -2.83329840e+00]
 [ 1.26958976e+03  6.08708635e+02  2.39493105e+03  2.10922423e+00
   1.41192839e+00 -1.35831755e+00]
 [ 4.99647040e+03  2.39493105e+03  9.43220132e+03  8.30680234e+00
   5.56014684e+00 -5.34513943e+00]
 [ 4.40043749e+00  2.10922423e+00  8.30680234e+00  7.31584026e-03
   4.89680804e-03 -4.70736549e-03]
 [ 2.94553783e+00  1.41192839e+00  5.56014684e+00  4.89680804e-03
   3.27771586e-03 -3.15104911e-03]
 [-2.83329840e+00 -1.35831755e+00 -5.34513943e+00 -4.70736549e-03
  -3.15104911e-03  3.03139495e-03]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[-5.83537939e+03],
       [-3.49334486e+03],
       [-2.12470070e+03],
       [-1.63469329e+00],
       [-1.56161816e+00],
       [ 7.12696543e+00]]), 'covar': array([[ 5.88515353e-04,  4.13707545e-04, -3.36222109e-04,
         1.68493158e-06,  8.83374879e-07, -1.36727321e-06],
       [ 4.13707545e-04,  4.20075311e-04, -2.74652047e-04,
         1.10289189e-06,  1.05337549e-06, -1.11695943e-06],
       [-3.36222109e-04, -2.74652047e-04,  3.55202962e-04,
        -8.78143139e-07, -5.72790469e-07,  1.45019736e-06],
       [ 1.68493158e-06,  1.10289189e-06, -8.78143139e-07,
         6.10286409e-09,  2.43516624e-09, -3.54580922e-09],
       [ 8.83374879e-07,  1.05337549e-06, -5.72790469e-07,
         2.43516624e-09,  4.04757828e-09, -2.27949079e-09],
       [-1.36727321e-06, -1.11695943e-06,  1.45019736e-06,
        -3.54580922e-09, -2.27949079e-09,  7.22534226e-09]])}
[[-5.83537939e+03]
 [-3.49334486e+03]
 [-2.12470070e+03]
 [-1.63469329e+00]
 [-1.56161816e+00]
 [ 7.12696543e+00]]
2018-07-13 08:31:50
delta_t 39620.0


 Predictor Step
2018-07-13 19:32:10
[[ 5.16311100e+03]
 [ 3.47076826e+03]
 [-3.48311408e+03]
 [-3.31306928e+00]
 [-1.56820783e+00]
 [-6.50945018e+00]]
[[ 4.44777092e+01  2.13615677e+01  8.33961387e+01  7.32567667e-02
   4.90840952e-02 -4.78977611e-02]
 [ 2.13615677e+01  1.02611666e+01  4.00540374e+01  3.51838992e-02
   2.35756198e-02 -2.30045194e-02]
 [ 8.33961387e+01  4.00540374e+01  1.56381049e+02  1.37360917e-01
   9.20374437e-02 -8.98166031e-02]
 [ 7.32567667e-02  3.51838992e-02  1.37360917e-01  1.20658970e-04
   8.08454561e-05 -7.88913103e-05]
 [ 4.90840952e-02  2.35756198e-02  9.20374437e-02  8.08454561e-05
   5.41704596e-05 -5.28604495e-05]
 [-4.78977611e-02 -2.30045194e-02 -8.98166031e-02 -7.88913103e-05
  -5.28604495e-05  5.15869179e-05]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 8, 31, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.16311100e+03],
       [ 3.47076826e+03],
       [-3.48311408e+03],
       [-3.31306928e+00],
       [-1.56820783e+00],
       [-6.50945018e+00]]), 'covar': array([[ 4.44777092e+01,  2.13615677e+01,  8.33961387e+01,
         7.32567667e-02,  4.90840952e-02, -4.78977611e-02],
       [ 2.13615677e+01,  1.02611666e+01,  4.00540374e+01,
         3.51838992e-02,  2.35756198e-02, -2.30045194e-02],
       [ 8.33961387e+01,  4.00540374e+01,  1.56381049e+02,
         1.37360917e-01,  9.20374437e-02, -8.98166031e-02],
       [ 7.32567667e-02,  3.51838992e-02,  1.37360917e-01,
         1.20658970e-04,  8.08454561e-05, -7.88913103e-05],
       [ 4.90840952e-02,  2.35756198e-02,  9.20374437e-02,
         8.08454561e-05,  5.41704596e-05, -5.28604495e-05],
       [-4.78977611e-02, -2.30045194e-02, -8.98166031e-02,
        -7.88913103e-05, -5.28604495e-05,  5.15869179e-05]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 3.20575609e-05],
       [-1.38645038e-05],
       [ 2.63412042e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 8, 31, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.17809465e+03],
       [ 3.47779874e+03],
       [-3.45287639e+03],
       [-3.28682248e+00],
       [-1.55070176e+00],
       [-6.52567273e+00],
       [ 7.79726146e-01],
       [ 2.46279036e-01],
       [-5.59428079e-01],
       [ 1.35698187e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65291595e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.64831736e+03,  1.26958976e+03,  4.99647040e+03,
         4.40043749e+00,  2.94553783e+00, -2.83329840e+00],
       [ 1.26958976e+03,  6.08708635e+02,  2.39493105e+03,
         2.10922423e+00,  1.41192839e+00, -1.35831755e+00],
       [ 4.99647040e+03,  2.39493105e+03,  9.43220132e+03,
         8.30680234e+00,  5.56014684e+00, -5.34513943e+00],
       [ 4.40043749e+00,  2.10922423e+00,  8.30680234e+00,
         7.31584026e-03,  4.89680804e-03, -4.70736549e-03],
       [ 2.94553783e+00,  1.41192839e+00,  5.56014684e+00,
         4.89680804e-03,  3.27771586e-03, -3.15104911e-03],
       [-2.83329840e+00, -1.35831755e+00, -5.34513943e+00,
        -4.70736549e-03, -3.15104911e-03,  3.03139495e-03]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 3.55739824e-05],
       [-3.96744898e-06],
       [-5.42084524e-02]])}}
Yi [[ 1.52847295]
 [ 0.0775405 ]
 [16.40909618]]
posterior
[[ 5.17809465e+03]
 [ 3.47779874e+03]
 [-3.45287639e+03]
 [-3.28682248e+00]
 [-1.55070176e+00]
 [-6.52567273e+00]
 [ 7.79726146e-01]
 [ 2.46279036e-01]
 [-5.59428079e-01]
 [ 1.35698187e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65291595e-18]]
[[ 5.15521522e+03]
 [ 3.46691311e+03]
 [-3.49735125e+03]
 [-3.32593922e+00]
 [-1.57683614e+00]
 [-6.50127213e+00]
 [ 7.79726146e-01]
 [ 2.46279036e-01]
 [-5.59428079e-01]
 [ 1.35698187e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65291595e-18]]
[[ 1.94985328e-01  8.80366074e-02  4.96408801e-01  4.30581651e-04
   2.86258238e-04 -2.02512919e-04]
 [ 8.80366074e-02  9.17036796e-02  2.20761356e-01  1.63787423e-04
   1.64581478e-04 -1.19873206e-04]
 [ 4.96408801e-01  2.20761356e-01  1.28687883e+00  1.11663542e-03
   7.39523817e-04 -5.13173404e-04]
 [ 4.30581651e-04  1.63787423e-04  1.11663542e-03  1.12025169e-06
   6.94938020e-07 -2.83944195e-07]
 [ 2.86258238e-04  1.64581478e-04  7.39523817e-04  6.94938020e-07
   4.91321158e-07 -2.37611389e-07]
 [-2.02512919e-04 -1.19873206e-04 -5.13173404e-04 -2.83944195e-07
  -2.37611389e-07  3.86177782e-07]]
[[ 1.5184848 ]
 [ 0.09684134]
 [16.77857399]]
[[ 0.00998815]
 [-0.01930083]
 [-0.36947781]]


 Corrector Step
2018-07-13 19:32:10
[[ 5.15521522e+03]
 [ 3.46691311e+03]
 [-3.49735125e+03]
 [-3.32593922e+00]
 [-1.57683614e+00]
 [-6.50127213e+00]
 [ 7.79726146e-01]
 [ 2.46279036e-01]
 [-5.59428079e-01]
 [ 1.35698187e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65291595e-18]]
[[ 1.94985328e-01  8.80366074e-02  4.96408801e-01  4.30581651e-04
   2.86258238e-04 -2.02512919e-04]
 [ 8.80366074e-02  9.17036796e-02  2.20761356e-01  1.63787423e-04
   1.64581478e-04 -1.19873206e-04]
 [ 4.96408801e-01  2.20761356e-01  1.28687883e+00  1.11663542e-03
   7.39523817e-04 -5.13173404e-04]
 [ 4.30581651e-04  1.63787423e-04  1.11663542e-03  1.12025169e-06
   6.94938020e-07 -2.83944195e-07]
 [ 2.86258238e-04  1.64581478e-04  7.39523817e-04  6.94938020e-07
   4.91321158e-07 -2.37611389e-07]
 [-2.02512919e-04 -1.19873206e-04 -5.13173404e-04 -2.83944195e-07
  -2.37611389e-07  3.86177782e-07]]
13588.56929849415
post
cubesat_nadir
Ybar_post [[ 1.52814832]
 [ 0.07837673]
 [16.32259371]]
resids [[ 0.00032463]
 [-0.00083623]
 [ 0.08650247]]
posterior
[[ 5.16311100e+03]
 [ 3.47076826e+03]
 [-3.48311408e+03]
 [-3.31306928e+00]
 [-1.56820783e+00]
 [-6.50945018e+00]]
[[ 5.15447663e+03]
 [ 3.46662264e+03]
 [-3.49928471e+03]
 [-3.32728479e+00]
 [-1.57773001e+00]
 [-6.50016377e+00]]
[[ 1.84488480e-03  7.69786356e-04  7.40260609e-04  2.22642950e-06
   1.16773922e-06 -2.71221884e-07]
 [ 7.69786356e-04  2.00558679e-03  5.97238204e-04  1.19462019e-06
   2.00116466e-06 -1.18697374e-07]
 [ 7.40260609e-04  5.97238204e-04  2.75569853e-03  1.64742675e-06
   1.40946296e-06 -1.64080977e-06]
 [ 2.22642950e-06  1.19462019e-06  1.64742675e-06  3.59688572e-09
   2.17025897e-09  7.63532916e-13]
 [ 1.16773922e-06  2.00116466e-06  1.40946296e-06  2.17025897e-09
   2.53293627e-09 -1.67806736e-10]
 [-2.71221884e-07 -1.18697374e-07 -1.64080977e-06  7.63532921e-13
  -1.67806736e-10  2.19994740e-09]]
[[ 1.52471498]
 [ 0.08451415]
 [17.04346132]]
[[ 0.00375797]
 [-0.00697365]
 [-0.63436515]]


 Corrector Step
2018-07-13 19:32:10
[[ 5.15447663e+03]
 [ 3.46662264e+03]
 [-3.49928471e+03]
 [-3.32728479e+00]
 [-1.57773001e+00]
 [-6.50016377e+00]]
[[ 1.84488480e-03  7.69786356e-04  7.40260609e-04  2.22642950e-06
   1.16773922e-06 -2.71221884e-07]
 [ 7.69786356e-04  2.00558679e-03  5.97238204e-04  1.19462019e-06
   2.00116466e-06 -1.18697374e-07]
 [ 7.40260609e-04  5.97238204e-04  2.75569853e-03  1.64742675e-06
   1.40946296e-06 -1.64080977e-06]
 [ 2.22642950e-06  1.19462019e-06  1.64742675e-06  3.59688572e-09
   2.17025897e-09  7.63532916e-13]
 [ 1.16773922e-06  2.00116466e-06  1.40946296e-06  2.17025897e-09
   2.53293627e-09 -1.67806736e-10]
 [-2.71221884e-07 -1.18697374e-07 -1.64080977e-06  7.63532921e-13
  -1.67806736e-10  2.19994740e-09]]
0.005297104998390583
post
sphere_lamr_small
Ybar_post [[ 1.52847188]
 [ 0.0775309 ]
 [17.03040103]]
resids [[ 1.06507556e-06]
 [ 9.60708358e-06]
 [-6.21304859e-01]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [13588.56929849415, 0.005297104998390583]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 5.15521522e+03],
       [ 3.46691311e+03],
       [-3.49735125e+03],
       [-3.32593922e+00],
       [-1.57683614e+00],
       [-6.50127213e+00]]), 'est_covars': array([[ 1.94985328e-01,  8.80366074e-02,  4.96408801e-01,
         4.30581651e-04,  2.86258238e-04, -2.02512919e-04],
       [ 8.80366074e-02,  9.17036796e-02,  2.20761356e-01,
         1.63787423e-04,  1.64581478e-04, -1.19873206e-04],
       [ 4.96408801e-01,  2.20761356e-01,  1.28687883e+00,
         1.11663542e-03,  7.39523817e-04, -5.13173404e-04],
       [ 4.30581651e-04,  1.63787423e-04,  1.11663542e-03,
         1.12025169e-06,  6.94938020e-07, -2.83944195e-07],
       [ 2.86258238e-04,  1.64581478e-04,  7.39523817e-04,
         6.94938020e-07,  4.91321158e-07, -2.37611389e-07],
       [-2.02512919e-04, -1.19873206e-04, -5.13173404e-04,
        -2.83944195e-07, -2.37611389e-07,  3.86177782e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.15447663e+03],
       [ 3.46662264e+03],
       [-3.49928471e+03],
       [-3.32728479e+00],
       [-1.57773001e+00],
       [-6.50016377e+00]]), 'covar': array([[ 1.84488480e-03,  7.69786356e-04,  7.40260609e-04,
         2.22642950e-06,  1.16773922e-06, -2.71221884e-07],
       [ 7.69786356e-04,  2.00558679e-03,  5.97238204e-04,
         1.19462019e-06,  2.00116466e-06, -1.18697374e-07],
       [ 7.40260609e-04,  5.97238204e-04,  2.75569853e-03,
         1.64742675e-06,  1.40946296e-06, -1.64080977e-06],
       [ 2.22642950e-06,  1.19462019e-06,  1.64742675e-06,
         3.59688572e-09,  2.17025897e-09,  7.63532916e-13],
       [ 1.16773922e-06,  2.00116466e-06,  1.40946296e-06,
         2.17025897e-09,  2.53293627e-09, -1.67806736e-10],
       [-2.71221884e-07, -1.18697374e-07, -1.64080977e-06,
         7.63532921e-13, -1.67806736e-10,  2.19994740e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.06507556e-06],
       [ 9.60708358e-06],
       [-6.21304859e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.15521522e+03],
       [ 3.46691311e+03],
       [-3.49735125e+03],
       [-3.32593922e+00],
       [-1.57683614e+00],
       [-6.50127213e+00],
       [ 7.79726146e-01],
       [ 2.46279036e-01],
       [-5.59428079e-01],
       [ 1.35698187e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65291595e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.94985328e-01,  8.80366074e-02,  4.96408801e-01,
         4.30581651e-04,  2.86258238e-04, -2.02512919e-04],
       [ 8.80366074e-02,  9.17036796e-02,  2.20761356e-01,
         1.63787423e-04,  1.64581478e-04, -1.19873206e-04],
       [ 4.96408801e-01,  2.20761356e-01,  1.28687883e+00,
         1.11663542e-03,  7.39523817e-04, -5.13173404e-04],
       [ 4.30581651e-04,  1.63787423e-04,  1.11663542e-03,
         1.12025169e-06,  6.94938020e-07, -2.83944195e-07],
       [ 2.86258238e-04,  1.64581478e-04,  7.39523817e-04,
         6.94938020e-07,  4.91321158e-07, -2.37611389e-07],
       [-2.02512919e-04, -1.19873206e-04, -5.13173404e-04,
        -2.83944195e-07, -2.37611389e-07,  3.86177782e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 0.00032463],
       [-0.00083623],
       [ 0.08650247]])}}
Current time:  2018-07-13 19:32:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.15521522e+03],
       [ 3.46691311e+03],
       [-3.49735125e+03],
       [-3.32593922e+00],
       [-1.57683614e+00],
       [-6.50127213e+00],
       [ 7.79726146e-01],
       [ 2.46279036e-01],
       [-5.59428079e-01],
       [ 1.35698187e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65291595e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.94985328e-01,  8.80366074e-02,  4.96408801e-01,
         4.30581651e-04,  2.86258238e-04, -2.02512919e-04],
       [ 8.80366074e-02,  9.17036796e-02,  2.20761356e-01,
         1.63787423e-04,  1.64581478e-04, -1.19873206e-04],
       [ 4.96408801e-01,  2.20761356e-01,  1.28687883e+00,
         1.11663542e-03,  7.39523817e-04, -5.13173404e-04],
       [ 4.30581651e-04,  1.63787423e-04,  1.11663542e-03,
         1.12025169e-06,  6.94938020e-07, -2.83944195e-07],
       [ 2.86258238e-04,  1.64581478e-04,  7.39523817e-04,
         6.94938020e-07,  4.91321158e-07, -2.37611389e-07],
       [-2.02512919e-04, -1.19873206e-04, -5.13173404e-04,
        -2.83944195e-07, -2.37611389e-07,  3.86177782e-07]])}
[[ 5.15521522e+03]
 [ 3.46691311e+03]
 [-3.49735125e+03]
 [-3.32593922e+00]
 [-1.57683614e+00]
 [-6.50127213e+00]
 [ 7.79726146e-01]
 [ 2.46279036e-01]
 [-5.59428079e-01]
 [ 1.35698187e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65291595e-18]]
2018-07-13 19:32:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:32:20
[[ 5.12167285e+03]
 [ 3.45095422e+03]
 [-3.56216996e+03]
 [-3.38244409e+00]
 [-1.61487227e+00]
 [-6.46235624e+00]
 [ 7.76794568e-01]
 [ 2.45567156e-01]
 [-5.63491648e-01]
 [ 1.36982237e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65312823e-18]]
[[ 2.03672390e-01  9.25914965e-02  5.05451499e-01  4.38093409e-04
   2.91182521e-04 -2.09896789e-04]
 [ 9.25914965e-02  9.50343084e-02  2.26896040e-01  1.69674963e-04
   1.68472640e-04 -1.24725688e-04]
 [ 5.05451499e-01  2.26896040e-01  1.27654044e+00  1.10427417e-03
   7.31982129e-04 -5.20596736e-04]
 [ 4.38093409e-04  1.69674963e-04  1.10427417e-03  1.11318445e-06
   6.85572361e-07 -2.90161403e-07]
 [ 2.91182521e-04  1.68472640e-04  7.31982129e-04  6.85572361e-07
   4.95198493e-07 -2.42332573e-07]
 [-2.09896789e-04 -1.24725688e-04 -5.20596736e-04 -2.90161403e-07
  -2.42332573e-07  4.05967044e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.15447663e+03],
       [ 3.46662264e+03],
       [-3.49928471e+03],
       [-3.32728479e+00],
       [-1.57773001e+00],
       [-6.50016377e+00]]), 'covar': array([[ 1.84488480e-03,  7.69786356e-04,  7.40260609e-04,
         2.22642950e-06,  1.16773922e-06, -2.71221884e-07],
       [ 7.69786356e-04,  2.00558679e-03,  5.97238204e-04,
         1.19462019e-06,  2.00116466e-06, -1.18697374e-07],
       [ 7.40260609e-04,  5.97238204e-04,  2.75569853e-03,
         1.64742675e-06,  1.40946296e-06, -1.64080977e-06],
       [ 2.22642950e-06,  1.19462019e-06,  1.64742675e-06,
         3.59688572e-09,  2.17025897e-09,  7.63532916e-13],
       [ 1.16773922e-06,  2.00116466e-06,  1.40946296e-06,
         2.17025897e-09,  2.53293627e-09, -1.67806736e-10],
       [-2.71221884e-07, -1.18697374e-07, -1.64080977e-06,
         7.63532921e-13, -1.67806736e-10,  2.19994740e-09]])}
[[ 5.15447663e+03]
 [ 3.46662264e+03]
 [-3.49928471e+03]
 [-3.32728479e+00]
 [-1.57773001e+00]
 [-6.50016377e+00]]
2018-07-13 19:32:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:32:20
[[ 5.12092111e+03]
 [ 3.45065508e+03]
 [-3.56409221e+03]
 [-3.38377471e+00]
 [-1.61575839e+00]
 [-6.46123105e+00]]
[[ 1.88988241e-03  7.93797482e-04  7.53779227e-04  2.27458469e-06
   1.20259572e-06 -3.01735106e-07]
 [ 7.93797482e-04  2.04584280e-03  6.09923007e-04  1.23741946e-06
   2.02459306e-06 -1.47557318e-07]
 [ 7.53779227e-04  6.09923007e-04  2.72291337e-03  1.62651152e-06
   1.39255486e-06 -1.63966653e-06]
 [ 2.27458469e-06  1.23741946e-06  1.62651152e-06  3.71378139e-09
   2.19312201e-09 -2.40327222e-11]
 [ 1.20259572e-06  2.02459306e-06  1.39255486e-06  2.19312201e-09
   2.62492281e-09 -1.91616383e-10]
 [-3.01735106e-07 -1.47557318e-07 -1.63966653e-06 -2.40327222e-11
  -1.91616383e-10  2.31830180e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.12092111e+03],
       [ 3.45065508e+03],
       [-3.56409221e+03],
       [-3.38377471e+00],
       [-1.61575839e+00],
       [-6.46123105e+00]]), 'covar': array([[ 1.88988241e-03,  7.93797482e-04,  7.53779227e-04,
         2.27458469e-06,  1.20259572e-06, -3.01735106e-07],
       [ 7.93797482e-04,  2.04584280e-03,  6.09923007e-04,
         1.23741946e-06,  2.02459306e-06, -1.47557318e-07],
       [ 7.53779227e-04,  6.09923007e-04,  2.72291337e-03,
         1.62651152e-06,  1.39255486e-06, -1.63966653e-06],
       [ 2.27458469e-06,  1.23741946e-06,  1.62651152e-06,
         3.71378139e-09,  2.19312201e-09, -2.40327222e-11],
       [ 1.20259572e-06,  2.02459306e-06,  1.39255486e-06,
         2.19312201e-09,  2.62492281e-09, -1.91616383e-10],
       [-3.01735106e-07, -1.47557318e-07, -1.63966653e-06,
        -2.40327222e-11, -1.91616383e-10,  2.31830180e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.06507556e-06],
       [ 9.60708358e-06],
       [-6.21304859e-01]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.12167285e+03],
       [ 3.45095422e+03],
       [-3.56216996e+03],
       [-3.38244409e+00],
       [-1.61487227e+00],
       [-6.46235624e+00],
       [ 7.76794568e-01],
       [ 2.45567156e-01],
       [-5.63491648e-01],
       [ 1.36982237e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65312823e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.03672390e-01,  9.25914965e-02,  5.05451499e-01,
         4.38093409e-04,  2.91182521e-04, -2.09896789e-04],
       [ 9.25914965e-02,  9.50343084e-02,  2.26896040e-01,
         1.69674963e-04,  1.68472640e-04, -1.24725688e-04],
       [ 5.05451499e-01,  2.26896040e-01,  1.27654044e+00,
         1.10427417e-03,  7.31982129e-04, -5.20596736e-04],
       [ 4.38093409e-04,  1.69674963e-04,  1.10427417e-03,
         1.11318445e-06,  6.85572361e-07, -2.90161403e-07],
       [ 2.91182521e-04,  1.68472640e-04,  7.31982129e-04,
         6.85572361e-07,  4.95198493e-07, -2.42332573e-07],
       [-2.09896789e-04, -1.24725688e-04, -5.20596736e-04,
        -2.90161403e-07, -2.42332573e-07,  4.05967044e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 0.00032463],
       [-0.00083623],
       [ 0.08650247]])}}
Yi [[ 1.54282747]
 [ 0.04916877]
 [15.86709598]]
posterior
[[ 5.12167285e+03]
 [ 3.45095422e+03]
 [-3.56216996e+03]
 [-3.38244409e+00]
 [-1.61487227e+00]
 [-6.46235624e+00]
 [ 7.76794568e-01]
 [ 2.45567156e-01]
 [-5.63491648e-01]
 [ 1.36982237e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65312823e-18]]
[[ 5.12085141e+03]
 [ 3.45058397e+03]
 [-3.56417236e+03]
 [-3.38418725e+00]
 [-1.61602579e+00]
 [-6.46151360e+00]
 [ 7.76794568e-01]
 [ 2.45567156e-01]
 [-5.63491648e-01]
 [ 1.36982237e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65312823e-18]]
[[ 1.77765822e-03  2.61748982e-03  6.22422026e-04  2.24578912e-07
   1.87598956e-06 -2.61613782e-06]
 [ 2.61748982e-03  5.48617648e-02  2.84665445e-03 -2.47704105e-05
   3.99668308e-05 -3.23638426e-05]
 [ 6.22422026e-04  2.84665445e-03  2.86531406e-03  9.36413538e-07
   3.38948912e-06 -2.14654627e-06]
 [ 2.24578912e-07 -2.47704105e-05  9.36413538e-07  1.57233315e-07
   5.42584039e-08  1.59502853e-07]
 [ 1.87598956e-06  3.99668308e-05  3.38948912e-06  5.42584039e-08
   7.82620001e-08  5.47621322e-08]
 [-2.61613782e-06 -3.23638426e-05 -2.14654627e-06  1.59502853e-07
   5.47621322e-08  1.93154628e-07]]
[[ 1.54245192]
 [ 0.05005674]
 [15.87724686]]
[[ 0.00037555]
 [-0.00088798]
 [-0.01015087]]


 Corrector Step
2018-07-13 19:32:20
[[ 5.12085141e+03]
 [ 3.45058397e+03]
 [-3.56417236e+03]
 [-3.38418725e+00]
 [-1.61602579e+00]
 [-6.46151360e+00]
 [ 7.76794568e-01]
 [ 2.45567156e-01]
 [-5.63491648e-01]
 [ 1.36982237e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65312823e-18]]
[[ 1.77765822e-03  2.61748982e-03  6.22422026e-04  2.24578912e-07
   1.87598956e-06 -2.61613782e-06]
 [ 2.61748982e-03  5.48617648e-02  2.84665445e-03 -2.47704105e-05
   3.99668308e-05 -3.23638426e-05]
 [ 6.22422026e-04  2.84665445e-03  2.86531406e-03  9.36413538e-07
   3.38948912e-06 -2.14654627e-06]
 [ 2.24578912e-07 -2.47704105e-05  9.36413538e-07  1.57233315e-07
   5.42584039e-08  1.59502853e-07]
 [ 1.87598956e-06  3.99668308e-05  3.38948912e-06  5.42584039e-08
   7.82620001e-08  5.47621322e-08]
 [-2.61613782e-06 -3.23638426e-05 -2.14654627e-06  1.59502853e-07
   5.47621322e-08  1.93154628e-07]]
5662410.356828746
post
cubesat_nadir
Ybar_post [[ 1.54281684]
 [ 0.04916647]
 [15.86237141]]
resids [[1.06276236e-05]
 [2.29700595e-06]
 [4.72456812e-03]]
posterior
[[ 5.12092111e+03]
 [ 3.45065508e+03]
 [-3.56409221e+03]
 [-3.38377471e+00]
 [-1.61575839e+00]
 [-6.46123105e+00]]
[[ 5.12088070e+03]
 [ 3.45063652e+03]
 [-3.56413400e+03]
 [-3.38383079e+00]
 [-1.61579250e+00]
 [-6.46120834e+00]]
[[ 1.12045763e-03  4.72221776e-04  2.57633062e-04  1.29518582e-06
   6.62257808e-07 -5.77941655e-08]
 [ 4.72221776e-04  1.90243650e-03  3.07048874e-04  8.00021404e-07
   1.76491655e-06  1.45539785e-08]
 [ 2.57633062e-04  3.07048874e-04  1.38998244e-03  6.97313257e-07
   6.85165675e-07 -8.44339401e-07]
 [ 1.29518582e-06  8.00021404e-07  6.97313257e-07  2.37964568e-09
   1.39985104e-09  4.73953548e-10]
 [ 6.62257808e-07  1.76491655e-06  6.85165675e-07  1.39985104e-09
   2.11826214e-09  2.05783570e-10]
 [-5.77941655e-08  1.45539785e-08 -8.44339401e-07  4.73953548e-10
   2.05783570e-10  1.83910811e-09]]
[[ 1.54278636]
 [ 0.04920085]
 [16.96509266]]
[[ 4.11061283e-05]
 [-3.20839787e-05]
 [-1.09799668e+00]]


 Corrector Step
2018-07-13 19:32:20
[[ 5.12088070e+03]
 [ 3.45063652e+03]
 [-3.56413400e+03]
 [-3.38383079e+00]
 [-1.61579250e+00]
 [-6.46120834e+00]]
[[ 1.12045763e-03  4.72221776e-04  2.57633062e-04  1.29518582e-06
   6.62257808e-07 -5.77941655e-08]
 [ 4.72221776e-04  1.90243650e-03  3.07048874e-04  8.00021404e-07
   1.76491655e-06  1.45539785e-08]
 [ 2.57633062e-04  3.07048874e-04  1.38998244e-03  6.97313257e-07
   6.85165675e-07 -8.44339401e-07]
 [ 1.29518582e-06  8.00021404e-07  6.97313257e-07  2.37964568e-09
   1.39985104e-09  4.73953548e-10]
 [ 6.62257808e-07  1.76491655e-06  6.85165675e-07  1.39985104e-09
   2.11826214e-09  2.05783570e-10]
 [-5.77941655e-08  1.45539785e-08 -8.44339401e-07  4.73953548e-10
   2.05783570e-10  1.83910811e-09]]
1.2471131601078583e-18
post
sphere_lamr_small
Ybar_post [[ 1.54280432]
 [ 0.04918252]
 [16.96508224]]
resids [[ 2.31445643e-05]
 [-1.37529200e-05]
 [-1.09798626e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [5662410.356828746, 1.2471131601078583e-18]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 5.12085141e+03],
       [ 3.45058397e+03],
       [-3.56417236e+03],
       [-3.38418725e+00],
       [-1.61602579e+00],
       [-6.46151360e+00]]), 'est_covars': array([[ 1.77765822e-03,  2.61748982e-03,  6.22422026e-04,
         2.24578912e-07,  1.87598956e-06, -2.61613782e-06],
       [ 2.61748982e-03,  5.48617648e-02,  2.84665445e-03,
        -2.47704105e-05,  3.99668308e-05, -3.23638426e-05],
       [ 6.22422026e-04,  2.84665445e-03,  2.86531406e-03,
         9.36413538e-07,  3.38948912e-06, -2.14654627e-06],
       [ 2.24578912e-07, -2.47704105e-05,  9.36413538e-07,
         1.57233315e-07,  5.42584039e-08,  1.59502853e-07],
       [ 1.87598956e-06,  3.99668308e-05,  3.38948912e-06,
         5.42584039e-08,  7.82620001e-08,  5.47621322e-08],
       [-2.61613782e-06, -3.23638426e-05, -2.14654627e-06,
         1.59502853e-07,  5.47621322e-08,  1.93154628e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.12088070e+03],
       [ 3.45063652e+03],
       [-3.56413400e+03],
       [-3.38383079e+00],
       [-1.61579250e+00],
       [-6.46120834e+00]]), 'covar': array([[ 1.12045763e-03,  4.72221776e-04,  2.57633062e-04,
         1.29518582e-06,  6.62257808e-07, -5.77941655e-08],
       [ 4.72221776e-04,  1.90243650e-03,  3.07048874e-04,
         8.00021404e-07,  1.76491655e-06,  1.45539785e-08],
       [ 2.57633062e-04,  3.07048874e-04,  1.38998244e-03,
         6.97313257e-07,  6.85165675e-07, -8.44339401e-07],
       [ 1.29518582e-06,  8.00021404e-07,  6.97313257e-07,
         2.37964568e-09,  1.39985104e-09,  4.73953548e-10],
       [ 6.62257808e-07,  1.76491655e-06,  6.85165675e-07,
         1.39985104e-09,  2.11826214e-09,  2.05783570e-10],
       [-5.77941655e-08,  1.45539785e-08, -8.44339401e-07,
         4.73953548e-10,  2.05783570e-10,  1.83910811e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.31445643e-05],
       [-1.37529200e-05],
       [-1.09798626e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.12085141e+03],
       [ 3.45058397e+03],
       [-3.56417236e+03],
       [-3.38418725e+00],
       [-1.61602579e+00],
       [-6.46151360e+00],
       [ 7.76794568e-01],
       [ 2.45567156e-01],
       [-5.63491648e-01],
       [ 1.36982237e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65312823e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.77765822e-03,  2.61748982e-03,  6.22422026e-04,
         2.24578912e-07,  1.87598956e-06, -2.61613782e-06],
       [ 2.61748982e-03,  5.48617648e-02,  2.84665445e-03,
        -2.47704105e-05,  3.99668308e-05, -3.23638426e-05],
       [ 6.22422026e-04,  2.84665445e-03,  2.86531406e-03,
         9.36413538e-07,  3.38948912e-06, -2.14654627e-06],
       [ 2.24578912e-07, -2.47704105e-05,  9.36413538e-07,
         1.57233315e-07,  5.42584039e-08,  1.59502853e-07],
       [ 1.87598956e-06,  3.99668308e-05,  3.38948912e-06,
         5.42584039e-08,  7.82620001e-08,  5.47621322e-08],
       [-2.61613782e-06, -3.23638426e-05, -2.14654627e-06,
         1.59502853e-07,  5.47621322e-08,  1.93154628e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.06276236e-05],
       [2.29700595e-06],
       [4.72456812e-03]])}}
Current time:  2018-07-13 19:32:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.12085141e+03],
       [ 3.45058397e+03],
       [-3.56417236e+03],
       [-3.38418725e+00],
       [-1.61602579e+00],
       [-6.46151360e+00],
       [ 7.76794568e-01],
       [ 2.45567156e-01],
       [-5.63491648e-01],
       [ 1.36982237e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65312823e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.77765822e-03,  2.61748982e-03,  6.22422026e-04,
         2.24578912e-07,  1.87598956e-06, -2.61613782e-06],
       [ 2.61748982e-03,  5.48617648e-02,  2.84665445e-03,
        -2.47704105e-05,  3.99668308e-05, -3.23638426e-05],
       [ 6.22422026e-04,  2.84665445e-03,  2.86531406e-03,
         9.36413538e-07,  3.38948912e-06, -2.14654627e-06],
       [ 2.24578912e-07, -2.47704105e-05,  9.36413538e-07,
         1.57233315e-07,  5.42584039e-08,  1.59502853e-07],
       [ 1.87598956e-06,  3.99668308e-05,  3.38948912e-06,
         5.42584039e-08,  7.82620001e-08,  5.47621322e-08],
       [-2.61613782e-06, -3.23638426e-05, -2.14654627e-06,
         1.59502853e-07,  5.47621322e-08,  1.93154628e-07]])}
[[ 5.12085141e+03]
 [ 3.45058397e+03]
 [-3.56417236e+03]
 [-3.38418725e+00]
 [-1.61602579e+00]
 [-6.46151360e+00]
 [ 7.76794568e-01]
 [ 2.45567156e-01]
 [-5.63491648e-01]
 [ 1.36982237e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65312823e-18]]
2018-07-13 19:32:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:32:30
[[ 5.08672883e+03]
 [ 3.43423426e+03]
 [-3.62858981e+03]
 [-3.44029794e+00]
 [-1.65387144e+00]
 [-6.42187224e+00]
 [ 7.73841813e-01]
 [ 2.44848582e-01]
 [-5.67539854e-01]
 [ 1.38262553e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65334052e-18]]
[[ 1.79849811e-03  2.39704180e-03  6.21399198e-04  1.87570492e-06
   2.42815910e-06 -1.06505169e-06]
 [ 2.39704180e-03  5.56674347e-02  2.55983005e-03 -2.36137502e-05
   4.06215820e-05 -3.22996774e-05]
 [ 6.21399198e-04  2.55983005e-03  2.84162031e-03  2.53095080e-06
   3.91094601e-06 -1.98570836e-07]
 [ 1.87570492e-06 -2.36137502e-05  2.53095080e-06  1.66653077e-07
   5.47637860e-08  1.59316495e-07]
 [ 2.42815910e-06  4.06215820e-05  3.91094601e-06  5.47637860e-08
   8.79851195e-08  5.44985022e-08]
 [-1.06505169e-06 -3.22996774e-05 -1.98570836e-07  1.59316495e-07
   5.44985022e-08  2.03725807e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.12088070e+03],
       [ 3.45063652e+03],
       [-3.56413400e+03],
       [-3.38383079e+00],
       [-1.61579250e+00],
       [-6.46120834e+00]]), 'covar': array([[ 1.12045763e-03,  4.72221776e-04,  2.57633062e-04,
         1.29518582e-06,  6.62257808e-07, -5.77941655e-08],
       [ 4.72221776e-04,  1.90243650e-03,  3.07048874e-04,
         8.00021404e-07,  1.76491655e-06,  1.45539785e-08],
       [ 2.57633062e-04,  3.07048874e-04,  1.38998244e-03,
         6.97313257e-07,  6.85165675e-07, -8.44339401e-07],
       [ 1.29518582e-06,  8.00021404e-07,  6.97313257e-07,
         2.37964568e-09,  1.39985104e-09,  4.73953548e-10],
       [ 6.62257808e-07,  1.76491655e-06,  6.85165675e-07,
         1.39985104e-09,  2.11826214e-09,  2.05783570e-10],
       [-5.77941655e-08,  1.45539785e-08, -8.44339401e-07,
         4.73953548e-10,  2.05783570e-10,  1.83910811e-09]])}
[[ 5.12088070e+03]
 [ 3.45063652e+03]
 [-3.56413400e+03]
 [-3.38383079e+00]
 [-1.61579250e+00]
 [-6.46120834e+00]]
2018-07-13 19:32:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:32:30
[[ 5.08676154e+03]
 [ 3.43428921e+03]
 [-3.62854838e+03]
 [-3.43994137e+00]
 [-1.65363828e+00]
 [-6.42156763e+00]]
[[ 1.14669121e-03  4.87136157e-04  2.63925717e-04  1.32858586e-06
   6.85580322e-07 -7.12118869e-08]
 [ 4.87136157e-04  1.93791528e-03  3.13907744e-04  8.35106827e-07
   1.78315264e-06 -5.48652714e-09]
 [ 2.63925717e-04  3.13907744e-04  1.37322408e-03  6.90532745e-07
   6.77963519e-07 -8.34458015e-07]
 [ 1.32858586e-06  8.35106827e-07  6.90532745e-07  2.49712459e-09
   1.42248856e-09  4.59559613e-10]
 [ 6.85580322e-07  1.78315264e-06  6.77963519e-07  1.42248856e-09
   2.21087436e-09  1.87786214e-10]
 [-7.12118869e-08 -5.48652714e-09 -8.34458015e-07  4.59559613e-10
   1.87786214e-10  1.94536514e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.08676154e+03],
       [ 3.43428921e+03],
       [-3.62854838e+03],
       [-3.43994137e+00],
       [-1.65363828e+00],
       [-6.42156763e+00]]), 'covar': array([[ 1.14669121e-03,  4.87136157e-04,  2.63925717e-04,
         1.32858586e-06,  6.85580322e-07, -7.12118869e-08],
       [ 4.87136157e-04,  1.93791528e-03,  3.13907744e-04,
         8.35106827e-07,  1.78315264e-06, -5.48652714e-09],
       [ 2.63925717e-04,  3.13907744e-04,  1.37322408e-03,
         6.90532745e-07,  6.77963519e-07, -8.34458015e-07],
       [ 1.32858586e-06,  8.35106827e-07,  6.90532745e-07,
         2.49712459e-09,  1.42248856e-09,  4.59559613e-10],
       [ 6.85580322e-07,  1.78315264e-06,  6.77963519e-07,
         1.42248856e-09,  2.21087436e-09,  1.87786214e-10],
       [-7.12118869e-08, -5.48652714e-09, -8.34458015e-07,
         4.59559613e-10,  1.87786214e-10,  1.94536514e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.31445643e-05],
       [-1.37529200e-05],
       [-1.09798626e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.08672883e+03],
       [ 3.43423426e+03],
       [-3.62858981e+03],
       [-3.44029794e+00],
       [-1.65387144e+00],
       [-6.42187224e+00],
       [ 7.73841813e-01],
       [ 2.44848582e-01],
       [-5.67539854e-01],
       [ 1.38262553e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65334052e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.79849811e-03,  2.39704180e-03,  6.21399198e-04,
         1.87570492e-06,  2.42815910e-06, -1.06505169e-06],
       [ 2.39704180e-03,  5.56674347e-02,  2.55983005e-03,
        -2.36137502e-05,  4.06215820e-05, -3.22996774e-05],
       [ 6.21399198e-04,  2.55983005e-03,  2.84162031e-03,
         2.53095080e-06,  3.91094601e-06, -1.98570836e-07],
       [ 1.87570492e-06, -2.36137502e-05,  2.53095080e-06,
         1.66653077e-07,  5.47637860e-08,  1.59316495e-07],
       [ 2.42815910e-06,  4.06215820e-05,  3.91094601e-06,
         5.47637860e-08,  8.79851195e-08,  5.44985022e-08],
       [-1.06505169e-06, -3.22996774e-05, -1.98570836e-07,
         1.59316495e-07,  5.44985022e-08,  2.03725807e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[1.06276236e-05],
       [2.29700595e-06],
       [4.72456812e-03]])}}
Yi [[ 1.5575848 ]
 [ 0.02042858]
 [15.31105725]]
posterior
[[ 5.08672883e+03]
 [ 3.43423426e+03]
 [-3.62858981e+03]
 [-3.44029794e+00]
 [-1.65387144e+00]
 [-6.42187224e+00]
 [ 7.73841813e-01]
 [ 2.44848582e-01]
 [-5.67539854e-01]
 [ 1.38262553e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65334052e-18]]
[[ 5.08679065e+03]
 [ 3.43430066e+03]
 [-3.62854310e+03]
 [-3.44019787e+00]
 [-1.65378085e+00]
 [-6.42188747e+00]
 [ 7.73841813e-01]
 [ 2.44848582e-01]
 [-5.67539854e-01]
 [ 1.38262553e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65334052e-18]]
[[ 1.09521704e-03  1.67684445e-03  2.19053267e-04  8.56319773e-07
   1.51424235e-06 -8.53374395e-07]
 [ 1.67684445e-03  5.47930657e-02  1.74660248e-03 -2.50132320e-05
   3.93044164e-05 -3.21858347e-05]
 [ 2.19053267e-04  1.74660248e-03  1.43287540e-03  9.02805613e-07
   2.26865029e-06 -3.80304827e-07]
 [ 8.56319773e-07 -2.50132320e-05  9.02805613e-07  1.64248935e-07
   5.24466499e-08  1.59354724e-07]
 [ 1.51424235e-06  3.93044164e-05  2.26865029e-06  5.24466499e-08
   8.57340590e-08  5.44860470e-08]
 [-8.53374395e-07 -3.21858347e-05 -3.80304827e-07  1.59354724e-07
   5.44860470e-08  2.03584182e-07]]
[[ 1.55765361]
 [ 0.02039485]
 [15.45727682]]
[[-6.88086250e-05]
 [ 3.37221134e-05]
 [-1.46219573e-01]]


 Corrector Step
2018-07-13 19:32:30
[[ 5.08679065e+03]
 [ 3.43430066e+03]
 [-3.62854310e+03]
 [-3.44019787e+00]
 [-1.65378085e+00]
 [-6.42188747e+00]
 [ 7.73841813e-01]
 [ 2.44848582e-01]
 [-5.67539854e-01]
 [ 1.38262553e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65334052e-18]]
[[ 1.09521704e-03  1.67684445e-03  2.19053267e-04  8.56319773e-07
   1.51424235e-06 -8.53374395e-07]
 [ 1.67684445e-03  5.47930657e-02  1.74660248e-03 -2.50132320e-05
   3.93044164e-05 -3.21858347e-05]
 [ 2.19053267e-04  1.74660248e-03  1.43287540e-03  9.02805613e-07
   2.26865029e-06 -3.80304827e-07]
 [ 8.56319773e-07 -2.50132320e-05  9.02805613e-07  1.64248935e-07
   5.24466499e-08  1.59354724e-07]
 [ 1.51424235e-06  3.93044164e-05  2.26865029e-06  5.24466499e-08
   8.57340590e-08  5.44860470e-08]
 [-8.53374395e-07 -3.21858347e-05 -3.80304827e-07  1.59354724e-07
   5.44860470e-08  2.03584182e-07]]
12893749.006796667
post
cubesat_nadir
Ybar_post [[ 1.55762601]
 [ 0.02041545]
 [15.45777197]]
resids [[-4.12083257e-05]
 [ 1.31277046e-05]
 [-1.46714726e-01]]
posterior
[[ 5.08676154e+03]
 [ 3.43428921e+03]
 [-3.62854838e+03]
 [-3.43994137e+00]
 [-1.65363828e+00]
 [-6.42156763e+00]]
[[ 5.08679711e+03]
 [ 3.43430438e+03]
 [-3.62853233e+03]
 [-3.43989799e+00]
 [-1.65361485e+00]
 [-6.42157484e+00]]
[[ 8.12156862e-04  3.44256646e-04  1.30889188e-04  9.25535595e-07
   4.69882480e-07 -1.48120007e-08]
 [ 3.44256646e-04  1.87004209e-03  2.04818650e-04  6.47789596e-07
   1.67129821e-06  5.12863533e-08]
 [ 1.30889188e-04  2.04818650e-04  9.21424494e-04  4.14443986e-07
   4.41617653e-07 -5.62596222e-07]
 [ 9.25535595e-07  6.47789596e-07  4.14443986e-07  1.97790569e-09
   1.11890151e-09  5.99924923e-10]
 [ 4.69882480e-07  1.67129821e-06  4.41617653e-07  1.11890151e-09
   2.01496475e-09  3.18302915e-10]
 [-1.48120007e-08  5.12863533e-08 -5.62596222e-07  5.99924923e-10
   3.18302915e-10  1.77988342e-09]]
[[ 1.55763915]
 [ 0.02041316]
 [16.89296603]]
[[-5.43544986e-05]
 [ 1.54178995e-05]
 [-1.58190878e+00]]


 Corrector Step
2018-07-13 19:32:30
[[ 5.08679711e+03]
 [ 3.43430438e+03]
 [-3.62853233e+03]
 [-3.43989799e+00]
 [-1.65361485e+00]
 [-6.42157484e+00]]
[[ 8.12156862e-04  3.44256646e-04  1.30889188e-04  9.25535595e-07
   4.69882480e-07 -1.48120007e-08]
 [ 3.44256646e-04  1.87004209e-03  2.04818650e-04  6.47789596e-07
   1.67129821e-06  5.12863533e-08]
 [ 1.30889188e-04  2.04818650e-04  9.21424494e-04  4.14443986e-07
   4.41617653e-07 -5.62596222e-07]
 [ 9.25535595e-07  6.47789596e-07  4.14443986e-07  1.97790569e-09
   1.11890151e-09  5.99924923e-10]
 [ 4.69882480e-07  1.67129821e-06  4.41617653e-07  1.11890151e-09
   2.01496475e-09  3.18302915e-10]
 [-1.48120007e-08  5.12863533e-08 -5.62596222e-07  5.99924923e-10
   3.18302915e-10  1.77988342e-09]]
5.270584673897475e-47
post
sphere_lamr_small
Ybar_post [[ 1.5576231 ]
 [ 0.02042031]
 [16.8929429 ]]
resids [[-3.82978632e-05]
 [ 8.27093441e-06]
 [-1.58188566e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [12893749.006796667, 5.270584673897475e-47]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 5.08679065e+03],
       [ 3.43430066e+03],
       [-3.62854310e+03],
       [-3.44019787e+00],
       [-1.65378085e+00],
       [-6.42188747e+00]]), 'est_covars': array([[ 1.09521704e-03,  1.67684445e-03,  2.19053267e-04,
         8.56319773e-07,  1.51424235e-06, -8.53374395e-07],
       [ 1.67684445e-03,  5.47930657e-02,  1.74660248e-03,
        -2.50132320e-05,  3.93044164e-05, -3.21858347e-05],
       [ 2.19053267e-04,  1.74660248e-03,  1.43287540e-03,
         9.02805613e-07,  2.26865029e-06, -3.80304827e-07],
       [ 8.56319773e-07, -2.50132320e-05,  9.02805613e-07,
         1.64248935e-07,  5.24466499e-08,  1.59354724e-07],
       [ 1.51424235e-06,  3.93044164e-05,  2.26865029e-06,
         5.24466499e-08,  8.57340590e-08,  5.44860470e-08],
       [-8.53374395e-07, -3.21858347e-05, -3.80304827e-07,
         1.59354724e-07,  5.44860470e-08,  2.03584182e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.08679711e+03],
       [ 3.43430438e+03],
       [-3.62853233e+03],
       [-3.43989799e+00],
       [-1.65361485e+00],
       [-6.42157484e+00]]), 'covar': array([[ 8.12156862e-04,  3.44256646e-04,  1.30889188e-04,
         9.25535595e-07,  4.69882480e-07, -1.48120007e-08],
       [ 3.44256646e-04,  1.87004209e-03,  2.04818650e-04,
         6.47789596e-07,  1.67129821e-06,  5.12863533e-08],
       [ 1.30889188e-04,  2.04818650e-04,  9.21424494e-04,
         4.14443986e-07,  4.41617653e-07, -5.62596222e-07],
       [ 9.25535595e-07,  6.47789596e-07,  4.14443986e-07,
         1.97790569e-09,  1.11890151e-09,  5.99924923e-10],
       [ 4.69882480e-07,  1.67129821e-06,  4.41617653e-07,
         1.11890151e-09,  2.01496475e-09,  3.18302915e-10],
       [-1.48120007e-08,  5.12863533e-08, -5.62596222e-07,
         5.99924923e-10,  3.18302915e-10,  1.77988342e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.82978632e-05],
       [ 8.27093441e-06],
       [-1.58188566e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.08679065e+03],
       [ 3.43430066e+03],
       [-3.62854310e+03],
       [-3.44019787e+00],
       [-1.65378085e+00],
       [-6.42188747e+00],
       [ 7.73841813e-01],
       [ 2.44848582e-01],
       [-5.67539854e-01],
       [ 1.38262553e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65334052e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.09521704e-03,  1.67684445e-03,  2.19053267e-04,
         8.56319773e-07,  1.51424235e-06, -8.53374395e-07],
       [ 1.67684445e-03,  5.47930657e-02,  1.74660248e-03,
        -2.50132320e-05,  3.93044164e-05, -3.21858347e-05],
       [ 2.19053267e-04,  1.74660248e-03,  1.43287540e-03,
         9.02805613e-07,  2.26865029e-06, -3.80304827e-07],
       [ 8.56319773e-07, -2.50132320e-05,  9.02805613e-07,
         1.64248935e-07,  5.24466499e-08,  1.59354724e-07],
       [ 1.51424235e-06,  3.93044164e-05,  2.26865029e-06,
         5.24466499e-08,  8.57340590e-08,  5.44860470e-08],
       [-8.53374395e-07, -3.21858347e-05, -3.80304827e-07,
         1.59354724e-07,  5.44860470e-08,  2.03584182e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-4.12083257e-05],
       [ 1.31277046e-05],
       [-1.46714726e-01]])}}
Current time:  2018-07-13 19:32:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.08679065e+03],
       [ 3.43430066e+03],
       [-3.62854310e+03],
       [-3.44019787e+00],
       [-1.65378085e+00],
       [-6.42188747e+00],
       [ 7.73841813e-01],
       [ 2.44848582e-01],
       [-5.67539854e-01],
       [ 1.38262553e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65334052e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.09521704e-03,  1.67684445e-03,  2.19053267e-04,
         8.56319773e-07,  1.51424235e-06, -8.53374395e-07],
       [ 1.67684445e-03,  5.47930657e-02,  1.74660248e-03,
        -2.50132320e-05,  3.93044164e-05, -3.21858347e-05],
       [ 2.19053267e-04,  1.74660248e-03,  1.43287540e-03,
         9.02805613e-07,  2.26865029e-06, -3.80304827e-07],
       [ 8.56319773e-07, -2.50132320e-05,  9.02805613e-07,
         1.64248935e-07,  5.24466499e-08,  1.59354724e-07],
       [ 1.51424235e-06,  3.93044164e-05,  2.26865029e-06,
         5.24466499e-08,  8.57340590e-08,  5.44860470e-08],
       [-8.53374395e-07, -3.21858347e-05, -3.80304827e-07,
         1.59354724e-07,  5.44860470e-08,  2.03584182e-07]])}
[[ 5.08679065e+03]
 [ 3.43430066e+03]
 [-3.62854310e+03]
 [-3.44019787e+00]
 [-1.65378085e+00]
 [-6.42188747e+00]
 [ 7.73841813e-01]
 [ 2.44848582e-01]
 [-5.67539854e-01]
 [ 1.38262553e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65334052e-18]]
2018-07-13 19:32:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:32:40
[[ 5.05210951e+03]
 [ 3.41757434e+03]
 [-3.69256061e+03]
 [-3.49592232e+00]
 [-1.69143961e+00]
 [-6.38154493e+00]
 [ 7.70867962e-01]
 [ 2.44123332e-01]
 [-5.71572589e-01]
 [ 1.39539099e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65355281e-18]]
[[ 1.12935790e-03  1.45024526e-03  2.35202206e-04  2.56689194e-06
   2.04659058e-06  7.12467662e-07]
 [ 1.45024526e-03  5.55861735e-02  1.45038373e-03 -2.38758570e-05
   4.00278810e-05 -3.21149983e-05]
 [ 2.35202206e-04  1.45038373e-03  1.44586647e-03  2.49752957e-06
   2.79772268e-06  1.68932212e-06]
 [ 2.56689194e-06 -2.38758570e-05  2.49752957e-06  1.73677055e-07
   5.29600562e-08  1.59160385e-07]
 [ 2.04659058e-06  4.00278810e-05  2.79772268e-06  5.29600562e-08
   9.54640276e-08  5.42384388e-08]
 [ 7.12467662e-07 -3.21149983e-05  1.68932212e-06  1.59160385e-07
   5.42384388e-08  2.14107791e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.08679711e+03],
       [ 3.43430438e+03],
       [-3.62853233e+03],
       [-3.43989799e+00],
       [-1.65361485e+00],
       [-6.42157484e+00]]), 'covar': array([[ 8.12156862e-04,  3.44256646e-04,  1.30889188e-04,
         9.25535595e-07,  4.69882480e-07, -1.48120007e-08],
       [ 3.44256646e-04,  1.87004209e-03,  2.04818650e-04,
         6.47789596e-07,  1.67129821e-06,  5.12863533e-08],
       [ 1.30889188e-04,  2.04818650e-04,  9.21424494e-04,
         4.14443986e-07,  4.41617653e-07, -5.62596222e-07],
       [ 9.25535595e-07,  6.47789596e-07,  4.14443986e-07,
         1.97790569e-09,  1.11890151e-09,  5.99924923e-10],
       [ 4.69882480e-07,  1.67129821e-06,  4.41617653e-07,
         1.11890151e-09,  2.01496475e-09,  3.18302915e-10],
       [-1.48120007e-08,  5.12863533e-08, -5.62596222e-07,
         5.99924923e-10,  3.18302915e-10,  1.77988342e-09]])}
[[ 5.08679711e+03]
 [ 3.43430438e+03]
 [-3.62853233e+03]
 [-3.43989799e+00]
 [-1.65361485e+00]
 [-6.42157484e+00]]
2018-07-13 19:32:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:32:40
[[ 5.05211914e+03]
 [ 3.41757963e+03]
 [-3.69254674e+03]
 [-3.49562243e+00]
 [-1.69127364e+00]
 [-6.38123222e+00]]
[[ 8.30942304e-04  3.55704810e-04  1.34814862e-04  9.52827903e-07
   4.88142637e-07 -2.19870630e-08]
 [ 3.55704810e-04  1.90372501e-03  2.09526930e-04  6.79589522e-07
   1.68772937e-06  3.40703558e-08]
 [ 1.34814862e-04  2.09526930e-04  9.10448233e-04  4.12665560e-07
   4.38078255e-07 -5.49368747e-07]
 [ 9.52827903e-07  6.79589522e-07  4.12665560e-07  2.09388732e-09
   1.14019581e-09  5.89809204e-10]
 [ 4.88142637e-07  1.68772937e-06  4.38078255e-07  1.14019581e-09
   2.10719086e-09  3.02084862e-10]
 [-2.19870630e-08  3.40703558e-08 -5.49368747e-07  5.89809204e-10
   3.02084862e-10  1.88270053e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.05211914e+03],
       [ 3.41757963e+03],
       [-3.69254674e+03],
       [-3.49562243e+00],
       [-1.69127364e+00],
       [-6.38123222e+00]]), 'covar': array([[ 8.30942304e-04,  3.55704810e-04,  1.34814862e-04,
         9.52827903e-07,  4.88142637e-07, -2.19870630e-08],
       [ 3.55704810e-04,  1.90372501e-03,  2.09526930e-04,
         6.79589522e-07,  1.68772937e-06,  3.40703558e-08],
       [ 1.34814862e-04,  2.09526930e-04,  9.10448233e-04,
         4.12665560e-07,  4.38078255e-07, -5.49368747e-07],
       [ 9.52827903e-07,  6.79589522e-07,  4.12665560e-07,
         2.09388732e-09,  1.14019581e-09,  5.89809204e-10],
       [ 4.88142637e-07,  1.68772937e-06,  4.38078255e-07,
         1.14019581e-09,  2.10719086e-09,  3.02084862e-10],
       [-2.19870630e-08,  3.40703558e-08, -5.49368747e-07,
         5.89809204e-10,  3.02084862e-10,  1.88270053e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-3.82978632e-05],
       [ 8.27093441e-06],
       [-1.58188566e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.05210951e+03],
       [ 3.41757434e+03],
       [-3.69256061e+03],
       [-3.49592232e+00],
       [-1.69143961e+00],
       [-6.38154493e+00],
       [ 7.70867962e-01],
       [ 2.44123332e-01],
       [-5.71572589e-01],
       [ 1.39539099e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65355281e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.12935790e-03,  1.45024526e-03,  2.35202206e-04,
         2.56689194e-06,  2.04659058e-06,  7.12467662e-07],
       [ 1.45024526e-03,  5.55861735e-02,  1.45038373e-03,
        -2.38758570e-05,  4.00278810e-05, -3.21149983e-05],
       [ 2.35202206e-04,  1.45038373e-03,  1.44586647e-03,
         2.49752957e-06,  2.79772268e-06,  1.68932212e-06],
       [ 2.56689194e-06, -2.38758570e-05,  2.49752957e-06,
         1.73677055e-07,  5.29600562e-08,  1.59160385e-07],
       [ 2.04659058e-06,  4.00278810e-05,  2.79772268e-06,
         5.29600562e-08,  9.54640276e-08,  5.42384388e-08],
       [ 7.12467662e-07, -3.21149983e-05,  1.68932212e-06,
         1.59160385e-07,  5.42384388e-08,  2.14107791e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-4.12083257e-05],
       [ 1.31277046e-05],
       [-1.46714726e-01]])}}
Yi [[ 1.57302002e+00]
 [-8.76450481e-03]
 [ 1.50433361e+01]]
posterior
[[ 5.05210951e+03]
 [ 3.41757434e+03]
 [-3.69256061e+03]
 [-3.49592232e+00]
 [-1.69143961e+00]
 [-6.38154493e+00]
 [ 7.70867962e-01]
 [ 2.44123332e-01]
 [-5.71572589e-01]
 [ 1.39539099e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65355281e-18]]
[[ 5.05209348e+03]
 [ 3.41754333e+03]
 [-3.69257148e+03]
 [-3.49596704e+00]
 [-1.69148429e+00]
 [-6.38156061e+00]
 [ 7.70867962e-01]
 [ 2.44123332e-01]
 [-5.71572589e-01]
 [ 1.39539099e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65355281e-18]]
[[ 7.95683135e-04  9.21308375e-04  1.07027742e-04  1.75450349e-06
   1.30721957e-06  4.71158511e-07]
 [ 9.21308375e-04  5.41638016e-02  7.31868355e-04 -2.58004045e-05
   3.78733119e-05 -3.29618612e-05]
 [ 1.07027742e-04  7.31868355e-04  9.41604724e-04  1.62309532e-06
   1.64632476e-06  1.18647098e-06]
 [ 1.75450349e-06 -2.58004045e-05  1.62309532e-06  1.71004035e-07
   5.00880217e-08  1.58065863e-07]
 [ 1.30721957e-06  3.78733119e-05  1.64632476e-06  5.00880217e-08
   9.21721447e-08  5.29220010e-08]
 [ 4.71158511e-07 -3.29618612e-05  1.18647098e-06  1.58065863e-07
   5.29220010e-08  2.13563452e-07]]
[[ 1.57299602e+00]
 [-8.75260041e-03]
 [ 1.50929947e+01]]
[[ 2.40007751e-05]
 [-1.19044027e-05]
 [-4.96586312e-02]]


 Corrector Step
2018-07-13 19:32:40
[[ 5.05209348e+03]
 [ 3.41754333e+03]
 [-3.69257148e+03]
 [-3.49596704e+00]
 [-1.69148429e+00]
 [-6.38156061e+00]
 [ 7.70867962e-01]
 [ 2.44123332e-01]
 [-5.71572589e-01]
 [ 1.39539099e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65355281e-18]]
[[ 7.95683135e-04  9.21308375e-04  1.07027742e-04  1.75450349e-06
   1.30721957e-06  4.71158511e-07]
 [ 9.21308375e-04  5.41638016e-02  7.31868355e-04 -2.58004045e-05
   3.78733119e-05 -3.29618612e-05]
 [ 1.07027742e-04  7.31868355e-04  9.41604724e-04  1.62309532e-06
   1.64632476e-06  1.18647098e-06]
 [ 1.75450349e-06 -2.58004045e-05  1.62309532e-06  1.71004035e-07
   5.00880217e-08  1.58065863e-07]
 [ 1.30721957e-06  3.78733119e-05  1.64632476e-06  5.00880217e-08
   9.21721447e-08  5.29220010e-08]
 [ 4.71158511e-07 -3.29618612e-05  1.18647098e-06  1.58065863e-07
   5.29220010e-08  2.13563452e-07]]
434108831.1620816
post
cubesat_nadir
Ybar_post [[ 1.57300349e+00]
 [-8.75770978e-03]
 [ 1.50928649e+01]]
resids [[ 1.65281059e-05]
 [-6.79503046e-06]
 [-4.95288278e-02]]
posterior
[[ 5.05211914e+03]
 [ 3.41757963e+03]
 [-3.69254674e+03]
 [-3.49562243e+00]
 [-1.69127364e+00]
 [-6.38123222e+00]]
[[ 5.05210400e+03]
 [ 3.41757104e+03]
 [-3.69255848e+03]
 [-3.49564255e+00]
 [-1.69128671e+00]
 [-6.38122616e+00]]
[[ 6.37097567e-04  2.67054999e-04  7.77730052e-05  7.22945368e-07
   3.62865316e-07 -1.24104566e-09]
 [ 2.67054999e-04  1.85581319e-03  1.44052306e-04  5.62934511e-07
   1.61400271e-06  6.77010743e-08]
 [ 7.77730052e-05  1.44052306e-04  6.83154504e-04  2.83428137e-07
   3.13381746e-07 -4.14231771e-07]
 [ 7.22945368e-07  5.62934511e-07  2.83428137e-07  1.80324680e-09
   9.65930117e-10  6.52164572e-10]
 [ 3.62865316e-07  1.61400271e-06  3.13381746e-07  9.65930117e-10
   1.98958029e-09  3.69329400e-10]
 [-1.24104566e-09  6.77010743e-08 -4.14231771e-07  6.52164572e-10
   3.69329400e-10  1.80138929e-09]]
[[ 1.57299164e+00]
 [-8.74621770e-03]
 [ 1.68144901e+01]]
[[ 2.83817165e-05]
 [-1.82871055e-05]
 [-1.77115402e+00]]


 Corrector Step
2018-07-13 19:32:40
[[ 5.05210400e+03]
 [ 3.41757104e+03]
 [-3.69255848e+03]
 [-3.49564255e+00]
 [-1.69128671e+00]
 [-6.38122616e+00]]
[[ 6.37097567e-04  2.67054999e-04  7.77730052e-05  7.22945368e-07
   3.62865316e-07 -1.24104566e-09]
 [ 2.67054999e-04  1.85581319e-03  1.44052306e-04  5.62934511e-07
   1.61400271e-06  6.77010743e-08]
 [ 7.77730052e-05  1.44052306e-04  6.83154504e-04  2.83428137e-07
   3.13381746e-07 -4.14231771e-07]
 [ 7.22945368e-07  5.62934511e-07  2.83428137e-07  1.80324680e-09
   9.65930117e-10  6.52164572e-10]
 [ 3.62865316e-07  1.61400271e-06  3.13381746e-07  9.65930117e-10
   1.98958029e-09  3.69329400e-10]
 [-1.24104566e-09  6.77010743e-08 -4.14231771e-07  6.52164572e-10
   3.69329400e-10  1.80138929e-09]]
3.057812950250279e-60
post
sphere_lamr_small
Ybar_post [[ 1.57299864e+00]
 [-8.75163313e-03]
 [ 1.68144868e+01]]
resids [[ 2.13816819e-05]
 [-1.28716799e-05]
 [-1.77115076e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [434108831.1620816, 3.057812950250279e-60]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 5.05209348e+03],
       [ 3.41754333e+03],
       [-3.69257148e+03],
       [-3.49596704e+00],
       [-1.69148429e+00],
       [-6.38156061e+00]]), 'est_covars': array([[ 7.95683135e-04,  9.21308375e-04,  1.07027742e-04,
         1.75450349e-06,  1.30721957e-06,  4.71158511e-07],
       [ 9.21308375e-04,  5.41638016e-02,  7.31868355e-04,
        -2.58004045e-05,  3.78733119e-05, -3.29618612e-05],
       [ 1.07027742e-04,  7.31868355e-04,  9.41604724e-04,
         1.62309532e-06,  1.64632476e-06,  1.18647098e-06],
       [ 1.75450349e-06, -2.58004045e-05,  1.62309532e-06,
         1.71004035e-07,  5.00880217e-08,  1.58065863e-07],
       [ 1.30721957e-06,  3.78733119e-05,  1.64632476e-06,
         5.00880217e-08,  9.21721447e-08,  5.29220010e-08],
       [ 4.71158511e-07, -3.29618612e-05,  1.18647098e-06,
         1.58065863e-07,  5.29220010e-08,  2.13563452e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.05210400e+03],
       [ 3.41757104e+03],
       [-3.69255848e+03],
       [-3.49564255e+00],
       [-1.69128671e+00],
       [-6.38122616e+00]]), 'covar': array([[ 6.37097567e-04,  2.67054999e-04,  7.77730052e-05,
         7.22945368e-07,  3.62865316e-07, -1.24104566e-09],
       [ 2.67054999e-04,  1.85581319e-03,  1.44052306e-04,
         5.62934511e-07,  1.61400271e-06,  6.77010743e-08],
       [ 7.77730052e-05,  1.44052306e-04,  6.83154504e-04,
         2.83428137e-07,  3.13381746e-07, -4.14231771e-07],
       [ 7.22945368e-07,  5.62934511e-07,  2.83428137e-07,
         1.80324680e-09,  9.65930117e-10,  6.52164572e-10],
       [ 3.62865316e-07,  1.61400271e-06,  3.13381746e-07,
         9.65930117e-10,  1.98958029e-09,  3.69329400e-10],
       [-1.24104566e-09,  6.77010743e-08, -4.14231771e-07,
         6.52164572e-10,  3.69329400e-10,  1.80138929e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.13816819e-05],
       [-1.28716799e-05],
       [-1.77115076e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.05209348e+03],
       [ 3.41754333e+03],
       [-3.69257148e+03],
       [-3.49596704e+00],
       [-1.69148429e+00],
       [-6.38156061e+00],
       [ 7.70867962e-01],
       [ 2.44123332e-01],
       [-5.71572589e-01],
       [ 1.39539099e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65355281e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.95683135e-04,  9.21308375e-04,  1.07027742e-04,
         1.75450349e-06,  1.30721957e-06,  4.71158511e-07],
       [ 9.21308375e-04,  5.41638016e-02,  7.31868355e-04,
        -2.58004045e-05,  3.78733119e-05, -3.29618612e-05],
       [ 1.07027742e-04,  7.31868355e-04,  9.41604724e-04,
         1.62309532e-06,  1.64632476e-06,  1.18647098e-06],
       [ 1.75450349e-06, -2.58004045e-05,  1.62309532e-06,
         1.71004035e-07,  5.00880217e-08,  1.58065863e-07],
       [ 1.30721957e-06,  3.78733119e-05,  1.64632476e-06,
         5.00880217e-08,  9.21721447e-08,  5.29220010e-08],
       [ 4.71158511e-07, -3.29618612e-05,  1.18647098e-06,
         1.58065863e-07,  5.29220010e-08,  2.13563452e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.65281059e-05],
       [-6.79503046e-06],
       [-4.95288278e-02]])}}
Current time:  2018-07-13 19:32:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.05209348e+03],
       [ 3.41754333e+03],
       [-3.69257148e+03],
       [-3.49596704e+00],
       [-1.69148429e+00],
       [-6.38156061e+00],
       [ 7.70867962e-01],
       [ 2.44123332e-01],
       [-5.71572589e-01],
       [ 1.39539099e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65355281e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.95683135e-04,  9.21308375e-04,  1.07027742e-04,
         1.75450349e-06,  1.30721957e-06,  4.71158511e-07],
       [ 9.21308375e-04,  5.41638016e-02,  7.31868355e-04,
        -2.58004045e-05,  3.78733119e-05, -3.29618612e-05],
       [ 1.07027742e-04,  7.31868355e-04,  9.41604724e-04,
         1.62309532e-06,  1.64632476e-06,  1.18647098e-06],
       [ 1.75450349e-06, -2.58004045e-05,  1.62309532e-06,
         1.71004035e-07,  5.00880217e-08,  1.58065863e-07],
       [ 1.30721957e-06,  3.78733119e-05,  1.64632476e-06,
         5.00880217e-08,  9.21721447e-08,  5.29220010e-08],
       [ 4.71158511e-07, -3.29618612e-05,  1.18647098e-06,
         1.58065863e-07,  5.29220010e-08,  2.13563452e-07]])}
[[ 5.05209348e+03]
 [ 3.41754333e+03]
 [-3.69257148e+03]
 [-3.49596704e+00]
 [-1.69148429e+00]
 [-6.38156061e+00]
 [ 7.70867962e-01]
 [ 2.44123332e-01]
 [-5.71572589e-01]
 [ 1.39539099e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65355281e-18]]
2018-07-13 19:32:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:32:50
[[ 5.01685666e+03]
 [ 3.40044096e+03]
 [-3.75618247e+03]
 [-3.55130042e+00]
 [-1.72895217e+00]
 [-6.34051985e+00]
 [ 7.67873094e-01]
 [ 2.43391427e-01]
 [-5.75589740e-01]
 [ 1.40811841e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65376509e-18]]
[[ 8.48300309e-04  6.84457428e-04  1.43663206e-04  3.52339473e-06
   1.81592693e-06  2.03393198e-06]
 [ 6.84457428e-04  5.49288923e-02  4.21654035e-04 -2.46934451e-05
   3.86588847e-05 -3.28951137e-05]
 [ 1.43663206e-04  4.21654035e-04  9.86872484e-04  3.19807521e-06
   2.16584815e-06  3.36652856e-06]
 [ 3.52339473e-06 -2.46934451e-05  3.19807521e-06  1.80412254e-07
   5.05948542e-08  1.57851079e-07]
 [ 1.81592693e-06  3.86588847e-05  2.16584815e-06  5.05948542e-08
   1.01910329e-07  5.26928293e-08]
 [ 2.03393198e-06 -3.28951137e-05  3.36652856e-06  1.57851079e-07
   5.26928293e-08  2.24067978e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.05210400e+03],
       [ 3.41757104e+03],
       [-3.69255848e+03],
       [-3.49564255e+00],
       [-1.69128671e+00],
       [-6.38122616e+00]]), 'covar': array([[ 6.37097567e-04,  2.67054999e-04,  7.77730052e-05,
         7.22945368e-07,  3.62865316e-07, -1.24104566e-09],
       [ 2.67054999e-04,  1.85581319e-03,  1.44052306e-04,
         5.62934511e-07,  1.61400271e-06,  6.77010743e-08],
       [ 7.77730052e-05,  1.44052306e-04,  6.83154504e-04,
         2.83428137e-07,  3.13381746e-07, -4.14231771e-07],
       [ 7.22945368e-07,  5.62934511e-07,  2.83428137e-07,
         1.80324680e-09,  9.65930117e-10,  6.52164572e-10],
       [ 3.62865316e-07,  1.61400271e-06,  3.13381746e-07,
         9.65930117e-10,  1.98958029e-09,  3.69329400e-10],
       [-1.24104566e-09,  6.77010743e-08, -4.14231771e-07,
         6.52164572e-10,  3.69329400e-10,  1.80138929e-09]])}
[[ 5.05210400e+03]
 [ 3.41757104e+03]
 [-3.69255848e+03]
 [-3.49564255e+00]
 [-1.69128671e+00]
 [-6.38122616e+00]]
2018-07-13 19:32:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:32:50
[[ 5.01687042e+03]
 [ 3.40047041e+03]
 [-3.75616596e+03]
 [-3.55097576e+00]
 [-1.72875462e+00]
 [-6.34018569e+00]]
[[ 6.51905773e-04  2.76700318e-04  8.04864356e-05  7.47049470e-07
   3.78125088e-07 -5.12111569e-09]
 [ 2.76700318e-04  1.88847623e-03  1.47648643e-04  5.93123101e-07
   1.62959125e-06  5.21145911e-08]
 [ 8.04864356e-05  1.47648643e-04  6.75091247e-04  2.83717908e-07
   3.11819884e-07 -3.99132848e-07]
 [ 7.47049470e-07  5.93123101e-07  2.83717908e-07  1.91716526e-09
   9.86000886e-10  6.43533647e-10]
 [ 3.78125088e-07  1.62959125e-06  3.11819884e-07  9.86000886e-10
   2.08145607e-09  3.53986317e-10]
 [-5.12111569e-09  5.21145911e-08 -3.99132848e-07  6.43533647e-10
   3.53986317e-10  1.90215956e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.01687042e+03],
       [ 3.40047041e+03],
       [-3.75616596e+03],
       [-3.55097576e+00],
       [-1.72875462e+00],
       [-6.34018569e+00]]), 'covar': array([[ 6.51905773e-04,  2.76700318e-04,  8.04864356e-05,
         7.47049470e-07,  3.78125088e-07, -5.12111569e-09],
       [ 2.76700318e-04,  1.88847623e-03,  1.47648643e-04,
         5.93123101e-07,  1.62959125e-06,  5.21145911e-08],
       [ 8.04864356e-05,  1.47648643e-04,  6.75091247e-04,
         2.83717908e-07,  3.11819884e-07, -3.99132848e-07],
       [ 7.47049470e-07,  5.93123101e-07,  2.83717908e-07,
         1.91716526e-09,  9.86000886e-10,  6.43533647e-10],
       [ 3.78125088e-07,  1.62959125e-06,  3.11819884e-07,
         9.86000886e-10,  2.08145607e-09,  3.53986317e-10],
       [-5.12111569e-09,  5.21145911e-08, -3.99132848e-07,
         6.43533647e-10,  3.53986317e-10,  1.90215956e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.13816819e-05],
       [-1.28716799e-05],
       [-1.77115076e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.01685666e+03],
       [ 3.40044096e+03],
       [-3.75618247e+03],
       [-3.55130042e+00],
       [-1.72895217e+00],
       [-6.34051985e+00],
       [ 7.67873094e-01],
       [ 2.43391427e-01],
       [-5.75589740e-01],
       [ 1.40811841e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65376509e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.48300309e-04,  6.84457428e-04,  1.43663206e-04,
         3.52339473e-06,  1.81592693e-06,  2.03393198e-06],
       [ 6.84457428e-04,  5.49288923e-02,  4.21654035e-04,
        -2.46934451e-05,  3.86588847e-05, -3.28951137e-05],
       [ 1.43663206e-04,  4.21654035e-04,  9.86872484e-04,
         3.19807521e-06,  2.16584815e-06,  3.36652856e-06],
       [ 3.52339473e-06, -2.46934451e-05,  3.19807521e-06,
         1.80412254e-07,  5.05948542e-08,  1.57851079e-07],
       [ 1.81592693e-06,  3.86588847e-05,  2.16584815e-06,
         5.05948542e-08,  1.01910329e-07,  5.26928293e-08],
       [ 2.03393198e-06, -3.28951137e-05,  3.36652856e-06,
         1.57851079e-07,  5.26928293e-08,  2.24067978e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.65281059e-05],
       [-6.79503046e-06],
       [-4.95288278e-02]])}}
Yi [[ 1.58893355]
 [-0.03824783]
 [14.76493483]]
posterior
[[ 5.01685666e+03]
 [ 3.40044096e+03]
 [-3.75618247e+03]
 [-3.55130042e+00]
 [-1.72895217e+00]
 [-6.34051985e+00]
 [ 7.67873094e-01]
 [ 2.43391427e-01]
 [-5.75589740e-01]
 [ 1.40811841e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65376509e-18]]
[[ 5.01685294e+03]
 [ 3.40046980e+03]
 [-3.75616710e+03]
 [-3.55128663e+00]
 [-1.72891121e+00]
 [-6.34049604e+00]
 [ 7.67873094e-01]
 [ 2.43391427e-01]
 [-5.75589740e-01]
 [ 1.40811841e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65376509e-18]]
[[ 6.40729063e-04  2.11552487e-04  7.71497425e-05  2.73088593e-06
   1.11179521e-06  1.63100448e-06]
 [ 2.11552487e-04  5.26183730e-02 -2.76728956e-04 -2.74233387e-05
   3.52845030e-05 -3.48372143e-05]
 [ 7.71497425e-05 -2.76728956e-04  7.22993560e-04  2.53405061e-06
   1.15510472e-06  2.78306346e-06]
 [ 2.73088593e-06 -2.74233387e-05  2.53405061e-06  1.76693107e-07
   4.65792783e-08  1.55544484e-07]
 [ 1.11179521e-06  3.52845030e-05  1.15510472e-06  4.65792783e-08
   9.69804320e-08  4.98555215e-08]
 [ 1.63100448e-06 -3.48372143e-05  2.78306346e-06  1.55544484e-07
   4.98555215e-08  2.22434660e-07]]
[[ 1.58892247]
 [-0.03827638]
 [14.76869869]]
[[ 1.10810803e-05]
 [ 2.85464958e-05]
 [-3.76386422e-03]]


 Corrector Step
2018-07-13 19:32:50
[[ 5.01685294e+03]
 [ 3.40046980e+03]
 [-3.75616710e+03]
 [-3.55128663e+00]
 [-1.72891121e+00]
 [-6.34049604e+00]
 [ 7.67873094e-01]
 [ 2.43391427e-01]
 [-5.75589740e-01]
 [ 1.40811841e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65376509e-18]]
[[ 6.40729063e-04  2.11552487e-04  7.71497425e-05  2.73088593e-06
   1.11179521e-06  1.63100448e-06]
 [ 2.11552487e-04  5.26183730e-02 -2.76728956e-04 -2.74233387e-05
   3.52845030e-05 -3.48372143e-05]
 [ 7.71497425e-05 -2.76728956e-04  7.22993560e-04  2.53405061e-06
   1.15510472e-06  2.78306346e-06]
 [ 2.73088593e-06 -2.74233387e-05  2.53405061e-06  1.76693107e-07
   4.65792783e-08  1.55544484e-07]
 [ 1.11179521e-06  3.52845030e-05  1.15510472e-06  4.65792783e-08
   9.69804320e-08  4.98555215e-08]
 [ 1.63100448e-06 -3.48372143e-05  2.78306346e-06  1.55544484e-07
   4.98555215e-08  2.22434660e-07]]
436293760.9701789
post
cubesat_nadir
Ybar_post [[ 1.58892399]
 [-0.03826876]
 [14.76877929]]
resids [[ 9.56091863e-06]
 [ 2.09288088e-05]
 [-3.84446045e-03]]
posterior
[[ 5.01687042e+03]
 [ 3.40047041e+03]
 [-3.75616596e+03]
 [-3.55097576e+00]
 [-1.72875462e+00]
 [-6.34018569e+00]]
[[ 5.01686410e+03]
 [ 3.40046935e+03]
 [-3.75615819e+03]
 [-3.55098052e+00]
 [-1.72875475e+00]
 [-6.34019075e+00]]
[[ 5.23618765e-04  2.12256060e-04  5.01482116e-05  5.94820550e-07
   2.91823081e-07  4.04855029e-09]
 [ 2.12256060e-04  1.84710613e-03  9.83657657e-05  5.06408539e-07
   1.57007635e-06  7.68936224e-08]
 [ 5.01482116e-05  9.83657657e-05  5.39100922e-04  2.08958036e-07
   2.30256900e-07 -3.20631723e-07]
 [ 5.94820550e-07  5.06408539e-07  2.08958036e-07  1.72486370e-09
   8.65191814e-10  6.77382541e-10]
 [ 2.91823081e-07  1.57007635e-06  2.30256900e-07  8.65191814e-10
   1.99436632e-09  3.96392939e-10]
 [ 4.04855029e-09  7.68936224e-08 -3.20631723e-07  6.77382541e-10
   3.96392939e-10  1.85627154e-09]]
[[ 1.58891582]
 [-0.03826823]
 [16.73031569]]
[[ 1.77269982e-05]
 [ 2.03992859e-05]
 [-1.96538086e+00]]


 Corrector Step
2018-07-13 19:32:50
[[ 5.01686410e+03]
 [ 3.40046935e+03]
 [-3.75615819e+03]
 [-3.55098052e+00]
 [-1.72875475e+00]
 [-6.34019075e+00]]
[[ 5.23618765e-04  2.12256060e-04  5.01482116e-05  5.94820550e-07
   2.91823081e-07  4.04855029e-09]
 [ 2.12256060e-04  1.84710613e-03  9.83657657e-05  5.06408539e-07
   1.57007635e-06  7.68936224e-08]
 [ 5.01482116e-05  9.83657657e-05  5.39100922e-04  2.08958036e-07
   2.30256900e-07 -3.20631723e-07]
 [ 5.94820550e-07  5.06408539e-07  2.08958036e-07  1.72486370e-09
   8.65191814e-10  6.77382541e-10]
 [ 2.91823081e-07  1.57007635e-06  2.30256900e-07  8.65191814e-10
   1.99436632e-09  3.96392939e-10]
 [ 4.04855029e-09  7.68936224e-08 -3.20631723e-07  6.77382541e-10
   3.96392939e-10  1.85627154e-09]]
6.847357940859481e-76
post
sphere_lamr_small
Ybar_post [[ 1.58891883]
 [-0.03826465]
 [16.73034235]]
resids [[ 1.47218296e-05]
 [ 1.68215893e-05]
 [-1.96540752e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [436293760.9701789, 6.847357940859481e-76]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 5.01685294e+03],
       [ 3.40046980e+03],
       [-3.75616710e+03],
       [-3.55128663e+00],
       [-1.72891121e+00],
       [-6.34049604e+00]]), 'est_covars': array([[ 6.40729063e-04,  2.11552487e-04,  7.71497425e-05,
         2.73088593e-06,  1.11179521e-06,  1.63100448e-06],
       [ 2.11552487e-04,  5.26183730e-02, -2.76728956e-04,
        -2.74233387e-05,  3.52845030e-05, -3.48372143e-05],
       [ 7.71497425e-05, -2.76728956e-04,  7.22993560e-04,
         2.53405061e-06,  1.15510472e-06,  2.78306346e-06],
       [ 2.73088593e-06, -2.74233387e-05,  2.53405061e-06,
         1.76693107e-07,  4.65792783e-08,  1.55544484e-07],
       [ 1.11179521e-06,  3.52845030e-05,  1.15510472e-06,
         4.65792783e-08,  9.69804320e-08,  4.98555215e-08],
       [ 1.63100448e-06, -3.48372143e-05,  2.78306346e-06,
         1.55544484e-07,  4.98555215e-08,  2.22434660e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.01686410e+03],
       [ 3.40046935e+03],
       [-3.75615819e+03],
       [-3.55098052e+00],
       [-1.72875475e+00],
       [-6.34019075e+00]]), 'covar': array([[ 5.23618765e-04,  2.12256060e-04,  5.01482116e-05,
         5.94820550e-07,  2.91823081e-07,  4.04855029e-09],
       [ 2.12256060e-04,  1.84710613e-03,  9.83657657e-05,
         5.06408539e-07,  1.57007635e-06,  7.68936224e-08],
       [ 5.01482116e-05,  9.83657657e-05,  5.39100922e-04,
         2.08958036e-07,  2.30256900e-07, -3.20631723e-07],
       [ 5.94820550e-07,  5.06408539e-07,  2.08958036e-07,
         1.72486370e-09,  8.65191814e-10,  6.77382541e-10],
       [ 2.91823081e-07,  1.57007635e-06,  2.30256900e-07,
         8.65191814e-10,  1.99436632e-09,  3.96392939e-10],
       [ 4.04855029e-09,  7.68936224e-08, -3.20631723e-07,
         6.77382541e-10,  3.96392939e-10,  1.85627154e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.47218296e-05],
       [ 1.68215893e-05],
       [-1.96540752e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.01685294e+03],
       [ 3.40046980e+03],
       [-3.75616710e+03],
       [-3.55128663e+00],
       [-1.72891121e+00],
       [-6.34049604e+00],
       [ 7.67873094e-01],
       [ 2.43391427e-01],
       [-5.75589740e-01],
       [ 1.40811841e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65376509e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.40729063e-04,  2.11552487e-04,  7.71497425e-05,
         2.73088593e-06,  1.11179521e-06,  1.63100448e-06],
       [ 2.11552487e-04,  5.26183730e-02, -2.76728956e-04,
        -2.74233387e-05,  3.52845030e-05, -3.48372143e-05],
       [ 7.71497425e-05, -2.76728956e-04,  7.22993560e-04,
         2.53405061e-06,  1.15510472e-06,  2.78306346e-06],
       [ 2.73088593e-06, -2.74233387e-05,  2.53405061e-06,
         1.76693107e-07,  4.65792783e-08,  1.55544484e-07],
       [ 1.11179521e-06,  3.52845030e-05,  1.15510472e-06,
         4.65792783e-08,  9.69804320e-08,  4.98555215e-08],
       [ 1.63100448e-06, -3.48372143e-05,  2.78306346e-06,
         1.55544484e-07,  4.98555215e-08,  2.22434660e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 9.56091863e-06],
       [ 2.09288088e-05],
       [-3.84446045e-03]])}}
Current time:  2018-07-13 19:33:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 5.01685294e+03],
       [ 3.40046980e+03],
       [-3.75616710e+03],
       [-3.55128663e+00],
       [-1.72891121e+00],
       [-6.34049604e+00],
       [ 7.67873094e-01],
       [ 2.43391427e-01],
       [-5.75589740e-01],
       [ 1.40811841e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65376509e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.40729063e-04,  2.11552487e-04,  7.71497425e-05,
         2.73088593e-06,  1.11179521e-06,  1.63100448e-06],
       [ 2.11552487e-04,  5.26183730e-02, -2.76728956e-04,
        -2.74233387e-05,  3.52845030e-05, -3.48372143e-05],
       [ 7.71497425e-05, -2.76728956e-04,  7.22993560e-04,
         2.53405061e-06,  1.15510472e-06,  2.78306346e-06],
       [ 2.73088593e-06, -2.74233387e-05,  2.53405061e-06,
         1.76693107e-07,  4.65792783e-08,  1.55544484e-07],
       [ 1.11179521e-06,  3.52845030e-05,  1.15510472e-06,
         4.65792783e-08,  9.69804320e-08,  4.98555215e-08],
       [ 1.63100448e-06, -3.48372143e-05,  2.78306346e-06,
         1.55544484e-07,  4.98555215e-08,  2.22434660e-07]])}
[[ 5.01685294e+03]
 [ 3.40046980e+03]
 [-3.75616710e+03]
 [-3.55128663e+00]
 [-1.72891121e+00]
 [-6.34049604e+00]
 [ 7.67873094e-01]
 [ 2.43391427e-01]
 [-5.75589740e-01]
 [ 1.40811841e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65376509e-18]]
2018-07-13 19:32:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:00
[[ 4.98106520e+03]
 [ 3.38299397e+03]
 [-3.81936408e+03]
 [-3.60622238e+00]
 [-1.76618452e+00]
 [-6.29876236e+00]
 [ 7.64857293e-01]
 [ 2.42652887e-01]
 [-5.79591200e-01]
 [ 1.42080745e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65397738e-18]]
[[ 7.13310923e-04 -4.40028759e-05  1.34199674e-04  4.54778685e-06
   1.58626050e-06  3.17610596e-06]
 [-4.40028759e-05  5.33323455e-02 -6.10717247e-04 -2.63677282e-05
   3.61201301e-05 -3.47824464e-05]
 [ 1.34199674e-04 -6.10717247e-04  8.01213133e-04  4.07463007e-06
   1.64906070e-06  5.06119630e-06]
 [ 4.54778685e-06 -2.63677282e-05  4.07463007e-06  1.86058638e-07
   4.70679188e-08  1.55301559e-07]
 [ 1.58626050e-06  3.61201301e-05  1.64906070e-06  4.70679188e-08
   1.06733886e-07  4.96556469e-08]
 [ 3.17610596e-06 -3.47824464e-05  5.06119630e-06  1.55301559e-07
   4.96556469e-08  2.32944276e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 5.01686410e+03],
       [ 3.40046935e+03],
       [-3.75615819e+03],
       [-3.55098052e+00],
       [-1.72875475e+00],
       [-6.34019075e+00]]), 'covar': array([[ 5.23618765e-04,  2.12256060e-04,  5.01482116e-05,
         5.94820550e-07,  2.91823081e-07,  4.04855029e-09],
       [ 2.12256060e-04,  1.84710613e-03,  9.83657657e-05,
         5.06408539e-07,  1.57007635e-06,  7.68936224e-08],
       [ 5.01482116e-05,  9.83657657e-05,  5.39100922e-04,
         2.08958036e-07,  2.30256900e-07, -3.20631723e-07],
       [ 5.94820550e-07,  5.06408539e-07,  2.08958036e-07,
         1.72486370e-09,  8.65191814e-10,  6.77382541e-10],
       [ 2.91823081e-07,  1.57007635e-06,  2.30256900e-07,
         8.65191814e-10,  1.99436632e-09,  3.96392939e-10],
       [ 4.04855029e-09,  7.68936224e-08, -3.20631723e-07,
         6.77382541e-10,  3.96392939e-10,  1.85627154e-09]])}
[[ 5.01686410e+03]
 [ 3.40046935e+03]
 [-3.75615819e+03]
 [-3.55098052e+00]
 [-1.72875475e+00]
 [-6.34019075e+00]]
2018-07-13 19:32:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:00
[[ 4.98107905e+03]
 [ 3.38299516e+03]
 [-3.81935208e+03]
 [-3.60591633e+00]
 [-1.76602789e+00]
 [-6.29845733e+00]]
[[ 5.35920374e-04  2.20550061e-04  5.23311059e-05  6.17075449e-07
   3.05140226e-07  2.41609457e-09]
 [ 2.20550061e-04  1.87871257e-03  1.01392972e-04  5.35472271e-07
   1.58539378e-06  6.24182503e-08]
 [ 5.23311059e-05  1.01392972e-04  5.32867678e-04  2.10443576e-07
   2.29863949e-07 -3.03907058e-07]
 [ 6.17075449e-07  5.35472271e-07  2.10443576e-07  1.83743251e-09
   8.84289354e-10  6.69843919e-10]
 [ 3.05140226e-07  1.58539378e-06  2.29863949e-07  8.84289354e-10
   2.08591527e-09  3.81547892e-10]
 [ 2.41609457e-09  6.24182503e-08 -3.03907058e-07  6.69843919e-10
   3.81547892e-10  1.95606696e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 32, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.98107905e+03],
       [ 3.38299516e+03],
       [-3.81935208e+03],
       [-3.60591633e+00],
       [-1.76602789e+00],
       [-6.29845733e+00]]), 'covar': array([[ 5.35920374e-04,  2.20550061e-04,  5.23311059e-05,
         6.17075449e-07,  3.05140226e-07,  2.41609457e-09],
       [ 2.20550061e-04,  1.87871257e-03,  1.01392972e-04,
         5.35472271e-07,  1.58539378e-06,  6.24182503e-08],
       [ 5.23311059e-05,  1.01392972e-04,  5.32867678e-04,
         2.10443576e-07,  2.29863949e-07, -3.03907058e-07],
       [ 6.17075449e-07,  5.35472271e-07,  2.10443576e-07,
         1.83743251e-09,  8.84289354e-10,  6.69843919e-10],
       [ 3.05140226e-07,  1.58539378e-06,  2.29863949e-07,
         8.84289354e-10,  2.08591527e-09,  3.81547892e-10],
       [ 2.41609457e-09,  6.24182503e-08, -3.03907058e-07,
         6.69843919e-10,  3.81547892e-10,  1.95606696e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.47218296e-05],
       [ 1.68215893e-05],
       [-1.96540752e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 32, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.98106520e+03],
       [ 3.38299397e+03],
       [-3.81936408e+03],
       [-3.60622238e+00],
       [-1.76618452e+00],
       [-6.29876236e+00],
       [ 7.64857293e-01],
       [ 2.42652887e-01],
       [-5.79591200e-01],
       [ 1.42080745e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65397738e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.13310923e-04, -4.40028759e-05,  1.34199674e-04,
         4.54778685e-06,  1.58626050e-06,  3.17610596e-06],
       [-4.40028759e-05,  5.33323455e-02, -6.10717247e-04,
        -2.63677282e-05,  3.61201301e-05, -3.47824464e-05],
       [ 1.34199674e-04, -6.10717247e-04,  8.01213133e-04,
         4.07463007e-06,  1.64906070e-06,  5.06119630e-06],
       [ 4.54778685e-06, -2.63677282e-05,  4.07463007e-06,
         1.86058638e-07,  4.70679188e-08,  1.55301559e-07],
       [ 1.58626050e-06,  3.61201301e-05,  1.64906070e-06,
         4.70679188e-08,  1.06733886e-07,  4.96556469e-08],
       [ 3.17610596e-06, -3.47824464e-05,  5.06119630e-06,
         1.55301559e-07,  4.96556469e-08,  2.32944276e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 9.56091863e-06],
       [ 2.09288088e-05],
       [-3.84446045e-03]])}}
Yi [[ 1.60536225]
 [-0.0680621 ]
 [14.53968914]]
posterior
[[ 4.98106520e+03]
 [ 3.38299397e+03]
 [-3.81936408e+03]
 [-3.60622238e+00]
 [-1.76618452e+00]
 [-6.29876236e+00]
 [ 7.64857293e-01]
 [ 2.42652887e-01]
 [-5.79591200e-01]
 [ 1.42080745e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65397738e-18]]
[[ 4.98108483e+03]
 [ 3.38307295e+03]
 [-3.81935302e+03]
 [-3.60610502e+00]
 [-1.76606749e+00]
 [-6.29868319e+00]
 [ 7.64857293e-01]
 [ 2.42652887e-01]
 [-5.79591200e-01]
 [ 1.42080745e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65397738e-18]]
[[ 5.65375922e-04 -4.78550270e-04  9.42845066e-05  3.75664760e-06
   9.16856838e-07  2.71462327e-06]
 [-4.78550270e-04  5.00962968e-02 -1.26483064e-03 -2.98583796e-05
   3.15440339e-05 -3.78272292e-05]
 [ 9.42845066e-05 -1.26483064e-03  6.43335935e-04  3.54142837e-06
   7.53397896e-07  4.47376531e-06]
 [ 3.75664760e-06 -2.98583796e-05  3.54142837e-06  1.81132694e-07
   4.19339614e-08  1.51827366e-07]
 [ 9.16856838e-07  3.15440339e-05  7.53397896e-07  4.19339614e-08
   1.00229046e-07  4.53174762e-08]
 [ 2.71462327e-06 -3.78272292e-05  4.47376531e-06  1.51827366e-07
   4.53174762e-08  2.30047874e-07]]
[[ 1.60540491]
 [-0.06808328]
 [14.48440981]]
[[-4.26681734e-05]
 [ 2.11721974e-05]
 [ 5.52793311e-02]]


 Corrector Step
2018-07-13 19:33:00
[[ 4.98108483e+03]
 [ 3.38307295e+03]
 [-3.81935302e+03]
 [-3.60610502e+00]
 [-1.76606749e+00]
 [-6.29868319e+00]
 [ 7.64857293e-01]
 [ 2.42652887e-01]
 [-5.79591200e-01]
 [ 1.42080745e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65397738e-18]]
[[ 5.65375922e-04 -4.78550270e-04  9.42845066e-05  3.75664760e-06
   9.16856838e-07  2.71462327e-06]
 [-4.78550270e-04  5.00962968e-02 -1.26483064e-03 -2.98583796e-05
   3.15440339e-05 -3.78272292e-05]
 [ 9.42845066e-05 -1.26483064e-03  6.43335935e-04  3.54142837e-06
   7.53397896e-07  4.47376531e-06]
 [ 3.75664760e-06 -2.98583796e-05  3.54142837e-06  1.81132694e-07
   4.19339614e-08  1.51827366e-07]
 [ 9.16856838e-07  3.15440339e-05  7.53397896e-07  4.19339614e-08
   1.00229046e-07  4.53174762e-08]
 [ 2.71462327e-06 -3.78272292e-05  4.47376531e-06  1.51827366e-07
   4.53174762e-08  2.30047874e-07]]
171196319.58703315
post
cubesat_nadir
Ybar_post [[ 1.6053945 ]
 [-0.06807565]
 [14.48460009]]
resids [[-3.22568669e-05]
 [ 1.35476593e-05]
 [ 5.50890506e-02]]
posterior
[[ 4.98107905e+03]
 [ 3.38299516e+03]
 [-3.81935208e+03]
 [-3.60591633e+00]
 [-1.76602789e+00]
 [-6.29845733e+00]]
[[ 4.98109264e+03]
 [ 3.38300374e+03]
 [-3.81934572e+03]
 [-3.60589892e+00]
 [-1.76601645e+00]
 [-6.29846004e+00]]
[[ 4.44029634e-04  1.69080336e-04  3.41351294e-05  5.06858529e-07
   2.39456036e-07  6.57539312e-09]
 [ 1.69080336e-04  1.83845837e-03  5.98475175e-05  4.63841596e-07
   1.53133905e-06  8.24125666e-08]
 [ 3.41351294e-05  5.98475175e-05  4.43219190e-04  1.61460339e-07
   1.69479988e-07 -2.54605359e-07]
 [ 5.06858529e-07  4.63841596e-07  1.61460339e-07  1.69666258e-09
   7.90551804e-10  6.90133780e-10]
 [ 2.39456036e-07  1.53133905e-06  1.69479988e-07  7.90551804e-10
   2.01287713e-09  4.11213437e-10]
 [ 6.57539312e-09  8.24125666e-08 -2.54605359e-07  6.90133780e-10
   4.11213437e-10  1.92856607e-09]]
[[ 1.60539845]
 [-0.06807767]
 [16.64122415]]
[[-3.62010694e-05]
 [ 1.55665669e-05]
 [-2.10153501e+00]]


 Corrector Step
2018-07-13 19:33:00
[[ 4.98109264e+03]
 [ 3.38300374e+03]
 [-3.81934572e+03]
 [-3.60589892e+00]
 [-1.76601645e+00]
 [-6.29846004e+00]]
[[ 4.44029634e-04  1.69080336e-04  3.41351294e-05  5.06858529e-07
   2.39456036e-07  6.57539312e-09]
 [ 1.69080336e-04  1.83845837e-03  5.98475175e-05  4.63841596e-07
   1.53133905e-06  8.24125666e-08]
 [ 3.41351294e-05  5.98475175e-05  4.43219190e-04  1.61460339e-07
   1.69479988e-07 -2.54605359e-07]
 [ 5.06858529e-07  4.63841596e-07  1.61460339e-07  1.69666258e-09
   7.90551804e-10  6.90133780e-10]
 [ 2.39456036e-07  1.53133905e-06  1.69479988e-07  7.90551804e-10
   2.01287713e-09  4.11213437e-10]
 [ 6.57539312e-09  8.24125666e-08 -2.54605359e-07  6.90133780e-10
   4.11213437e-10  1.92856607e-09]]
3.8219159512183603e-88
post
sphere_lamr_small
Ybar_post [[ 1.60539197]
 [-0.06807445]
 [16.64122452]]
resids [[-2.97269580e-05]
 [ 1.23497059e-05]
 [-2.10153538e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [171196319.58703315, 3.8219159512183603e-88]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.98108483e+03],
       [ 3.38307295e+03],
       [-3.81935302e+03],
       [-3.60610502e+00],
       [-1.76606749e+00],
       [-6.29868319e+00]]), 'est_covars': array([[ 5.65375922e-04, -4.78550270e-04,  9.42845066e-05,
         3.75664760e-06,  9.16856838e-07,  2.71462327e-06],
       [-4.78550270e-04,  5.00962968e-02, -1.26483064e-03,
        -2.98583796e-05,  3.15440339e-05, -3.78272292e-05],
       [ 9.42845066e-05, -1.26483064e-03,  6.43335935e-04,
         3.54142837e-06,  7.53397896e-07,  4.47376531e-06],
       [ 3.75664760e-06, -2.98583796e-05,  3.54142837e-06,
         1.81132694e-07,  4.19339614e-08,  1.51827366e-07],
       [ 9.16856838e-07,  3.15440339e-05,  7.53397896e-07,
         4.19339614e-08,  1.00229046e-07,  4.53174762e-08],
       [ 2.71462327e-06, -3.78272292e-05,  4.47376531e-06,
         1.51827366e-07,  4.53174762e-08,  2.30047874e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.98109264e+03],
       [ 3.38300374e+03],
       [-3.81934572e+03],
       [-3.60589892e+00],
       [-1.76601645e+00],
       [-6.29846004e+00]]), 'covar': array([[ 4.44029634e-04,  1.69080336e-04,  3.41351294e-05,
         5.06858529e-07,  2.39456036e-07,  6.57539312e-09],
       [ 1.69080336e-04,  1.83845837e-03,  5.98475175e-05,
         4.63841596e-07,  1.53133905e-06,  8.24125666e-08],
       [ 3.41351294e-05,  5.98475175e-05,  4.43219190e-04,
         1.61460339e-07,  1.69479988e-07, -2.54605359e-07],
       [ 5.06858529e-07,  4.63841596e-07,  1.61460339e-07,
         1.69666258e-09,  7.90551804e-10,  6.90133780e-10],
       [ 2.39456036e-07,  1.53133905e-06,  1.69479988e-07,
         7.90551804e-10,  2.01287713e-09,  4.11213437e-10],
       [ 6.57539312e-09,  8.24125666e-08, -2.54605359e-07,
         6.90133780e-10,  4.11213437e-10,  1.92856607e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.97269580e-05],
       [ 1.23497059e-05],
       [-2.10153538e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.98108483e+03],
       [ 3.38307295e+03],
       [-3.81935302e+03],
       [-3.60610502e+00],
       [-1.76606749e+00],
       [-6.29868319e+00],
       [ 7.64857293e-01],
       [ 2.42652887e-01],
       [-5.79591200e-01],
       [ 1.42080745e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65397738e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.65375922e-04, -4.78550270e-04,  9.42845066e-05,
         3.75664760e-06,  9.16856838e-07,  2.71462327e-06],
       [-4.78550270e-04,  5.00962968e-02, -1.26483064e-03,
        -2.98583796e-05,  3.15440339e-05, -3.78272292e-05],
       [ 9.42845066e-05, -1.26483064e-03,  6.43335935e-04,
         3.54142837e-06,  7.53397896e-07,  4.47376531e-06],
       [ 3.75664760e-06, -2.98583796e-05,  3.54142837e-06,
         1.81132694e-07,  4.19339614e-08,  1.51827366e-07],
       [ 9.16856838e-07,  3.15440339e-05,  7.53397896e-07,
         4.19339614e-08,  1.00229046e-07,  4.53174762e-08],
       [ 2.71462327e-06, -3.78272292e-05,  4.47376531e-06,
         1.51827366e-07,  4.53174762e-08,  2.30047874e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.22568669e-05],
       [ 1.35476593e-05],
       [ 5.50890506e-02]])}}
Current time:  2018-07-13 19:33:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.98108483e+03],
       [ 3.38307295e+03],
       [-3.81935302e+03],
       [-3.60610502e+00],
       [-1.76606749e+00],
       [-6.29868319e+00],
       [ 7.64857293e-01],
       [ 2.42652887e-01],
       [-5.79591200e-01],
       [ 1.42080745e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65397738e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.65375922e-04, -4.78550270e-04,  9.42845066e-05,
         3.75664760e-06,  9.16856838e-07,  2.71462327e-06],
       [-4.78550270e-04,  5.00962968e-02, -1.26483064e-03,
        -2.98583796e-05,  3.15440339e-05, -3.78272292e-05],
       [ 9.42845066e-05, -1.26483064e-03,  6.43335935e-04,
         3.54142837e-06,  7.53397896e-07,  4.47376531e-06],
       [ 3.75664760e-06, -2.98583796e-05,  3.54142837e-06,
         1.81132694e-07,  4.19339614e-08,  1.51827366e-07],
       [ 9.16856838e-07,  3.15440339e-05,  7.53397896e-07,
         4.19339614e-08,  1.00229046e-07,  4.53174762e-08],
       [ 2.71462327e-06, -3.78272292e-05,  4.47376531e-06,
         1.51827366e-07,  4.53174762e-08,  2.30047874e-07]])}
[[ 4.98108483e+03]
 [ 3.38307295e+03]
 [-3.81935302e+03]
 [-3.60610502e+00]
 [-1.76606749e+00]
 [-6.29868319e+00]
 [ 7.64857293e-01]
 [ 2.42652887e-01]
 [-5.79591200e-01]
 [ 1.42080745e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65397738e-18]]
2018-07-13 19:33:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:10
[[ 4.94475069e+03]
 [ 3.36522667e+03]
 [-3.88212809e+03]
 [-3.66063655e+00]
 [-1.80314196e+00]
 [-6.25626172e+00]
 [ 7.61820640e-01]
 [ 2.41907731e-01]
 [-5.83576859e-01]
 [ 1.43345775e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65418967e-18]]
[[ 6.58857960e-04 -7.60883248e-04  1.71776672e-04  5.60917224e-06
   1.34625252e-06  4.22890143e-06]
 [-7.60883248e-04  5.07357002e-02 -1.63317691e-03 -2.88753852e-05
   3.24182906e-05 -3.77910786e-05]
 [ 1.71776672e-04 -1.63317691e-03  7.56403073e-04  5.03460114e-06
   1.20655141e-06  6.83695117e-06]
 [ 5.60917224e-06 -2.88753852e-05  5.03460114e-06  1.90435588e-07
   4.23942468e-08  1.51549190e-07]
 [ 1.34625252e-06  3.24182906e-05  1.20655141e-06  4.23942468e-08
   1.10005686e-07  4.51590462e-08]
 [ 4.22890143e-06 -3.77910786e-05  6.83695117e-06  1.51549190e-07
   4.51590462e-08  2.40585718e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.98109264e+03],
       [ 3.38300374e+03],
       [-3.81934572e+03],
       [-3.60589892e+00],
       [-1.76601645e+00],
       [-6.29846004e+00]]), 'covar': array([[ 4.44029634e-04,  1.69080336e-04,  3.41351294e-05,
         5.06858529e-07,  2.39456036e-07,  6.57539312e-09],
       [ 1.69080336e-04,  1.83845837e-03,  5.98475175e-05,
         4.63841596e-07,  1.53133905e-06,  8.24125666e-08],
       [ 3.41351294e-05,  5.98475175e-05,  4.43219190e-04,
         1.61460339e-07,  1.69479988e-07, -2.54605359e-07],
       [ 5.06858529e-07,  4.63841596e-07,  1.61460339e-07,
         1.69666258e-09,  7.90551804e-10,  6.90133780e-10],
       [ 2.39456036e-07,  1.53133905e-06,  1.69479988e-07,
         7.90551804e-10,  2.01287713e-09,  4.11213437e-10],
       [ 6.57539312e-09,  8.24125666e-08, -2.54605359e-07,
         6.90133780e-10,  4.11213437e-10,  1.92856607e-09]])}
[[ 4.98109264e+03]
 [ 3.38300374e+03]
 [-3.81934572e+03]
 [-3.60589892e+00]
 [-1.76601645e+00]
 [-6.29846004e+00]]
2018-07-13 19:33:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:10
[[ 4.94476051e+03]
 [ 3.36515801e+03]
 [-3.88211881e+03]
 [-3.66043106e+00]
 [-1.80309061e+00]
 [-6.25603832e+00]]
[[ 4.54453590e-04  1.76325945e-04  3.58395640e-05  5.27966388e-07
   2.51399331e-07  6.28308868e-09]
 [ 1.76325945e-04  1.86923732e-03  6.23022323e-05  4.92015384e-07
   1.54657016e-06  6.85570252e-08]
 [ 3.58395640e-05  6.23022323e-05  4.38308943e-04  1.63675346e-07
   1.69955789e-07 -2.36376305e-07]
 [ 5.27966388e-07  4.92015384e-07  1.63675346e-07  1.80818352e-09
   8.08840455e-10  6.83434197e-10]
 [ 2.51399331e-07  1.54657016e-06  1.69955789e-07  8.08840455e-10
   2.10419153e-09  3.96815663e-10]
 [ 6.28308868e-09  6.85570252e-08 -2.36376305e-07  6.83434197e-10
   3.96815663e-10  2.02785915e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.94476051e+03],
       [ 3.36515801e+03],
       [-3.88211881e+03],
       [-3.66043106e+00],
       [-1.80309061e+00],
       [-6.25603832e+00]]), 'covar': array([[ 4.54453590e-04,  1.76325945e-04,  3.58395640e-05,
         5.27966388e-07,  2.51399331e-07,  6.28308868e-09],
       [ 1.76325945e-04,  1.86923732e-03,  6.23022323e-05,
         4.92015384e-07,  1.54657016e-06,  6.85570252e-08],
       [ 3.58395640e-05,  6.23022323e-05,  4.38308943e-04,
         1.63675346e-07,  1.69955789e-07, -2.36376305e-07],
       [ 5.27966388e-07,  4.92015384e-07,  1.63675346e-07,
         1.80818352e-09,  8.08840455e-10,  6.83434197e-10],
       [ 2.51399331e-07,  1.54657016e-06,  1.69955789e-07,
         8.08840455e-10,  2.10419153e-09,  3.96815663e-10],
       [ 6.28308868e-09,  6.85570252e-08, -2.36376305e-07,
         6.83434197e-10,  3.96815663e-10,  2.02785915e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.97269580e-05],
       [ 1.23497059e-05],
       [-2.10153538e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.94475069e+03],
       [ 3.36522667e+03],
       [-3.88212809e+03],
       [-3.66063655e+00],
       [-1.80314196e+00],
       [-6.25626172e+00],
       [ 7.61820640e-01],
       [ 2.41907731e-01],
       [-5.83576859e-01],
       [ 1.43345775e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65418967e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.58857960e-04, -7.60883248e-04,  1.71776672e-04,
         5.60917224e-06,  1.34625252e-06,  4.22890143e-06],
       [-7.60883248e-04,  5.07357002e-02, -1.63317691e-03,
        -2.88753852e-05,  3.24182906e-05, -3.77910786e-05],
       [ 1.71776672e-04, -1.63317691e-03,  7.56403073e-04,
         5.03460114e-06,  1.20655141e-06,  6.83695117e-06],
       [ 5.60917224e-06, -2.88753852e-05,  5.03460114e-06,
         1.90435588e-07,  4.23942468e-08,  1.51549190e-07],
       [ 1.34625252e-06,  3.24182906e-05,  1.20655141e-06,
         4.23942468e-08,  1.10005686e-07,  4.51590462e-08],
       [ 4.22890143e-06, -3.77910786e-05,  6.83695117e-06,
         1.51549190e-07,  4.51590462e-08,  2.40585718e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.22568669e-05],
       [ 1.35476593e-05],
       [ 5.50890506e-02]])}}
Yi [[ 1.62244959]
 [-0.098161  ]
 [14.22653411]]
posterior
[[ 4.94475069e+03]
 [ 3.36522667e+03]
 [-3.88212809e+03]
 [-3.66063655e+00]
 [-1.80314196e+00]
 [-6.25626172e+00]
 [ 7.61820640e-01]
 [ 2.41907731e-01]
 [-5.83576859e-01]
 [ 1.43345775e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65418967e-18]]
[[ 4.94474990e+03]
 [ 3.36515884e+03]
 [-3.88214057e+03]
 [-3.66067458e+00]
 [-1.80322937e+00]
 [-6.25632315e+00]
 [ 7.61820640e-01]
 [ 2.41907731e-01]
 [-5.83576859e-01]
 [ 1.43345775e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65418967e-18]]
[[ 5.44176327e-04 -1.14358680e-03  1.48424767e-04  4.82810427e-06
   7.38261443e-07  3.77371147e-06]
 [-1.14358680e-03  4.68368585e-02 -2.20671231e-03 -3.27981695e-05
   2.70411443e-05 -4.16580713e-05]
 [ 1.48424767e-04 -2.20671231e-03  6.57944841e-04  4.62666651e-06
   4.49767189e-07  6.30030367e-06]
 [ 4.82810427e-06 -3.27981695e-05  4.62666651e-06  1.84454795e-07
   3.65721653e-08  1.47269719e-07]
 [ 7.38261443e-07  2.70411443e-05  4.49767189e-07  3.65721653e-08
   1.02506243e-07  3.97469342e-08]
 [ 3.77371147e-06 -4.16580713e-05  6.30030367e-06  1.47269719e-07
   3.97469342e-08  2.36675460e-07]]
[[ 1.62244999]
 [-0.09812532]
 [14.23839092]]
[[-4.08929513e-07]
 [-3.56718802e-05]
 [-1.18568117e-02]]


 Corrector Step
2018-07-13 19:33:10
[[ 4.94474990e+03]
 [ 3.36515884e+03]
 [-3.88214057e+03]
 [-3.66067458e+00]
 [-1.80322937e+00]
 [-6.25632315e+00]
 [ 7.61820640e-01]
 [ 2.41907731e-01]
 [-5.83576859e-01]
 [ 1.43345775e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65418967e-18]]
[[ 5.44176327e-04 -1.14358680e-03  1.48424767e-04  4.82810427e-06
   7.38261443e-07  3.77371147e-06]
 [-1.14358680e-03  4.68368585e-02 -2.20671231e-03 -3.27981695e-05
   2.70411443e-05 -4.16580713e-05]
 [ 1.48424767e-04 -2.20671231e-03  6.57944841e-04  4.62666651e-06
   4.49767189e-07  6.30030367e-06]
 [ 4.82810427e-06 -3.27981695e-05  4.62666651e-06  1.84454795e-07
   3.65721653e-08  1.47269719e-07]
 [ 7.38261443e-07  2.70411443e-05  4.49767189e-07  3.65721653e-08
   1.02506243e-07  3.97469342e-08]
 [ 3.77371147e-06 -4.16580713e-05  6.30030367e-06  1.47269719e-07
   3.97469342e-08  2.36675460e-07]]
365663256.45901537
post
cubesat_nadir
Ybar_post [[ 1.62245206]
 [-0.09813427]
 [14.238265  ]]
resids [[-2.47366363e-06]
 [-2.67259454e-05]
 [-1.17308889e-02]]
posterior
[[ 4.94476051e+03]
 [ 3.36515801e+03]
 [-3.88211881e+03]
 [-3.66043106e+00]
 [-1.80309061e+00]
 [-6.25603832e+00]]
[[ 4.94475878e+03]
 [ 3.36515112e+03]
 [-3.88213010e+03]
 [-3.66043696e+00]
 [-1.80309939e+00]
 [-6.25603254e+00]]
[[ 3.85131880e-04  1.32683925e-04  2.42255195e-05  4.43260768e-07
   1.98118052e-07  7.84126701e-09]
 [ 1.32683925e-04  1.82720932e-03  2.52413877e-05  4.28637632e-07
   1.49379847e-06  8.51403495e-08]
 [ 2.42255195e-05  2.52413877e-05  3.75548154e-04  1.28937806e-07
   1.21722501e-07 -2.04219919e-07]
 [ 4.43260768e-07  4.28637632e-07  1.28937806e-07  1.69773856e-09
   7.30455342e-10  6.96113874e-10]
 [ 1.98118052e-07  1.49379847e-06  1.21722501e-07  7.30455342e-10
   2.03783376e-09  4.18628229e-10]
 [ 7.84126701e-09  8.51403495e-08 -2.04219919e-07  6.96113874e-10
   4.18628229e-10  2.01109615e-09]]
[[ 1.62244707]
 [-0.09812417]
 [16.54803634]]
[[ 2.51169808e-06]
 [-3.68304455e-05]
 [-2.32150223e+00]]


 Corrector Step
2018-07-13 19:33:10
[[ 4.94475878e+03]
 [ 3.36515112e+03]
 [-3.88213010e+03]
 [-3.66043696e+00]
 [-1.80309939e+00]
 [-6.25603254e+00]]
[[ 3.85131880e-04  1.32683925e-04  2.42255195e-05  4.43260768e-07
   1.98118052e-07  7.84126701e-09]
 [ 1.32683925e-04  1.82720932e-03  2.52413877e-05  4.28637632e-07
   1.49379847e-06  8.51403495e-08]
 [ 2.42255195e-05  2.52413877e-05  3.75548154e-04  1.28937806e-07
   1.21722501e-07 -2.04219919e-07]
 [ 4.43260768e-07  4.28637632e-07  1.28937806e-07  1.69773856e-09
   7.30455342e-10  6.96113874e-10]
 [ 1.98118052e-07  1.49379847e-06  1.21722501e-07  7.30455342e-10
   2.03783376e-09  4.18628229e-10]
 [ 7.84126701e-09  8.51403495e-08 -2.04219919e-07  6.96113874e-10
   4.18628229e-10  2.01109615e-09]]
3.227718859235809e-109
post
sphere_lamr_small
Ybar_post [[ 1.62244806]
 [-0.09812976]
 [16.54800902]]
resids [[ 1.52060357e-06]
 [-3.12389109e-05]
 [-2.32147491e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [365663256.45901537, 3.227718859235809e-109]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.94474990e+03],
       [ 3.36515884e+03],
       [-3.88214057e+03],
       [-3.66067458e+00],
       [-1.80322937e+00],
       [-6.25632315e+00]]), 'est_covars': array([[ 5.44176327e-04, -1.14358680e-03,  1.48424767e-04,
         4.82810427e-06,  7.38261443e-07,  3.77371147e-06],
       [-1.14358680e-03,  4.68368585e-02, -2.20671231e-03,
        -3.27981695e-05,  2.70411443e-05, -4.16580713e-05],
       [ 1.48424767e-04, -2.20671231e-03,  6.57944841e-04,
         4.62666651e-06,  4.49767189e-07,  6.30030367e-06],
       [ 4.82810427e-06, -3.27981695e-05,  4.62666651e-06,
         1.84454795e-07,  3.65721653e-08,  1.47269719e-07],
       [ 7.38261443e-07,  2.70411443e-05,  4.49767189e-07,
         3.65721653e-08,  1.02506243e-07,  3.97469342e-08],
       [ 3.77371147e-06, -4.16580713e-05,  6.30030367e-06,
         1.47269719e-07,  3.97469342e-08,  2.36675460e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.94475878e+03],
       [ 3.36515112e+03],
       [-3.88213010e+03],
       [-3.66043696e+00],
       [-1.80309939e+00],
       [-6.25603254e+00]]), 'covar': array([[ 3.85131880e-04,  1.32683925e-04,  2.42255195e-05,
         4.43260768e-07,  1.98118052e-07,  7.84126701e-09],
       [ 1.32683925e-04,  1.82720932e-03,  2.52413877e-05,
         4.28637632e-07,  1.49379847e-06,  8.51403495e-08],
       [ 2.42255195e-05,  2.52413877e-05,  3.75548154e-04,
         1.28937806e-07,  1.21722501e-07, -2.04219919e-07],
       [ 4.43260768e-07,  4.28637632e-07,  1.28937806e-07,
         1.69773856e-09,  7.30455342e-10,  6.96113874e-10],
       [ 1.98118052e-07,  1.49379847e-06,  1.21722501e-07,
         7.30455342e-10,  2.03783376e-09,  4.18628229e-10],
       [ 7.84126701e-09,  8.51403495e-08, -2.04219919e-07,
         6.96113874e-10,  4.18628229e-10,  2.01109615e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.52060357e-06],
       [-3.12389109e-05],
       [-2.32147491e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.94474990e+03],
       [ 3.36515884e+03],
       [-3.88214057e+03],
       [-3.66067458e+00],
       [-1.80322937e+00],
       [-6.25632315e+00],
       [ 7.61820640e-01],
       [ 2.41907731e-01],
       [-5.83576859e-01],
       [ 1.43345775e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65418967e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.44176327e-04, -1.14358680e-03,  1.48424767e-04,
         4.82810427e-06,  7.38261443e-07,  3.77371147e-06],
       [-1.14358680e-03,  4.68368585e-02, -2.20671231e-03,
        -3.27981695e-05,  2.70411443e-05, -4.16580713e-05],
       [ 1.48424767e-04, -2.20671231e-03,  6.57944841e-04,
         4.62666651e-06,  4.49767189e-07,  6.30030367e-06],
       [ 4.82810427e-06, -3.27981695e-05,  4.62666651e-06,
         1.84454795e-07,  3.65721653e-08,  1.47269719e-07],
       [ 7.38261443e-07,  2.70411443e-05,  4.49767189e-07,
         3.65721653e-08,  1.02506243e-07,  3.97469342e-08],
       [ 3.77371147e-06, -4.16580713e-05,  6.30030367e-06,
         1.47269719e-07,  3.97469342e-08,  2.36675460e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.47366363e-06],
       [-2.67259454e-05],
       [-1.17308889e-02]])}}
Current time:  2018-07-13 19:33:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.94474990e+03],
       [ 3.36515884e+03],
       [-3.88214057e+03],
       [-3.66067458e+00],
       [-1.80322937e+00],
       [-6.25632315e+00],
       [ 7.61820640e-01],
       [ 2.41907731e-01],
       [-5.83576859e-01],
       [ 1.43345775e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65418967e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.44176327e-04, -1.14358680e-03,  1.48424767e-04,
         4.82810427e-06,  7.38261443e-07,  3.77371147e-06],
       [-1.14358680e-03,  4.68368585e-02, -2.20671231e-03,
        -3.27981695e-05,  2.70411443e-05, -4.16580713e-05],
       [ 1.48424767e-04, -2.20671231e-03,  6.57944841e-04,
         4.62666651e-06,  4.49767189e-07,  6.30030367e-06],
       [ 4.82810427e-06, -3.27981695e-05,  4.62666651e-06,
         1.84454795e-07,  3.65721653e-08,  1.47269719e-07],
       [ 7.38261443e-07,  2.70411443e-05,  4.49767189e-07,
         3.65721653e-08,  1.02506243e-07,  3.97469342e-08],
       [ 3.77371147e-06, -4.16580713e-05,  6.30030367e-06,
         1.47269719e-07,  3.97469342e-08,  2.36675460e-07]])}
[[ 4.94474990e+03]
 [ 3.36515884e+03]
 [-3.88214057e+03]
 [-3.66067458e+00]
 [-1.80322937e+00]
 [-6.25632315e+00]
 [ 7.61820640e-01]
 [ 2.41907731e-01]
 [-5.83576859e-01]
 [ 1.43345775e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65418967e-18]]
2018-07-13 19:33:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:20
[[ 4.90787238e+03]
 [ 3.34694191e+03]
 [-3.94448864e+03]
 [-3.71479723e+00]
 [-1.84010035e+00]
 [-6.21321770e+00]
 [ 7.58763218e-01]
 [ 2.41155980e-01]
 [-5.87546609e-01]
 [ 1.44606897e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65440195e-18]]
[[ 6.59345483e-04 -1.45788197e-03  2.47095501e-04  6.70526013e-06
   1.11571781e-06  5.24836848e-06]
 [-1.45788197e-03  4.73865454e-02 -2.61678630e-03 -3.19022655e-05
   2.79476382e-05 -4.16445389e-05]
 [ 2.47095501e-04 -2.61678630e-03  8.08197394e-04  6.06381976e-06
   8.51582025e-07  8.73754222e-06]
 [ 6.70526013e-06 -3.19022655e-05  6.06381976e-06  1.93682716e-07
   3.69976716e-08  1.46950251e-07]
 [ 1.11571781e-06  2.79476382e-05  8.51582025e-07  3.69976716e-08
   1.12311805e-07  3.96385928e-08]
 [ 5.24836848e-06 -4.16445389e-05  8.73754222e-06  1.46950251e-07
   3.96385928e-08  2.47258381e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.94475878e+03],
       [ 3.36515112e+03],
       [-3.88213010e+03],
       [-3.66043696e+00],
       [-1.80309939e+00],
       [-6.25603254e+00]]), 'covar': array([[ 3.85131880e-04,  1.32683925e-04,  2.42255195e-05,
         4.43260768e-07,  1.98118052e-07,  7.84126701e-09],
       [ 1.32683925e-04,  1.82720932e-03,  2.52413877e-05,
         4.28637632e-07,  1.49379847e-06,  8.51403495e-08],
       [ 2.42255195e-05,  2.52413877e-05,  3.75548154e-04,
         1.28937806e-07,  1.21722501e-07, -2.04219919e-07],
       [ 4.43260768e-07,  4.28637632e-07,  1.28937806e-07,
         1.69773856e-09,  7.30455342e-10,  6.96113874e-10],
       [ 1.98118052e-07,  1.49379847e-06,  1.21722501e-07,
         7.30455342e-10,  2.03783376e-09,  4.18628229e-10],
       [ 7.84126701e-09,  8.51403495e-08, -2.04219919e-07,
         6.96113874e-10,  4.18628229e-10,  2.01109615e-09]])}
[[ 4.94475878e+03]
 [ 3.36515112e+03]
 [-3.88213010e+03]
 [-3.66043696e+00]
 [-1.80309939e+00]
 [-6.25603254e+00]]
2018-07-13 19:33:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:20
[[ 4.90788312e+03]
 [ 3.34693557e+03]
 [-3.94447524e+03]
 [-3.71455986e+00]
 [-1.83997042e+00]
 [-6.21292709e+00]]
[[ 3.94518120e-04  1.39183805e-04  2.53765429e-05  4.63785658e-07
   2.08905854e-07  8.39813696e-09]
 [ 1.39183805e-04  1.85724045e-03  2.72195719e-05  4.56052582e-07
   1.50904262e-06  7.17666659e-08]
 [ 2.53765429e-05  2.72195719e-05  3.71830380e-04  1.31574313e-07
   1.22861831e-07 -1.84307779e-07]
 [ 4.63785658e-07  4.56052582e-07  1.31574313e-07  1.80821433e-09
   7.48040865e-10  6.89828065e-10]
 [ 2.08905854e-07  1.50904262e-06  1.22861831e-07  7.48040865e-10
   2.12900645e-09  4.04653230e-10]
 [ 8.39813696e-09  7.17666659e-08 -1.84307779e-07  6.89828065e-10
   4.04653230e-10  2.11023430e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.90788312e+03],
       [ 3.34693557e+03],
       [-3.94447524e+03],
       [-3.71455986e+00],
       [-1.83997042e+00],
       [-6.21292709e+00]]), 'covar': array([[ 3.94518120e-04,  1.39183805e-04,  2.53765429e-05,
         4.63785658e-07,  2.08905854e-07,  8.39813696e-09],
       [ 1.39183805e-04,  1.85724045e-03,  2.72195719e-05,
         4.56052582e-07,  1.50904262e-06,  7.17666659e-08],
       [ 2.53765429e-05,  2.72195719e-05,  3.71830380e-04,
         1.31574313e-07,  1.22861831e-07, -1.84307779e-07],
       [ 4.63785658e-07,  4.56052582e-07,  1.31574313e-07,
         1.80821433e-09,  7.48040865e-10,  6.89828065e-10],
       [ 2.08905854e-07,  1.50904262e-06,  1.22861831e-07,
         7.48040865e-10,  2.12900645e-09,  4.04653230e-10],
       [ 8.39813696e-09,  7.17666659e-08, -1.84307779e-07,
         6.89828065e-10,  4.04653230e-10,  2.11023430e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.52060357e-06],
       [-3.12389109e-05],
       [-2.32147491e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.90787238e+03],
       [ 3.34694191e+03],
       [-3.94448864e+03],
       [-3.71479723e+00],
       [-1.84010035e+00],
       [-6.21321770e+00],
       [ 7.58763218e-01],
       [ 2.41155980e-01],
       [-5.87546609e-01],
       [ 1.44606897e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65440195e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.59345483e-04, -1.45788197e-03,  2.47095501e-04,
         6.70526013e-06,  1.11571781e-06,  5.24836848e-06],
       [-1.45788197e-03,  4.73865454e-02, -2.61678630e-03,
        -3.19022655e-05,  2.79476382e-05, -4.16445389e-05],
       [ 2.47095501e-04, -2.61678630e-03,  8.08197394e-04,
         6.06381976e-06,  8.51582025e-07,  8.73754222e-06],
       [ 6.70526013e-06, -3.19022655e-05,  6.06381976e-06,
         1.93682716e-07,  3.69976716e-08,  1.46950251e-07],
       [ 1.11571781e-06,  2.79476382e-05,  8.51582025e-07,
         3.69976716e-08,  1.12311805e-07,  3.96385928e-08],
       [ 5.24836848e-06, -4.16445389e-05,  8.73754222e-06,
         1.46950251e-07,  3.96385928e-08,  2.47258381e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.47366363e-06],
       [-2.67259454e-05],
       [-1.17308889e-02]])}}
Yi [[ 1.64009069]
 [-0.12833897]
 [13.85433406]]
posterior
[[ 4.90787238e+03]
 [ 3.34694191e+03]
 [-3.94448864e+03]
 [-3.71479723e+00]
 [-1.84010035e+00]
 [-6.21321770e+00]
 [ 7.58763218e-01]
 [ 2.41155980e-01]
 [-5.87546609e-01]
 [ 1.44606897e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65440195e-18]]
[[ 4.90787463e+03]
 [ 3.34698323e+03]
 [-3.94448348e+03]
 [-3.71476338e+00]
 [-1.84004515e+00]
 [-6.21317498e+00]
 [ 7.58763218e-01]
 [ 2.41155980e-01]
 [-5.87546609e-01]
 [ 1.44606897e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65440195e-18]]
[[ 5.64613650e-04 -1.77167833e-03  2.35569184e-04  5.94173107e-06
   5.93382728e-07  4.84540894e-06]
 [-1.77167833e-03  4.32556843e-02 -3.08556482e-03 -3.57952790e-05
   2.23583161e-05 -4.58660797e-05]
 [ 2.35569184e-04 -3.08556482e-03  7.46807657e-04  5.78090619e-06
   2.50470437e-07  8.28633523e-06]
 [ 5.94173107e-06 -3.57952790e-05  5.78090619e-06  1.86926858e-07
   3.10850417e-08  1.42428495e-07]
 [ 5.93382728e-07  2.23583161e-05  2.50470437e-07  3.10850417e-08
   1.04614225e-07  3.38128720e-08]
 [ 4.84540894e-06 -4.58660797e-05  8.28633523e-06  1.42428495e-07
   3.38128720e-08  2.42847926e-07]]
[[ 1.64009684]
 [-0.12835709]
 [14.02797651]]
[[-6.15583086e-06]
 [ 1.81159024e-05]
 [-1.73642458e-01]]


 Corrector Step
2018-07-13 19:33:20
[[ 4.90787463e+03]
 [ 3.34698323e+03]
 [-3.94448348e+03]
 [-3.71476338e+00]
 [-1.84004515e+00]
 [-6.21317498e+00]
 [ 7.58763218e-01]
 [ 2.41155980e-01]
 [-5.87546609e-01]
 [ 1.44606897e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65440195e-18]]
[[ 5.64613650e-04 -1.77167833e-03  2.35569184e-04  5.94173107e-06
   5.93382728e-07  4.84540894e-06]
 [-1.77167833e-03  4.32556843e-02 -3.08556482e-03 -3.57952790e-05
   2.23583161e-05 -4.58660797e-05]
 [ 2.35569184e-04 -3.08556482e-03  7.46807657e-04  5.78090619e-06
   2.50470437e-07  8.28633523e-06]
 [ 5.94173107e-06 -3.57952790e-05  5.78090619e-06  1.86926858e-07
   3.10850417e-08  1.42428495e-07]
 [ 5.93382728e-07  2.23583161e-05  2.50470437e-07  3.10850417e-08
   1.04614225e-07  3.38128720e-08]
 [ 4.84540894e-06 -4.58660797e-05  8.28633523e-06  1.42428495e-07
   3.38128720e-08  2.42847926e-07]]
147405049.18225437
post
cubesat_nadir
Ybar_post [[ 1.64009438]
 [-0.12835219]
 [14.02805026]]
resids [[-3.69496992e-06]
 [ 1.32138624e-05]
 [-1.73716209e-01]]
posterior
[[ 4.90788312e+03]
 [ 3.34693557e+03]
 [-3.94447524e+03]
 [-3.71455986e+00]
 [-1.83997042e+00]
 [-6.21292709e+00]]
[[ 4.90788381e+03]
 [ 3.34693748e+03]
 [-3.94447220e+03]
 [-3.71455798e+00]
 [-1.83996797e+00]
 [-6.21292851e+00]]
[[ 3.40203928e-04  1.00681923e-04  1.78501398e-05  3.95782838e-07
   1.63808220e-07  8.43025466e-09]
 [ 1.00681923e-04  1.81159214e-03 -6.75141821e-06  3.97282777e-07
   1.45520452e-06  8.53573507e-08]
 [ 1.78501398e-05 -6.75141821e-06  3.26112771e-04  1.05669558e-07
   8.24941930e-08 -1.63135964e-07]
 [ 3.95782838e-07  3.97282777e-07  1.05669558e-07  1.71699258e-09
   6.78990333e-10  6.97677396e-10]
 [ 1.63808220e-07  1.45520452e-06  8.24941930e-08  6.78990333e-10
   2.06550474e-09  4.20845566e-10]
 [ 8.43025466e-09  8.53573507e-08 -1.63135964e-07  6.97677396e-10
   4.20845566e-10  2.10020494e-09]]
[[ 1.6400919 ]
 [-0.12835123]
 [16.45169687]]
[[-1.20864534e-06]
 [ 1.22597461e-05]
 [-2.59736282e+00]]


 Corrector Step
2018-07-13 19:33:20
[[ 4.90788381e+03]
 [ 3.34693748e+03]
 [-3.94447220e+03]
 [-3.71455798e+00]
 [-1.83996797e+00]
 [-6.21292851e+00]]
[[ 3.40203928e-04  1.00681923e-04  1.78501398e-05  3.95782838e-07
   1.63808220e-07  8.43025466e-09]
 [ 1.00681923e-04  1.81159214e-03 -6.75141821e-06  3.97282777e-07
   1.45520452e-06  8.53573507e-08]
 [ 1.78501398e-05 -6.75141821e-06  3.26112771e-04  1.05669558e-07
   8.24941930e-08 -1.63135964e-07]
 [ 3.95782838e-07  3.97282777e-07  1.05669558e-07  1.71699258e-09
   6.78990333e-10  6.97677396e-10]
 [ 1.63808220e-07  1.45520452e-06  8.24941930e-08  6.78990333e-10
   2.06550474e-09  4.20845566e-10]
 [ 8.43025466e-09  8.53573507e-08 -1.63135964e-07  6.97677396e-10
   4.20845566e-10  2.10020494e-09]]
2.672489105468495e-138
post
sphere_lamr_small
Ybar_post [[ 1.64009153]
 [-0.1283497 ]
 [16.45170465]]
resids [[-8.39743619e-07]
 [ 1.07297807e-05]
 [-2.59737060e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [147405049.18225437, 2.672489105468495e-138]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.90787463e+03],
       [ 3.34698323e+03],
       [-3.94448348e+03],
       [-3.71476338e+00],
       [-1.84004515e+00],
       [-6.21317498e+00]]), 'est_covars': array([[ 5.64613650e-04, -1.77167833e-03,  2.35569184e-04,
         5.94173107e-06,  5.93382728e-07,  4.84540894e-06],
       [-1.77167833e-03,  4.32556843e-02, -3.08556482e-03,
        -3.57952790e-05,  2.23583161e-05, -4.58660797e-05],
       [ 2.35569184e-04, -3.08556482e-03,  7.46807657e-04,
         5.78090619e-06,  2.50470437e-07,  8.28633523e-06],
       [ 5.94173107e-06, -3.57952790e-05,  5.78090619e-06,
         1.86926858e-07,  3.10850417e-08,  1.42428495e-07],
       [ 5.93382728e-07,  2.23583161e-05,  2.50470437e-07,
         3.10850417e-08,  1.04614225e-07,  3.38128720e-08],
       [ 4.84540894e-06, -4.58660797e-05,  8.28633523e-06,
         1.42428495e-07,  3.38128720e-08,  2.42847926e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.90788381e+03],
       [ 3.34693748e+03],
       [-3.94447220e+03],
       [-3.71455798e+00],
       [-1.83996797e+00],
       [-6.21292851e+00]]), 'covar': array([[ 3.40203928e-04,  1.00681923e-04,  1.78501398e-05,
         3.95782838e-07,  1.63808220e-07,  8.43025466e-09],
       [ 1.00681923e-04,  1.81159214e-03, -6.75141821e-06,
         3.97282777e-07,  1.45520452e-06,  8.53573507e-08],
       [ 1.78501398e-05, -6.75141821e-06,  3.26112771e-04,
         1.05669558e-07,  8.24941930e-08, -1.63135964e-07],
       [ 3.95782838e-07,  3.97282777e-07,  1.05669558e-07,
         1.71699258e-09,  6.78990333e-10,  6.97677396e-10],
       [ 1.63808220e-07,  1.45520452e-06,  8.24941930e-08,
         6.78990333e-10,  2.06550474e-09,  4.20845566e-10],
       [ 8.43025466e-09,  8.53573507e-08, -1.63135964e-07,
         6.97677396e-10,  4.20845566e-10,  2.10020494e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-8.39743619e-07],
       [ 1.07297807e-05],
       [-2.59737060e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.90787463e+03],
       [ 3.34698323e+03],
       [-3.94448348e+03],
       [-3.71476338e+00],
       [-1.84004515e+00],
       [-6.21317498e+00],
       [ 7.58763218e-01],
       [ 2.41155980e-01],
       [-5.87546609e-01],
       [ 1.44606897e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65440195e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.64613650e-04, -1.77167833e-03,  2.35569184e-04,
         5.94173107e-06,  5.93382728e-07,  4.84540894e-06],
       [-1.77167833e-03,  4.32556843e-02, -3.08556482e-03,
        -3.57952790e-05,  2.23583161e-05, -4.58660797e-05],
       [ 2.35569184e-04, -3.08556482e-03,  7.46807657e-04,
         5.78090619e-06,  2.50470437e-07,  8.28633523e-06],
       [ 5.94173107e-06, -3.57952790e-05,  5.78090619e-06,
         1.86926858e-07,  3.10850417e-08,  1.42428495e-07],
       [ 5.93382728e-07,  2.23583161e-05,  2.50470437e-07,
         3.10850417e-08,  1.04614225e-07,  3.38128720e-08],
       [ 4.84540894e-06, -4.58660797e-05,  8.28633523e-06,
         1.42428495e-07,  3.38128720e-08,  2.42847926e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.69496992e-06],
       [ 1.32138624e-05],
       [-1.73716209e-01]])}}
Current time:  2018-07-13 19:33:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.90787463e+03],
       [ 3.34698323e+03],
       [-3.94448348e+03],
       [-3.71476338e+00],
       [-1.84004515e+00],
       [-6.21317498e+00],
       [ 7.58763218e-01],
       [ 2.41155980e-01],
       [-5.87546609e-01],
       [ 1.44606897e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65440195e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.64613650e-04, -1.77167833e-03,  2.35569184e-04,
         5.94173107e-06,  5.93382728e-07,  4.84540894e-06],
       [-1.77167833e-03,  4.32556843e-02, -3.08556482e-03,
        -3.57952790e-05,  2.23583161e-05, -4.58660797e-05],
       [ 2.35569184e-04, -3.08556482e-03,  7.46807657e-04,
         5.78090619e-06,  2.50470437e-07,  8.28633523e-06],
       [ 5.94173107e-06, -3.57952790e-05,  5.78090619e-06,
         1.86926858e-07,  3.10850417e-08,  1.42428495e-07],
       [ 5.93382728e-07,  2.23583161e-05,  2.50470437e-07,
         3.10850417e-08,  1.04614225e-07,  3.38128720e-08],
       [ 4.84540894e-06, -4.58660797e-05,  8.28633523e-06,
         1.42428495e-07,  3.38128720e-08,  2.42847926e-07]])}
[[ 4.90787463e+03]
 [ 3.34698323e+03]
 [-3.94448348e+03]
 [-3.71476338e+00]
 [-1.84004515e+00]
 [-6.21317498e+00]
 [ 7.58763218e-01]
 [ 2.41155980e-01]
 [-5.87546609e-01]
 [ 1.44606897e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65440195e-18]]
2018-07-13 19:33:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:30
[[ 4.87045790e+03]
 [ 3.32839914e+03]
 [-4.00639683e+03]
 [-3.76847029e+00]
 [-1.87670936e+00]
 [-6.16939170e+00]
 [ 7.55685110e-01]
 [ 2.40397655e-01]
 [-5.91500340e-01]
 [ 1.45864077e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65461424e-18]]
[[ 7.02313676e-04 -2.11795819e-03  3.55855726e-04  7.83517130e-06
   9.17584046e-07  6.27661452e-06]
 [-2.11795819e-03  4.37120713e-02 -3.54006003e-03 -3.49904422e-05
   2.32973476e-05 -4.58761338e-05]
 [ 3.55855726e-04 -3.54006003e-03  9.37335959e-04  7.15919565e-06
   5.96736654e-07  1.07922791e-05]
 [ 7.83517130e-06 -3.49904422e-05  7.15919565e-06  1.96077690e-07
   3.14742088e-08  1.42062808e-07]
 [ 9.17584046e-07  2.32973476e-05  5.96736654e-07  3.14742088e-08
   1.14450553e-07  3.37563814e-08]
 [ 6.27661452e-06 -4.58761338e-05  1.07922791e-05  1.42062808e-07
   3.37563814e-08  2.53485184e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.90788381e+03],
       [ 3.34693748e+03],
       [-3.94447220e+03],
       [-3.71455798e+00],
       [-1.83996797e+00],
       [-6.21292851e+00]]), 'covar': array([[ 3.40203928e-04,  1.00681923e-04,  1.78501398e-05,
         3.95782838e-07,  1.63808220e-07,  8.43025466e-09],
       [ 1.00681923e-04,  1.81159214e-03, -6.75141821e-06,
         3.97282777e-07,  1.45520452e-06,  8.53573507e-08],
       [ 1.78501398e-05, -6.75141821e-06,  3.26112771e-04,
         1.05669558e-07,  8.24941930e-08, -1.63135964e-07],
       [ 3.95782838e-07,  3.97282777e-07,  1.05669558e-07,
         1.71699258e-09,  6.78990333e-10,  6.97677396e-10],
       [ 1.63808220e-07,  1.45520452e-06,  8.24941930e-08,
         6.78990333e-10,  2.06550474e-09,  4.20845566e-10],
       [ 8.43025466e-09,  8.53573507e-08, -1.63135964e-07,
         6.97677396e-10,  4.20845566e-10,  2.10020494e-09]])}
[[ 4.90788381e+03]
 [ 3.34693748e+03]
 [-3.94447220e+03]
 [-3.71455798e+00]
 [-1.83996797e+00]
 [-6.21292851e+00]]
2018-07-13 19:33:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:30
[[ 4.87046930e+03]
 [ 3.32835422e+03]
 [-4.00638316e+03]
 [-3.76826571e+00]
 [-1.87663204e+00]
 [-6.16914458e+00]]
[[ 3.48323083e-04  1.06485775e-04  1.90153165e-05  4.15900439e-07
   1.73758878e-07  1.00934735e-08]
 [ 1.06485775e-04  1.84086839e-03 -5.12663534e-06  4.23970241e-07
   1.47054407e-06  7.23864632e-08]
 [ 1.90153165e-05 -5.12663534e-06  3.23057799e-04  1.08536836e-07
   8.40512811e-08 -1.42059421e-07]
 [ 4.15900439e-07  4.23970241e-07  1.08536836e-07  1.82658640e-09
   6.95942238e-10  6.91752935e-10]
 [ 1.73758878e-07  1.47054407e-06  8.40512811e-08  6.95942238e-10
   2.15658883e-09  4.07207900e-10]
 [ 1.00934735e-08  7.23864632e-08 -1.42059421e-07  6.91752935e-10
   4.07207900e-10  2.19901658e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.87046930e+03],
       [ 3.32835422e+03],
       [-4.00638316e+03],
       [-3.76826571e+00],
       [-1.87663204e+00],
       [-6.16914458e+00]]), 'covar': array([[ 3.48323083e-04,  1.06485775e-04,  1.90153165e-05,
         4.15900439e-07,  1.73758878e-07,  1.00934735e-08],
       [ 1.06485775e-04,  1.84086839e-03, -5.12663534e-06,
         4.23970241e-07,  1.47054407e-06,  7.23864632e-08],
       [ 1.90153165e-05, -5.12663534e-06,  3.23057799e-04,
         1.08536836e-07,  8.40512811e-08, -1.42059421e-07],
       [ 4.15900439e-07,  4.23970241e-07,  1.08536836e-07,
         1.82658640e-09,  6.95942238e-10,  6.91752935e-10],
       [ 1.73758878e-07,  1.47054407e-06,  8.40512811e-08,
         6.95942238e-10,  2.15658883e-09,  4.07207900e-10],
       [ 1.00934735e-08,  7.23864632e-08, -1.42059421e-07,
         6.91752935e-10,  4.07207900e-10,  2.19901658e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-8.39743619e-07],
       [ 1.07297807e-05],
       [-2.59737060e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.87045790e+03],
       [ 3.32839914e+03],
       [-4.00639683e+03],
       [-3.76847029e+00],
       [-1.87670936e+00],
       [-6.16939170e+00],
       [ 7.55685110e-01],
       [ 2.40397655e-01],
       [-5.91500340e-01],
       [ 1.45864077e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65461424e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.02313676e-04, -2.11795819e-03,  3.55855726e-04,
         7.83517130e-06,  9.17584046e-07,  6.27661452e-06],
       [-2.11795819e-03,  4.37120713e-02, -3.54006003e-03,
        -3.49904422e-05,  2.32973476e-05, -4.58761338e-05],
       [ 3.55855726e-04, -3.54006003e-03,  9.37335959e-04,
         7.15919565e-06,  5.96736654e-07,  1.07922791e-05],
       [ 7.83517130e-06, -3.49904422e-05,  7.15919565e-06,
         1.96077690e-07,  3.14742088e-08,  1.42062808e-07],
       [ 9.17584046e-07,  2.32973476e-05,  5.96736654e-07,
         3.14742088e-08,  1.14450553e-07,  3.37563814e-08],
       [ 6.27661452e-06, -4.58761338e-05,  1.07922791e-05,
         1.42062808e-07,  3.37563814e-08,  2.53485184e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.69496992e-06],
       [ 1.32138624e-05],
       [-1.73716209e-01]])}}
Yi [[ 1.65830702]
 [-0.15866616]
 [13.99158684]]
posterior
[[ 4.87045790e+03]
 [ 3.32839914e+03]
 [-4.00639683e+03]
 [-3.76847029e+00]
 [-1.87670936e+00]
 [-6.16939170e+00]
 [ 7.55685110e-01]
 [ 2.40397655e-01]
 [-5.91500340e-01]
 [ 1.45864077e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65461424e-18]]
[[ 4.87046851e+03]
 [ 3.32844900e+03]
 [-4.00639448e+03]
 [-3.76836698e+00]
 [-1.87663086e+00]
 [-6.16933249e+00]
 [ 7.55685110e-01]
 [ 2.40397655e-01]
 [-5.91500340e-01]
 [ 1.45864077e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65461424e-18]]
[[ 6.19272275e-04 -2.35440778e-03  3.52865614e-04  7.08530485e-06
   4.90662198e-07  5.95378886e-06]
 [-2.35440778e-03  3.97577098e-02 -3.89992224e-03 -3.84592252e-05
   1.80165072e-05 -5.00043307e-05]
 [ 3.52865614e-04 -3.89992224e-03  8.99596598e-04  6.98935112e-06
   1.46022596e-07  1.04369451e-05]
 [ 7.08530485e-06 -3.84592252e-05  6.98935112e-06  1.88764160e-07
   2.59666278e-08  1.37843014e-07]
 [ 4.90662198e-07  1.80165072e-05  1.46022596e-07  2.59666278e-08
   1.07218868e-07  2.81205576e-08]
 [ 5.95378886e-06 -5.00043307e-05  1.04369451e-05  1.37843014e-07
   2.81205576e-08  2.49090905e-07]]
[[ 1.65833938]
 [-0.15867594]
 [13.85105467]]
[[-3.23662009e-05]
 [ 9.77727086e-06]
 [ 1.40532168e-01]]


 Corrector Step
2018-07-13 19:33:30
[[ 4.87046851e+03]
 [ 3.32844900e+03]
 [-4.00639448e+03]
 [-3.76836698e+00]
 [-1.87663086e+00]
 [-6.16933249e+00]
 [ 7.55685110e-01]
 [ 2.40397655e-01]
 [-5.91500340e-01]
 [ 1.45864077e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65461424e-18]]
[[ 6.19272275e-04 -2.35440778e-03  3.52865614e-04  7.08530485e-06
   4.90662198e-07  5.95378886e-06]
 [-2.35440778e-03  3.97577098e-02 -3.89992224e-03 -3.84592252e-05
   1.80165072e-05 -5.00043307e-05]
 [ 3.52865614e-04 -3.89992224e-03  8.99596598e-04  6.98935112e-06
   1.46022596e-07  1.04369451e-05]
 [ 7.08530485e-06 -3.84592252e-05  6.98935112e-06  1.88764160e-07
   2.59666278e-08  1.37843014e-07]
 [ 4.90662198e-07  1.80165072e-05  1.46022596e-07  2.59666278e-08
   1.07218868e-07  2.81205576e-08]
 [ 5.95378886e-06 -5.00043307e-05  1.04369451e-05  1.37843014e-07
   2.81205576e-08  2.49090905e-07]]
148985712.6476737
post
cubesat_nadir
Ybar_post [[ 1.65833221]
 [-0.15867118]
 [13.85114965]]
resids [[-2.51991645e-05]
 [ 5.02206474e-06]
 [ 1.40437183e-01]]
posterior
[[ 4.87046930e+03]
 [ 3.32835422e+03]
 [-4.00638316e+03]
 [-3.76826571e+00]
 [-1.87663204e+00]
 [-6.16914458e+00]]
[[ 4.87047676e+03]
 [ 3.32836043e+03]
 [-4.00638148e+03]
 [-3.76825581e+00]
 [-1.87662490e+00]
 [-6.16914479e+00]]
[[ 3.04678537e-04  7.16739262e-05  1.41926567e-05  3.59564976e-07
   1.34494980e-07  9.14101560e-09]
 [ 7.16739262e-05  1.79037285e-03 -3.66053041e-05  3.67746813e-07
   1.41423947e-06  8.30201523e-08]
 [ 1.41926567e-05 -3.66053041e-05  2.88931487e-04  8.85873678e-08
   4.93354168e-08 -1.28313219e-07]
 [ 3.59564976e-07  3.67746813e-07  8.85873678e-08  1.74826267e-09
   6.32850649e-10  6.96182484e-10]
 [ 1.34494980e-07  1.41423947e-06  4.93354168e-08  6.32850649e-10
   2.09379667e-09  4.18876373e-10]
 [ 9.14101560e-09  8.30201523e-08 -1.28313219e-07  6.96182484e-10
   4.18876373e-10  2.19328448e-09]]
[[ 1.65833575]
 [-0.15867296]
 [16.35324931]]
[[-2.87303176e-05]
 [ 6.80076391e-06]
 [-2.36166248e+00]]


 Corrector Step
2018-07-13 19:33:30
[[ 4.87047676e+03]
 [ 3.32836043e+03]
 [-4.00638148e+03]
 [-3.76825581e+00]
 [-1.87662490e+00]
 [-6.16914479e+00]]
[[ 3.04678537e-04  7.16739262e-05  1.41926567e-05  3.59564976e-07
   1.34494980e-07  9.14101560e-09]
 [ 7.16739262e-05  1.79037285e-03 -3.66053041e-05  3.67746813e-07
   1.41423947e-06  8.30201523e-08]
 [ 1.41926567e-05 -3.66053041e-05  2.88931487e-04  8.85873678e-08
   4.93354168e-08 -1.28313219e-07]
 [ 3.59564976e-07  3.67746813e-07  8.85873678e-08  1.74826267e-09
   6.32850649e-10  6.96182484e-10]
 [ 1.34494980e-07  1.41423947e-06  4.93354168e-08  6.32850649e-10
   2.09379667e-09  4.18876373e-10]
 [ 9.14101560e-09  8.30201523e-08 -1.28313219e-07  6.96182484e-10
   4.18876373e-10  2.19328448e-09]]
3.840912041256928e-113
post
sphere_lamr_small
Ybar_post [[ 1.65833199]
 [-0.15867176]
 [16.35325106]]
resids [[-2.49709626e-05]
 [ 5.60217526e-06]
 [-2.36166423e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [148985712.6476737, 3.840912041256928e-113]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.87046851e+03],
       [ 3.32844900e+03],
       [-4.00639448e+03],
       [-3.76836698e+00],
       [-1.87663086e+00],
       [-6.16933249e+00]]), 'est_covars': array([[ 6.19272275e-04, -2.35440778e-03,  3.52865614e-04,
         7.08530485e-06,  4.90662198e-07,  5.95378886e-06],
       [-2.35440778e-03,  3.97577098e-02, -3.89992224e-03,
        -3.84592252e-05,  1.80165072e-05, -5.00043307e-05],
       [ 3.52865614e-04, -3.89992224e-03,  8.99596598e-04,
         6.98935112e-06,  1.46022596e-07,  1.04369451e-05],
       [ 7.08530485e-06, -3.84592252e-05,  6.98935112e-06,
         1.88764160e-07,  2.59666278e-08,  1.37843014e-07],
       [ 4.90662198e-07,  1.80165072e-05,  1.46022596e-07,
         2.59666278e-08,  1.07218868e-07,  2.81205576e-08],
       [ 5.95378886e-06, -5.00043307e-05,  1.04369451e-05,
         1.37843014e-07,  2.81205576e-08,  2.49090905e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.87047676e+03],
       [ 3.32836043e+03],
       [-4.00638148e+03],
       [-3.76825581e+00],
       [-1.87662490e+00],
       [-6.16914479e+00]]), 'covar': array([[ 3.04678537e-04,  7.16739262e-05,  1.41926567e-05,
         3.59564976e-07,  1.34494980e-07,  9.14101560e-09],
       [ 7.16739262e-05,  1.79037285e-03, -3.66053041e-05,
         3.67746813e-07,  1.41423947e-06,  8.30201523e-08],
       [ 1.41926567e-05, -3.66053041e-05,  2.88931487e-04,
         8.85873678e-08,  4.93354168e-08, -1.28313219e-07],
       [ 3.59564976e-07,  3.67746813e-07,  8.85873678e-08,
         1.74826267e-09,  6.32850649e-10,  6.96182484e-10],
       [ 1.34494980e-07,  1.41423947e-06,  4.93354168e-08,
         6.32850649e-10,  2.09379667e-09,  4.18876373e-10],
       [ 9.14101560e-09,  8.30201523e-08, -1.28313219e-07,
         6.96182484e-10,  4.18876373e-10,  2.19328448e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.49709626e-05],
       [ 5.60217526e-06],
       [-2.36166423e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.87046851e+03],
       [ 3.32844900e+03],
       [-4.00639448e+03],
       [-3.76836698e+00],
       [-1.87663086e+00],
       [-6.16933249e+00],
       [ 7.55685110e-01],
       [ 2.40397655e-01],
       [-5.91500340e-01],
       [ 1.45864077e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65461424e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.19272275e-04, -2.35440778e-03,  3.52865614e-04,
         7.08530485e-06,  4.90662198e-07,  5.95378886e-06],
       [-2.35440778e-03,  3.97577098e-02, -3.89992224e-03,
        -3.84592252e-05,  1.80165072e-05, -5.00043307e-05],
       [ 3.52865614e-04, -3.89992224e-03,  8.99596598e-04,
         6.98935112e-06,  1.46022596e-07,  1.04369451e-05],
       [ 7.08530485e-06, -3.84592252e-05,  6.98935112e-06,
         1.88764160e-07,  2.59666278e-08,  1.37843014e-07],
       [ 4.90662198e-07,  1.80165072e-05,  1.46022596e-07,
         2.59666278e-08,  1.07218868e-07,  2.81205576e-08],
       [ 5.95378886e-06, -5.00043307e-05,  1.04369451e-05,
         1.37843014e-07,  2.81205576e-08,  2.49090905e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.51991645e-05],
       [ 5.02206474e-06],
       [ 1.40437183e-01]])}}
Current time:  2018-07-13 19:33:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.87046851e+03],
       [ 3.32844900e+03],
       [-4.00639448e+03],
       [-3.76836698e+00],
       [-1.87663086e+00],
       [-6.16933249e+00],
       [ 7.55685110e-01],
       [ 2.40397655e-01],
       [-5.91500340e-01],
       [ 1.45864077e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65461424e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 6.19272275e-04, -2.35440778e-03,  3.52865614e-04,
         7.08530485e-06,  4.90662198e-07,  5.95378886e-06],
       [-2.35440778e-03,  3.97577098e-02, -3.89992224e-03,
        -3.84592252e-05,  1.80165072e-05, -5.00043307e-05],
       [ 3.52865614e-04, -3.89992224e-03,  8.99596598e-04,
         6.98935112e-06,  1.46022596e-07,  1.04369451e-05],
       [ 7.08530485e-06, -3.84592252e-05,  6.98935112e-06,
         1.88764160e-07,  2.59666278e-08,  1.37843014e-07],
       [ 4.90662198e-07,  1.80165072e-05,  1.46022596e-07,
         2.59666278e-08,  1.07218868e-07,  2.81205576e-08],
       [ 5.95378886e-06, -5.00043307e-05,  1.04369451e-05,
         1.37843014e-07,  2.81205576e-08,  2.49090905e-07]])}
[[ 4.87046851e+03]
 [ 3.32844900e+03]
 [-4.00639448e+03]
 [-3.76836698e+00]
 [-1.87663086e+00]
 [-6.16933249e+00]
 [ 7.55685110e-01]
 [ 2.40397655e-01]
 [-5.91500340e-01]
 [ 1.45864077e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65461424e-18]]
2018-07-13 19:33:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:40
[[ 4.83251798e+03]
 [ 3.30950015e+03]
 [-4.06786602e+03]
 [-3.82165276e+00]
 [-1.91308417e+00]
 [-6.12487576e+00]
 [ 7.52586401e-01]
 [ 2.39632776e-01]
 [-5.95437946e-01]
 [ 1.47117280e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65482653e-18]]
[[ 7.79825362e-04 -2.72909912e-03  4.95840219e-04  8.98950313e-06
   7.65444512e-07  7.34322133e-06]
 [-2.72909912e-03  4.01276041e-02 -4.39723204e-03 -3.77397984e-05
   1.89934817e-05 -5.00369368e-05]
 [ 4.95840219e-04 -4.39723204e-03  1.13383787e-03  8.31140805e-06
   4.38831445e-07  1.30117650e-05]
 [ 8.98950313e-06 -3.77397984e-05  8.31140805e-06  1.97843889e-07
   2.63217872e-08  1.37428060e-07]
 [ 7.65444512e-07  1.89934817e-05  4.38831445e-07  2.63217872e-08
   1.17084239e-07  2.81121537e-08]
 [ 7.34322133e-06 -5.00369368e-05  1.30117650e-05  1.37428060e-07
   2.81121537e-08  2.59783829e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.87047676e+03],
       [ 3.32836043e+03],
       [-4.00638148e+03],
       [-3.76825581e+00],
       [-1.87662490e+00],
       [-6.16914479e+00]]), 'covar': array([[ 3.04678537e-04,  7.16739262e-05,  1.41926567e-05,
         3.59564976e-07,  1.34494980e-07,  9.14101560e-09],
       [ 7.16739262e-05,  1.79037285e-03, -3.66053041e-05,
         3.67746813e-07,  1.41423947e-06,  8.30201523e-08],
       [ 1.41926567e-05, -3.66053041e-05,  2.88931487e-04,
         8.85873678e-08,  4.93354168e-08, -1.28313219e-07],
       [ 3.59564976e-07,  3.67746813e-07,  8.85873678e-08,
         1.74826267e-09,  6.32850649e-10,  6.96182484e-10],
       [ 1.34494980e-07,  1.41423947e-06,  4.93354168e-08,
         6.32850649e-10,  2.09379667e-09,  4.18876373e-10],
       [ 9.14101560e-09,  8.30201523e-08, -1.28313219e-07,
         6.96182484e-10,  4.18876373e-10,  2.19328448e-09]])}
[[ 4.87047676e+03]
 [ 3.32836043e+03]
 [-4.00638148e+03]
 [-3.76825581e+00]
 [-1.87662490e+00]
 [-6.16914479e+00]]
2018-07-13 19:33:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:40
[[ 4.83252713e+03]
 [ 3.30941144e+03]
 [-4.06785136e+03]
 [-3.82154238e+00]
 [-1.91307804e+00]
 [-6.12468764e+00]]
[[ 3.12323705e-04  7.71490510e-05  1.53240093e-05  3.79410156e-07
   1.43709076e-07  1.15029826e-08]
 [ 7.71490510e-05  1.81910857e-03 -3.51967281e-05  3.93640399e-07
   1.42976211e-06  7.05080642e-08]
 [ 1.53240093e-05 -3.51967281e-05  2.86649670e-04  9.15125094e-08
   5.12491614e-08 -1.05869578e-07]
 [ 3.79410156e-07  3.93640399e-07  9.15125094e-08  1.85705020e-09
   6.49195536e-10  6.90472127e-10]
 [ 1.43709076e-07  1.42976211e-06  5.12491614e-08  6.49195536e-10
   2.18484272e-09  4.05546571e-10]
 [ 1.15029826e-08  7.05080642e-08 -1.05869578e-07  6.90472127e-10
   4.05546571e-10  2.29177419e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.83252713e+03],
       [ 3.30941144e+03],
       [-4.06785136e+03],
       [-3.82154238e+00],
       [-1.91307804e+00],
       [-6.12468764e+00]]), 'covar': array([[ 3.12323705e-04,  7.71490510e-05,  1.53240093e-05,
         3.79410156e-07,  1.43709076e-07,  1.15029826e-08],
       [ 7.71490510e-05,  1.81910857e-03, -3.51967281e-05,
         3.93640399e-07,  1.42976211e-06,  7.05080642e-08],
       [ 1.53240093e-05, -3.51967281e-05,  2.86649670e-04,
         9.15125094e-08,  5.12491614e-08, -1.05869578e-07],
       [ 3.79410156e-07,  3.93640399e-07,  9.15125094e-08,
         1.85705020e-09,  6.49195536e-10,  6.90472127e-10],
       [ 1.43709076e-07,  1.42976211e-06,  5.12491614e-08,
         6.49195536e-10,  2.18484272e-09,  4.05546571e-10],
       [ 1.15029826e-08,  7.05080642e-08, -1.05869578e-07,
         6.90472127e-10,  4.05546571e-10,  2.29177419e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.49709626e-05],
       [ 5.60217526e-06],
       [-2.36166423e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.83251798e+03],
       [ 3.30950015e+03],
       [-4.06786602e+03],
       [-3.82165276e+00],
       [-1.91308417e+00],
       [-6.12487576e+00],
       [ 7.52586401e-01],
       [ 2.39632776e-01],
       [-5.95437946e-01],
       [ 1.47117280e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65482653e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.79825362e-04, -2.72909912e-03,  4.95840219e-04,
         8.98950313e-06,  7.65444512e-07,  7.34322133e-06],
       [-2.72909912e-03,  4.01276041e-02, -4.39723204e-03,
        -3.77397984e-05,  1.89934817e-05, -5.00369368e-05],
       [ 4.95840219e-04, -4.39723204e-03,  1.13383787e-03,
         8.31140805e-06,  4.38831445e-07,  1.30117650e-05],
       [ 8.98950313e-06, -3.77397984e-05,  8.31140805e-06,
         1.97843889e-07,  2.63217872e-08,  1.37428060e-07],
       [ 7.65444512e-07,  1.89934817e-05,  4.38831445e-07,
         2.63217872e-08,  1.17084239e-07,  2.81121537e-08],
       [ 7.34322133e-06, -5.00369368e-05,  1.30117650e-05,
         1.37428060e-07,  2.81121537e-08,  2.59783829e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-2.51991645e-05],
       [ 5.02206474e-06],
       [ 1.40437183e-01]])}}
Yi [[ 1.6771816 ]
 [-0.18899555]
 [13.61355726]]
posterior
[[ 4.83251798e+03]
 [ 3.30950015e+03]
 [-4.06786602e+03]
 [-3.82165276e+00]
 [-1.91308417e+00]
 [-6.12487576e+00]
 [ 7.52586401e-01]
 [ 2.39632776e-01]
 [-5.95437946e-01]
 [ 1.47117280e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65482653e-18]]
[[ 4.83251866e+03]
 [ 3.30955269e+03]
 [-4.06786164e+03]
 [-3.82162570e+00]
 [-1.91301721e+00]
 [-6.12482044e+00]
 [ 7.52586401e-01]
 [ 2.39632776e-01]
 [-5.95437946e-01]
 [ 1.47117280e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65482653e-18]]
[[ 7.02709213e-04 -2.89142149e-03  4.98762569e-04  8.23933375e-06
   4.28316314e-07  7.11304965e-06]
 [-2.89142149e-03  3.66044537e-02 -4.66057062e-03 -4.05733846e-05
   1.43164410e-05 -5.37848905e-05]
 [ 4.98762569e-04 -4.66057062e-03  1.11089185e-03  8.23354079e-06
   1.15518709e-07  1.27439691e-05]
 [ 8.23933375e-06 -4.05733846e-05  8.23354079e-06  1.90051600e-07
   2.14777220e-08  1.33901828e-07]
 [ 4.28316314e-07  1.43164410e-05  1.15518709e-07  2.14777220e-08
   1.10662828e-07  2.30359939e-08]
 [ 7.11304965e-06 -5.37848905e-05  1.27439691e-05  1.33901828e-07
   2.30359939e-08  2.55748376e-07]]
[[ 1.67718774]
 [-0.18902098]
 [13.70459986]]
[[-6.13607461e-06]
 [ 2.54244872e-05]
 [-9.10425993e-02]]


 Corrector Step
2018-07-13 19:33:40
[[ 4.83251866e+03]
 [ 3.30955269e+03]
 [-4.06786164e+03]
 [-3.82162570e+00]
 [-1.91301721e+00]
 [-6.12482044e+00]
 [ 7.52586401e-01]
 [ 2.39632776e-01]
 [-5.95437946e-01]
 [ 1.47117280e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65482653e-18]]
[[ 7.02709213e-04 -2.89142149e-03  4.98762569e-04  8.23933375e-06
   4.28316314e-07  7.11304965e-06]
 [-2.89142149e-03  3.66044537e-02 -4.66057062e-03 -4.05733846e-05
   1.43164410e-05 -5.37848905e-05]
 [ 4.98762569e-04 -4.66057062e-03  1.11089185e-03  8.23354079e-06
   1.15518709e-07  1.27439691e-05]
 [ 8.23933375e-06 -4.05733846e-05  8.23354079e-06  1.90051600e-07
   2.14777220e-08  1.33901828e-07]
 [ 4.28316314e-07  1.43164410e-05  1.15518709e-07  2.14777220e-08
   1.10662828e-07  2.30359939e-08]
 [ 7.11304965e-06 -5.37848905e-05  1.27439691e-05  1.33901828e-07
   2.30359939e-08  2.55748376e-07]]
362163981.450984
post
cubesat_nadir
Ybar_post [[ 1.67718474]
 [-0.18901426]
 [13.70468083]]
resids [[-3.13276301e-06]
 [ 1.87076498e-05]
 [-9.11235743e-02]]
posterior
[[ 4.83252713e+03]
 [ 3.30941144e+03]
 [-4.06785136e+03]
 [-3.82154238e+00]
 [-1.91307804e+00]
 [-6.12468764e+00]]
[[ 4.83252898e+03]
 [ 3.30941780e+03]
 [-4.06784618e+03]
 [-3.82153770e+00]
 [-1.91307125e+00]
 [-6.12468927e+00]]
[[ 2.76485519e-04  4.51447698e-05  1.24309313e-05  3.31560863e-07
   1.08859370e-07  9.91521582e-09]
 [ 4.51447698e-05  1.76290419e-03 -6.44051243e-05  3.38725267e-07
   1.37013940e-06  7.80763818e-08]
 [ 1.24309313e-05 -6.44051243e-05  2.60753887e-04  7.59057280e-08
   2.09654056e-08 -9.73363967e-08]
 [ 3.31560863e-07  3.38725267e-07  7.59057280e-08  1.78778970e-09
   5.90094344e-10  6.92316013e-10]
 [ 1.08859370e-07  1.37013940e-06  2.09654056e-08  5.90094344e-10
   2.12154788e-09  4.13274249e-10]
 [ 9.91521582e-09  7.80763818e-08 -9.73363967e-08  6.92316013e-10
   4.13274249e-10  2.28878052e-09]]
[[ 1.67718792]
 [-0.18902209]
 [16.25363541]]
[[-6.31488855e-06]
 [ 2.65420743e-05]
 [-2.64007815e+00]]


 Corrector Step
2018-07-13 19:33:40
[[ 4.83252898e+03]
 [ 3.30941780e+03]
 [-4.06784618e+03]
 [-3.82153770e+00]
 [-1.91307125e+00]
 [-6.12468927e+00]]
[[ 2.76485519e-04  4.51447698e-05  1.24309313e-05  3.31560863e-07
   1.08859370e-07  9.91521582e-09]
 [ 4.51447698e-05  1.76290419e-03 -6.44051243e-05  3.38725267e-07
   1.37013940e-06  7.80763818e-08]
 [ 1.24309313e-05 -6.44051243e-05  2.60753887e-04  7.59057280e-08
   2.09654056e-08 -9.73363967e-08]
 [ 3.31560863e-07  3.38725267e-07  7.59057280e-08  1.78778970e-09
   5.90094344e-10  6.92316013e-10]
 [ 1.08859370e-07  1.37013940e-06  2.09654056e-08  5.90094344e-10
   2.12154788e-09  4.13274249e-10]
 [ 9.91521582e-09  7.80763818e-08 -9.73363967e-08  6.92316013e-10
   4.13274249e-10  2.28878052e-09]]
2.4205174711820513e-143
post
sphere_lamr_small
Ybar_post [[ 1.67718671]
 [-0.18901913]
 [16.25365202]]
resids [[-5.10186822e-06]
 [ 2.35810295e-05]
 [-2.64009476e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [362163981.450984, 2.4205174711820513e-143]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.83251866e+03],
       [ 3.30955269e+03],
       [-4.06786164e+03],
       [-3.82162570e+00],
       [-1.91301721e+00],
       [-6.12482044e+00]]), 'est_covars': array([[ 7.02709213e-04, -2.89142149e-03,  4.98762569e-04,
         8.23933375e-06,  4.28316314e-07,  7.11304965e-06],
       [-2.89142149e-03,  3.66044537e-02, -4.66057062e-03,
        -4.05733846e-05,  1.43164410e-05, -5.37848905e-05],
       [ 4.98762569e-04, -4.66057062e-03,  1.11089185e-03,
         8.23354079e-06,  1.15518709e-07,  1.27439691e-05],
       [ 8.23933375e-06, -4.05733846e-05,  8.23354079e-06,
         1.90051600e-07,  2.14777220e-08,  1.33901828e-07],
       [ 4.28316314e-07,  1.43164410e-05,  1.15518709e-07,
         2.14777220e-08,  1.10662828e-07,  2.30359939e-08],
       [ 7.11304965e-06, -5.37848905e-05,  1.27439691e-05,
         1.33901828e-07,  2.30359939e-08,  2.55748376e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.83252898e+03],
       [ 3.30941780e+03],
       [-4.06784618e+03],
       [-3.82153770e+00],
       [-1.91307125e+00],
       [-6.12468927e+00]]), 'covar': array([[ 2.76485519e-04,  4.51447698e-05,  1.24309313e-05,
         3.31560863e-07,  1.08859370e-07,  9.91521582e-09],
       [ 4.51447698e-05,  1.76290419e-03, -6.44051243e-05,
         3.38725267e-07,  1.37013940e-06,  7.80763818e-08],
       [ 1.24309313e-05, -6.44051243e-05,  2.60753887e-04,
         7.59057280e-08,  2.09654056e-08, -9.73363967e-08],
       [ 3.31560863e-07,  3.38725267e-07,  7.59057280e-08,
         1.78778970e-09,  5.90094344e-10,  6.92316013e-10],
       [ 1.08859370e-07,  1.37013940e-06,  2.09654056e-08,
         5.90094344e-10,  2.12154788e-09,  4.13274249e-10],
       [ 9.91521582e-09,  7.80763818e-08, -9.73363967e-08,
         6.92316013e-10,  4.13274249e-10,  2.28878052e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-5.10186822e-06],
       [ 2.35810295e-05],
       [-2.64009476e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.83251866e+03],
       [ 3.30955269e+03],
       [-4.06786164e+03],
       [-3.82162570e+00],
       [-1.91301721e+00],
       [-6.12482044e+00],
       [ 7.52586401e-01],
       [ 2.39632776e-01],
       [-5.95437946e-01],
       [ 1.47117280e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65482653e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.02709213e-04, -2.89142149e-03,  4.98762569e-04,
         8.23933375e-06,  4.28316314e-07,  7.11304965e-06],
       [-2.89142149e-03,  3.66044537e-02, -4.66057062e-03,
        -4.05733846e-05,  1.43164410e-05, -5.37848905e-05],
       [ 4.98762569e-04, -4.66057062e-03,  1.11089185e-03,
         8.23354079e-06,  1.15518709e-07,  1.27439691e-05],
       [ 8.23933375e-06, -4.05733846e-05,  8.23354079e-06,
         1.90051600e-07,  2.14777220e-08,  1.33901828e-07],
       [ 4.28316314e-07,  1.43164410e-05,  1.15518709e-07,
         2.14777220e-08,  1.10662828e-07,  2.30359939e-08],
       [ 7.11304965e-06, -5.37848905e-05,  1.27439691e-05,
         1.33901828e-07,  2.30359939e-08,  2.55748376e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.13276301e-06],
       [ 1.87076498e-05],
       [-9.11235743e-02]])}}
Current time:  2018-07-13 19:33:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.83251866e+03],
       [ 3.30955269e+03],
       [-4.06786164e+03],
       [-3.82162570e+00],
       [-1.91301721e+00],
       [-6.12482044e+00],
       [ 7.52586401e-01],
       [ 2.39632776e-01],
       [-5.95437946e-01],
       [ 1.47117280e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65482653e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 7.02709213e-04, -2.89142149e-03,  4.98762569e-04,
         8.23933375e-06,  4.28316314e-07,  7.11304965e-06],
       [-2.89142149e-03,  3.66044537e-02, -4.66057062e-03,
        -4.05733846e-05,  1.43164410e-05, -5.37848905e-05],
       [ 4.98762569e-04, -4.66057062e-03,  1.11089185e-03,
         8.23354079e-06,  1.15518709e-07,  1.27439691e-05],
       [ 8.23933375e-06, -4.05733846e-05,  8.23354079e-06,
         1.90051600e-07,  2.14777220e-08,  1.33901828e-07],
       [ 4.28316314e-07,  1.43164410e-05,  1.15518709e-07,
         2.14777220e-08,  1.10662828e-07,  2.30359939e-08],
       [ 7.11304965e-06, -5.37848905e-05,  1.27439691e-05,
         1.33901828e-07,  2.30359939e-08,  2.55748376e-07]])}
[[ 4.83251866e+03]
 [ 3.30955269e+03]
 [-4.06786164e+03]
 [-3.82162570e+00]
 [-1.91301721e+00]
 [-6.12482044e+00]
 [ 7.52586401e-01]
 [ 2.39632776e-01]
 [-5.95437946e-01]
 [ 1.47117280e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65482653e-18]]
2018-07-13 19:33:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:50
[[ 4.79403757e+03]
 [ 3.29024102e+03]
 [-4.12888498e+03]
 [-3.87448406e+00]
 [-1.94925594e+00]
 [-6.07969580e+00]
 [ 7.49467174e-01]
 [ 2.38861364e-01]
 [-5.99359319e-01]
 [ 1.48366472e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65503881e-18]]
[[ 8.86485263e-04 -3.28842732e-03  6.65490623e-04  1.01489150e-05
   6.59899040e-07  8.46666999e-06]
 [-3.28842732e-03  3.69008132e-02 -5.19622851e-03 -3.99288125e-05
   1.53392147e-05 -5.38373020e-05]
 [ 6.65490623e-04 -5.19622851e-03  1.39208807e-03  9.50597888e-06
   3.60455043e-07  1.53908939e-05]
 [ 1.01489150e-05 -3.99288125e-05  9.50597888e-06  1.99070837e-07
   2.18037327e-08  1.33436019e-07]
 [ 6.59899040e-07  1.53392147e-05  3.60455043e-07  2.18037327e-08
   1.20553114e-07  2.30677754e-08]
 [ 8.46666999e-06 -5.38373020e-05  1.53908939e-05  1.33436019e-07
   2.30677754e-08  2.66492539e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.83252898e+03],
       [ 3.30941780e+03],
       [-4.06784618e+03],
       [-3.82153770e+00],
       [-1.91307125e+00],
       [-6.12468927e+00]]), 'covar': array([[ 2.76485519e-04,  4.51447698e-05,  1.24309313e-05,
         3.31560863e-07,  1.08859370e-07,  9.91521582e-09],
       [ 4.51447698e-05,  1.76290419e-03, -6.44051243e-05,
         3.38725267e-07,  1.37013940e-06,  7.80763818e-08],
       [ 1.24309313e-05, -6.44051243e-05,  2.60753887e-04,
         7.59057280e-08,  2.09654056e-08, -9.73363967e-08],
       [ 3.31560863e-07,  3.38725267e-07,  7.59057280e-08,
         1.78778970e-09,  5.90094344e-10,  6.92316013e-10],
       [ 1.08859370e-07,  1.37013940e-06,  2.09654056e-08,
         5.90094344e-10,  2.12154788e-09,  4.13274249e-10],
       [ 9.91521582e-09,  7.80763818e-08, -9.73363967e-08,
         6.92316013e-10,  4.13274249e-10,  2.28878052e-09]])}
[[ 4.83252898e+03]
 [ 3.30941780e+03]
 [-4.06784618e+03]
 [-3.82153770e+00]
 [-1.91307125e+00]
 [-6.12468927e+00]]
2018-07-13 19:33:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:33:50
[[ 4.79404885e+03]
 [ 3.29010576e+03]
 [-4.12886768e+03]
 [-3.87439748e+00]
 [-1.94930955e+00]
 [-6.07956351e+00]]
[[ 2.83340984e-04  4.97736361e-05  1.32200129e-05  3.51353911e-07
   1.17416978e-07  1.27481355e-08]
 [ 4.97736361e-05  1.79047043e-03 -6.34101763e-05  3.63993536e-07
   1.38585300e-06  6.59713079e-08]
 [ 1.32200129e-05 -6.34101763e-05  2.59386432e-04  7.90956203e-08
   2.31210600e-08 -7.33624734e-08]
 [ 3.51353911e-07  3.63993536e-07  7.90956203e-08  1.89589962e-09
   6.05841937e-10  6.86878523e-10]
 [ 1.17416978e-07  1.38585300e-06  2.31210600e-08  6.05841937e-10
   2.21262192e-09  4.00300826e-10]
 [ 1.27481355e-08  6.59713079e-08 -7.33624734e-08  6.86878523e-10
   4.00300826e-10  2.38736432e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.79404885e+03],
       [ 3.29010576e+03],
       [-4.12886768e+03],
       [-3.87439748e+00],
       [-1.94930955e+00],
       [-6.07956351e+00]]), 'covar': array([[ 2.83340984e-04,  4.97736361e-05,  1.32200129e-05,
         3.51353911e-07,  1.17416978e-07,  1.27481355e-08],
       [ 4.97736361e-05,  1.79047043e-03, -6.34101763e-05,
         3.63993536e-07,  1.38585300e-06,  6.59713079e-08],
       [ 1.32200129e-05, -6.34101763e-05,  2.59386432e-04,
         7.90956203e-08,  2.31210600e-08, -7.33624734e-08],
       [ 3.51353911e-07,  3.63993536e-07,  7.90956203e-08,
         1.89589962e-09,  6.05841937e-10,  6.86878523e-10],
       [ 1.17416978e-07,  1.38585300e-06,  2.31210600e-08,
         6.05841937e-10,  2.21262192e-09,  4.00300826e-10],
       [ 1.27481355e-08,  6.59713079e-08, -7.33624734e-08,
         6.86878523e-10,  4.00300826e-10,  2.38736432e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-5.10186822e-06],
       [ 2.35810295e-05],
       [-2.64009476e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.79403757e+03],
       [ 3.29024102e+03],
       [-4.12888498e+03],
       [-3.87448406e+00],
       [-1.94925594e+00],
       [-6.07969580e+00],
       [ 7.49467174e-01],
       [ 2.38861364e-01],
       [-5.99359319e-01],
       [ 1.48366472e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65503881e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.86485263e-04, -3.28842732e-03,  6.65490623e-04,
         1.01489150e-05,  6.59899040e-07,  8.46666999e-06],
       [-3.28842732e-03,  3.69008132e-02, -5.19622851e-03,
        -3.99288125e-05,  1.53392147e-05, -5.38373020e-05],
       [ 6.65490623e-04, -5.19622851e-03,  1.39208807e-03,
         9.50597888e-06,  3.60455043e-07,  1.53908939e-05],
       [ 1.01489150e-05, -3.99288125e-05,  9.50597888e-06,
         1.99070837e-07,  2.18037327e-08,  1.33436019e-07],
       [ 6.59899040e-07,  1.53392147e-05,  3.60455043e-07,
         2.18037327e-08,  1.20553114e-07,  2.30677754e-08],
       [ 8.46666999e-06, -5.38373020e-05,  1.53908939e-05,
         1.33436019e-07,  2.30677754e-08,  2.66492539e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.13276301e-06],
       [ 1.87076498e-05],
       [-9.11235743e-02]])}}
Yi [[ 1.69667436]
 [-0.21932282]
 [13.48159969]]
posterior
[[ 4.79403757e+03]
 [ 3.29024102e+03]
 [-4.12888498e+03]
 [-3.87448406e+00]
 [-1.94925594e+00]
 [-6.07969580e+00]
 [ 7.49467174e-01]
 [ 2.38861364e-01]
 [-5.99359319e-01]
 [ 1.48366472e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65503881e-18]]
[[ 4.79403428e+03]
 [ 3.29021153e+03]
 [-4.12888629e+03]
 [-3.87452749e+00]
 [-1.94929910e+00]
 [-6.07972764e+00]
 [ 7.49467174e-01]
 [ 2.38861364e-01]
 [-5.99359319e-01]
 [ 1.48366472e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65503881e-18]]
[[ 8.11124672e-04 -3.38793958e-03  6.72512791e-04  9.38127739e-06
   3.98100748e-07  8.33222622e-06]
 [-3.38793958e-03  3.39030627e-02 -5.38253522e-03 -4.20938211e-05
   1.13456342e-05 -5.70914312e-05]
 [ 6.72512791e-04 -5.38253522e-03  1.37808084e-03  9.49892556e-06
   1.35919319e-07  1.51934080e-05]
 [ 9.38127739e-06 -4.20938211e-05  9.49892556e-06  1.90788991e-07
   1.76716515e-08  1.30830493e-07]
 [ 3.98100748e-07  1.13456342e-05  1.35919319e-07  1.76716515e-08
   1.15001059e-07  1.86849931e-08]
 [ 8.33222622e-06 -5.70914312e-05  1.51934080e-05  1.30830493e-07
   1.86849931e-08  2.62949441e-07]]
[[ 1.69666108]
 [-0.21931187]
 [13.58564663]]
[[ 1.32718447e-05]
 [-1.09493917e-05]
 [-1.04046939e-01]]


 Corrector Step
2018-07-13 19:33:50
[[ 4.79403428e+03]
 [ 3.29021153e+03]
 [-4.12888629e+03]
 [-3.87452749e+00]
 [-1.94929910e+00]
 [-6.07972764e+00]
 [ 7.49467174e-01]
 [ 2.38861364e-01]
 [-5.99359319e-01]
 [ 1.48366472e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65503881e-18]]
[[ 8.11124672e-04 -3.38793958e-03  6.72512791e-04  9.38127739e-06
   3.98100748e-07  8.33222622e-06]
 [-3.38793958e-03  3.39030627e-02 -5.38253522e-03 -4.20938211e-05
   1.13456342e-05 -5.70914312e-05]
 [ 6.72512791e-04 -5.38253522e-03  1.37808084e-03  9.49892556e-06
   1.35919319e-07  1.51934080e-05]
 [ 9.38127739e-06 -4.20938211e-05  9.49892556e-06  1.90788991e-07
   1.76716515e-08  1.30830493e-07]
 [ 3.98100748e-07  1.13456342e-05  1.35919319e-07  1.76716515e-08
   1.15001059e-07  1.86849931e-08]
 [ 8.33222622e-06 -5.70914312e-05  1.51934080e-05  1.30830493e-07
   1.86849931e-08  2.62949441e-07]]
407198820.25620097
post
cubesat_nadir
Ybar_post [[ 1.69666452]
 [-0.21931548]
 [13.58560008]]
resids [[ 9.83403279e-06]
 [-7.34102890e-06]
 [-1.04000393e-01]]
posterior
[[ 4.79404885e+03]
 [ 3.29010576e+03]
 [-4.12886768e+03]
 [-3.87439748e+00]
 [-1.94930955e+00]
 [-6.07956351e+00]]
[[ 4.79404666e+03]
 [ 3.29010199e+03]
 [-4.12886862e+03]
 [-3.87440104e+00]
 [-1.94931331e+00]
 [-6.07956346e+00]]
[[ 2.53521148e-04  2.02456248e-05  1.18490927e-05  3.10003085e-07
   8.62156066e-08  1.07822591e-08]
 [ 2.02456248e-05  1.72827995e-03 -9.03169914e-05  3.09746032e-07
   1.32260746e-06  7.03224053e-08]
 [ 1.18490927e-05 -9.03169914e-05  2.39513196e-04  6.68811465e-08
  -3.39603675e-09 -6.85697588e-08]
 [ 3.10003085e-07  3.09746032e-07  6.68811465e-08  1.83318959e-09
   5.49516963e-10  6.86694660e-10]
 [ 8.62156066e-08  1.32260746e-06 -3.39603675e-09  5.49516963e-10
   2.14821642e-09  4.04426583e-10]
 [ 1.07822591e-08  7.03224053e-08 -6.85697588e-08  6.86694660e-10
   4.04426583e-10  2.38603107e-09]]
[[ 1.69666389]
 [-0.21931789]
 [16.15382814]]
[[ 1.04704264e-05]
 [-4.92932253e-06]
 [-2.67222845e+00]]


 Corrector Step
2018-07-13 19:33:50
[[ 4.79404666e+03]
 [ 3.29010199e+03]
 [-4.12886862e+03]
 [-3.87440104e+00]
 [-1.94931331e+00]
 [-6.07956346e+00]]
[[ 2.53521148e-04  2.02456248e-05  1.18490927e-05  3.10003085e-07
   8.62156066e-08  1.07822591e-08]
 [ 2.02456248e-05  1.72827995e-03 -9.03169914e-05  3.09746032e-07
   1.32260746e-06  7.03224053e-08]
 [ 1.18490927e-05 -9.03169914e-05  2.39513196e-04  6.68811465e-08
  -3.39603675e-09 -6.85697588e-08]
 [ 3.10003085e-07  3.09746032e-07  6.68811465e-08  1.83318959e-09
   5.49516963e-10  6.86694660e-10]
 [ 8.62156066e-08  1.32260746e-06 -3.39603675e-09  5.49516963e-10
   2.14821642e-09  4.04426583e-10]
 [ 1.07822591e-08  7.03224053e-08 -6.85697588e-08  6.86694660e-10
   4.04426583e-10  2.38603107e-09]]
7.579022588749671e-147
post
sphere_lamr_small
Ybar_post [[ 1.69666524]
 [-0.2193187 ]
 [16.15382417]]
resids [[ 9.11780631e-06]
 [-4.12376583e-06]
 [-2.67222448e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [407198820.25620097, 7.579022588749671e-147]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.79403428e+03],
       [ 3.29021153e+03],
       [-4.12888629e+03],
       [-3.87452749e+00],
       [-1.94929910e+00],
       [-6.07972764e+00]]), 'est_covars': array([[ 8.11124672e-04, -3.38793958e-03,  6.72512791e-04,
         9.38127739e-06,  3.98100748e-07,  8.33222622e-06],
       [-3.38793958e-03,  3.39030627e-02, -5.38253522e-03,
        -4.20938211e-05,  1.13456342e-05, -5.70914312e-05],
       [ 6.72512791e-04, -5.38253522e-03,  1.37808084e-03,
         9.49892556e-06,  1.35919319e-07,  1.51934080e-05],
       [ 9.38127739e-06, -4.20938211e-05,  9.49892556e-06,
         1.90788991e-07,  1.76716515e-08,  1.30830493e-07],
       [ 3.98100748e-07,  1.13456342e-05,  1.35919319e-07,
         1.76716515e-08,  1.15001059e-07,  1.86849931e-08],
       [ 8.33222622e-06, -5.70914312e-05,  1.51934080e-05,
         1.30830493e-07,  1.86849931e-08,  2.62949441e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.79404666e+03],
       [ 3.29010199e+03],
       [-4.12886862e+03],
       [-3.87440104e+00],
       [-1.94931331e+00],
       [-6.07956346e+00]]), 'covar': array([[ 2.53521148e-04,  2.02456248e-05,  1.18490927e-05,
         3.10003085e-07,  8.62156066e-08,  1.07822591e-08],
       [ 2.02456248e-05,  1.72827995e-03, -9.03169914e-05,
         3.09746032e-07,  1.32260746e-06,  7.03224053e-08],
       [ 1.18490927e-05, -9.03169914e-05,  2.39513196e-04,
         6.68811465e-08, -3.39603675e-09, -6.85697588e-08],
       [ 3.10003085e-07,  3.09746032e-07,  6.68811465e-08,
         1.83318959e-09,  5.49516963e-10,  6.86694660e-10],
       [ 8.62156066e-08,  1.32260746e-06, -3.39603675e-09,
         5.49516963e-10,  2.14821642e-09,  4.04426583e-10],
       [ 1.07822591e-08,  7.03224053e-08, -6.85697588e-08,
         6.86694660e-10,  4.04426583e-10,  2.38603107e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 9.11780631e-06],
       [-4.12376583e-06],
       [-2.67222448e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.79403428e+03],
       [ 3.29021153e+03],
       [-4.12888629e+03],
       [-3.87452749e+00],
       [-1.94929910e+00],
       [-6.07972764e+00],
       [ 7.49467174e-01],
       [ 2.38861364e-01],
       [-5.99359319e-01],
       [ 1.48366472e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65503881e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.11124672e-04, -3.38793958e-03,  6.72512791e-04,
         9.38127739e-06,  3.98100748e-07,  8.33222622e-06],
       [-3.38793958e-03,  3.39030627e-02, -5.38253522e-03,
        -4.20938211e-05,  1.13456342e-05, -5.70914312e-05],
       [ 6.72512791e-04, -5.38253522e-03,  1.37808084e-03,
         9.49892556e-06,  1.35919319e-07,  1.51934080e-05],
       [ 9.38127739e-06, -4.20938211e-05,  9.49892556e-06,
         1.90788991e-07,  1.76716515e-08,  1.30830493e-07],
       [ 3.98100748e-07,  1.13456342e-05,  1.35919319e-07,
         1.76716515e-08,  1.15001059e-07,  1.86849931e-08],
       [ 8.33222622e-06, -5.70914312e-05,  1.51934080e-05,
         1.30830493e-07,  1.86849931e-08,  2.62949441e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 9.83403279e-06],
       [-7.34102890e-06],
       [-1.04000393e-01]])}}
Current time:  2018-07-13 19:34:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.79403428e+03],
       [ 3.29021153e+03],
       [-4.12888629e+03],
       [-3.87452749e+00],
       [-1.94929910e+00],
       [-6.07972764e+00],
       [ 7.49467174e-01],
       [ 2.38861364e-01],
       [-5.99359319e-01],
       [ 1.48366472e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65503881e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 8.11124672e-04, -3.38793958e-03,  6.72512791e-04,
         9.38127739e-06,  3.98100748e-07,  8.33222622e-06],
       [-3.38793958e-03,  3.39030627e-02, -5.38253522e-03,
        -4.20938211e-05,  1.13456342e-05, -5.70914312e-05],
       [ 6.72512791e-04, -5.38253522e-03,  1.37808084e-03,
         9.49892556e-06,  1.35919319e-07,  1.51934080e-05],
       [ 9.38127739e-06, -4.20938211e-05,  9.49892556e-06,
         1.90788991e-07,  1.76716515e-08,  1.30830493e-07],
       [ 3.98100748e-07,  1.13456342e-05,  1.35919319e-07,
         1.76716515e-08,  1.15001059e-07,  1.86849931e-08],
       [ 8.33222622e-06, -5.70914312e-05,  1.51934080e-05,
         1.30830493e-07,  1.86849931e-08,  2.62949441e-07]])}
[[ 4.79403428e+03]
 [ 3.29021153e+03]
 [-4.12888629e+03]
 [-3.87452749e+00]
 [-1.94929910e+00]
 [-6.07972764e+00]
 [ 7.49467174e-01]
 [ 2.38861364e-01]
 [-5.99359319e-01]
 [ 1.48366472e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65503881e-18]]
2018-07-13 19:33:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:00
[[ 4.75502622e+03]
 [ 3.27053814e+03]
 [-4.18945521e+03]
 [-3.92695379e+00]
 [-1.98531896e+00]
 [-6.03393959e+00]
 [ 7.46327516e-01]
 [ 2.38083441e-01]
 [-6.03264352e-01]
 [ 1.49611620e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65525110e-18]]
[[ 1.01786600e-03 -3.80092469e-03  8.63631056e-04  1.12911552e-05
   5.93195342e-07  9.65841202e-06]
 [-3.80092469e-03  3.41405334e-02 -5.95141674e-03 -4.15116326e-05
   1.24220788e-05 -5.71607205e-05]
 [ 8.63631056e-04 -5.95141674e-03  1.70892105e-03  1.07303487e-05
   3.40032773e-07  1.79176097e-05]
 [ 1.12911552e-05 -4.15116326e-05  1.07303487e-05  1.99759092e-07
   1.79735043e-08  1.30312863e-07]
 [ 5.93195342e-07  1.24220788e-05  3.40032773e-07  1.79735043e-08
   1.24911396e-07  1.87481653e-08]
 [ 9.65841202e-06 -5.71607205e-05  1.79176097e-05  1.30312863e-07
   1.87481653e-08  2.73738580e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.79404666e+03],
       [ 3.29010199e+03],
       [-4.12886862e+03],
       [-3.87440104e+00],
       [-1.94931331e+00],
       [-6.07956346e+00]]), 'covar': array([[ 2.53521148e-04,  2.02456248e-05,  1.18490927e-05,
         3.10003085e-07,  8.62156066e-08,  1.07822591e-08],
       [ 2.02456248e-05,  1.72827995e-03, -9.03169914e-05,
         3.09746032e-07,  1.32260746e-06,  7.03224053e-08],
       [ 1.18490927e-05, -9.03169914e-05,  2.39513196e-04,
         6.68811465e-08, -3.39603675e-09, -6.85697588e-08],
       [ 3.10003085e-07,  3.09746032e-07,  6.68811465e-08,
         1.83318959e-09,  5.49516963e-10,  6.86694660e-10],
       [ 8.62156066e-08,  1.32260746e-06, -3.39603675e-09,
         5.49516963e-10,  2.14821642e-09,  4.04426583e-10],
       [ 1.07822591e-08,  7.03224053e-08, -6.85697588e-08,
         6.86694660e-10,  4.04426583e-10,  2.38603107e-09]])}
[[ 4.79404666e+03]
 [ 3.29010199e+03]
 [-4.12886862e+03]
 [-3.87440104e+00]
 [-1.94931331e+00]
 [-6.07956346e+00]]
2018-07-13 19:33:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:00
[[ 4.75503982e+03]
 [ 3.27042850e+03]
 [-4.18943577e+03]
 [-3.92682866e+00]
 [-1.98533273e+00]
 [-6.03377397e+00]]
[[ 2.60282089e-04  2.44457847e-05  1.25549953e-05  3.29858989e-07
   9.41117512e-08  1.35731406e-08]
 [ 2.44457847e-05  1.75490654e-03 -8.97164368e-05  3.34182335e-07
   1.33854158e-06  5.84491264e-08]
 [ 1.25549953e-05 -8.97164368e-05  2.38418395e-04  6.97881397e-08
  -1.02317647e-09 -4.33603705e-08]
 [ 3.29858989e-07  3.34182335e-07  6.97881397e-08  1.94035002e-09
   5.64695586e-10  6.81229789e-10]
 [ 9.41117512e-08  1.33854158e-06 -1.02317647e-09  5.64695586e-10
   2.23938693e-09  3.91958195e-10]
 [ 1.35731406e-08  5.84491264e-08 -4.33603705e-08  6.81229789e-10
   3.91958195e-10  2.48535693e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 33, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.75503982e+03],
       [ 3.27042850e+03],
       [-4.18943577e+03],
       [-3.92682866e+00],
       [-1.98533273e+00],
       [-6.03377397e+00]]), 'covar': array([[ 2.60282089e-04,  2.44457847e-05,  1.25549953e-05,
         3.29858989e-07,  9.41117512e-08,  1.35731406e-08],
       [ 2.44457847e-05,  1.75490654e-03, -8.97164368e-05,
         3.34182335e-07,  1.33854158e-06,  5.84491264e-08],
       [ 1.25549953e-05, -8.97164368e-05,  2.38418395e-04,
         6.97881397e-08, -1.02317647e-09, -4.33603705e-08],
       [ 3.29858989e-07,  3.34182335e-07,  6.97881397e-08,
         1.94035002e-09,  5.64695586e-10,  6.81229789e-10],
       [ 9.41117512e-08,  1.33854158e-06, -1.02317647e-09,
         5.64695586e-10,  2.23938693e-09,  3.91958195e-10],
       [ 1.35731406e-08,  5.84491264e-08, -4.33603705e-08,
         6.81229789e-10,  3.91958195e-10,  2.48535693e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 9.11780631e-06],
       [-4.12376583e-06],
       [-2.67222448e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 33, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.75502622e+03],
       [ 3.27053814e+03],
       [-4.18945521e+03],
       [-3.92695379e+00],
       [-1.98531896e+00],
       [-6.03393959e+00],
       [ 7.46327516e-01],
       [ 2.38083441e-01],
       [-6.03264352e-01],
       [ 1.49611620e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65525110e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.01786600e-03, -3.80092469e-03,  8.63631056e-04,
         1.12911552e-05,  5.93195342e-07,  9.65841202e-06],
       [-3.80092469e-03,  3.41405334e-02, -5.95141674e-03,
        -4.15116326e-05,  1.24220788e-05, -5.71607205e-05],
       [ 8.63631056e-04, -5.95141674e-03,  1.70892105e-03,
         1.07303487e-05,  3.40032773e-07,  1.79176097e-05],
       [ 1.12911552e-05, -4.15116326e-05,  1.07303487e-05,
         1.99759092e-07,  1.79735043e-08,  1.30312863e-07],
       [ 5.93195342e-07,  1.24220788e-05,  3.40032773e-07,
         1.79735043e-08,  1.24911396e-07,  1.87481653e-08],
       [ 9.65841202e-06, -5.71607205e-05,  1.79176097e-05,
         1.30312863e-07,  1.87481653e-08,  2.73738580e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 9.83403279e-06],
       [-7.34102890e-06],
       [-1.04000393e-01]])}}
Yi [[ 1.71679326]
 [-0.24946549]
 [13.42931172]]
posterior
[[ 4.75502622e+03]
 [ 3.27053814e+03]
 [-4.18945521e+03]
 [-3.92695379e+00]
 [-1.98531896e+00]
 [-6.03393959e+00]
 [ 7.46327516e-01]
 [ 2.38083441e-01]
 [-6.03264352e-01]
 [ 1.49611620e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65525110e-18]]
[[ 4.75501777e+03]
 [ 3.27054847e+03]
 [-4.18945314e+03]
 [-3.92703525e+00]
 [-1.98532016e+00]
 [-6.03392547e+00]
 [ 7.46327516e-01]
 [ 2.38083441e-01]
 [-6.03264352e-01]
 [ 1.49611620e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65525110e-18]]
[[ 9.41517480e-04 -3.85166196e-03  8.73887603e-04  1.04930687e-05
   3.90958173e-07  9.61926462e-06]
 [-3.85166196e-03  3.16542560e-02 -6.07973229e-03 -4.30879860e-05
   9.05595647e-06 -5.99237418e-05]
 [ 8.73887603e-04 -6.07973229e-03  1.70008925e-03  1.07799131e-05
   1.89113164e-07  1.77719689e-05]
 [ 1.04930687e-05 -4.30879860e-05  1.07799131e-05  1.90970397e-07
   1.44811344e-08  1.28736152e-07]
 [ 3.90958173e-07  9.05595647e-06  1.89113164e-07  1.44811344e-08
   1.20117189e-07  1.50376384e-08]
 [ 9.61926462e-06 -5.99237418e-05  1.77719689e-05  1.28736152e-07
   1.50376384e-08  2.70662980e-07]]
[[ 1.7167713 ]
 [-0.24948113]
 [13.4911797 ]]
[[ 2.19595949e-05]
 [ 1.56373909e-05]
 [-6.18679822e-02]]


 Corrector Step
2018-07-13 19:34:00
[[ 4.75501777e+03]
 [ 3.27054847e+03]
 [-4.18945314e+03]
 [-3.92703525e+00]
 [-1.98532016e+00]
 [-6.03392547e+00]
 [ 7.46327516e-01]
 [ 2.38083441e-01]
 [-6.03264352e-01]
 [ 1.49611620e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65525110e-18]]
[[ 9.41517480e-04 -3.85166196e-03  8.73887603e-04  1.04930687e-05
   3.90958173e-07  9.61926462e-06]
 [-3.85166196e-03  3.16542560e-02 -6.07973229e-03 -4.30879860e-05
   9.05595647e-06 -5.99237418e-05]
 [ 8.73887603e-04 -6.07973229e-03  1.70008925e-03  1.07799131e-05
   1.89113164e-07  1.77719689e-05]
 [ 1.04930687e-05 -4.30879860e-05  1.07799131e-05  1.90970397e-07
   1.44811344e-08  1.28736152e-07]
 [ 3.90958173e-07  9.05595647e-06  1.89113164e-07  1.44811344e-08
   1.20117189e-07  1.50376384e-08]
 [ 9.61926462e-06 -5.99237418e-05  1.77719689e-05  1.28736152e-07
   1.50376384e-08  2.70662980e-07]]
410472992.6416371
post
cubesat_nadir
Ybar_post [[ 1.71677473]
 [-0.24947883]
 [13.49118772]]
resids [[ 1.85313400e-05]
 [ 1.33320654e-05]
 [-6.18759960e-02]]
posterior
[[ 4.75503982e+03]
 [ 3.27042850e+03]
 [-4.18943577e+03]
 [-3.92682866e+00]
 [-1.98533273e+00]
 [-6.03377397e+00]]
[[ 4.75503587e+03]
 [ 3.27042854e+03]
 [-4.18943274e+03]
 [-3.92683263e+00]
 [-1.98533296e+00]
 [-6.03377474e+00]]
[[ 2.35115675e-04 -2.86154754e-06  1.23832656e-05  2.93574905e-07
   6.60190492e-08  1.14913280e-08]
 [-2.86154754e-06  1.68673199e-03 -1.14170250e-04  2.80300372e-07
   1.27167151e-06  5.95584744e-08]
 [ 1.23832656e-05 -1.14170250e-04  2.23138217e-04  6.04042365e-08
  -2.41245577e-08 -4.12538844e-08]
 [ 2.93574905e-07  2.80300372e-07  6.04042365e-08  1.88257365e-09
   5.10493234e-10  6.79496399e-10]
 [ 6.60190492e-08  1.27167151e-06 -2.41245577e-08  5.10493234e-10
   2.17367615e-09  3.92814119e-10]
 [ 1.14913280e-08  5.95584744e-08 -4.12538844e-08  6.79496399e-10
   3.92814119e-10  2.48489037e-09]]
[[ 1.7167725 ]
 [-0.24948517]
 [16.0546844 ]]
[[ 2.07675020e-05]
 [ 1.96793309e-05]
 [-2.62537268e+00]]


 Corrector Step
2018-07-13 19:34:00
[[ 4.75503587e+03]
 [ 3.27042854e+03]
 [-4.18943274e+03]
 [-3.92683263e+00]
 [-1.98533296e+00]
 [-6.03377474e+00]]
[[ 2.35115675e-04 -2.86154754e-06  1.23832656e-05  2.93574905e-07
   6.60190492e-08  1.14913280e-08]
 [-2.86154754e-06  1.68673199e-03 -1.14170250e-04  2.80300372e-07
   1.27167151e-06  5.95584744e-08]
 [ 1.23832656e-05 -1.14170250e-04  2.23138217e-04  6.04042365e-08
  -2.41245577e-08 -4.12538844e-08]
 [ 2.93574905e-07  2.80300372e-07  6.04042365e-08  1.88257365e-09
   5.10493234e-10  6.79496399e-10]
 [ 6.60190492e-08  1.27167151e-06 -2.41245577e-08  5.10493234e-10
   2.17367615e-09  3.92814119e-10]
 [ 1.14913280e-08  5.95584744e-08 -4.12538844e-08  6.79496399e-10
   3.92814119e-10  2.48489037e-09]]
1.090017046154298e-141
post
sphere_lamr_small
Ybar_post [[ 1.7167745 ]
 [-0.2494837 ]
 [16.05469434]]
resids [[ 1.87634573e-05]
 [ 1.82062003e-05]
 [-2.62538262e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [410472992.6416371, 1.090017046154298e-141]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.75501777e+03],
       [ 3.27054847e+03],
       [-4.18945314e+03],
       [-3.92703525e+00],
       [-1.98532016e+00],
       [-6.03392547e+00]]), 'est_covars': array([[ 9.41517480e-04, -3.85166196e-03,  8.73887603e-04,
         1.04930687e-05,  3.90958173e-07,  9.61926462e-06],
       [-3.85166196e-03,  3.16542560e-02, -6.07973229e-03,
        -4.30879860e-05,  9.05595647e-06, -5.99237418e-05],
       [ 8.73887603e-04, -6.07973229e-03,  1.70008925e-03,
         1.07799131e-05,  1.89113164e-07,  1.77719689e-05],
       [ 1.04930687e-05, -4.30879860e-05,  1.07799131e-05,
         1.90970397e-07,  1.44811344e-08,  1.28736152e-07],
       [ 3.90958173e-07,  9.05595647e-06,  1.89113164e-07,
         1.44811344e-08,  1.20117189e-07,  1.50376384e-08],
       [ 9.61926462e-06, -5.99237418e-05,  1.77719689e-05,
         1.28736152e-07,  1.50376384e-08,  2.70662980e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.75503587e+03],
       [ 3.27042854e+03],
       [-4.18943274e+03],
       [-3.92683263e+00],
       [-1.98533296e+00],
       [-6.03377474e+00]]), 'covar': array([[ 2.35115675e-04, -2.86154754e-06,  1.23832656e-05,
         2.93574905e-07,  6.60190492e-08,  1.14913280e-08],
       [-2.86154754e-06,  1.68673199e-03, -1.14170250e-04,
         2.80300372e-07,  1.27167151e-06,  5.95584744e-08],
       [ 1.23832656e-05, -1.14170250e-04,  2.23138217e-04,
         6.04042365e-08, -2.41245577e-08, -4.12538844e-08],
       [ 2.93574905e-07,  2.80300372e-07,  6.04042365e-08,
         1.88257365e-09,  5.10493234e-10,  6.79496399e-10],
       [ 6.60190492e-08,  1.27167151e-06, -2.41245577e-08,
         5.10493234e-10,  2.17367615e-09,  3.92814119e-10],
       [ 1.14913280e-08,  5.95584744e-08, -4.12538844e-08,
         6.79496399e-10,  3.92814119e-10,  2.48489037e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.87634573e-05],
       [ 1.82062003e-05],
       [-2.62538262e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.75501777e+03],
       [ 3.27054847e+03],
       [-4.18945314e+03],
       [-3.92703525e+00],
       [-1.98532016e+00],
       [-6.03392547e+00],
       [ 7.46327516e-01],
       [ 2.38083441e-01],
       [-6.03264352e-01],
       [ 1.49611620e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65525110e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.41517480e-04, -3.85166196e-03,  8.73887603e-04,
         1.04930687e-05,  3.90958173e-07,  9.61926462e-06],
       [-3.85166196e-03,  3.16542560e-02, -6.07973229e-03,
        -4.30879860e-05,  9.05595647e-06, -5.99237418e-05],
       [ 8.73887603e-04, -6.07973229e-03,  1.70008925e-03,
         1.07799131e-05,  1.89113164e-07,  1.77719689e-05],
       [ 1.04930687e-05, -4.30879860e-05,  1.07799131e-05,
         1.90970397e-07,  1.44811344e-08,  1.28736152e-07],
       [ 3.90958173e-07,  9.05595647e-06,  1.89113164e-07,
         1.44811344e-08,  1.20117189e-07,  1.50376384e-08],
       [ 9.61926462e-06, -5.99237418e-05,  1.77719689e-05,
         1.28736152e-07,  1.50376384e-08,  2.70662980e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.85313400e-05],
       [ 1.33320654e-05],
       [-6.18759960e-02]])}}
Current time:  2018-07-13 19:34:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.75501777e+03],
       [ 3.27054847e+03],
       [-4.18945314e+03],
       [-3.92703525e+00],
       [-1.98532016e+00],
       [-6.03392547e+00],
       [ 7.46327516e-01],
       [ 2.38083441e-01],
       [-6.03264352e-01],
       [ 1.49611620e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65525110e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 9.41517480e-04, -3.85166196e-03,  8.73887603e-04,
         1.04930687e-05,  3.90958173e-07,  9.61926462e-06],
       [-3.85166196e-03,  3.16542560e-02, -6.07973229e-03,
        -4.30879860e-05,  9.05595647e-06, -5.99237418e-05],
       [ 8.73887603e-04, -6.07973229e-03,  1.70008925e-03,
         1.07799131e-05,  1.89113164e-07,  1.77719689e-05],
       [ 1.04930687e-05, -4.30879860e-05,  1.07799131e-05,
         1.90970397e-07,  1.44811344e-08,  1.28736152e-07],
       [ 3.90958173e-07,  9.05595647e-06,  1.89113164e-07,
         1.44811344e-08,  1.20117189e-07,  1.50376384e-08],
       [ 9.61926462e-06, -5.99237418e-05,  1.77719689e-05,
         1.28736152e-07,  1.50376384e-08,  2.70662980e-07]])}
[[ 4.75501777e+03]
 [ 3.27054847e+03]
 [-4.18945314e+03]
 [-3.92703525e+00]
 [-1.98532016e+00]
 [-6.03392547e+00]
 [ 7.46327516e-01]
 [ 2.38083441e-01]
 [-6.03264352e-01]
 [ 1.49611620e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65525110e-18]]
2018-07-13 19:34:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:10
[[ 4.71548707e+03]
 [ 3.25051607e+03]
 [-4.24956039e+03]
 [-3.97902341e+00]
 [-2.02111742e+00]
 [-5.98747875e+00]
 [ 7.43167510e-01]
 [ 2.37299026e-01]
 [-6.07152938e-01]
 [ 1.50852689e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65546339e-18]]
[[ 1.17021072e-03 -4.27515989e-03  1.09038987e-03  1.23978483e-05
   5.55602178e-07  1.09270084e-05]
 [-4.27515989e-03  3.18464989e-02 -6.67667909e-03 -4.25565784e-05
   1.01927132e-05 -6.00075604e-05]
 [ 1.09038987e-03 -6.67667909e-03  2.08364877e-03  1.19799469e-05
   3.59190026e-07  2.05784635e-05]
 [ 1.23978483e-05 -4.25565784e-05  1.19799469e-05  1.99900886e-07
   1.47633101e-08  1.28166803e-07]
 [ 5.55602178e-07  1.01927132e-05  3.59190026e-07  1.47633101e-08
   1.30042863e-07  1.51239540e-08]
 [ 1.09270084e-05 -6.00075604e-05  2.05784635e-05  1.28166803e-07
   1.51239540e-08  2.81490790e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.75503587e+03],
       [ 3.27042854e+03],
       [-4.18943274e+03],
       [-3.92683263e+00],
       [-1.98533296e+00],
       [-6.03377474e+00]]), 'covar': array([[ 2.35115675e-04, -2.86154754e-06,  1.23832656e-05,
         2.93574905e-07,  6.60190492e-08,  1.14913280e-08],
       [-2.86154754e-06,  1.68673199e-03, -1.14170250e-04,
         2.80300372e-07,  1.27167151e-06,  5.95584744e-08],
       [ 1.23832656e-05, -1.14170250e-04,  2.23138217e-04,
         6.04042365e-08, -2.41245577e-08, -4.12538844e-08],
       [ 2.93574905e-07,  2.80300372e-07,  6.04042365e-08,
         1.88257365e-09,  5.10493234e-10,  6.79496399e-10],
       [ 6.60190492e-08,  1.27167151e-06, -2.41245577e-08,
         5.10493234e-10,  2.17367615e-09,  3.92814119e-10],
       [ 1.14913280e-08,  5.95584744e-08, -4.12538844e-08,
         6.79496399e-10,  3.92814119e-10,  2.48489037e-09]])}
[[ 4.75503587e+03]
 [ 3.27042854e+03]
 [-4.18943274e+03]
 [-3.92683263e+00]
 [-1.98533296e+00]
 [-6.03377474e+00]]
2018-07-13 19:34:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:10
[[ 4.71550741e+03]
 [ 3.25039608e+03]
 [-4.24953867e+03]
 [-3.97882209e+00]
 [-2.02112985e+00]
 [-5.98732744e+00]]
[[ 2.41261762e-04  7.63535139e-07  1.32237316e-05  3.13714305e-07
   7.34513947e-08  1.52084574e-08]
 [ 7.63535139e-07  1.71232460e-03 -1.13846821e-04  3.03923079e-07
   1.28788689e-06  4.81974208e-08]
 [ 1.32237316e-05 -1.13846821e-04  2.22659934e-04  6.33194855e-08
  -2.16648094e-08 -1.48981298e-08]
 [ 3.13714305e-07  3.03923079e-07  6.33194855e-08  1.98911376e-09
   5.25055224e-10  6.73978752e-10]
 [ 7.34513947e-08  1.28788689e-06 -2.16648094e-08  5.25055224e-10
   2.26496084e-09  3.80633023e-10]
 [ 1.52084574e-08  4.81974208e-08 -1.48981298e-08  6.73978752e-10
   3.80633023e-10  2.58355210e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.71550741e+03],
       [ 3.25039608e+03],
       [-4.24953867e+03],
       [-3.97882209e+00],
       [-2.02112985e+00],
       [-5.98732744e+00]]), 'covar': array([[ 2.41261762e-04,  7.63535139e-07,  1.32237316e-05,
         3.13714305e-07,  7.34513947e-08,  1.52084574e-08],
       [ 7.63535139e-07,  1.71232460e-03, -1.13846821e-04,
         3.03923079e-07,  1.28788689e-06,  4.81974208e-08],
       [ 1.32237316e-05, -1.13846821e-04,  2.22659934e-04,
         6.33194855e-08, -2.16648094e-08, -1.48981298e-08],
       [ 3.13714305e-07,  3.03923079e-07,  6.33194855e-08,
         1.98911376e-09,  5.25055224e-10,  6.73978752e-10],
       [ 7.34513947e-08,  1.28788689e-06, -2.16648094e-08,
         5.25055224e-10,  2.26496084e-09,  3.80633023e-10],
       [ 1.52084574e-08,  4.81974208e-08, -1.48981298e-08,
         6.73978752e-10,  3.80633023e-10,  2.58355210e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.87634573e-05],
       [ 1.82062003e-05],
       [-2.62538262e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.71548707e+03],
       [ 3.25051607e+03],
       [-4.24956039e+03],
       [-3.97902341e+00],
       [-2.02111742e+00],
       [-5.98747875e+00],
       [ 7.43167510e-01],
       [ 2.37299026e-01],
       [-6.07152938e-01],
       [ 1.50852689e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65546339e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.17021072e-03, -4.27515989e-03,  1.09038987e-03,
         1.23978483e-05,  5.55602178e-07,  1.09270084e-05],
       [-4.27515989e-03,  3.18464989e-02, -6.67667909e-03,
        -4.25565784e-05,  1.01927132e-05, -6.00075604e-05],
       [ 1.09038987e-03, -6.67667909e-03,  2.08364877e-03,
         1.19799469e-05,  3.59190026e-07,  2.05784635e-05],
       [ 1.23978483e-05, -4.25565784e-05,  1.19799469e-05,
         1.99900886e-07,  1.47633101e-08,  1.28166803e-07],
       [ 5.55602178e-07,  1.01927132e-05,  3.59190026e-07,
         1.47633101e-08,  1.30042863e-07,  1.51239540e-08],
       [ 1.09270084e-05, -6.00075604e-05,  2.05784635e-05,
         1.28166803e-07,  1.51239540e-08,  2.81490790e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.85313400e-05],
       [ 1.33320654e-05],
       [-6.18759960e-02]])}}
Yi [[ 1.73753551]
 [-0.27943562]
 [13.55782538]]
posterior
[[ 4.71548707e+03]
 [ 3.25051607e+03]
 [-4.24956039e+03]
 [-3.97902341e+00]
 [-2.02111742e+00]
 [-5.98747875e+00]
 [ 7.43167510e-01]
 [ 2.37299026e-01]
 [-6.07152938e-01]
 [ 1.50852689e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65546339e-18]]
[[ 4.71548260e+03]
 [ 3.25049566e+03]
 [-4.24956062e+03]
 [-3.97908003e+00]
 [-2.02115372e+00]
 [-5.98749960e+00]
 [ 7.43167510e-01]
 [ 2.37299026e-01]
 [-6.07152938e-01]
 [ 1.50852689e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65546339e-18]]
[[ 1.09159031e-03 -4.29104326e-03  1.10376163e-03  1.15653994e-05
   3.99416012e-07  1.09814551e-05]
 [-4.29104326e-03  2.98080264e-02 -6.76310473e-03 -4.36745716e-05
   7.34220071e-06 -6.23350035e-05]
 [ 1.10376163e-03 -6.76310473e-03  2.07746211e-03  1.20799226e-05
   2.62279665e-07  2.04666926e-05]
 [ 1.15653994e-05 -4.36745716e-05  1.20799226e-05  1.90643470e-07
   1.17939873e-08  1.27651840e-07]
 [ 3.99416012e-07  7.34220071e-06  2.62279665e-07  1.17939873e-08
   1.25828078e-07  1.19929155e-08]
 [ 1.09814551e-05 -6.23350035e-05  2.04666926e-05  1.27651840e-07
   1.19929155e-08  2.78765083e-07]]
[[ 1.73751831]
 [-0.27942851]
 [13.41858649]]
[[ 1.72015535e-05]
 [-7.11428562e-06]
 [ 1.39238891e-01]]


 Corrector Step
2018-07-13 19:34:10
[[ 4.71548260e+03]
 [ 3.25049566e+03]
 [-4.24956062e+03]
 [-3.97908003e+00]
 [-2.02115372e+00]
 [-5.98749960e+00]
 [ 7.43167510e-01]
 [ 2.37299026e-01]
 [-6.07152938e-01]
 [ 1.50852689e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65546339e-18]]
[[ 1.09159031e-03 -4.29104326e-03  1.10376163e-03  1.15653994e-05
   3.99416012e-07  1.09814551e-05]
 [-4.29104326e-03  2.98080264e-02 -6.76310473e-03 -4.36745716e-05
   7.34220071e-06 -6.23350035e-05]
 [ 1.10376163e-03 -6.76310473e-03  2.07746211e-03  1.20799226e-05
   2.62279665e-07  2.04666926e-05]
 [ 1.15653994e-05 -4.36745716e-05  1.20799226e-05  1.90643470e-07
   1.17939873e-08  1.27651840e-07]
 [ 3.99416012e-07  7.34220071e-06  2.62279665e-07  1.17939873e-08
   1.25828078e-07  1.19929155e-08]
 [ 1.09814551e-05 -6.23350035e-05  2.04666926e-05  1.27651840e-07
   1.19929155e-08  2.78765083e-07]]
255912519.32758743
post
cubesat_nadir
Ybar_post [[ 1.7375222 ]
 [-0.27943119]
 [13.41855719]]
resids [[ 1.33140893e-05]
 [-4.43659855e-06]
 [ 1.39268189e-01]]
posterior
[[ 4.71550741e+03]
 [ 3.25039608e+03]
 [-4.24953867e+03]
 [-3.97882209e+00]
 [-2.02112985e+00]
 [-5.98732744e+00]]
[[ 4.71550435e+03]
 [ 3.25039166e+03]
 [-4.24953872e+03]
 [-3.97882692e+00]
 [-2.02113415e+00]
 [-5.98732775e+00]]
[[ 2.19878002e-04 -2.43809593e-05  1.39813103e-05  2.81553388e-07
   4.81567863e-08  1.31400436e-08]
 [-2.43809593e-05  1.63854641e-03 -1.35747014e-04  2.50329187e-07
   1.21770029e-06  4.60260329e-08]
 [ 1.39813103e-05 -1.35747014e-04  2.10884243e-04  5.63258796e-08
  -4.16172609e-08 -1.46904040e-08]
 [ 2.81553388e-07  2.50329187e-07  5.63258796e-08  1.93511415e-09
   4.72580201e-10  6.70960950e-10]
 [ 4.81567863e-08  1.21770029e-06 -4.16172609e-08  4.72580201e-10
   2.19804362e-09  3.78424889e-10]
 [ 1.31400436e-08  4.60260329e-08 -1.46904040e-08  6.70960950e-10
   3.78424889e-10  2.58335048e-09]]
[[ 1.73751819]
 [-0.27943458]
 [15.95705891]]
[[ 1.73207628e-05]
 [-1.03833715e-06]
 [-2.39923352e+00]]


 Corrector Step
2018-07-13 19:34:10
[[ 4.71550435e+03]
 [ 3.25039166e+03]
 [-4.24953872e+03]
 [-3.97882692e+00]
 [-2.02113415e+00]
 [-5.98732775e+00]]
[[ 2.19878002e-04 -2.43809593e-05  1.39813103e-05  2.81553388e-07
   4.81567863e-08  1.31400436e-08]
 [-2.43809593e-05  1.63854641e-03 -1.35747014e-04  2.50329187e-07
   1.21770029e-06  4.60260329e-08]
 [ 1.39813103e-05 -1.35747014e-04  2.10884243e-04  5.63258796e-08
  -4.16172609e-08 -1.46904040e-08]
 [ 2.81553388e-07  2.50329187e-07  5.63258796e-08  1.93511415e-09
   4.72580201e-10  6.70960950e-10]
 [ 4.81567863e-08  1.21770029e-06 -4.16172609e-08  4.72580201e-10
   2.19804362e-09  3.78424889e-10]
 [ 1.31400436e-08  4.60260329e-08 -1.46904040e-08  6.70960950e-10
   3.78424889e-10  2.58335048e-09]]
7.790527913498624e-117
post
sphere_lamr_small
Ybar_post [[ 1.73752012]
 [-0.27943513]
 [15.95705596]]
resids [[ 1.53968238e-05]
 [-4.96682626e-07]
 [-2.39923058e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [255912519.32758743, 7.790527913498624e-117]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.71548260e+03],
       [ 3.25049566e+03],
       [-4.24956062e+03],
       [-3.97908003e+00],
       [-2.02115372e+00],
       [-5.98749960e+00]]), 'est_covars': array([[ 1.09159031e-03, -4.29104326e-03,  1.10376163e-03,
         1.15653994e-05,  3.99416012e-07,  1.09814551e-05],
       [-4.29104326e-03,  2.98080264e-02, -6.76310473e-03,
        -4.36745716e-05,  7.34220071e-06, -6.23350035e-05],
       [ 1.10376163e-03, -6.76310473e-03,  2.07746211e-03,
         1.20799226e-05,  2.62279665e-07,  2.04666926e-05],
       [ 1.15653994e-05, -4.36745716e-05,  1.20799226e-05,
         1.90643470e-07,  1.17939873e-08,  1.27651840e-07],
       [ 3.99416012e-07,  7.34220071e-06,  2.62279665e-07,
         1.17939873e-08,  1.25828078e-07,  1.19929155e-08],
       [ 1.09814551e-05, -6.23350035e-05,  2.04666926e-05,
         1.27651840e-07,  1.19929155e-08,  2.78765083e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.71550435e+03],
       [ 3.25039166e+03],
       [-4.24953872e+03],
       [-3.97882692e+00],
       [-2.02113415e+00],
       [-5.98732775e+00]]), 'covar': array([[ 2.19878002e-04, -2.43809593e-05,  1.39813103e-05,
         2.81553388e-07,  4.81567863e-08,  1.31400436e-08],
       [-2.43809593e-05,  1.63854641e-03, -1.35747014e-04,
         2.50329187e-07,  1.21770029e-06,  4.60260329e-08],
       [ 1.39813103e-05, -1.35747014e-04,  2.10884243e-04,
         5.63258796e-08, -4.16172609e-08, -1.46904040e-08],
       [ 2.81553388e-07,  2.50329187e-07,  5.63258796e-08,
         1.93511415e-09,  4.72580201e-10,  6.70960950e-10],
       [ 4.81567863e-08,  1.21770029e-06, -4.16172609e-08,
         4.72580201e-10,  2.19804362e-09,  3.78424889e-10],
       [ 1.31400436e-08,  4.60260329e-08, -1.46904040e-08,
         6.70960950e-10,  3.78424889e-10,  2.58335048e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.53968238e-05],
       [-4.96682626e-07],
       [-2.39923058e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.71548260e+03],
       [ 3.25049566e+03],
       [-4.24956062e+03],
       [-3.97908003e+00],
       [-2.02115372e+00],
       [-5.98749960e+00],
       [ 7.43167510e-01],
       [ 2.37299026e-01],
       [-6.07152938e-01],
       [ 1.50852689e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65546339e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.09159031e-03, -4.29104326e-03,  1.10376163e-03,
         1.15653994e-05,  3.99416012e-07,  1.09814551e-05],
       [-4.29104326e-03,  2.98080264e-02, -6.76310473e-03,
        -4.36745716e-05,  7.34220071e-06, -6.23350035e-05],
       [ 1.10376163e-03, -6.76310473e-03,  2.07746211e-03,
         1.20799226e-05,  2.62279665e-07,  2.04666926e-05],
       [ 1.15653994e-05, -4.36745716e-05,  1.20799226e-05,
         1.90643470e-07,  1.17939873e-08,  1.27651840e-07],
       [ 3.99416012e-07,  7.34220071e-06,  2.62279665e-07,
         1.17939873e-08,  1.25828078e-07,  1.19929155e-08],
       [ 1.09814551e-05, -6.23350035e-05,  2.04666926e-05,
         1.27651840e-07,  1.19929155e-08,  2.78765083e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.33140893e-05],
       [-4.43659855e-06],
       [ 1.39268189e-01]])}}
Current time:  2018-07-13 19:34:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.71548260e+03],
       [ 3.25049566e+03],
       [-4.24956062e+03],
       [-3.97908003e+00],
       [-2.02115372e+00],
       [-5.98749960e+00],
       [ 7.43167510e-01],
       [ 2.37299026e-01],
       [-6.07152938e-01],
       [ 1.50852689e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65546339e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.09159031e-03, -4.29104326e-03,  1.10376163e-03,
         1.15653994e-05,  3.99416012e-07,  1.09814551e-05],
       [-4.29104326e-03,  2.98080264e-02, -6.76310473e-03,
        -4.36745716e-05,  7.34220071e-06, -6.23350035e-05],
       [ 1.10376163e-03, -6.76310473e-03,  2.07746211e-03,
         1.20799226e-05,  2.62279665e-07,  2.04666926e-05],
       [ 1.15653994e-05, -4.36745716e-05,  1.20799226e-05,
         1.90643470e-07,  1.17939873e-08,  1.27651840e-07],
       [ 3.99416012e-07,  7.34220071e-06,  2.62279665e-07,
         1.17939873e-08,  1.25828078e-07,  1.19929155e-08],
       [ 1.09814551e-05, -6.23350035e-05,  2.04666926e-05,
         1.27651840e-07,  1.19929155e-08,  2.78765083e-07]])}
[[ 4.71548260e+03]
 [ 3.25049566e+03]
 [-4.24956062e+03]
 [-3.97908003e+00]
 [-2.02115372e+00]
 [-5.98749960e+00]
 [ 7.43167510e-01]
 [ 2.37299026e-01]
 [-6.07152938e-01]
 [ 1.50852689e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65546339e-18]]
2018-07-13 19:34:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:20
[[ 4.67543352e+03]
 [ 3.23010596e+03]
 [-4.30920051e+03]
 [-4.03062482e+00]
 [-2.05672442e+00]
 [-5.94040003e+00]
 [ 7.39987244e-01]
 [ 2.36508142e-01]
 [-6.11024972e-01]
 [ 1.52089645e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65567568e-18]]
[[ 1.34175579e-03 -4.72057643e-03  1.34669252e-03  1.34599607e-05
   5.38444427e-07  1.22807498e-05]
 [-4.72057643e-03  2.99666927e-02 -7.38366237e-03 -4.31840973e-05
   8.54414979e-06 -6.24312780e-05]
 [ 1.34669252e-03 -7.38366237e-03  2.51549861e-03  1.32580234e-05
   4.03843598e-07  2.33585035e-05]
 [ 1.34599607e-05 -4.31840973e-05  1.32580234e-05  1.99540832e-07
   1.20599111e-08  1.27030969e-07]
 [ 5.38444427e-07  8.54414979e-06  4.03843598e-07  1.20599111e-08
   1.35764872e-07  1.20949128e-08]
 [ 1.22807498e-05 -6.24312780e-05  2.33585035e-05  1.27030969e-07
   1.20949128e-08  2.89625119e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.71550435e+03],
       [ 3.25039166e+03],
       [-4.24953872e+03],
       [-3.97882692e+00],
       [-2.02113415e+00],
       [-5.98732775e+00]]), 'covar': array([[ 2.19878002e-04, -2.43809593e-05,  1.39813103e-05,
         2.81553388e-07,  4.81567863e-08,  1.31400436e-08],
       [-2.43809593e-05,  1.63854641e-03, -1.35747014e-04,
         2.50329187e-07,  1.21770029e-06,  4.60260329e-08],
       [ 1.39813103e-05, -1.35747014e-04,  2.10884243e-04,
         5.63258796e-08, -4.16172609e-08, -1.46904040e-08],
       [ 2.81553388e-07,  2.50329187e-07,  5.63258796e-08,
         1.93511415e-09,  4.72580201e-10,  6.70960950e-10],
       [ 4.81567863e-08,  1.21770029e-06, -4.16172609e-08,
         4.72580201e-10,  2.19804362e-09,  3.78424889e-10],
       [ 1.31400436e-08,  4.60260329e-08, -1.46904040e-08,
         6.70960950e-10,  3.78424889e-10,  2.58335048e-09]])}
[[ 4.71550435e+03]
 [ 3.25039166e+03]
 [-4.24953872e+03]
 [-3.97882692e+00]
 [-2.02113415e+00]
 [-5.98732775e+00]]
2018-07-13 19:34:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:20
[[ 4.67545785e+03]
 [ 3.23000214e+03]
 [-4.30917706e+03]
 [-4.03037307e+00]
 [-2.05670455e+00]
 [-5.94022723e+00]]
[[ 2.25746428e-04 -2.11932791e-05  1.47156509e-05  3.01733423e-07
   5.51292715e-08  1.70288394e-08]
 [-2.11932791e-05  1.66313946e-03 -1.35735852e-04  2.73027312e-07
   1.23424141e-06  3.49180377e-08]
 [ 1.47156509e-05 -1.35735852e-04  2.10864485e-04  5.89697271e-08
  -3.90743354e-08  1.28499360e-08]
 [ 3.01733423e-07  2.73027312e-07  5.89697271e-08  2.04066084e-09
   4.86560876e-10  6.65363938e-10]
 [ 5.51292715e-08  1.23424141e-06 -3.90743354e-08  4.86560876e-10
   2.28951122e-09  3.66615681e-10]
 [ 1.70288394e-08  3.49180377e-08  1.28499360e-08  6.65363938e-10
   3.66615681e-10  2.68252923e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.67545785e+03],
       [ 3.23000214e+03],
       [-4.30917706e+03],
       [-4.03037307e+00],
       [-2.05670455e+00],
       [-5.94022723e+00]]), 'covar': array([[ 2.25746428e-04, -2.11932791e-05,  1.47156509e-05,
         3.01733423e-07,  5.51292715e-08,  1.70288394e-08],
       [-2.11932791e-05,  1.66313946e-03, -1.35735852e-04,
         2.73027312e-07,  1.23424141e-06,  3.49180377e-08],
       [ 1.47156509e-05, -1.35735852e-04,  2.10864485e-04,
         5.89697271e-08, -3.90743354e-08,  1.28499360e-08],
       [ 3.01733423e-07,  2.73027312e-07,  5.89697271e-08,
         2.04066084e-09,  4.86560876e-10,  6.65363938e-10],
       [ 5.51292715e-08,  1.23424141e-06, -3.90743354e-08,
         4.86560876e-10,  2.28951122e-09,  3.66615681e-10],
       [ 1.70288394e-08,  3.49180377e-08,  1.28499360e-08,
         6.65363938e-10,  3.66615681e-10,  2.68252923e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.53968238e-05],
       [-4.96682626e-07],
       [-2.39923058e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.67543352e+03],
       [ 3.23010596e+03],
       [-4.30920051e+03],
       [-4.03062482e+00],
       [-2.05672442e+00],
       [-5.94040003e+00],
       [ 7.39987244e-01],
       [ 2.36508142e-01],
       [-6.11024972e-01],
       [ 1.52089645e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65567568e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.34175579e-03, -4.72057643e-03,  1.34669252e-03,
         1.34599607e-05,  5.38444427e-07,  1.22807498e-05],
       [-4.72057643e-03,  2.99666927e-02, -7.38366237e-03,
        -4.31840973e-05,  8.54414979e-06, -6.24312780e-05],
       [ 1.34669252e-03, -7.38366237e-03,  2.51549861e-03,
         1.32580234e-05,  4.03843598e-07,  2.33585035e-05],
       [ 1.34599607e-05, -4.31840973e-05,  1.32580234e-05,
         1.99540832e-07,  1.20599111e-08,  1.27030969e-07],
       [ 5.38444427e-07,  8.54414979e-06,  4.03843598e-07,
         1.20599111e-08,  1.35764872e-07,  1.20949128e-08],
       [ 1.22807498e-05, -6.24312780e-05,  2.33585035e-05,
         1.27030969e-07,  1.20949128e-08,  2.89625119e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.33140893e-05],
       [-4.43659855e-06],
       [ 1.39268189e-01]])}}
Yi [[ 1.75892405]
 [-0.30903242]
 [13.34534512]]
posterior
[[ 4.67543352e+03]
 [ 3.23010596e+03]
 [-4.30920051e+03]
 [-4.03062482e+00]
 [-2.05672442e+00]
 [-5.94040003e+00]
 [ 7.39987244e-01]
 [ 2.36508142e-01]
 [-6.11024972e-01]
 [ 1.52089645e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65567568e-18]]
[[ 4.67542125e+03]
 [ 3.23016252e+03]
 [-4.30919613e+03]
 [-4.03072628e+00]
 [-2.05666048e+00]
 [-5.94031310e+00]
 [ 7.39987244e-01]
 [ 2.36508142e-01]
 [-6.11024972e-01]
 [ 1.52089645e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65567568e-18]]
[[ 1.26063673e-03 -4.71394480e-03  1.36355803e-03  1.25978510e-05
   4.18041488e-07  1.24258324e-05]
 [-4.71394480e-03  2.82963572e-02 -7.43948776e-03 -4.39808183e-05
   6.08702080e-06 -6.43890269e-05]
 [ 1.36355803e-03 -7.43948776e-03  2.51020604e-03  1.34089788e-05
   3.48404201e-07  2.32647690e-05]
 [ 1.25978510e-05 -4.39808183e-05  1.34089788e-05  1.89928197e-07
   9.49906322e-09  1.27562167e-07]
 [ 4.18041488e-07  6.08702080e-06  3.48404201e-07  9.49906322e-09
   1.31941330e-07  9.43501192e-09]
 [ 1.24258324e-05 -6.43890269e-05  2.32647690e-05  1.27562167e-07
   9.43501192e-09  2.87096634e-07]]
[[ 1.75890774]
 [-0.30908182]
 [13.36513543]]
[[ 1.63171702e-05]
 [ 4.94013290e-05]
 [-1.97903114e-02]]


 Corrector Step
2018-07-13 19:34:20
[[ 4.67542125e+03]
 [ 3.23016252e+03]
 [-4.30919613e+03]
 [-4.03072628e+00]
 [-2.05666048e+00]
 [-5.94031310e+00]
 [ 7.39987244e-01]
 [ 2.36508142e-01]
 [-6.11024972e-01]
 [ 1.52089645e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65567568e-18]]
[[ 1.26063673e-03 -4.71394480e-03  1.36355803e-03  1.25978510e-05
   4.18041488e-07  1.24258324e-05]
 [-4.71394480e-03  2.82963572e-02 -7.43948776e-03 -4.39808183e-05
   6.08702080e-06 -6.43890269e-05]
 [ 1.36355803e-03 -7.43948776e-03  2.51020604e-03  1.34089788e-05
   3.48404201e-07  2.32647690e-05]
 [ 1.25978510e-05 -4.39808183e-05  1.34089788e-05  1.89928197e-07
   9.49906322e-09  1.27562167e-07]
 [ 4.18041488e-07  6.08702080e-06  3.48404201e-07  9.49906322e-09
   1.31941330e-07  9.43501192e-09]
 [ 1.24258324e-05 -6.43890269e-05  2.32647690e-05  1.27562167e-07
   9.43501192e-09  2.87096634e-07]]
129675399.61444658
post
cubesat_nadir
Ybar_post [[ 1.7589085 ]
 [-0.3090714 ]
 [13.36519906]]
resids [[ 1.55525977e-05]
 [ 3.89822751e-05]
 [-1.98539395e-02]]
posterior
[[ 4.67545785e+03]
 [ 3.23000214e+03]
 [-4.30917706e+03]
 [-4.03037307e+00]
 [-2.05670455e+00]
 [-5.94022723e+00]]
[[ 4.67545439e+03]
 [ 3.23001209e+03]
 [-4.30917047e+03]
 [-4.03037352e+00]
 [-2.05669601e+00]
 [-5.94022671e+00]]
[[ 2.07442439e-04 -4.41832190e-05  1.62261378e-05  2.73011447e-07
   3.24279044e-08  1.51570083e-08]
 [-4.41832190e-05  1.58443124e-03 -1.54953570e-04  2.19867757e-07
   1.16127330e-06  2.96152723e-08]
 [ 1.62261378e-05 -1.54953570e-04  2.01793030e-04  5.41009081e-08
  -5.60372948e-08  1.17537016e-08]
 [ 2.73011447e-07  2.19867757e-07  5.41009081e-08  1.98973408e-09
   4.35697797e-10  6.61414758e-10]
 [ 3.24279044e-08  1.16127330e-06 -5.60372948e-08  4.35697797e-10
   2.22169833e-09  3.61660958e-10]
 [ 1.51570083e-08  2.96152723e-08  1.17537016e-08  6.61414758e-10
   3.61660958e-10  2.68216297e-09]]
[[ 1.7589055 ]
 [-0.30908662]
 [15.86165714]]
[[ 1.85523444e-05]
 [ 5.42032282e-05]
 [-2.51631202e+00]]


 Corrector Step
2018-07-13 19:34:20
[[ 4.67545439e+03]
 [ 3.23001209e+03]
 [-4.30917047e+03]
 [-4.03037352e+00]
 [-2.05669601e+00]
 [-5.94022671e+00]]
[[ 2.07442439e-04 -4.41832190e-05  1.62261378e-05  2.73011447e-07
   3.24279044e-08  1.51570083e-08]
 [-4.41832190e-05  1.58443124e-03 -1.54953570e-04  2.19867757e-07
   1.16127330e-06  2.96152723e-08]
 [ 1.62261378e-05 -1.54953570e-04  2.01793030e-04  5.41009081e-08
  -5.60372948e-08  1.17537016e-08]
 [ 2.73011447e-07  2.19867757e-07  5.41009081e-08  1.98973408e-09
   4.35697797e-10  6.61414758e-10]
 [ 3.24279044e-08  1.16127330e-06 -5.60372948e-08  4.35697797e-10
   2.22169833e-09  3.61660958e-10]
 [ 1.51570083e-08  2.96152723e-08  1.17537016e-08  6.61414758e-10
   3.61660958e-10  2.68216297e-09]]
2.3795927349570222e-130
post
sphere_lamr_small
Ybar_post [[ 1.75890628]
 [-0.30908211]
 [15.86168635]]
resids [[ 1.77710661e-05]
 [ 4.96961380e-05]
 [-2.51634123e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [129675399.61444658, 2.3795927349570222e-130]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.67542125e+03],
       [ 3.23016252e+03],
       [-4.30919613e+03],
       [-4.03072628e+00],
       [-2.05666048e+00],
       [-5.94031310e+00]]), 'est_covars': array([[ 1.26063673e-03, -4.71394480e-03,  1.36355803e-03,
         1.25978510e-05,  4.18041488e-07,  1.24258324e-05],
       [-4.71394480e-03,  2.82963572e-02, -7.43948776e-03,
        -4.39808183e-05,  6.08702080e-06, -6.43890269e-05],
       [ 1.36355803e-03, -7.43948776e-03,  2.51020604e-03,
         1.34089788e-05,  3.48404201e-07,  2.32647690e-05],
       [ 1.25978510e-05, -4.39808183e-05,  1.34089788e-05,
         1.89928197e-07,  9.49906322e-09,  1.27562167e-07],
       [ 4.18041488e-07,  6.08702080e-06,  3.48404201e-07,
         9.49906322e-09,  1.31941330e-07,  9.43501192e-09],
       [ 1.24258324e-05, -6.43890269e-05,  2.32647690e-05,
         1.27562167e-07,  9.43501192e-09,  2.87096634e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.67545439e+03],
       [ 3.23001209e+03],
       [-4.30917047e+03],
       [-4.03037352e+00],
       [-2.05669601e+00],
       [-5.94022671e+00]]), 'covar': array([[ 2.07442439e-04, -4.41832190e-05,  1.62261378e-05,
         2.73011447e-07,  3.24279044e-08,  1.51570083e-08],
       [-4.41832190e-05,  1.58443124e-03, -1.54953570e-04,
         2.19867757e-07,  1.16127330e-06,  2.96152723e-08],
       [ 1.62261378e-05, -1.54953570e-04,  2.01793030e-04,
         5.41009081e-08, -5.60372948e-08,  1.17537016e-08],
       [ 2.73011447e-07,  2.19867757e-07,  5.41009081e-08,
         1.98973408e-09,  4.35697797e-10,  6.61414758e-10],
       [ 3.24279044e-08,  1.16127330e-06, -5.60372948e-08,
         4.35697797e-10,  2.22169833e-09,  3.61660958e-10],
       [ 1.51570083e-08,  2.96152723e-08,  1.17537016e-08,
         6.61414758e-10,  3.61660958e-10,  2.68216297e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.77710661e-05],
       [ 4.96961380e-05],
       [-2.51634123e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.67542125e+03],
       [ 3.23016252e+03],
       [-4.30919613e+03],
       [-4.03072628e+00],
       [-2.05666048e+00],
       [-5.94031310e+00],
       [ 7.39987244e-01],
       [ 2.36508142e-01],
       [-6.11024972e-01],
       [ 1.52089645e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65567568e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.26063673e-03, -4.71394480e-03,  1.36355803e-03,
         1.25978510e-05,  4.18041488e-07,  1.24258324e-05],
       [-4.71394480e-03,  2.82963572e-02, -7.43948776e-03,
        -4.39808183e-05,  6.08702080e-06, -6.43890269e-05],
       [ 1.36355803e-03, -7.43948776e-03,  2.51020604e-03,
         1.34089788e-05,  3.48404201e-07,  2.32647690e-05],
       [ 1.25978510e-05, -4.39808183e-05,  1.34089788e-05,
         1.89928197e-07,  9.49906322e-09,  1.27562167e-07],
       [ 4.18041488e-07,  6.08702080e-06,  3.48404201e-07,
         9.49906322e-09,  1.31941330e-07,  9.43501192e-09],
       [ 1.24258324e-05, -6.43890269e-05,  2.32647690e-05,
         1.27562167e-07,  9.43501192e-09,  2.87096634e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.55525977e-05],
       [ 3.89822751e-05],
       [-1.98539395e-02]])}}
Current time:  2018-07-13 19:34:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.67542125e+03],
       [ 3.23016252e+03],
       [-4.30919613e+03],
       [-4.03072628e+00],
       [-2.05666048e+00],
       [-5.94031310e+00],
       [ 7.39987244e-01],
       [ 2.36508142e-01],
       [-6.11024972e-01],
       [ 1.52089645e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65567568e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.26063673e-03, -4.71394480e-03,  1.36355803e-03,
         1.25978510e-05,  4.18041488e-07,  1.24258324e-05],
       [-4.71394480e-03,  2.82963572e-02, -7.43948776e-03,
        -4.39808183e-05,  6.08702080e-06, -6.43890269e-05],
       [ 1.36355803e-03, -7.43948776e-03,  2.51020604e-03,
         1.34089788e-05,  3.48404201e-07,  2.32647690e-05],
       [ 1.25978510e-05, -4.39808183e-05,  1.34089788e-05,
         1.89928197e-07,  9.49906322e-09,  1.27562167e-07],
       [ 4.18041488e-07,  6.08702080e-06,  3.48404201e-07,
         9.49906322e-09,  1.31941330e-07,  9.43501192e-09],
       [ 1.24258324e-05, -6.43890269e-05,  2.32647690e-05,
         1.27562167e-07,  9.43501192e-09,  2.87096634e-07]])}
[[ 4.67542125e+03]
 [ 3.23016252e+03]
 [-4.30919613e+03]
 [-4.03072628e+00]
 [-2.05666048e+00]
 [-5.94031310e+00]
 [ 7.39987244e-01]
 [ 2.36508142e-01]
 [-6.11024972e-01]
 [ 1.52089645e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65567568e-18]]
2018-07-13 19:34:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:30
[[ 4.63485795e+03]
 [ 3.20941890e+03]
 [-4.36836104e+03]
 [-4.08182144e+00]
 [-2.09200117e+00]
 [-5.89256611e+00]
 [ 7.36786805e-01]
 [ 2.35710811e-01]
 [-6.14880349e-01]
 [ 1.53322455e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65588796e-18]]
[[ 1.53128908e-03 -5.14663981e-03  1.63422385e-03  1.44782278e-05
   5.35232870e-07  1.37263653e-05]
 [-5.14663981e-03  2.84305961e-02 -8.07986544e-03 -4.35233078e-05
   7.35732321e-06 -6.44963624e-05]
 [ 1.63422385e-03 -8.07986544e-03  3.00503156e-03  1.45746580e-05
   4.66113752e-07  2.62443999e-05]
 [ 1.44782278e-05 -4.35233078e-05  1.45746580e-05  1.98796055e-07
   9.75131733e-09  1.26890961e-07]
 [ 5.35232870e-07  7.35732321e-06  4.66113752e-07  9.75131733e-09
   1.41885863e-07  9.54695695e-09]
 [ 1.37263653e-05 -6.44963624e-05  2.62443999e-05  1.26890961e-07
   9.54695695e-09  2.97984496e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.67545439e+03],
       [ 3.23001209e+03],
       [-4.30917047e+03],
       [-4.03037352e+00],
       [-2.05669601e+00],
       [-5.94022671e+00]]), 'covar': array([[ 2.07442439e-04, -4.41832190e-05,  1.62261378e-05,
         2.73011447e-07,  3.24279044e-08,  1.51570083e-08],
       [-4.41832190e-05,  1.58443124e-03, -1.54953570e-04,
         2.19867757e-07,  1.16127330e-06,  2.96152723e-08],
       [ 1.62261378e-05, -1.54953570e-04,  2.01793030e-04,
         5.41009081e-08, -5.60372948e-08,  1.17537016e-08],
       [ 2.73011447e-07,  2.19867757e-07,  5.41009081e-08,
         1.98973408e-09,  4.35697797e-10,  6.61414758e-10],
       [ 3.24279044e-08,  1.16127330e-06, -5.60372948e-08,
         4.35697797e-10,  2.22169833e-09,  3.61660958e-10],
       [ 1.51570083e-08,  2.96152723e-08,  1.17537016e-08,
         6.61414758e-10,  3.61660958e-10,  2.68216297e-09]])}
[[ 4.67545439e+03]
 [ 3.23001209e+03]
 [-4.30917047e+03]
 [-4.03037352e+00]
 [-2.05669601e+00]
 [-5.94022671e+00]]
2018-07-13 19:34:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:30
[[ 4.63489489e+03]
 [ 3.20926820e+03]
 [-4.36833430e+03]
 [-4.08147036e+00]
 [-2.09203606e+00]
 [-5.89247878e+00]]
[[ 2.13118454e-04 -4.15309615e-05  1.70088390e-05  2.93486294e-07
   3.89258490e-08  1.94527620e-08]
 [-4.15309615e-05  1.60782993e-03 -1.55292603e-04  2.41611939e-07
   1.17810351e-06  1.90457668e-08]
 [ 1.70088390e-05 -1.55292603e-04  2.02495586e-04  5.67602721e-08
  -5.34661136e-08  4.06847504e-08]
 [ 2.93486294e-07  2.41611939e-07  5.67602721e-08  2.09461971e-09
   4.49109398e-10  6.55796300e-10]
 [ 3.89258490e-08  1.17810351e-06 -5.34661136e-08  4.49109398e-10
   2.31336972e-09  3.50370676e-10]
 [ 1.94527620e-08  1.90457668e-08  4.06847504e-08  6.55796300e-10
   3.50370676e-10  2.78149371e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.63489489e+03],
       [ 3.20926820e+03],
       [-4.36833430e+03],
       [-4.08147036e+00],
       [-2.09203606e+00],
       [-5.89247878e+00]]), 'covar': array([[ 2.13118454e-04, -4.15309615e-05,  1.70088390e-05,
         2.93486294e-07,  3.89258490e-08,  1.94527620e-08],
       [-4.15309615e-05,  1.60782993e-03, -1.55292603e-04,
         2.41611939e-07,  1.17810351e-06,  1.90457668e-08],
       [ 1.70088390e-05, -1.55292603e-04,  2.02495586e-04,
         5.67602721e-08, -5.34661136e-08,  4.06847504e-08],
       [ 2.93486294e-07,  2.41611939e-07,  5.67602721e-08,
         2.09461971e-09,  4.49109398e-10,  6.55796300e-10],
       [ 3.89258490e-08,  1.17810351e-06, -5.34661136e-08,
         4.49109398e-10,  2.31336972e-09,  3.50370676e-10],
       [ 1.94527620e-08,  1.90457668e-08,  4.06847504e-08,
         6.55796300e-10,  3.50370676e-10,  2.78149371e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 1.77710661e-05],
       [ 4.96961380e-05],
       [-2.51634123e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.63485795e+03],
       [ 3.20941890e+03],
       [-4.36836104e+03],
       [-4.08182144e+00],
       [-2.09200117e+00],
       [-5.89256611e+00],
       [ 7.36786805e-01],
       [ 2.35710811e-01],
       [-6.14880349e-01],
       [ 1.53322455e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65588796e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.53128908e-03, -5.14663981e-03,  1.63422385e-03,
         1.44782278e-05,  5.35232870e-07,  1.37263653e-05],
       [-5.14663981e-03,  2.84305961e-02, -8.07986544e-03,
        -4.35233078e-05,  7.35732321e-06, -6.44963624e-05],
       [ 1.63422385e-03, -8.07986544e-03,  3.00503156e-03,
         1.45746580e-05,  4.66113752e-07,  2.62443999e-05],
       [ 1.44782278e-05, -4.35233078e-05,  1.45746580e-05,
         1.98796055e-07,  9.75131733e-09,  1.26890961e-07],
       [ 5.35232870e-07,  7.35732321e-06,  4.66113752e-07,
         9.75131733e-09,  1.41885863e-07,  9.54695695e-09],
       [ 1.37263653e-05, -6.44963624e-05,  2.62443999e-05,
         1.26890961e-07,  9.54695695e-09,  2.97984496e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.55525977e-05],
       [ 3.89822751e-05],
       [-1.98539395e-02]])}}
Yi [[ 1.78092577]
 [-0.33833419]
 [13.30043057]]
posterior
[[ 4.63485795e+03]
 [ 3.20941890e+03]
 [-4.36836104e+03]
 [-4.08182144e+00]
 [-2.09200117e+00]
 [-5.89256611e+00]
 [ 7.36786805e-01]
 [ 2.35710811e-01]
 [-6.14880349e-01]
 [ 1.53322455e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65588796e-18]]
[[ 4.63486095e+03]
 [ 3.20942928e+03]
 [-4.36836154e+03]
 [-4.08178313e+00]
 [-2.09198006e+00]
 [-5.89256129e+00]
 [ 7.36786805e-01]
 [ 2.35710811e-01]
 [-6.14880349e-01]
 [ 1.53322455e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65588796e-18]]
[[ 1.44850545e-03 -5.12743166e-03  1.65520980e-03  1.35996017e-05
   4.43931570e-07  1.39573642e-05]
 [-5.12743166e-03  2.70529948e-02 -8.11277331e-03 -4.41200833e-05
   5.18464611e-06 -6.61414949e-05]
 [ 1.65520980e-03 -8.11277331e-03  2.99912653e-03  1.47810384e-05
   4.44423715e-07  2.61532042e-05]
 [ 1.35996017e-05 -4.41200833e-05  1.47810384e-05  1.89003901e-07
   7.50309168e-09  1.28414628e-07]
 [ 4.43931570e-07  5.18464611e-06  4.44423715e-07  7.50309168e-09
   1.38279935e-07  7.25851695e-09]
 [ 1.39573642e-05 -6.61414949e-05  2.61532042e-05  1.28414628e-07
   7.25851695e-09  2.95493719e-07]]
[[ 1.78093761]
 [-0.33833756]
 [13.32850957]]
[[-1.18380194e-05]
 [ 3.36701530e-06]
 [-2.80789961e-02]]


 Corrector Step
2018-07-13 19:34:30
[[ 4.63486095e+03]
 [ 3.20942928e+03]
 [-4.36836154e+03]
 [-4.08178313e+00]
 [-2.09198006e+00]
 [-5.89256129e+00]
 [ 7.36786805e-01]
 [ 2.35710811e-01]
 [-6.14880349e-01]
 [ 1.53322455e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65588796e-18]]
[[ 1.44850545e-03 -5.12743166e-03  1.65520980e-03  1.35996017e-05
   4.43931570e-07  1.39573642e-05]
 [-5.12743166e-03  2.70529948e-02 -8.11277331e-03 -4.41200833e-05
   5.18464611e-06 -6.61414949e-05]
 [ 1.65520980e-03 -8.11277331e-03  2.99912653e-03  1.47810384e-05
   4.44423715e-07  2.61532042e-05]
 [ 1.35996017e-05 -4.41200833e-05  1.47810384e-05  1.89003901e-07
   7.50309168e-09  1.28414628e-07]
 [ 4.43931570e-07  5.18464611e-06  4.44423715e-07  7.50309168e-09
   1.38279935e-07  7.25851695e-09]
 [ 1.39573642e-05 -6.61414949e-05  2.61532042e-05  1.28414628e-07
   7.25851695e-09  2.95493719e-07]]
738293963.6748908
post
cubesat_nadir
Ybar_post [[ 1.78093516]
 [-0.33833629]
 [13.32852204]]
resids [[-9.38531288e-06]
 [ 2.09957308e-06]
 [-2.80914623e-02]]
posterior
[[ 4.63489489e+03]
 [ 3.20926820e+03]
 [-4.36833430e+03]
 [-4.08147036e+00]
 [-2.09203606e+00]
 [-5.89247878e+00]]
[[ 4.63489623e+03]
 [ 3.20927418e+03]
 [-4.36833280e+03]
 [-4.08146669e+00]
 [-2.09203059e+00]
 [-5.89247813e+00]]
[[ 1.97350695e-04 -6.23528544e-05  1.91066707e-05  2.67668445e-07
   1.86619568e-08  1.79127238e-08]
 [-6.23528544e-05  1.52518060e-03 -1.71790646e-04  1.89114304e-07
   1.10310567e-06  1.08031167e-08]
 [ 1.91066707e-05 -1.71790646e-04  1.95484849e-04  5.37655118e-08
  -6.76227270e-08  3.87204680e-08]
 [ 2.67668445e-07  1.89114304e-07  5.37655118e-08  2.04620466e-09
   3.99832777e-10  6.51202775e-10]
 [ 1.86619568e-08  1.10310567e-06 -6.76227270e-08  3.99832777e-10
   2.24513672e-09  3.42960948e-10]
 [ 1.79127238e-08  1.08031167e-08  3.87204680e-08  6.51202775e-10
   3.42960948e-10  2.78064430e-09]]
[[ 1.78093538]
 [-0.3383501 ]
 [15.76916337]]
[[-9.60284526e-06]
 [ 1.59137930e-05]
 [-2.46873280e+00]]


 Corrector Step
2018-07-13 19:34:30
[[ 4.63489623e+03]
 [ 3.20927418e+03]
 [-4.36833280e+03]
 [-4.08146669e+00]
 [-2.09203059e+00]
 [-5.89247813e+00]]
[[ 1.97350695e-04 -6.23528544e-05  1.91066707e-05  2.67668445e-07
   1.86619568e-08  1.79127238e-08]
 [-6.23528544e-05  1.52518060e-03 -1.71790646e-04  1.89114304e-07
   1.10310567e-06  1.08031167e-08]
 [ 1.91066707e-05 -1.71790646e-04  1.95484849e-04  5.37655118e-08
  -6.76227270e-08  3.87204680e-08]
 [ 2.67668445e-07  1.89114304e-07  5.37655118e-08  2.04620466e-09
   3.99832777e-10  6.51202775e-10]
 [ 1.86619568e-08  1.10310567e-06 -6.76227270e-08  3.99832777e-10
   2.24513672e-09  3.42960948e-10]
 [ 1.79127238e-08  1.08031167e-08  3.87204680e-08  6.51202775e-10
   3.42960948e-10  2.78064430e-09]]
3.406432232893981e-124
post
sphere_lamr_small
Ybar_post [[ 1.78093407]
 [-0.33834855]
 [15.76917417]]
resids [[-8.29546541e-06]
 [ 1.43652090e-05]
 [-2.46874359e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [738293963.6748908, 3.406432232893981e-124]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.63486095e+03],
       [ 3.20942928e+03],
       [-4.36836154e+03],
       [-4.08178313e+00],
       [-2.09198006e+00],
       [-5.89256129e+00]]), 'est_covars': array([[ 1.44850545e-03, -5.12743166e-03,  1.65520980e-03,
         1.35996017e-05,  4.43931570e-07,  1.39573642e-05],
       [-5.12743166e-03,  2.70529948e-02, -8.11277331e-03,
        -4.41200833e-05,  5.18464611e-06, -6.61414949e-05],
       [ 1.65520980e-03, -8.11277331e-03,  2.99912653e-03,
         1.47810384e-05,  4.44423715e-07,  2.61532042e-05],
       [ 1.35996017e-05, -4.41200833e-05,  1.47810384e-05,
         1.89003901e-07,  7.50309168e-09,  1.28414628e-07],
       [ 4.43931570e-07,  5.18464611e-06,  4.44423715e-07,
         7.50309168e-09,  1.38279935e-07,  7.25851695e-09],
       [ 1.39573642e-05, -6.61414949e-05,  2.61532042e-05,
         1.28414628e-07,  7.25851695e-09,  2.95493719e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.63489623e+03],
       [ 3.20927418e+03],
       [-4.36833280e+03],
       [-4.08146669e+00],
       [-2.09203059e+00],
       [-5.89247813e+00]]), 'covar': array([[ 1.97350695e-04, -6.23528544e-05,  1.91066707e-05,
         2.67668445e-07,  1.86619568e-08,  1.79127238e-08],
       [-6.23528544e-05,  1.52518060e-03, -1.71790646e-04,
         1.89114304e-07,  1.10310567e-06,  1.08031167e-08],
       [ 1.91066707e-05, -1.71790646e-04,  1.95484849e-04,
         5.37655118e-08, -6.76227270e-08,  3.87204680e-08],
       [ 2.67668445e-07,  1.89114304e-07,  5.37655118e-08,
         2.04620466e-09,  3.99832777e-10,  6.51202775e-10],
       [ 1.86619568e-08,  1.10310567e-06, -6.76227270e-08,
         3.99832777e-10,  2.24513672e-09,  3.42960948e-10],
       [ 1.79127238e-08,  1.08031167e-08,  3.87204680e-08,
         6.51202775e-10,  3.42960948e-10,  2.78064430e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-8.29546541e-06],
       [ 1.43652090e-05],
       [-2.46874359e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.63486095e+03],
       [ 3.20942928e+03],
       [-4.36836154e+03],
       [-4.08178313e+00],
       [-2.09198006e+00],
       [-5.89256129e+00],
       [ 7.36786805e-01],
       [ 2.35710811e-01],
       [-6.14880349e-01],
       [ 1.53322455e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65588796e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.44850545e-03, -5.12743166e-03,  1.65520980e-03,
         1.35996017e-05,  4.43931570e-07,  1.39573642e-05],
       [-5.12743166e-03,  2.70529948e-02, -8.11277331e-03,
        -4.41200833e-05,  5.18464611e-06, -6.61414949e-05],
       [ 1.65520980e-03, -8.11277331e-03,  2.99912653e-03,
         1.47810384e-05,  4.44423715e-07,  2.61532042e-05],
       [ 1.35996017e-05, -4.41200833e-05,  1.47810384e-05,
         1.89003901e-07,  7.50309168e-09,  1.28414628e-07],
       [ 4.43931570e-07,  5.18464611e-06,  4.44423715e-07,
         7.50309168e-09,  1.38279935e-07,  7.25851695e-09],
       [ 1.39573642e-05, -6.61414949e-05,  2.61532042e-05,
         1.28414628e-07,  7.25851695e-09,  2.95493719e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-9.38531288e-06],
       [ 2.09957308e-06],
       [-2.80914623e-02]])}}
Current time:  2018-07-13 19:34:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.63486095e+03],
       [ 3.20942928e+03],
       [-4.36836154e+03],
       [-4.08178313e+00],
       [-2.09198006e+00],
       [-5.89256129e+00],
       [ 7.36786805e-01],
       [ 2.35710811e-01],
       [-6.14880349e-01],
       [ 1.53322455e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65588796e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.44850545e-03, -5.12743166e-03,  1.65520980e-03,
         1.35996017e-05,  4.43931570e-07,  1.39573642e-05],
       [-5.12743166e-03,  2.70529948e-02, -8.11277331e-03,
        -4.41200833e-05,  5.18464611e-06, -6.61414949e-05],
       [ 1.65520980e-03, -8.11277331e-03,  2.99912653e-03,
         1.47810384e-05,  4.44423715e-07,  2.61532042e-05],
       [ 1.35996017e-05, -4.41200833e-05,  1.47810384e-05,
         1.89003901e-07,  7.50309168e-09,  1.28414628e-07],
       [ 4.43931570e-07,  5.18464611e-06,  4.44423715e-07,
         7.50309168e-09,  1.38279935e-07,  7.25851695e-09],
       [ 1.39573642e-05, -6.61414949e-05,  2.61532042e-05,
         1.28414628e-07,  7.25851695e-09,  2.95493719e-07]])}
[[ 4.63486095e+03]
 [ 3.20942928e+03]
 [-4.36836154e+03]
 [-4.08178313e+00]
 [-2.09198006e+00]
 [-5.89256129e+00]
 [ 7.36786805e-01]
 [ 2.35710811e-01]
 [-6.14880349e-01]
 [ 1.53322455e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65588796e-18]]
2018-07-13 19:34:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:40
[[ 4.59378926e+03]
 [ 3.18833354e+03]
 [-4.42704565e+03]
 [-4.13242366e+00]
 [-2.12708663e+00]
 [-5.84417235e+00]
 [ 7.33566278e-01]
 [ 2.34907053e-01]
 [-6.18718962e-01]
 [ 1.54551085e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65610025e-18]]
[[ 1.73924577e-03 -5.56133013e-03  1.95484172e-03  1.54634337e-05
   5.42121908e-07  1.52684962e-05]
 [-5.56133013e-03  2.71700003e-02 -8.76994487e-03 -4.36893206e-05
   6.52483309e-06 -6.62588729e-05]
 [ 1.95484172e-03 -8.76994487e-03  3.55265651e-03  1.59431966e-05
   5.41861143e-07  2.92212764e-05]
 [ 1.54634337e-05 -4.36893206e-05  1.59431966e-05  1.97843069e-07
   7.74337879e-09  1.27694365e-07]
 [ 5.42121908e-07  6.52483309e-06  5.41861143e-07  7.74337879e-09
   1.48229411e-07  7.37568350e-09]
 [ 1.52684962e-05 -6.62588729e-05  2.92212764e-05  1.27694365e-07
   7.37568350e-09  3.06405365e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.63489623e+03],
       [ 3.20927418e+03],
       [-4.36833280e+03],
       [-4.08146669e+00],
       [-2.09203059e+00],
       [-5.89247813e+00]]), 'covar': array([[ 1.97350695e-04, -6.23528544e-05,  1.91066707e-05,
         2.67668445e-07,  1.86619568e-08,  1.79127238e-08],
       [-6.23528544e-05,  1.52518060e-03, -1.71790646e-04,
         1.89114304e-07,  1.10310567e-06,  1.08031167e-08],
       [ 1.91066707e-05, -1.71790646e-04,  1.95484849e-04,
         5.37655118e-08, -6.76227270e-08,  3.87204680e-08],
       [ 2.67668445e-07,  1.89114304e-07,  5.37655118e-08,
         2.04620466e-09,  3.99832777e-10,  6.51202775e-10],
       [ 1.86619568e-08,  1.10310567e-06, -6.76227270e-08,
         3.99832777e-10,  2.24513672e-09,  3.42960948e-10],
       [ 1.79127238e-08,  1.08031167e-08,  3.87204680e-08,
         6.51202775e-10,  3.42960948e-10,  2.78064430e-09]])}
[[ 4.63489623e+03]
 [ 3.20927418e+03]
 [-4.36833280e+03]
 [-4.08146669e+00]
 [-2.09203059e+00]
 [-5.89247813e+00]]
2018-07-13 19:34:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:40
[[ 4.59382788e+03]
 [ 3.18817807e+03]
 [-4.42701582e+03]
 [-4.13210907e+00]
 [-2.12713646e+00]
 [-5.84408856e+00]]
[[ 2.02960181e-04 -6.00971375e-05  1.97087950e-05  2.88330105e-07
   2.47040594e-08  2.24450134e-08]
 [-6.00971375e-05  1.54744950e-03 -1.72518903e-04  2.09884680e-07
   1.12027809e-06  7.70919275e-10]
 [ 1.97087950e-05 -1.72518903e-04  1.96931078e-04  5.61785258e-08
  -6.50500481e-08  6.84328217e-08]
 [ 2.88330105e-07  2.09884680e-07  5.61785258e-08  2.15012418e-09
   4.12645014e-10  6.45163904e-10]
 [ 2.47040594e-08  1.12027809e-06 -6.50500481e-08  4.12645014e-10
   2.33705640e-09  3.32079956e-10]
 [ 2.24450134e-08  7.70919275e-10  6.84328217e-08  6.45163904e-10
   3.32079956e-10  2.88030070e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.59382788e+03],
       [ 3.18817807e+03],
       [-4.42701582e+03],
       [-4.13210907e+00],
       [-2.12713646e+00],
       [-5.84408856e+00]]), 'covar': array([[ 2.02960181e-04, -6.00971375e-05,  1.97087950e-05,
         2.88330105e-07,  2.47040594e-08,  2.24450134e-08],
       [-6.00971375e-05,  1.54744950e-03, -1.72518903e-04,
         2.09884680e-07,  1.12027809e-06,  7.70919275e-10],
       [ 1.97087950e-05, -1.72518903e-04,  1.96931078e-04,
         5.61785258e-08, -6.50500481e-08,  6.84328217e-08],
       [ 2.88330105e-07,  2.09884680e-07,  5.61785258e-08,
         2.15012418e-09,  4.12645014e-10,  6.45163904e-10],
       [ 2.47040594e-08,  1.12027809e-06, -6.50500481e-08,
         4.12645014e-10,  2.33705640e-09,  3.32079956e-10],
       [ 2.24450134e-08,  7.70919275e-10,  6.84328217e-08,
         6.45163904e-10,  3.32079956e-10,  2.88030070e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-8.29546541e-06],
       [ 1.43652090e-05],
       [-2.46874359e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.59378926e+03],
       [ 3.18833354e+03],
       [-4.42704565e+03],
       [-4.13242366e+00],
       [-2.12708663e+00],
       [-5.84417235e+00],
       [ 7.33566278e-01],
       [ 2.34907053e-01],
       [-6.18718962e-01],
       [ 1.54551085e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65610025e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.73924577e-03, -5.56133013e-03,  1.95484172e-03,
         1.54634337e-05,  5.42121908e-07,  1.52684962e-05],
       [-5.56133013e-03,  2.71700003e-02, -8.76994487e-03,
        -4.36893206e-05,  6.52483309e-06, -6.62588729e-05],
       [ 1.95484172e-03, -8.76994487e-03,  3.55265651e-03,
         1.59431966e-05,  5.41861143e-07,  2.92212764e-05],
       [ 1.54634337e-05, -4.36893206e-05,  1.59431966e-05,
         1.97843069e-07,  7.74337879e-09,  1.27694365e-07],
       [ 5.42121908e-07,  6.52483309e-06,  5.41861143e-07,
         7.74337879e-09,  1.48229411e-07,  7.37568350e-09],
       [ 1.52684962e-05, -6.62588729e-05,  2.92212764e-05,
         1.27694365e-07,  7.37568350e-09,  3.06405365e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-9.38531288e-06],
       [ 2.09957308e-06],
       [-2.80914623e-02]])}}
Yi [[ 1.80358979]
 [-0.36715568]
 [13.29551269]]
posterior
[[ 4.59378926e+03]
 [ 3.18833354e+03]
 [-4.42704565e+03]
 [-4.13242366e+00]
 [-2.12708663e+00]
 [-5.84417235e+00]
 [ 7.33566278e-01]
 [ 2.34907053e-01]
 [-6.18718962e-01]
 [ 1.54551085e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65610025e-18]]
[[ 4.59379796e+03]
 [ 3.18832238e+03]
 [-4.42704838e+03]
 [-4.13233736e+00]
 [-2.12709470e+00]
 [-5.84421429e+00]
 [ 7.33566278e-01]
 [ 2.34907053e-01]
 [-6.18718962e-01]
 [ 1.54551085e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65610025e-18]]
[[ 1.65617369e-03 -5.53677702e-03  1.98060078e-03  1.45856549e-05
   4.76301943e-07  1.55783300e-05]
 [-5.53677702e-03  2.60184825e-02 -8.78417992e-03 -4.41811545e-05
   4.54552166e-06 -6.76327490e-05]
 [ 1.98060078e-03 -8.78417992e-03  3.54461611e-03  1.62110293e-05
   5.50657753e-07  2.91176229e-05]
 [ 1.45856549e-05 -4.41811545e-05  1.62110293e-05  1.88074790e-07
   5.73558092e-09  1.30126285e-07]
 [ 4.76301943e-07  4.54552166e-06  5.50657753e-07  5.73558092e-09
   1.44685721e-07  5.38077789e-09]
 [ 1.55783300e-05 -6.76327490e-05  2.91176229e-05  1.30126285e-07
   5.38077789e-09  3.03811053e-07]]
[[ 1.80360791]
 [-0.36713662]
 [13.30633092]]
[[-1.81233990e-05]
 [-1.90638216e-05]
 [-1.08182283e-02]]


 Corrector Step
2018-07-13 19:34:40
[[ 4.59379796e+03]
 [ 3.18832238e+03]
 [-4.42704838e+03]
 [-4.13233736e+00]
 [-2.12709470e+00]
 [-5.84421429e+00]
 [ 7.33566278e-01]
 [ 2.34907053e-01]
 [-6.18718962e-01]
 [ 1.54551085e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65610025e-18]]
[[ 1.65617369e-03 -5.53677702e-03  1.98060078e-03  1.45856549e-05
   4.76301943e-07  1.55783300e-05]
 [-5.53677702e-03  2.60184825e-02 -8.78417992e-03 -4.41811545e-05
   4.54552166e-06 -6.76327490e-05]
 [ 1.98060078e-03 -8.78417992e-03  3.54461611e-03  1.62110293e-05
   5.50657753e-07  2.91176229e-05]
 [ 1.45856549e-05 -4.41811545e-05  1.62110293e-05  1.88074790e-07
   5.73558092e-09  1.30126285e-07]
 [ 4.76301943e-07  4.54552166e-06  5.50657753e-07  5.73558092e-09
   1.44685721e-07  5.38077789e-09]
 [ 1.55783300e-05 -6.76327490e-05  2.91176229e-05  1.30126285e-07
   5.38077789e-09  3.03811053e-07]]
519757551.04282415
post
cubesat_nadir
Ybar_post [[ 1.80360495]
 [-0.36714004]
 [13.3063199 ]]
resids [[-1.51602290e-05]
 [-1.56426728e-05]
 [-1.08072123e-02]]
posterior
[[ 4.59382788e+03]
 [ 3.18817807e+03]
 [-4.42701582e+03]
 [-4.13210907e+00]
 [-2.12713646e+00]
 [-5.84408856e+00]]
[[ 4.59383052e+03]
 [ 3.18818012e+03]
 [-4.42701658e+03]
 [-4.13210502e+00]
 [-2.12713427e+00]
 [-5.84408852e+00]]
[[ 1.89280606e-04 -7.87428118e-05  2.22803096e-05  2.65002536e-07
   6.75545100e-09  2.13631668e-08]
 [-7.87428118e-05  1.46199132e-03 -1.86296744e-04  1.58367836e-07
   1.04408569e-06 -1.00292969e-08]
 [ 2.22803096e-05 -1.86296744e-04  1.91472929e-04  5.48872903e-08
  -7.65653707e-08  6.59518872e-08]
 [ 2.65002536e-07  1.58367836e-07  5.48872903e-08  2.10386699e-09
   3.65048047e-10  6.40256139e-10]
 [ 6.75545100e-09  1.04408569e-06 -7.65653707e-08  3.65048047e-10
   2.26894259e-09  3.22626401e-10]
 [ 2.13631668e-08 -1.00292969e-08  6.59518872e-08  6.40256139e-10
   3.22626401e-10  2.87876673e-09]]
[[ 1.80360705]
 [-0.36715074]
 [15.68006706]]
[[-1.72591317e-05]
 [-4.94497134e-06]
 [-2.38455437e+00]]


 Corrector Step
2018-07-13 19:34:40
[[ 4.59383052e+03]
 [ 3.18818012e+03]
 [-4.42701658e+03]
 [-4.13210502e+00]
 [-2.12713427e+00]
 [-5.84408852e+00]]
[[ 1.89280606e-04 -7.87428118e-05  2.22803096e-05  2.65002536e-07
   6.75545100e-09  2.13631668e-08]
 [-7.87428118e-05  1.46199132e-03 -1.86296744e-04  1.58367836e-07
   1.04408569e-06 -1.00292969e-08]
 [ 2.22803096e-05 -1.86296744e-04  1.91472929e-04  5.48872903e-08
  -7.65653707e-08  6.59518872e-08]
 [ 2.65002536e-07  1.58367836e-07  5.48872903e-08  2.10386699e-09
   3.65048047e-10  6.40256139e-10]
 [ 6.75545100e-09  1.04408569e-06 -7.65653707e-08  3.65048047e-10
   2.26894259e-09  3.22626401e-10]
 [ 2.13631668e-08 -1.00292969e-08  6.59518872e-08  6.40256139e-10
   3.22626401e-10  2.87876673e-09]]
2.5708229999832785e-115
post
sphere_lamr_small
Ybar_post [[ 1.80360553]
 [-0.36715085]
 [15.68006749]]
resids [[-1.57415569e-05]
 [-4.83105076e-06]
 [-2.38455480e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [519757551.04282415, 2.5708229999832785e-115]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.59379796e+03],
       [ 3.18832238e+03],
       [-4.42704838e+03],
       [-4.13233736e+00],
       [-2.12709470e+00],
       [-5.84421429e+00]]), 'est_covars': array([[ 1.65617369e-03, -5.53677702e-03,  1.98060078e-03,
         1.45856549e-05,  4.76301943e-07,  1.55783300e-05],
       [-5.53677702e-03,  2.60184825e-02, -8.78417992e-03,
        -4.41811545e-05,  4.54552166e-06, -6.76327490e-05],
       [ 1.98060078e-03, -8.78417992e-03,  3.54461611e-03,
         1.62110293e-05,  5.50657753e-07,  2.91176229e-05],
       [ 1.45856549e-05, -4.41811545e-05,  1.62110293e-05,
         1.88074790e-07,  5.73558092e-09,  1.30126285e-07],
       [ 4.76301943e-07,  4.54552166e-06,  5.50657753e-07,
         5.73558092e-09,  1.44685721e-07,  5.38077789e-09],
       [ 1.55783300e-05, -6.76327490e-05,  2.91176229e-05,
         1.30126285e-07,  5.38077789e-09,  3.03811053e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.59383052e+03],
       [ 3.18818012e+03],
       [-4.42701658e+03],
       [-4.13210502e+00],
       [-2.12713427e+00],
       [-5.84408852e+00]]), 'covar': array([[ 1.89280606e-04, -7.87428118e-05,  2.22803096e-05,
         2.65002536e-07,  6.75545100e-09,  2.13631668e-08],
       [-7.87428118e-05,  1.46199132e-03, -1.86296744e-04,
         1.58367836e-07,  1.04408569e-06, -1.00292969e-08],
       [ 2.22803096e-05, -1.86296744e-04,  1.91472929e-04,
         5.48872903e-08, -7.65653707e-08,  6.59518872e-08],
       [ 2.65002536e-07,  1.58367836e-07,  5.48872903e-08,
         2.10386699e-09,  3.65048047e-10,  6.40256139e-10],
       [ 6.75545100e-09,  1.04408569e-06, -7.65653707e-08,
         3.65048047e-10,  2.26894259e-09,  3.22626401e-10],
       [ 2.13631668e-08, -1.00292969e-08,  6.59518872e-08,
         6.40256139e-10,  3.22626401e-10,  2.87876673e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.57415569e-05],
       [-4.83105076e-06],
       [-2.38455480e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.59379796e+03],
       [ 3.18832238e+03],
       [-4.42704838e+03],
       [-4.13233736e+00],
       [-2.12709470e+00],
       [-5.84421429e+00],
       [ 7.33566278e-01],
       [ 2.34907053e-01],
       [-6.18718962e-01],
       [ 1.54551085e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65610025e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.65617369e-03, -5.53677702e-03,  1.98060078e-03,
         1.45856549e-05,  4.76301943e-07,  1.55783300e-05],
       [-5.53677702e-03,  2.60184825e-02, -8.78417992e-03,
        -4.41811545e-05,  4.54552166e-06, -6.76327490e-05],
       [ 1.98060078e-03, -8.78417992e-03,  3.54461611e-03,
         1.62110293e-05,  5.50657753e-07,  2.91176229e-05],
       [ 1.45856549e-05, -4.41811545e-05,  1.62110293e-05,
         1.88074790e-07,  5.73558092e-09,  1.30126285e-07],
       [ 4.76301943e-07,  4.54552166e-06,  5.50657753e-07,
         5.73558092e-09,  1.44685721e-07,  5.38077789e-09],
       [ 1.55783300e-05, -6.76327490e-05,  2.91176229e-05,
         1.30126285e-07,  5.38077789e-09,  3.03811053e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.51602290e-05],
       [-1.56426728e-05],
       [-1.08072123e-02]])}}
Current time:  2018-07-13 19:34:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.59379796e+03],
       [ 3.18832238e+03],
       [-4.42704838e+03],
       [-4.13233736e+00],
       [-2.12709470e+00],
       [-5.84421429e+00],
       [ 7.33566278e-01],
       [ 2.34907053e-01],
       [-6.18718962e-01],
       [ 1.54551085e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65610025e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.65617369e-03, -5.53677702e-03,  1.98060078e-03,
         1.45856549e-05,  4.76301943e-07,  1.55783300e-05],
       [-5.53677702e-03,  2.60184825e-02, -8.78417992e-03,
        -4.41811545e-05,  4.54552166e-06, -6.76327490e-05],
       [ 1.98060078e-03, -8.78417992e-03,  3.54461611e-03,
         1.62110293e-05,  5.50657753e-07,  2.91176229e-05],
       [ 1.45856549e-05, -4.41811545e-05,  1.62110293e-05,
         1.88074790e-07,  5.73558092e-09,  1.30126285e-07],
       [ 4.76301943e-07,  4.54552166e-06,  5.50657753e-07,
         5.73558092e-09,  1.44685721e-07,  5.38077789e-09],
       [ 1.55783300e-05, -6.76327490e-05,  2.91176229e-05,
         1.30126285e-07,  5.38077789e-09,  3.03811053e-07]])}
[[ 4.59379796e+03]
 [ 3.18832238e+03]
 [-4.42704838e+03]
 [-4.13233736e+00]
 [-2.12709470e+00]
 [-5.84421429e+00]
 [ 7.33566278e-01]
 [ 2.34907053e-01]
 [-6.18718962e-01]
 [ 1.54551085e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65610025e-18]]
2018-07-13 19:34:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:50
[[ 4.55222338e+03]
 [ 3.16687687e+03]
 [-4.48524569e+03]
 [-4.18251791e+00]
 [-2.16196328e+00]
 [-5.79518868e+00]
 [ 7.30325754e-01]
 [ 2.34096892e-01]
 [-6.22540707e-01]
 [ 1.55775501e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65631254e-18]]
[[ 1.96615524e-03 -5.97139077e-03  2.31106077e-03  1.64327706e-05
   5.57704790e-07  1.69088972e-05]
 [-5.97139077e-03  2.61232472e-02 -9.45525490e-03 -4.37721898e-05
   5.95576408e-06 -6.77592247e-05]
 [ 2.31106077e-03 -9.45525490e-03  4.15845379e-03  1.73777171e-05
   6.30500754e-07  3.22732707e-05]
 [ 1.64327706e-05 -4.37721898e-05  1.73777171e-05  1.96884221e-07
   5.96504289e-09  1.29358664e-07]
 [ 5.57704790e-07  5.95576408e-06  6.30500754e-07  5.96504289e-09
   1.54637988e-07  5.49949763e-09]
 [ 1.69088972e-05 -6.77592247e-05  3.22732707e-05  1.29358664e-07
   5.49949763e-09  3.14743235e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.59383052e+03],
       [ 3.18818012e+03],
       [-4.42701658e+03],
       [-4.13210502e+00],
       [-2.12713427e+00],
       [-5.84408852e+00]]), 'covar': array([[ 1.89280606e-04, -7.87428118e-05,  2.22803096e-05,
         2.65002536e-07,  6.75545100e-09,  2.13631668e-08],
       [-7.87428118e-05,  1.46199132e-03, -1.86296744e-04,
         1.58367836e-07,  1.04408569e-06, -1.00292969e-08],
       [ 2.22803096e-05, -1.86296744e-04,  1.91472929e-04,
         5.48872903e-08, -7.65653707e-08,  6.59518872e-08],
       [ 2.65002536e-07,  1.58367836e-07,  5.48872903e-08,
         2.10386699e-09,  3.65048047e-10,  6.40256139e-10],
       [ 6.75545100e-09,  1.04408569e-06, -7.65653707e-08,
         3.65048047e-10,  2.26894259e-09,  3.22626401e-10],
       [ 2.13631668e-08, -1.00292969e-08,  6.59518872e-08,
         6.40256139e-10,  3.22626401e-10,  2.87876673e-09]])}
[[ 4.59383052e+03]
 [ 3.18818012e+03]
 [-4.42701658e+03]
 [-4.13210502e+00]
 [-2.12713427e+00]
 [-5.84408852e+00]]
2018-07-13 19:34:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:34:50
[[ 4.55225831e+03]
 [ 3.16673422e+03]
 [-4.48521272e+03]
 [-4.18228756e+00]
 [-2.16200204e+00]
 [-5.79506183e+00]]
[[ 1.94841842e-04 -7.69758000e-05  2.31498325e-05  2.85967180e-07
   1.24657658e-08  2.60783623e-08]
 [-7.69758000e-05  1.48304909e-03 -1.87212358e-04  1.78171629e-07
   1.06164700e-06 -1.97275064e-08]
 [ 2.31498325e-05 -1.87212358e-04  1.93191949e-04  5.69649554e-08
  -7.40325083e-08  9.71776946e-08]
 [ 2.85967180e-07  1.78171629e-07  5.69649554e-08  2.20697060e-09
   3.77211416e-10  6.33930183e-10]
 [ 1.24657658e-08  1.06164700e-06 -7.40325083e-08  3.77211416e-10
   2.36118851e-09  3.12363186e-10]
 [ 2.60783623e-08 -1.97275064e-08  9.71776946e-08  6.33930183e-10
   3.12363186e-10  2.97898321e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.55225831e+03],
       [ 3.16673422e+03],
       [-4.48521272e+03],
       [-4.18228756e+00],
       [-2.16200204e+00],
       [-5.79506183e+00]]), 'covar': array([[ 1.94841842e-04, -7.69758000e-05,  2.31498325e-05,
         2.85967180e-07,  1.24657658e-08,  2.60783623e-08],
       [-7.69758000e-05,  1.48304909e-03, -1.87212358e-04,
         1.78171629e-07,  1.06164700e-06, -1.97275064e-08],
       [ 2.31498325e-05, -1.87212358e-04,  1.93191949e-04,
         5.69649554e-08, -7.40325083e-08,  9.71776946e-08],
       [ 2.85967180e-07,  1.78171629e-07,  5.69649554e-08,
         2.20697060e-09,  3.77211416e-10,  6.33930183e-10],
       [ 1.24657658e-08,  1.06164700e-06, -7.40325083e-08,
         3.77211416e-10,  2.36118851e-09,  3.12363186e-10],
       [ 2.60783623e-08, -1.97275064e-08,  9.71776946e-08,
         6.33930183e-10,  3.12363186e-10,  2.97898321e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.57415569e-05],
       [-4.83105076e-06],
       [-2.38455480e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.55222338e+03],
       [ 3.16687687e+03],
       [-4.48524569e+03],
       [-4.18251791e+00],
       [-2.16196328e+00],
       [-5.79518868e+00],
       [ 7.30325754e-01],
       [ 2.34096892e-01],
       [-6.22540707e-01],
       [ 1.55775501e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65631254e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.96615524e-03, -5.97139077e-03,  2.31106077e-03,
         1.64327706e-05,  5.57704790e-07,  1.69088972e-05],
       [-5.97139077e-03,  2.61232472e-02, -9.45525490e-03,
        -4.37721898e-05,  5.95576408e-06, -6.77592247e-05],
       [ 2.31106077e-03, -9.45525490e-03,  4.15845379e-03,
         1.73777171e-05,  6.30500754e-07,  3.22732707e-05],
       [ 1.64327706e-05, -4.37721898e-05,  1.73777171e-05,
         1.96884221e-07,  5.96504289e-09,  1.29358664e-07],
       [ 5.57704790e-07,  5.95576408e-06,  6.30500754e-07,
         5.96504289e-09,  1.54637988e-07,  5.49949763e-09],
       [ 1.69088972e-05, -6.77592247e-05,  3.22732707e-05,
         1.29358664e-07,  5.49949763e-09,  3.14743235e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.51602290e-05],
       [-1.56426728e-05],
       [-1.08072123e-02]])}}
Yi [[ 1.82689787]
 [-0.39540432]
 [13.35490255]]
posterior
[[ 4.55222338e+03]
 [ 3.16687687e+03]
 [-4.48524569e+03]
 [-4.18251791e+00]
 [-2.16196328e+00]
 [-5.79518868e+00]
 [ 7.30325754e-01]
 [ 2.34096892e-01]
 [-6.22540707e-01]
 [ 1.55775501e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65631254e-18]]
[[ 4.55223080e+03]
 [ 3.16687880e+03]
 [-4.48524863e+03]
 [-4.18243673e+00]
 [-2.16195163e+00]
 [-5.79521957e+00]
 [ 7.30325754e-01]
 [ 2.34096892e-01]
 [-6.22540707e-01]
 [ 1.55775501e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65631254e-18]]
[[ 1.88472347e-03 -5.94611483e-03  2.34193439e-03  1.55760407e-05
   5.16383752e-07  1.72874413e-05]
 [-5.94611483e-03  2.51428428e-02 -9.45267003e-03 -4.42263652e-05
   4.09759426e-06 -6.88891816e-05]
 [ 2.34193439e-03 -9.45267003e-03  4.14657893e-03  1.77115441e-05
   6.69518036e-07  3.21422348e-05]
 [ 1.55760407e-05 -4.42263652e-05  1.77115441e-05  1.87337537e-07
   4.14499921e-09  1.32591639e-07]
 [ 5.16383752e-07  4.09759426e-06  6.69518036e-07  4.14499921e-09
   1.51017435e-07  3.74322111e-09]
 [ 1.72874413e-05 -6.88891816e-05  3.21422348e-05  1.32591639e-07
   3.74322111e-09  3.11927593e-07]]
[[ 1.82691827]
 [-0.39539497]
 [13.29661059]]
[[-2.04032387e-05]
 [-9.35413982e-06]
 [ 5.82919586e-02]]


 Corrector Step
2018-07-13 19:34:50
[[ 4.55223080e+03]
 [ 3.16687880e+03]
 [-4.48524863e+03]
 [-4.18243673e+00]
 [-2.16195163e+00]
 [-5.79521957e+00]
 [ 7.30325754e-01]
 [ 2.34096892e-01]
 [-6.22540707e-01]
 [ 1.55775501e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65631254e-18]]
[[ 1.88472347e-03 -5.94611483e-03  2.34193439e-03  1.55760407e-05
   5.16383752e-07  1.72874413e-05]
 [-5.94611483e-03  2.51428428e-02 -9.45267003e-03 -4.42263652e-05
   4.09759426e-06 -6.88891816e-05]
 [ 2.34193439e-03 -9.45267003e-03  4.14657893e-03  1.77115441e-05
   6.69518036e-07  3.21422348e-05]
 [ 1.55760407e-05 -4.42263652e-05  1.77115441e-05  1.87337537e-07
   4.14499921e-09  1.32591639e-07]
 [ 5.16383752e-07  4.09759426e-06  6.69518036e-07  4.14499921e-09
   1.51017435e-07  3.74322111e-09]
 [ 1.72874413e-05 -6.88891816e-05  3.21422348e-05  1.32591639e-07
   3.74322111e-09  3.11927593e-07]]
507443562.4423326
post
cubesat_nadir
Ybar_post [[ 1.82691432]
 [-0.39539627]
 [13.29661258]]
resids [[-1.64536449e-05]
 [-8.05000560e-06]
 [ 5.82899762e-02]]
posterior
[[ 4.55225831e+03]
 [ 3.16673422e+03]
 [-4.48521272e+03]
 [-4.18228756e+00]
 [-2.16200204e+00]
 [-5.79506183e+00]]
[[ 4.55226119e+03]
 [ 3.16673961e+03]
 [-4.48521294e+03]
 [-4.18228194e+00]
 [-2.16199698e+00]
 [-5.79506135e+00]]
[[ 1.82900991e-04 -9.34938987e-05  2.60425059e-05  2.64780044e-07
  -3.33043846e-09  2.55593964e-08]
 [-9.34938987e-05  1.39598302e-03 -1.98346884e-04  1.27985543e-07
   9.85110190e-07 -3.27084564e-08]
 [ 2.60425059e-05 -1.98346884e-04  1.88923519e-04  5.71766392e-08
  -8.30955140e-08  9.44129319e-08]
 [ 2.64780044e-07  1.27985543e-07  5.71766392e-08  2.16258995e-09
   3.31404722e-10  6.29022503e-10]
 [-3.33043846e-09  9.85110190e-07 -8.30955140e-08  3.31404722e-10
   2.29372280e-09  3.01233622e-10]
 [ 2.55593964e-08 -3.27084564e-08  9.44129319e-08  6.29022503e-10
   3.01233622e-10  2.97661883e-09]]
[[ 1.82691947]
 [-0.39540737]
 [15.59481788]]
[[-2.15953316e-05]
 [ 3.05107687e-06]
 [-2.23991532e+00]]


 Corrector Step
2018-07-13 19:34:50
[[ 4.55226119e+03]
 [ 3.16673961e+03]
 [-4.48521294e+03]
 [-4.18228194e+00]
 [-2.16199698e+00]
 [-5.79506135e+00]]
[[ 1.82900991e-04 -9.34938987e-05  2.60425059e-05  2.64780044e-07
  -3.33043846e-09  2.55593964e-08]
 [-9.34938987e-05  1.39598302e-03 -1.98346884e-04  1.27985543e-07
   9.85110190e-07 -3.27084564e-08]
 [ 2.60425059e-05 -1.98346884e-04  1.88923519e-04  5.71766392e-08
  -8.30955140e-08  9.44129319e-08]
 [ 2.64780044e-07  1.27985543e-07  5.71766392e-08  2.16258995e-09
   3.31404722e-10  6.29022503e-10]
 [-3.33043846e-09  9.85110190e-07 -8.30955140e-08  3.31404722e-10
   2.29372280e-09  3.01233622e-10]
 [ 2.55593964e-08 -3.27084564e-08  9.44129319e-08  6.29022503e-10
   3.01233622e-10  2.97661883e-09]]
7.69685761420297e-101
post
sphere_lamr_small
Ybar_post [[ 1.82691734]
 [-0.39540666]
 [15.59482438]]
resids [[-1.94671178e-05]
 [ 2.33574886e-06]
 [-2.23992183e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [507443562.4423326, 7.69685761420297e-101]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.55223080e+03],
       [ 3.16687880e+03],
       [-4.48524863e+03],
       [-4.18243673e+00],
       [-2.16195163e+00],
       [-5.79521957e+00]]), 'est_covars': array([[ 1.88472347e-03, -5.94611483e-03,  2.34193439e-03,
         1.55760407e-05,  5.16383752e-07,  1.72874413e-05],
       [-5.94611483e-03,  2.51428428e-02, -9.45267003e-03,
        -4.42263652e-05,  4.09759426e-06, -6.88891816e-05],
       [ 2.34193439e-03, -9.45267003e-03,  4.14657893e-03,
         1.77115441e-05,  6.69518036e-07,  3.21422348e-05],
       [ 1.55760407e-05, -4.42263652e-05,  1.77115441e-05,
         1.87337537e-07,  4.14499921e-09,  1.32591639e-07],
       [ 5.16383752e-07,  4.09759426e-06,  6.69518036e-07,
         4.14499921e-09,  1.51017435e-07,  3.74322111e-09],
       [ 1.72874413e-05, -6.88891816e-05,  3.21422348e-05,
         1.32591639e-07,  3.74322111e-09,  3.11927593e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.55226119e+03],
       [ 3.16673961e+03],
       [-4.48521294e+03],
       [-4.18228194e+00],
       [-2.16199698e+00],
       [-5.79506135e+00]]), 'covar': array([[ 1.82900991e-04, -9.34938987e-05,  2.60425059e-05,
         2.64780044e-07, -3.33043846e-09,  2.55593964e-08],
       [-9.34938987e-05,  1.39598302e-03, -1.98346884e-04,
         1.27985543e-07,  9.85110190e-07, -3.27084564e-08],
       [ 2.60425059e-05, -1.98346884e-04,  1.88923519e-04,
         5.71766392e-08, -8.30955140e-08,  9.44129319e-08],
       [ 2.64780044e-07,  1.27985543e-07,  5.71766392e-08,
         2.16258995e-09,  3.31404722e-10,  6.29022503e-10],
       [-3.33043846e-09,  9.85110190e-07, -8.30955140e-08,
         3.31404722e-10,  2.29372280e-09,  3.01233622e-10],
       [ 2.55593964e-08, -3.27084564e-08,  9.44129319e-08,
         6.29022503e-10,  3.01233622e-10,  2.97661883e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.94671178e-05],
       [ 2.33574886e-06],
       [-2.23992183e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.55223080e+03],
       [ 3.16687880e+03],
       [-4.48524863e+03],
       [-4.18243673e+00],
       [-2.16195163e+00],
       [-5.79521957e+00],
       [ 7.30325754e-01],
       [ 2.34096892e-01],
       [-6.22540707e-01],
       [ 1.55775501e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65631254e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.88472347e-03, -5.94611483e-03,  2.34193439e-03,
         1.55760407e-05,  5.16383752e-07,  1.72874413e-05],
       [-5.94611483e-03,  2.51428428e-02, -9.45267003e-03,
        -4.42263652e-05,  4.09759426e-06, -6.88891816e-05],
       [ 2.34193439e-03, -9.45267003e-03,  4.14657893e-03,
         1.77115441e-05,  6.69518036e-07,  3.21422348e-05],
       [ 1.55760407e-05, -4.42263652e-05,  1.77115441e-05,
         1.87337537e-07,  4.14499921e-09,  1.32591639e-07],
       [ 5.16383752e-07,  4.09759426e-06,  6.69518036e-07,
         4.14499921e-09,  1.51017435e-07,  3.74322111e-09],
       [ 1.72874413e-05, -6.88891816e-05,  3.21422348e-05,
         1.32591639e-07,  3.74322111e-09,  3.11927593e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.64536449e-05],
       [-8.05000560e-06],
       [ 5.82899762e-02]])}}
Current time:  2018-07-13 19:35:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.55223080e+03],
       [ 3.16687880e+03],
       [-4.48524863e+03],
       [-4.18243673e+00],
       [-2.16195163e+00],
       [-5.79521957e+00],
       [ 7.30325754e-01],
       [ 2.34096892e-01],
       [-6.22540707e-01],
       [ 1.55775501e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65631254e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 1.88472347e-03, -5.94611483e-03,  2.34193439e-03,
         1.55760407e-05,  5.16383752e-07,  1.72874413e-05],
       [-5.94611483e-03,  2.51428428e-02, -9.45267003e-03,
        -4.42263652e-05,  4.09759426e-06, -6.88891816e-05],
       [ 2.34193439e-03, -9.45267003e-03,  4.14657893e-03,
         1.77115441e-05,  6.69518036e-07,  3.21422348e-05],
       [ 1.55760407e-05, -4.42263652e-05,  1.77115441e-05,
         1.87337537e-07,  4.14499921e-09,  1.32591639e-07],
       [ 5.16383752e-07,  4.09759426e-06,  6.69518036e-07,
         4.14499921e-09,  1.51017435e-07,  3.74322111e-09],
       [ 1.72874413e-05, -6.88891816e-05,  3.21422348e-05,
         1.32591639e-07,  3.74322111e-09,  3.11927593e-07]])}
[[ 4.55223080e+03]
 [ 3.16687880e+03]
 [-4.48524863e+03]
 [-4.18243673e+00]
 [-2.16195163e+00]
 [-5.79521957e+00]
 [ 7.30325754e-01]
 [ 2.34096892e-01]
 [-6.22540707e-01]
 [ 1.55775501e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65631254e-18]]
2018-07-13 19:34:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:00
[[ 4.51015741e+03]
 [ 3.14508579e+03]
 [-4.54295314e+03]
 [-4.23215211e+00]
 [-2.19657831e+00]
 [-5.74556295e+00]
 [ 7.27065318e-01]
 [ 2.33280348e-01]
 [-6.26345481e-01]
 [ 1.56995671e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65652482e-18]]
[[ 2.21435865e-03 -6.38090552e-03  2.70463741e-03  1.74076759e-05
   5.82512715e-07  1.86448345e-05]
 [-6.38090552e-03  2.52394226e-02 -1.01351941e-02 -4.38355272e-05
   5.57661767e-06 -6.90242421e-05]
 [ 2.70463741e-03 -1.01351941e-02  4.82156866e-03  1.88894293e-05
   7.33962163e-07  3.53834239e-05]
 [ 1.74076759e-05 -4.38355272e-05  1.88894293e-05  1.96114484e-07
   4.36434988e-09  1.31778598e-07]
 [ 5.82512715e-07  5.57661767e-06  7.33962163e-07  4.36434988e-09
   1.60970872e-07  3.86068444e-09]
 [ 1.86448345e-05 -6.90242421e-05  3.53834239e-05  1.31778598e-07
   3.86068444e-09  3.22877696e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.55226119e+03],
       [ 3.16673961e+03],
       [-4.48521294e+03],
       [-4.18228194e+00],
       [-2.16199698e+00],
       [-5.79506135e+00]]), 'covar': array([[ 1.82900991e-04, -9.34938987e-05,  2.60425059e-05,
         2.64780044e-07, -3.33043846e-09,  2.55593964e-08],
       [-9.34938987e-05,  1.39598302e-03, -1.98346884e-04,
         1.27985543e-07,  9.85110190e-07, -3.27084564e-08],
       [ 2.60425059e-05, -1.98346884e-04,  1.88923519e-04,
         5.71766392e-08, -8.30955140e-08,  9.44129319e-08],
       [ 2.64780044e-07,  1.27985543e-07,  5.71766392e-08,
         2.16258995e-09,  3.31404722e-10,  6.29022503e-10],
       [-3.33043846e-09,  9.85110190e-07, -8.30955140e-08,
         3.31404722e-10,  2.29372280e-09,  3.01233622e-10],
       [ 2.55593964e-08, -3.27084564e-08,  9.44129319e-08,
         6.29022503e-10,  3.01233622e-10,  2.97661883e-09]])}
[[ 4.55226119e+03]
 [ 3.16673961e+03]
 [-4.48521294e+03]
 [-4.18228194e+00]
 [-2.16199698e+00]
 [-5.79506135e+00]]
2018-07-13 19:34:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:00
[[ 4.51018942e+03]
 [ 3.14494613e+03]
 [-4.54291584e+03]
 [-4.23199896e+00]
 [-2.19662301e+00]
 [-5.74540360e+00]]
[[ 1.88404012e-04 -9.21216048e-05  2.69081305e-05  2.86134631e-07
   1.92877852e-09  3.02689059e-08]
 [-9.21216048e-05  1.41595619e-03 -1.99526989e-04  1.46760232e-07
   1.00300866e-06 -4.20877179e-08]
 [ 2.69081305e-05 -1.99526989e-04  1.91128730e-04  5.91388690e-08
  -8.07525518e-08  1.26575836e-07]
 [ 2.86134631e-07  1.46760232e-07  5.91388690e-08  2.26483521e-09
   3.43036100e-10  6.22489753e-10]
 [ 1.92877852e-09  1.00300866e-06 -8.07525518e-08  3.43036100e-10
   2.38627969e-09  2.91426202e-10]
 [ 3.02689059e-08 -4.20877179e-08  1.26575836e-07  6.22489753e-10
   2.91426202e-10  3.07727540e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 34, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.51018942e+03],
       [ 3.14494613e+03],
       [-4.54291584e+03],
       [-4.23199896e+00],
       [-2.19662301e+00],
       [-5.74540360e+00]]), 'covar': array([[ 1.88404012e-04, -9.21216048e-05,  2.69081305e-05,
         2.86134631e-07,  1.92877852e-09,  3.02689059e-08],
       [-9.21216048e-05,  1.41595619e-03, -1.99526989e-04,
         1.46760232e-07,  1.00300866e-06, -4.20877179e-08],
       [ 2.69081305e-05, -1.99526989e-04,  1.91128730e-04,
         5.91388690e-08, -8.07525518e-08,  1.26575836e-07],
       [ 2.86134631e-07,  1.46760232e-07,  5.91388690e-08,
         2.26483521e-09,  3.43036100e-10,  6.22489753e-10],
       [ 1.92877852e-09,  1.00300866e-06, -8.07525518e-08,
         3.43036100e-10,  2.38627969e-09,  2.91426202e-10],
       [ 3.02689059e-08, -4.20877179e-08,  1.26575836e-07,
         6.22489753e-10,  2.91426202e-10,  3.07727540e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.94671178e-05],
       [ 2.33574886e-06],
       [-2.23992183e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 34, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.51015741e+03],
       [ 3.14508579e+03],
       [-4.54295314e+03],
       [-4.23215211e+00],
       [-2.19657831e+00],
       [-5.74556295e+00],
       [ 7.27065318e-01],
       [ 2.33280348e-01],
       [-6.26345481e-01],
       [ 1.56995671e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65652482e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.21435865e-03, -6.38090552e-03,  2.70463741e-03,
         1.74076759e-05,  5.82512715e-07,  1.86448345e-05],
       [-6.38090552e-03,  2.52394226e-02, -1.01351941e-02,
        -4.38355272e-05,  5.57661767e-06, -6.90242421e-05],
       [ 2.70463741e-03, -1.01351941e-02,  4.82156866e-03,
         1.88894293e-05,  7.33962163e-07,  3.53834239e-05],
       [ 1.74076759e-05, -4.38355272e-05,  1.88894293e-05,
         1.96114484e-07,  4.36434988e-09,  1.31778598e-07],
       [ 5.82512715e-07,  5.57661767e-06,  7.33962163e-07,
         4.36434988e-09,  1.60970872e-07,  3.86068444e-09],
       [ 1.86448345e-05, -6.90242421e-05,  3.53834239e-05,
         1.31778598e-07,  3.86068444e-09,  3.22877696e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.64536449e-05],
       [-8.05000560e-06],
       [ 5.82899762e-02]])}}
Yi [[ 1.85086663]
 [-0.42303616]
 [13.22049972]]
posterior
[[ 4.51015741e+03]
 [ 3.14508579e+03]
 [-4.54295314e+03]
 [-4.23215211e+00]
 [-2.19657831e+00]
 [-5.74556295e+00]
 [ 7.27065318e-01]
 [ 2.33280348e-01]
 [-6.26345481e-01]
 [ 1.56995671e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65652482e-18]]
[[ 4.51015778e+03]
 [ 3.14507688e+03]
 [-4.54295288e+03]
 [-4.23215564e+00]
 [-2.19659655e+00]
 [-5.74557188e+00]
 [ 7.27065318e-01]
 [ 2.33280348e-01]
 [-6.26345481e-01]
 [ 1.56995671e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65652482e-18]]
[[ 2.13632340e-03 -6.35740139e-03  2.74061438e-03  1.65899780e-05
   5.66486907e-07  1.90798281e-05]
 [-6.35740139e-03  2.43853846e-02 -1.01155360e-02 -4.42952744e-05
   3.78247833e-06 -6.99270757e-05]
 [ 2.74061438e-03 -1.01155360e-02  4.80386360e-03  1.92918430e-05
   8.06050030e-07  3.52104547e-05]
 [ 1.65899780e-05 -4.42952744e-05  1.92918430e-05  1.86957616e-07
   2.69679905e-09  1.35693376e-07]
 [ 5.66486907e-07  3.78247833e-06  8.06050030e-07  2.69679905e-09
   1.57146272e-07  2.30992607e-09]
 [ 1.90798281e-05 -6.99270757e-05  3.52104547e-05  1.35693376e-07
   2.30992607e-09  3.19747398e-07]]
[[ 1.85086235]
 [-0.42302912]
 [13.2975812 ]]
[[ 4.27195129e-06]
 [-7.03556883e-06]
 [-7.70814783e-02]]


 Corrector Step
2018-07-13 19:35:00
[[ 4.51015778e+03]
 [ 3.14507688e+03]
 [-4.54295288e+03]
 [-4.23215564e+00]
 [-2.19659655e+00]
 [-5.74557188e+00]
 [ 7.27065318e-01]
 [ 2.33280348e-01]
 [-6.26345481e-01]
 [ 1.56995671e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65652482e-18]]
[[ 2.13632340e-03 -6.35740139e-03  2.74061438e-03  1.65899780e-05
   5.66486907e-07  1.90798281e-05]
 [-6.35740139e-03  2.43853846e-02 -1.01155360e-02 -4.42952744e-05
   3.78247833e-06 -6.99270757e-05]
 [ 2.74061438e-03 -1.01155360e-02  4.80386360e-03  1.92918430e-05
   8.06050030e-07  3.52104547e-05]
 [ 1.65899780e-05 -4.42952744e-05  1.92918430e-05  1.86957616e-07
   2.69679905e-09  1.35693376e-07]
 [ 5.66486907e-07  3.78247833e-06  8.06050030e-07  2.69679905e-09
   1.57146272e-07  2.30992607e-09]
 [ 1.90798281e-05 -6.99270757e-05  3.52104547e-05  1.35693376e-07
   2.30992607e-09  3.19747398e-07]]
608456773.6649065
post
cubesat_nadir
Ybar_post [[ 1.85086347]
 [-0.4230307 ]
 [13.29757345]]
resids [[ 3.15176576e-06]
 [-5.45875389e-06]
 [-7.70737295e-02]]
posterior
[[ 4.51018942e+03]
 [ 3.14494613e+03]
 [-4.54291584e+03]
 [-4.23199896e+00]
 [-2.19662301e+00]
 [-5.74540360e+00]]
[[ 4.51018932e+03]
 [ 3.14494694e+03]
 [-4.54291549e+03]
 [-4.23199879e+00]
 [-2.19662229e+00]
 [-5.74540329e+00]]
[[ 1.77916240e-04 -1.06561291e-04  3.00233583e-05  2.66805092e-07
  -1.18397922e-08  3.04029472e-08]
 [-1.06561291e-04  1.32846888e-03 -2.08145890e-04  9.81988206e-08
   9.26974895e-07 -5.67332942e-08]
 [ 3.00233583e-05 -2.08145890e-04  1.87738869e-04  6.06898530e-08
  -8.75604271e-08  1.23704509e-07]
 [ 2.66805092e-07  9.81988206e-08  6.06898530e-08  2.22208436e-09
   2.99129971e-10  6.17922232e-10]
 [-1.18397922e-08  9.26974895e-07 -8.75604271e-08  2.99129971e-10
   2.32001656e-09  2.79081790e-10]
 [ 3.04029472e-08 -5.67332942e-08  1.23704509e-07  6.17922232e-10
   2.79081790e-10  3.07402054e-09]]
[[ 1.85086641]
 [-0.42304079]
 [15.51378202]]
[[ 2.18835443e-07]
 [ 4.63204038e-06]
 [-2.29328231e+00]]


 Corrector Step
2018-07-13 19:35:00
[[ 4.51018932e+03]
 [ 3.14494694e+03]
 [-4.54291549e+03]
 [-4.23199879e+00]
 [-2.19662229e+00]
 [-5.74540329e+00]]
[[ 1.77916240e-04 -1.06561291e-04  3.00233583e-05  2.66805092e-07
  -1.18397922e-08  3.04029472e-08]
 [-1.06561291e-04  1.32846888e-03 -2.08145890e-04  9.81988206e-08
   9.26974895e-07 -5.67332942e-08]
 [ 3.00233583e-05 -2.08145890e-04  1.87738869e-04  6.06898530e-08
  -8.75604271e-08  1.23704509e-07]
 [ 2.66805092e-07  9.81988206e-08  6.06898530e-08  2.22208436e-09
   2.99129971e-10  6.17922232e-10]
 [-1.18397922e-08  9.26974895e-07 -8.75604271e-08  2.99129971e-10
   2.32001656e-09  2.79081790e-10]
 [ 3.04029472e-08 -5.67332942e-08  1.23704509e-07  6.17922232e-10
   2.79081790e-10  3.07402054e-09]]
6.08827298957239e-106
post
sphere_lamr_small
Ybar_post [[ 1.85086638]
 [-0.4230405 ]
 [15.51378445]]
resids [[ 2.50371250e-07]
 [ 4.33919599e-06]
 [-2.29328473e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [608456773.6649065, 6.08827298957239e-106]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.51015778e+03],
       [ 3.14507688e+03],
       [-4.54295288e+03],
       [-4.23215564e+00],
       [-2.19659655e+00],
       [-5.74557188e+00]]), 'est_covars': array([[ 2.13632340e-03, -6.35740139e-03,  2.74061438e-03,
         1.65899780e-05,  5.66486907e-07,  1.90798281e-05],
       [-6.35740139e-03,  2.43853846e-02, -1.01155360e-02,
        -4.42952744e-05,  3.78247833e-06, -6.99270757e-05],
       [ 2.74061438e-03, -1.01155360e-02,  4.80386360e-03,
         1.92918430e-05,  8.06050030e-07,  3.52104547e-05],
       [ 1.65899780e-05, -4.42952744e-05,  1.92918430e-05,
         1.86957616e-07,  2.69679905e-09,  1.35693376e-07],
       [ 5.66486907e-07,  3.78247833e-06,  8.06050030e-07,
         2.69679905e-09,  1.57146272e-07,  2.30992607e-09],
       [ 1.90798281e-05, -6.99270757e-05,  3.52104547e-05,
         1.35693376e-07,  2.30992607e-09,  3.19747398e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.51018932e+03],
       [ 3.14494694e+03],
       [-4.54291549e+03],
       [-4.23199879e+00],
       [-2.19662229e+00],
       [-5.74540329e+00]]), 'covar': array([[ 1.77916240e-04, -1.06561291e-04,  3.00233583e-05,
         2.66805092e-07, -1.18397922e-08,  3.04029472e-08],
       [-1.06561291e-04,  1.32846888e-03, -2.08145890e-04,
         9.81988206e-08,  9.26974895e-07, -5.67332942e-08],
       [ 3.00233583e-05, -2.08145890e-04,  1.87738869e-04,
         6.06898530e-08, -8.75604271e-08,  1.23704509e-07],
       [ 2.66805092e-07,  9.81988206e-08,  6.06898530e-08,
         2.22208436e-09,  2.99129971e-10,  6.17922232e-10],
       [-1.18397922e-08,  9.26974895e-07, -8.75604271e-08,
         2.99129971e-10,  2.32001656e-09,  2.79081790e-10],
       [ 3.04029472e-08, -5.67332942e-08,  1.23704509e-07,
         6.17922232e-10,  2.79081790e-10,  3.07402054e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.50371250e-07],
       [ 4.33919599e-06],
       [-2.29328473e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.51015778e+03],
       [ 3.14507688e+03],
       [-4.54295288e+03],
       [-4.23215564e+00],
       [-2.19659655e+00],
       [-5.74557188e+00],
       [ 7.27065318e-01],
       [ 2.33280348e-01],
       [-6.26345481e-01],
       [ 1.56995671e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65652482e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.13632340e-03, -6.35740139e-03,  2.74061438e-03,
         1.65899780e-05,  5.66486907e-07,  1.90798281e-05],
       [-6.35740139e-03,  2.43853846e-02, -1.01155360e-02,
        -4.42952744e-05,  3.78247833e-06, -6.99270757e-05],
       [ 2.74061438e-03, -1.01155360e-02,  4.80386360e-03,
         1.92918430e-05,  8.06050030e-07,  3.52104547e-05],
       [ 1.65899780e-05, -4.42952744e-05,  1.92918430e-05,
         1.86957616e-07,  2.69679905e-09,  1.35693376e-07],
       [ 5.66486907e-07,  3.78247833e-06,  8.06050030e-07,
         2.69679905e-09,  1.57146272e-07,  2.30992607e-09],
       [ 1.90798281e-05, -6.99270757e-05,  3.52104547e-05,
         1.35693376e-07,  2.30992607e-09,  3.19747398e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 3.15176576e-06],
       [-5.45875389e-06],
       [-7.70737295e-02]])}}
Current time:  2018-07-13 19:35:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.51015778e+03],
       [ 3.14507688e+03],
       [-4.54295288e+03],
       [-4.23215564e+00],
       [-2.19659655e+00],
       [-5.74557188e+00],
       [ 7.27065318e-01],
       [ 2.33280348e-01],
       [-6.26345481e-01],
       [ 1.56995671e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65652482e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.13632340e-03, -6.35740139e-03,  2.74061438e-03,
         1.65899780e-05,  5.66486907e-07,  1.90798281e-05],
       [-6.35740139e-03,  2.43853846e-02, -1.01155360e-02,
        -4.42952744e-05,  3.78247833e-06, -6.99270757e-05],
       [ 2.74061438e-03, -1.01155360e-02,  4.80386360e-03,
         1.92918430e-05,  8.06050030e-07,  3.52104547e-05],
       [ 1.65899780e-05, -4.42952744e-05,  1.92918430e-05,
         1.86957616e-07,  2.69679905e-09,  1.35693376e-07],
       [ 5.66486907e-07,  3.78247833e-06,  8.06050030e-07,
         2.69679905e-09,  1.57146272e-07,  2.30992607e-09],
       [ 1.90798281e-05, -6.99270757e-05,  3.52104547e-05,
         1.35693376e-07,  2.30992607e-09,  3.19747398e-07]])}
[[ 4.51015778e+03]
 [ 3.14507688e+03]
 [-4.54295288e+03]
 [-4.23215564e+00]
 [-2.19659655e+00]
 [-5.74557188e+00]
 [ 7.27065318e-01]
 [ 2.33280348e-01]
 [-6.26345481e-01]
 [ 1.56995671e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65652482e-18]]
2018-07-13 19:35:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:10
[[ 4.46758954e+03]
 [ 3.12293865e+03]
 [-4.60015758e+03]
 [-4.28140019e+00]
 [-2.23097789e+00]
 [-5.69528961e+00]
 [ 7.23785062e-01]
 [ 2.32457444e-01]
 [-6.30133179e-01]
 [ 1.58211561e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65673711e-18]]
[[ 2.48611833e-03 -6.79252183e-03  3.13724515e-03  1.84091822e-05
   6.18646377e-07  2.04705080e-05]
 [-6.79252183e-03  2.44763246e-02 -1.08072908e-02 -4.39198531e-05
   5.32800987e-06 -7.00700334e-05]
 [ 3.13724515e-03 -1.08072908e-02  5.54111646e-03  2.04869153e-05
   8.56875401e-07  3.85343314e-05]
 [ 1.84091822e-05 -4.39198531e-05  2.04869153e-05  1.95698833e-07
   2.90631454e-09  1.34837120e-07]
 [ 6.18646377e-07  5.32800987e-06  8.56875401e-07  2.90631454e-09
   1.67099589e-07  2.42384189e-09]
 [ 2.04705080e-05 -7.00700334e-05  3.85343314e-05  1.34837120e-07
   2.42384189e-09  3.30713194e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.51018932e+03],
       [ 3.14494694e+03],
       [-4.54291549e+03],
       [-4.23199879e+00],
       [-2.19662229e+00],
       [-5.74540329e+00]]), 'covar': array([[ 1.77916240e-04, -1.06561291e-04,  3.00233583e-05,
         2.66805092e-07, -1.18397922e-08,  3.04029472e-08],
       [-1.06561291e-04,  1.32846888e-03, -2.08145890e-04,
         9.81988206e-08,  9.26974895e-07, -5.67332942e-08],
       [ 3.00233583e-05, -2.08145890e-04,  1.87738869e-04,
         6.06898530e-08, -8.75604271e-08,  1.23704509e-07],
       [ 2.66805092e-07,  9.81988206e-08,  6.06898530e-08,
         2.22208436e-09,  2.99129971e-10,  6.17922232e-10],
       [-1.18397922e-08,  9.26974895e-07, -8.75604271e-08,
         2.99129971e-10,  2.32001656e-09,  2.79081790e-10],
       [ 3.04029472e-08, -5.67332942e-08,  1.23704509e-07,
         6.17922232e-10,  2.79081790e-10,  3.07402054e-09]])}
[[ 4.51018932e+03]
 [ 3.14494694e+03]
 [-4.54291549e+03]
 [-4.23199879e+00]
 [-2.19662229e+00]
 [-5.74540329e+00]]
2018-07-13 19:35:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:10
[[ 4.46762249e+03]
 [ 3.12280864e+03]
 [-4.60011861e+03]
 [-4.28124515e+00]
 [-2.23100303e+00]
 [-5.69512016e+00]]
[[ 1.83675422e-04 -1.05604475e-04  3.09114061e-05  2.88554198e-07
  -6.96050793e-09  3.51762490e-08]
 [-1.05604475e-04  1.34719236e-03 -2.09615196e-04  1.15948230e-07
   9.45417848e-07 -6.55402835e-08]
 [ 3.09114061e-05 -2.09615196e-04  1.90553163e-04  6.24801678e-08
  -8.53236288e-08  1.56988508e-07]
 [ 2.88554198e-07  1.15948230e-07  6.24801678e-08  2.32351778e-09
   3.10203571e-10  6.11044895e-10]
 [-6.96050793e-09  9.45417848e-07 -8.53236288e-08  3.10203571e-10
   2.41277765e-09  2.69575262e-10]
 [ 3.51762490e-08 -6.55402835e-08  1.56988508e-07  6.11044895e-10
   2.69575262e-10  3.17501559e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.46762249e+03],
       [ 3.12280864e+03],
       [-4.60011861e+03],
       [-4.28124515e+00],
       [-2.23100303e+00],
       [-5.69512016e+00]]), 'covar': array([[ 1.83675422e-04, -1.05604475e-04,  3.09114061e-05,
         2.88554198e-07, -6.96050793e-09,  3.51762490e-08],
       [-1.05604475e-04,  1.34719236e-03, -2.09615196e-04,
         1.15948230e-07,  9.45417848e-07, -6.55402835e-08],
       [ 3.09114061e-05, -2.09615196e-04,  1.90553163e-04,
         6.24801678e-08, -8.53236288e-08,  1.56988508e-07],
       [ 2.88554198e-07,  1.15948230e-07,  6.24801678e-08,
         2.32351778e-09,  3.10203571e-10,  6.11044895e-10],
       [-6.96050793e-09,  9.45417848e-07, -8.53236288e-08,
         3.10203571e-10,  2.41277765e-09,  2.69575262e-10],
       [ 3.51762490e-08, -6.55402835e-08,  1.56988508e-07,
         6.11044895e-10,  2.69575262e-10,  3.17501559e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 2.50371250e-07],
       [ 4.33919599e-06],
       [-2.29328473e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.46758954e+03],
       [ 3.12293865e+03],
       [-4.60015758e+03],
       [-4.28140019e+00],
       [-2.23097789e+00],
       [-5.69528961e+00],
       [ 7.23785062e-01],
       [ 2.32457444e-01],
       [-6.30133179e-01],
       [ 1.58211561e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65673711e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.48611833e-03, -6.79252183e-03,  3.13724515e-03,
         1.84091822e-05,  6.18646377e-07,  2.04705080e-05],
       [-6.79252183e-03,  2.44763246e-02, -1.08072908e-02,
        -4.39198531e-05,  5.32800987e-06, -7.00700334e-05],
       [ 3.13724515e-03, -1.08072908e-02,  5.54111646e-03,
         2.04869153e-05,  8.56875401e-07,  3.85343314e-05],
       [ 1.84091822e-05, -4.39198531e-05,  2.04869153e-05,
         1.95698833e-07,  2.90631454e-09,  1.34837120e-07],
       [ 6.18646377e-07,  5.32800987e-06,  8.56875401e-07,
         2.90631454e-09,  1.67099589e-07,  2.42384189e-09],
       [ 2.04705080e-05, -7.00700334e-05,  3.85343314e-05,
         1.34837120e-07,  2.42384189e-09,  3.30713194e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 3.15176576e-06],
       [-5.45875389e-06],
       [-7.70737295e-02]])}}
Yi [[ 1.87543463]
 [-0.44993909]
 [13.26335759]]
posterior
[[ 4.46758954e+03]
 [ 3.12293865e+03]
 [-4.60015758e+03]
 [-4.28140019e+00]
 [-2.23097789e+00]
 [-5.69528961e+00]
 [ 7.23785062e-01]
 [ 2.32457444e-01]
 [-6.30133179e-01]
 [ 1.58211561e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65673711e-18]]
[[ 4.46758401e+03]
 [ 3.12296454e+03]
 [-4.60015604e+03]
 [-4.28143521e+00]
 [-2.23091992e+00]
 [-5.69523527e+00]
 [ 7.23785062e-01]
 [ 2.32457444e-01]
 [-6.30133179e-01]
 [ 1.58211561e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65673711e-18]]
[[ 2.41297828e-03 -6.77136427e-03  3.17786925e-03  1.76453920e-05
   6.30485720e-07  2.09480353e-05]
 [-6.77136427e-03  2.37126630e-02 -1.07690813e-02 -4.44081518e-05
   3.55251968e-06 -7.07554618e-05]
 [ 3.17786925e-03 -1.07690813e-02  5.51523350e-03  2.09579332e-05
   9.67080687e-07  3.83049527e-05]
 [ 1.76453920e-05 -4.44081518e-05  2.09579332e-05  1.87058660e-07
   1.37090481e-09  1.39311575e-07]
 [ 6.30485720e-07  3.55251968e-06  9.67080687e-07  1.37090481e-09
   1.62952069e-07  1.06540943e-09]
 [ 2.09480353e-05 -7.07554618e-05  3.83049527e-05  1.39311575e-07
   1.06540943e-09  3.27197644e-07]]
[[ 1.87543747]
 [-0.44996884]
 [13.30762148]]
[[-2.83881592e-06]
 [ 2.97596202e-05]
 [-4.42638921e-02]]


 Corrector Step
2018-07-13 19:35:10
[[ 4.46758401e+03]
 [ 3.12296454e+03]
 [-4.60015604e+03]
 [-4.28143521e+00]
 [-2.23091992e+00]
 [-5.69523527e+00]
 [ 7.23785062e-01]
 [ 2.32457444e-01]
 [-6.30133179e-01]
 [ 1.58211561e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65673711e-18]]
[[ 2.41297828e-03 -6.77136427e-03  3.17786925e-03  1.76453920e-05
   6.30485720e-07  2.09480353e-05]
 [-6.77136427e-03  2.37126630e-02 -1.07690813e-02 -4.44081518e-05
   3.55251968e-06 -7.07554618e-05]
 [ 3.17786925e-03 -1.07690813e-02  5.51523350e-03  2.09579332e-05
   9.67080687e-07  3.83049527e-05]
 [ 1.76453920e-05 -4.44081518e-05  2.09579332e-05  1.87058660e-07
   1.37090481e-09  1.39311575e-07]
 [ 6.30485720e-07  3.55251968e-06  9.67080687e-07  1.37090481e-09
   1.62952069e-07  1.06540943e-09]
 [ 2.09480353e-05 -7.07554618e-05  3.83049527e-05  1.39311575e-07
   1.06540943e-09  3.27197644e-07]]
425148186.37646484
post
cubesat_nadir
Ybar_post [[ 1.8754362 ]
 [-0.44996282]
 [13.30764479]]
resids [[-1.57094740e-06]
 [ 2.37313774e-05]
 [-4.42871981e-02]]
posterior
[[ 4.46762249e+03]
 [ 3.12280864e+03]
 [-4.60011861e+03]
 [-4.28124515e+00]
 [-2.23100303e+00]
 [-5.69512016e+00]]
[[ 4.46762200e+03]
 [ 3.12282101e+03]
 [-4.60011633e+03]
 [-4.28124178e+00]
 [-2.23099267e+00]
 [-5.69511686e+00]]
[[ 1.74371877e-04 -1.18070919e-04  3.41703693e-05  2.70808991e-07
  -1.88671785e-08  3.60180818e-08]
 [-1.18070919e-04  1.26043773e-03 -2.15908715e-04  6.92891191e-08
   8.70629825e-07 -8.13772005e-08]
 [ 3.41703693e-05 -2.15908715e-04  1.87789206e-04  6.52140544e-08
  -9.01062772e-08  1.54111814e-07]
 [ 2.70808991e-07  6.92891191e-08  6.52140544e-08  2.28219740e-09
   2.68275910e-10  6.07109138e-10]
 [-1.88671785e-08  8.70629825e-07 -9.01062772e-08  2.68275910e-10
   2.34812655e-09  2.56404141e-10]
 [ 3.60180818e-08 -8.13772005e-08  1.54111814e-07  6.07109138e-10
   2.56404141e-10  3.17083076e-09]]
[[ 1.8754414 ]
 [-0.4499797 ]
 [15.43721151]]
[[-6.77272248e-06]
 [ 4.06151161e-05]
 [-2.17385393e+00]]


 Corrector Step
2018-07-13 19:35:10
[[ 4.46762200e+03]
 [ 3.12282101e+03]
 [-4.60011633e+03]
 [-4.28124178e+00]
 [-2.23099267e+00]
 [-5.69511686e+00]]
[[ 1.74371877e-04 -1.18070919e-04  3.41703693e-05  2.70808991e-07
  -1.88671785e-08  3.60180818e-08]
 [-1.18070919e-04  1.26043773e-03 -2.15908715e-04  6.92891191e-08
   8.70629825e-07 -8.13772005e-08]
 [ 3.41703693e-05 -2.15908715e-04  1.87789206e-04  6.52140544e-08
  -9.01062772e-08  1.54111814e-07]
 [ 2.70808991e-07  6.92891191e-08  6.52140544e-08  2.28219740e-09
   2.68275910e-10  6.07109138e-10]
 [-1.88671785e-08  8.70629825e-07 -9.01062772e-08  2.68275910e-10
   2.34812655e-09  2.56404141e-10]
 [ 3.60180818e-08 -8.13772005e-08  1.54111814e-07  6.07109138e-10
   2.56404141e-10  3.17083076e-09]]
6.386560264214435e-95
post
sphere_lamr_small
Ybar_post [[ 1.87543975]
 [-0.44997631]
 [15.43723446]]
resids [[-5.11941766e-06]
 [ 3.72280555e-05]
 [-2.17387688e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [425148186.37646484, 6.386560264214435e-95]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.46758401e+03],
       [ 3.12296454e+03],
       [-4.60015604e+03],
       [-4.28143521e+00],
       [-2.23091992e+00],
       [-5.69523527e+00]]), 'est_covars': array([[ 2.41297828e-03, -6.77136427e-03,  3.17786925e-03,
         1.76453920e-05,  6.30485720e-07,  2.09480353e-05],
       [-6.77136427e-03,  2.37126630e-02, -1.07690813e-02,
        -4.44081518e-05,  3.55251968e-06, -7.07554618e-05],
       [ 3.17786925e-03, -1.07690813e-02,  5.51523350e-03,
         2.09579332e-05,  9.67080687e-07,  3.83049527e-05],
       [ 1.76453920e-05, -4.44081518e-05,  2.09579332e-05,
         1.87058660e-07,  1.37090481e-09,  1.39311575e-07],
       [ 6.30485720e-07,  3.55251968e-06,  9.67080687e-07,
         1.37090481e-09,  1.62952069e-07,  1.06540943e-09],
       [ 2.09480353e-05, -7.07554618e-05,  3.83049527e-05,
         1.39311575e-07,  1.06540943e-09,  3.27197644e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.46762200e+03],
       [ 3.12282101e+03],
       [-4.60011633e+03],
       [-4.28124178e+00],
       [-2.23099267e+00],
       [-5.69511686e+00]]), 'covar': array([[ 1.74371877e-04, -1.18070919e-04,  3.41703693e-05,
         2.70808991e-07, -1.88671785e-08,  3.60180818e-08],
       [-1.18070919e-04,  1.26043773e-03, -2.15908715e-04,
         6.92891191e-08,  8.70629825e-07, -8.13772005e-08],
       [ 3.41703693e-05, -2.15908715e-04,  1.87789206e-04,
         6.52140544e-08, -9.01062772e-08,  1.54111814e-07],
       [ 2.70808991e-07,  6.92891191e-08,  6.52140544e-08,
         2.28219740e-09,  2.68275910e-10,  6.07109138e-10],
       [-1.88671785e-08,  8.70629825e-07, -9.01062772e-08,
         2.68275910e-10,  2.34812655e-09,  2.56404141e-10],
       [ 3.60180818e-08, -8.13772005e-08,  1.54111814e-07,
         6.07109138e-10,  2.56404141e-10,  3.17083076e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-5.11941766e-06],
       [ 3.72280555e-05],
       [-2.17387688e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.46758401e+03],
       [ 3.12296454e+03],
       [-4.60015604e+03],
       [-4.28143521e+00],
       [-2.23091992e+00],
       [-5.69523527e+00],
       [ 7.23785062e-01],
       [ 2.32457444e-01],
       [-6.30133179e-01],
       [ 1.58211561e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65673711e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.41297828e-03, -6.77136427e-03,  3.17786925e-03,
         1.76453920e-05,  6.30485720e-07,  2.09480353e-05],
       [-6.77136427e-03,  2.37126630e-02, -1.07690813e-02,
        -4.44081518e-05,  3.55251968e-06, -7.07554618e-05],
       [ 3.17786925e-03, -1.07690813e-02,  5.51523350e-03,
         2.09579332e-05,  9.67080687e-07,  3.83049527e-05],
       [ 1.76453920e-05, -4.44081518e-05,  2.09579332e-05,
         1.87058660e-07,  1.37090481e-09,  1.39311575e-07],
       [ 6.30485720e-07,  3.55251968e-06,  9.67080687e-07,
         1.37090481e-09,  1.62952069e-07,  1.06540943e-09],
       [ 2.09480353e-05, -7.07554618e-05,  3.83049527e-05,
         1.39311575e-07,  1.06540943e-09,  3.27197644e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.57094740e-06],
       [ 2.37313774e-05],
       [-4.42871981e-02]])}}
Current time:  2018-07-13 19:35:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.46758401e+03],
       [ 3.12296454e+03],
       [-4.60015604e+03],
       [-4.28143521e+00],
       [-2.23091992e+00],
       [-5.69523527e+00],
       [ 7.23785062e-01],
       [ 2.32457444e-01],
       [-6.30133179e-01],
       [ 1.58211561e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65673711e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.41297828e-03, -6.77136427e-03,  3.17786925e-03,
         1.76453920e-05,  6.30485720e-07,  2.09480353e-05],
       [-6.77136427e-03,  2.37126630e-02, -1.07690813e-02,
        -4.44081518e-05,  3.55251968e-06, -7.07554618e-05],
       [ 3.17786925e-03, -1.07690813e-02,  5.51523350e-03,
         2.09579332e-05,  9.67080687e-07,  3.83049527e-05],
       [ 1.76453920e-05, -4.44081518e-05,  2.09579332e-05,
         1.87058660e-07,  1.37090481e-09,  1.39311575e-07],
       [ 6.30485720e-07,  3.55251968e-06,  9.67080687e-07,
         1.37090481e-09,  1.62952069e-07,  1.06540943e-09],
       [ 2.09480353e-05, -7.07554618e-05,  3.83049527e-05,
         1.39311575e-07,  1.06540943e-09,  3.27197644e-07]])}
[[ 4.46758401e+03]
 [ 3.12296454e+03]
 [-4.60015604e+03]
 [-4.28143521e+00]
 [-2.23091992e+00]
 [-5.69523527e+00]
 [ 7.23785062e-01]
 [ 2.32457444e-01]
 [-6.30133179e-01]
 [ 1.58211561e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65673711e-18]]
2018-07-13 19:35:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:20
[[ 4.42452550e+03]
 [ 3.10048430e+03]
 [-4.65685435e+03]
 [-4.33020377e+00]
 [-2.26505221e+00]
 [-5.64433304e+00]
 [ 7.20485073e-01]
 [ 2.31628204e-01]
 [-6.33903698e-01]
 [ 1.59423137e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65694940e-18]]
[[ 2.78380965e-03 -7.20719676e-03  3.61019849e-03  1.94565287e-05
   6.69716062e-07  2.23774002e-05]
 [-7.20719676e-03  2.37996547e-02 -1.14675475e-02 -4.40457060e-05
   5.16096663e-06 -7.09055832e-05]
 [ 3.61019849e-03 -1.14675475e-02  6.31509091e-03  2.21746476e-05
   1.00595056e-06  4.17077799e-05]
 [ 1.94565287e-05 -4.40457060e-05  2.21746476e-05  1.95760156e-07
   1.57050926e-09  1.38414195e-07]
 [ 6.69716062e-07  5.16096663e-06  1.00595056e-06  1.57050926e-09
   1.72904320e-07  1.17407182e-09]
 [ 2.23774002e-05 -7.09055832e-05  4.17077799e-05  1.38414195e-07
   1.17407182e-09  3.38177451e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.46762200e+03],
       [ 3.12282101e+03],
       [-4.60011633e+03],
       [-4.28124178e+00],
       [-2.23099267e+00],
       [-5.69511686e+00]]), 'covar': array([[ 1.74371877e-04, -1.18070919e-04,  3.41703693e-05,
         2.70808991e-07, -1.88671785e-08,  3.60180818e-08],
       [-1.18070919e-04,  1.26043773e-03, -2.15908715e-04,
         6.92891191e-08,  8.70629825e-07, -8.13772005e-08],
       [ 3.41703693e-05, -2.15908715e-04,  1.87789206e-04,
         6.52140544e-08, -9.01062772e-08,  1.54111814e-07],
       [ 2.70808991e-07,  6.92891191e-08,  6.52140544e-08,
         2.28219740e-09,  2.68275910e-10,  6.07109138e-10],
       [-1.88671785e-08,  8.70629825e-07, -9.01062772e-08,
         2.68275910e-10,  2.34812655e-09,  2.56404141e-10],
       [ 3.60180818e-08, -8.13772005e-08,  1.54111814e-07,
         6.07109138e-10,  2.56404141e-10,  3.17083076e-09]])}
[[ 4.46762200e+03]
 [ 3.12282101e+03]
 [-4.60011633e+03]
 [-4.28124178e+00]
 [-2.23099267e+00]
 [-5.69511686e+00]]
2018-07-13 19:35:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:20
[[ 4.42456517e+03]
 [ 3.10034014e+03]
 [-4.65681358e+03]
 [-4.33001198e+00]
 [-2.26512433e+00]
 [-5.64421395e+00]]
[[ 1.80088585e-04 -1.17419058e-04  3.52451734e-05  2.92856556e-07
  -1.43517547e-08  4.08603538e-08]
 [-1.17419058e-04  1.27805812e-03 -2.17639102e-04  8.59915872e-08
   8.89535932e-07 -8.97842719e-08]
 [ 3.52451734e-05 -2.17639102e-04  1.91221417e-04  6.68191754e-08
  -8.80341299e-08  1.88432870e-07]
 [ 2.92856556e-07  8.59915872e-08  6.68191754e-08  2.38289587e-09
   2.78846324e-10  5.99880564e-10]
 [-1.43517547e-08  8.89535932e-07 -8.80341299e-08  2.78846324e-10
   2.44119268e-09  2.47319159e-10]
 [ 4.08603538e-08 -8.97842719e-08  1.88432870e-07  5.99880564e-10
   2.47319159e-10  3.27242244e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.42456517e+03],
       [ 3.10034014e+03],
       [-4.65681358e+03],
       [-4.33001198e+00],
       [-2.26512433e+00],
       [-5.64421395e+00]]), 'covar': array([[ 1.80088585e-04, -1.17419058e-04,  3.52451734e-05,
         2.92856556e-07, -1.43517547e-08,  4.08603538e-08],
       [-1.17419058e-04,  1.27805812e-03, -2.17639102e-04,
         8.59915872e-08,  8.89535932e-07, -8.97842719e-08],
       [ 3.52451734e-05, -2.17639102e-04,  1.91221417e-04,
         6.68191754e-08, -8.80341299e-08,  1.88432870e-07],
       [ 2.92856556e-07,  8.59915872e-08,  6.68191754e-08,
         2.38289587e-09,  2.78846324e-10,  5.99880564e-10],
       [-1.43517547e-08,  8.89535932e-07, -8.80341299e-08,
         2.78846324e-10,  2.44119268e-09,  2.47319159e-10],
       [ 4.08603538e-08, -8.97842719e-08,  1.88432870e-07,
         5.99880564e-10,  2.47319159e-10,  3.27242244e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-5.11941766e-06],
       [ 3.72280555e-05],
       [-2.17387688e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.42452550e+03],
       [ 3.10048430e+03],
       [-4.65685435e+03],
       [-4.33020377e+00],
       [-2.26505221e+00],
       [-5.64433304e+00],
       [ 7.20485073e-01],
       [ 2.31628204e-01],
       [-6.33903698e-01],
       [ 1.59423137e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65694940e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.78380965e-03, -7.20719676e-03,  3.61019849e-03,
         1.94565287e-05,  6.69716062e-07,  2.23774002e-05],
       [-7.20719676e-03,  2.37996547e-02, -1.14675475e-02,
        -4.40457060e-05,  5.16096663e-06, -7.09055832e-05],
       [ 3.61019849e-03, -1.14675475e-02,  6.31509091e-03,
         2.21746476e-05,  1.00595056e-06,  4.17077799e-05],
       [ 1.94565287e-05, -4.40457060e-05,  2.21746476e-05,
         1.95760156e-07,  1.57050926e-09,  1.38414195e-07],
       [ 6.69716062e-07,  5.16096663e-06,  1.00595056e-06,
         1.57050926e-09,  1.72904320e-07,  1.17407182e-09],
       [ 2.23774002e-05, -7.09055832e-05,  4.17077799e-05,
         1.38414195e-07,  1.17407182e-09,  3.38177451e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.57094740e-06],
       [ 2.37313774e-05],
       [-4.42871981e-02]])}}
Yi [[ 1.90060048]
 [-0.47613065]
 [13.4199286 ]]
posterior
[[ 4.42452550e+03]
 [ 3.10048430e+03]
 [-4.65685435e+03]
 [-4.33020377e+00]
 [-2.26505221e+00]
 [-5.64433304e+00]
 [ 7.20485073e-01]
 [ 2.31628204e-01]
 [-6.33903698e-01]
 [ 1.59423137e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65694940e-18]]
[[ 4.42452856e+03]
 [ 3.10050379e+03]
 [-4.65685863e+03]
 [-4.33015051e+00]
 [-2.26500268e+00]
 [-5.64434798e+00]
 [ 7.20485073e-01]
 [ 2.31628204e-01]
 [-6.33903698e-01]
 [ 1.59423137e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65694940e-18]]
[[ 2.71664080e-03 -7.18749705e-03  3.65449162e-03  1.87572944e-05
   7.13342822e-07  2.28824170e-05]
 [-7.18749705e-03  2.30980335e-02 -1.14086383e-02 -4.45700572e-05
   3.36841075e-06 -7.13800136e-05]
 [ 3.65449162e-03 -1.14086383e-02  6.27842516e-03  2.27111300e-05
   1.16096867e-06  4.14082003e-05]
 [ 1.87572944e-05 -4.45700572e-05  2.27111300e-05  1.87716417e-07
   1.59075876e-10  1.43329566e-07]
 [ 7.13342822e-07  3.36841075e-06  1.16096867e-06  1.59075876e-10
   1.68323447e-07  1.03625416e-11]
 [ 2.28824170e-05 -7.13800136e-05  4.14082003e-05  1.43329566e-07
   1.03625416e-11  3.34224748e-07]]
[[ 1.90062267]
 [-0.47613834]
 [13.32536197]]
[[-2.21821643e-05]
 [ 7.69278127e-06]
 [ 9.45666307e-02]]


 Corrector Step
2018-07-13 19:35:20
[[ 4.42452856e+03]
 [ 3.10050379e+03]
 [-4.65685863e+03]
 [-4.33015051e+00]
 [-2.26500268e+00]
 [-5.64434798e+00]
 [ 7.20485073e-01]
 [ 2.31628204e-01]
 [-6.33903698e-01]
 [ 1.59423137e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65694940e-18]]
[[ 2.71664080e-03 -7.18749705e-03  3.65449162e-03  1.87572944e-05
   7.13342822e-07  2.28824170e-05]
 [-7.18749705e-03  2.30980335e-02 -1.14086383e-02 -4.45700572e-05
   3.36841075e-06 -7.13800136e-05]
 [ 3.65449162e-03 -1.14086383e-02  6.27842516e-03  2.27111300e-05
   1.16096867e-06  4.14082003e-05]
 [ 1.87572944e-05 -4.45700572e-05  2.27111300e-05  1.87716417e-07
   1.59075876e-10  1.43329566e-07]
 [ 7.13342822e-07  3.36841075e-06  1.16096867e-06  1.59075876e-10
   1.68323447e-07  1.03625416e-11]
 [ 2.28824170e-05 -7.13800136e-05  4.14082003e-05  1.43329566e-07
   1.03625416e-11  3.34224748e-07]]
382023900.14895386
post
cubesat_nadir
Ybar_post [[ 1.9006179 ]
 [-0.47613638]
 [13.32537653]]
resids [[-1.74122696e-05]
 [ 5.73231860e-06]
 [ 9.45520722e-02]]
posterior
[[ 4.42456517e+03]
 [ 3.10034014e+03]
 [-4.65681358e+03]
 [-4.33001198e+00]
 [-2.26512433e+00]
 [-5.64421395e+00]]
[[ 4.42456730e+03]
 [ 3.10035230e+03]
 [-4.65681322e+03]
 [-4.33000463e+00]
 [-2.26511376e+00]
 [-5.64421179e+00]]
[[ 1.71787889e-04 -1.28041796e-04  3.85658984e-05  2.76497581e-07
  -2.45553322e-08  4.24347256e-08]
 [-1.28041796e-04  1.19301667e-03 -2.21848591e-04  4.14587305e-08
   8.16614758e-07 -1.06333448e-07]
 [ 3.85658984e-05 -2.21848591e-04  1.88891379e-04  7.05697382e-08
  -9.10398168e-08  1.85605079e-07]
 [ 2.76497581e-07  4.14587305e-08  7.05697382e-08  2.34286183e-09
   2.38965472e-10  5.96851996e-10]
 [-2.45553322e-08  8.16614758e-07 -9.10398168e-08  2.38965472e-10
   2.37849250e-09  2.33700283e-10]
 [ 4.24347256e-08 -1.06333448e-07  1.85605079e-07  5.96851996e-10
   2.33700283e-10  3.26730036e-09]]
[[ 1.90062749]
 [-0.47615331]
 [15.36531353]]
[[-2.70101405e-05]
 [ 2.26684483e-05]
 [-1.94538493e+00]]


 Corrector Step
2018-07-13 19:35:20
[[ 4.42456730e+03]
 [ 3.10035230e+03]
 [-4.65681322e+03]
 [-4.33000463e+00]
 [-2.26511376e+00]
 [-5.64421179e+00]]
[[ 1.71787889e-04 -1.28041796e-04  3.85658984e-05  2.76497581e-07
  -2.45553322e-08  4.24347256e-08]
 [-1.28041796e-04  1.19301667e-03 -2.21848591e-04  4.14587305e-08
   8.16614758e-07 -1.06333448e-07]
 [ 3.85658984e-05 -2.21848591e-04  1.88891379e-04  7.05697382e-08
  -9.10398168e-08  1.85605079e-07]
 [ 2.76497581e-07  4.14587305e-08  7.05697382e-08  2.34286183e-09
   2.38965472e-10  5.96851996e-10]
 [-2.45553322e-08  8.16614758e-07 -9.10398168e-08  2.38965472e-10
   2.37849250e-09  2.33700283e-10]
 [ 4.24347256e-08 -1.06333448e-07  1.85605079e-07  5.96851996e-10
   2.33700283e-10  3.26730036e-09]]
2.546787972806398e-74
post
sphere_lamr_small
Ybar_post [[ 1.9006244 ]
 [-0.47615087]
 [15.36533091]]
resids [[-2.39190607e-05]
 [ 2.02206447e-05]
 [-1.94540231e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [382023900.14895386, 2.546787972806398e-74]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.42452856e+03],
       [ 3.10050379e+03],
       [-4.65685863e+03],
       [-4.33015051e+00],
       [-2.26500268e+00],
       [-5.64434798e+00]]), 'est_covars': array([[ 2.71664080e-03, -7.18749705e-03,  3.65449162e-03,
         1.87572944e-05,  7.13342822e-07,  2.28824170e-05],
       [-7.18749705e-03,  2.30980335e-02, -1.14086383e-02,
        -4.45700572e-05,  3.36841075e-06, -7.13800136e-05],
       [ 3.65449162e-03, -1.14086383e-02,  6.27842516e-03,
         2.27111300e-05,  1.16096867e-06,  4.14082003e-05],
       [ 1.87572944e-05, -4.45700572e-05,  2.27111300e-05,
         1.87716417e-07,  1.59075876e-10,  1.43329566e-07],
       [ 7.13342822e-07,  3.36841075e-06,  1.16096867e-06,
         1.59075876e-10,  1.68323447e-07,  1.03625416e-11],
       [ 2.28824170e-05, -7.13800136e-05,  4.14082003e-05,
         1.43329566e-07,  1.03625416e-11,  3.34224748e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.42456730e+03],
       [ 3.10035230e+03],
       [-4.65681322e+03],
       [-4.33000463e+00],
       [-2.26511376e+00],
       [-5.64421179e+00]]), 'covar': array([[ 1.71787889e-04, -1.28041796e-04,  3.85658984e-05,
         2.76497581e-07, -2.45553322e-08,  4.24347256e-08],
       [-1.28041796e-04,  1.19301667e-03, -2.21848591e-04,
         4.14587305e-08,  8.16614758e-07, -1.06333448e-07],
       [ 3.85658984e-05, -2.21848591e-04,  1.88891379e-04,
         7.05697382e-08, -9.10398168e-08,  1.85605079e-07],
       [ 2.76497581e-07,  4.14587305e-08,  7.05697382e-08,
         2.34286183e-09,  2.38965472e-10,  5.96851996e-10],
       [-2.45553322e-08,  8.16614758e-07, -9.10398168e-08,
         2.38965472e-10,  2.37849250e-09,  2.33700283e-10],
       [ 4.24347256e-08, -1.06333448e-07,  1.85605079e-07,
         5.96851996e-10,  2.33700283e-10,  3.26730036e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.39190607e-05],
       [ 2.02206447e-05],
       [-1.94540231e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.42452856e+03],
       [ 3.10050379e+03],
       [-4.65685863e+03],
       [-4.33015051e+00],
       [-2.26500268e+00],
       [-5.64434798e+00],
       [ 7.20485073e-01],
       [ 2.31628204e-01],
       [-6.33903698e-01],
       [ 1.59423137e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65694940e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.71664080e-03, -7.18749705e-03,  3.65449162e-03,
         1.87572944e-05,  7.13342822e-07,  2.28824170e-05],
       [-7.18749705e-03,  2.30980335e-02, -1.14086383e-02,
        -4.45700572e-05,  3.36841075e-06, -7.13800136e-05],
       [ 3.65449162e-03, -1.14086383e-02,  6.27842516e-03,
         2.27111300e-05,  1.16096867e-06,  4.14082003e-05],
       [ 1.87572944e-05, -4.45700572e-05,  2.27111300e-05,
         1.87716417e-07,  1.59075876e-10,  1.43329566e-07],
       [ 7.13342822e-07,  3.36841075e-06,  1.16096867e-06,
         1.59075876e-10,  1.68323447e-07,  1.03625416e-11],
       [ 2.28824170e-05, -7.13800136e-05,  4.14082003e-05,
         1.43329566e-07,  1.03625416e-11,  3.34224748e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.74122696e-05],
       [ 5.73231860e-06],
       [ 9.45520722e-02]])}}
Current time:  2018-07-13 19:35:30
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.42452856e+03],
       [ 3.10050379e+03],
       [-4.65685863e+03],
       [-4.33015051e+00],
       [-2.26500268e+00],
       [-5.64434798e+00],
       [ 7.20485073e-01],
       [ 2.31628204e-01],
       [-6.33903698e-01],
       [ 1.59423137e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65694940e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 2.71664080e-03, -7.18749705e-03,  3.65449162e-03,
         1.87572944e-05,  7.13342822e-07,  2.28824170e-05],
       [-7.18749705e-03,  2.30980335e-02, -1.14086383e-02,
        -4.45700572e-05,  3.36841075e-06, -7.13800136e-05],
       [ 3.65449162e-03, -1.14086383e-02,  6.27842516e-03,
         2.27111300e-05,  1.16096867e-06,  4.14082003e-05],
       [ 1.87572944e-05, -4.45700572e-05,  2.27111300e-05,
         1.87716417e-07,  1.59075876e-10,  1.43329566e-07],
       [ 7.13342822e-07,  3.36841075e-06,  1.16096867e-06,
         1.59075876e-10,  1.68323447e-07,  1.03625416e-11],
       [ 2.28824170e-05, -7.13800136e-05,  4.14082003e-05,
         1.43329566e-07,  1.03625416e-11,  3.34224748e-07]])}
[[ 4.42452856e+03]
 [ 3.10050379e+03]
 [-4.65685863e+03]
 [-4.33015051e+00]
 [-2.26500268e+00]
 [-5.64434798e+00]
 [ 7.20485073e-01]
 [ 2.31628204e-01]
 [-6.33903698e-01]
 [ 1.59423137e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65694940e-18]]
2018-07-13 19:35:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:30
[[ 4.38098526e+03]
 [ 3.07768403e+03]
 [-4.71304513e+03]
 [-4.37843742e+00]
 [-2.29888234e+00]
 [-5.59283208e+00]
 [ 7.17165442e-01]
 [ 2.30792648e-01]
 [-6.37656935e-01]
 [ 1.60630368e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65716168e-18]]
[[ 3.10965590e-03 -7.62419247e-03  4.12402194e-03  2.05653602e-05
   7.40601914e-07  2.43544005e-05]
 [-7.62419247e-03  2.31818676e-02 -1.21114441e-02 -4.42189597e-05
   5.03533346e-06 -7.15359566e-05]
 [ 4.12402194e-03 -1.21114441e-02  7.14109274e-03  2.39530007e-05
   1.18948345e-06  4.48856831e-05]
 [ 2.05653602e-05 -4.42189597e-05  2.39530007e-05  1.96374587e-07
   3.48257027e-10  1.42393453e-07]
 [ 7.40601914e-07  5.03533346e-06  1.18948345e-06  3.48257027e-10
   1.78273937e-07  1.12270004e-10]
 [ 2.43544005e-05 -7.15359566e-05  4.48856831e-05  1.42393453e-07
   1.12270004e-10  3.45216453e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.42456730e+03],
       [ 3.10035230e+03],
       [-4.65681322e+03],
       [-4.33000463e+00],
       [-2.26511376e+00],
       [-5.64421179e+00]]), 'covar': array([[ 1.71787889e-04, -1.28041796e-04,  3.85658984e-05,
         2.76497581e-07, -2.45553322e-08,  4.24347256e-08],
       [-1.28041796e-04,  1.19301667e-03, -2.21848591e-04,
         4.14587305e-08,  8.16614758e-07, -1.06333448e-07],
       [ 3.85658984e-05, -2.21848591e-04,  1.88891379e-04,
         7.05697382e-08, -9.10398168e-08,  1.85605079e-07],
       [ 2.76497581e-07,  4.14587305e-08,  7.05697382e-08,
         2.34286183e-09,  2.38965472e-10,  5.96851996e-10],
       [-2.45553322e-08,  8.16614758e-07, -9.10398168e-08,
         2.38965472e-10,  2.37849250e-09,  2.33700283e-10],
       [ 4.24347256e-08, -1.06333448e-07,  1.85605079e-07,
         5.96851996e-10,  2.33700283e-10,  3.26730036e-09]])}
[[ 4.42456730e+03]
 [ 3.10035230e+03]
 [-4.65681322e+03]
 [-4.33000463e+00]
 [-2.26511376e+00]
 [-5.64421179e+00]]
2018-07-13 19:35:20
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:30
[[ 4.38102515e+03]
 [ 3.07753161e+03]
 [-4.71299816e+03]
 [-4.37829373e+00]
 [-2.29899259e+00]
 [-5.59269473e+00]]
[[ 1.77777381e-04 -1.27807684e-04  3.96556234e-05  2.99050838e-07
  -2.04533874e-08  4.71451843e-08]
 [-1.27807684e-04  1.20954590e-03 -2.23842375e-04  5.72144546e-08
   8.36066986e-07 -1.14289119e-07]
 [ 3.96556234e-05 -2.23842375e-04  1.92975451e-04  7.20560872e-08
  -8.90830411e-08  2.21048711e-07]
 [ 2.99050838e-07  5.72144546e-08  7.20560872e-08  2.44270124e-09
   2.48993369e-10  5.89168257e-10]
 [-2.04533874e-08  8.36066986e-07 -8.90830411e-08  2.48993369e-10
   2.47189120e-09  2.25091409e-10]
 [ 4.71451843e-08 -1.14289119e-07  2.21048711e-07  5.89168257e-10
   2.25091409e-10  3.36969595e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.38102515e+03],
       [ 3.07753161e+03],
       [-4.71299816e+03],
       [-4.37829373e+00],
       [-2.29899259e+00],
       [-5.59269473e+00]]), 'covar': array([[ 1.77777381e-04, -1.27807684e-04,  3.96556234e-05,
         2.99050838e-07, -2.04533874e-08,  4.71451843e-08],
       [-1.27807684e-04,  1.20954590e-03, -2.23842375e-04,
         5.72144546e-08,  8.36066986e-07, -1.14289119e-07],
       [ 3.96556234e-05, -2.23842375e-04,  1.92975451e-04,
         7.20560872e-08, -8.90830411e-08,  2.21048711e-07],
       [ 2.99050838e-07,  5.72144546e-08,  7.20560872e-08,
         2.44270124e-09,  2.48993369e-10,  5.89168257e-10],
       [-2.04533874e-08,  8.36066986e-07, -8.90830411e-08,
         2.48993369e-10,  2.47189120e-09,  2.25091409e-10],
       [ 4.71451843e-08, -1.14289119e-07,  2.21048711e-07,
         5.89168257e-10,  2.25091409e-10,  3.36969595e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.39190607e-05],
       [ 2.02206447e-05],
       [-1.94540231e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.38098526e+03],
       [ 3.07768403e+03],
       [-4.71304513e+03],
       [-4.37843742e+00],
       [-2.29888234e+00],
       [-5.59283208e+00],
       [ 7.17165442e-01],
       [ 2.30792648e-01],
       [-6.37656935e-01],
       [ 1.60630368e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65716168e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.10965590e-03, -7.62419247e-03,  4.12402194e-03,
         2.05653602e-05,  7.40601914e-07,  2.43544005e-05],
       [-7.62419247e-03,  2.31818676e-02, -1.21114441e-02,
        -4.42189597e-05,  5.03533346e-06, -7.15359566e-05],
       [ 4.12402194e-03, -1.21114441e-02,  7.14109274e-03,
         2.39530007e-05,  1.18948345e-06,  4.48856831e-05],
       [ 2.05653602e-05, -4.42189597e-05,  2.39530007e-05,
         1.96374587e-07,  3.48257027e-10,  1.42393453e-07],
       [ 7.40601914e-07,  5.03533346e-06,  1.18948345e-06,
         3.48257027e-10,  1.78273937e-07,  1.12270004e-10],
       [ 2.43544005e-05, -7.15359566e-05,  4.48856831e-05,
         1.42393453e-07,  1.12270004e-10,  3.45216453e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.74122696e-05],
       [ 5.73231860e-06],
       [ 9.45520722e-02]])}}
Yi [[ 1.92639969]
 [-0.50149326]
 [13.36710296]]
posterior
[[ 4.38098526e+03]
 [ 3.07768403e+03]
 [-4.71304513e+03]
 [-4.37843742e+00]
 [-2.29888234e+00]
 [-5.59283208e+00]
 [ 7.17165442e-01]
 [ 2.30792648e-01]
 [-6.37656935e-01]
 [ 1.60630368e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65716168e-18]]
[[ 4.38098638e+03]
 [ 3.07768070e+03]
 [-4.71304558e+03]
 [-4.37842925e+00]
 [-2.29889212e+00]
 [-5.59284235e+00]
 [ 7.17165442e-01]
 [ 2.30792648e-01]
 [-6.37656935e-01]
 [ 1.60630368e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65716168e-18]]
[[ 3.04897268e-03 -7.60395489e-03  4.17056620e-03  1.99366605e-05
   8.21268739e-07  2.48716422e-05]
 [-7.60395489e-03  2.25199207e-02 -1.20292670e-02 -4.47760335e-05
   3.19715529e-06 -7.18038598e-05]
 [ 4.17056620e-03 -1.20292670e-02  7.09079166e-03  2.45495717e-05
   1.39756104e-06  4.45028731e-05]
 [ 1.99366605e-05 -4.47760335e-05  2.45495717e-05  1.88963742e-07
  -9.35545791e-10  1.47640834e-07]
 [ 8.21268739e-07  3.19715529e-06  1.39756104e-06 -9.35545791e-10
   1.73158905e-07 -8.40344572e-10]
 [ 2.48716422e-05 -7.18038598e-05  4.45028731e-05  1.47640834e-07
  -8.40344572e-10  3.40790875e-07]]
[[ 1.92639983]
 [-0.50148822]
 [13.34952641]]
[[-1.39077525e-07]
 [-5.03327876e-06]
 [ 1.75765557e-02]]


 Corrector Step
2018-07-13 19:35:30
[[ 4.38098638e+03]
 [ 3.07768070e+03]
 [-4.71304558e+03]
 [-4.37842925e+00]
 [-2.29889212e+00]
 [-5.59284235e+00]
 [ 7.17165442e-01]
 [ 2.30792648e-01]
 [-6.37656935e-01]
 [ 1.60630368e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65716168e-18]]
[[ 3.04897268e-03 -7.60395489e-03  4.17056620e-03  1.99366605e-05
   8.21268739e-07  2.48716422e-05]
 [-7.60395489e-03  2.25199207e-02 -1.20292670e-02 -4.47760335e-05
   3.19715529e-06 -7.18038598e-05]
 [ 4.17056620e-03 -1.20292670e-02  7.09079166e-03  2.45495717e-05
   1.39756104e-06  4.45028731e-05]
 [ 1.99366605e-05 -4.47760335e-05  2.45495717e-05  1.88963742e-07
  -9.35545791e-10  1.47640834e-07]
 [ 8.21268739e-07  3.19715529e-06  1.39756104e-06 -9.35545791e-10
   1.73158905e-07 -8.40344572e-10]
 [ 2.48716422e-05 -7.18038598e-05  4.45028731e-05  1.47640834e-07
  -8.40344572e-10  3.40790875e-07]]
834809029.1715004
post
cubesat_nadir
Ybar_post [[ 1.92639987]
 [-0.50148919]
 [13.34952422]]
resids [[-1.81335247e-07]
 [-4.06560817e-06]
 [ 1.75787407e-02]]
posterior
[[ 4.38102515e+03]
 [ 3.07753161e+03]
 [-4.71299816e+03]
 [-4.37829373e+00]
 [-2.29899259e+00]
 [-5.59269473e+00]]
[[ 4.38102560e+03]
 [ 3.07753610e+03]
 [-4.71299792e+03]
 [-4.37829145e+00]
 [-2.29898871e+00]
 [-5.59269367e+00]]
[[ 1.70295704e-04 -1.36724032e-04  4.29943578e-05  2.83869206e-07
  -2.91104566e-08  4.94764110e-08]
 [-1.36724032e-04  1.12706261e-03 -2.26209676e-04  1.49504688e-08
   7.65502660e-07 -1.31106300e-07]
 [ 4.29943578e-05 -2.26209676e-04  1.90925013e-04  7.66962124e-08
  -9.05406901e-08  2.18277733e-07]
 [ 2.83869206e-07  1.49504688e-08  7.66962124e-08  2.40376441e-09
   2.11160836e-10  5.87307242e-10]
 [-2.91104566e-08  7.65502660e-07 -9.05406901e-08  2.11160836e-10
   2.41136103e-09  2.11359462e-10]
 [ 4.94764110e-08 -1.31106300e-07  2.18277733e-07  5.87307242e-10
   2.11359462e-10  3.36362584e-09]]
[[ 1.92640805]
 [-0.50150403]
 [15.29817009]]
[[-8.36451850e-06]
 [ 1.07768533e-05]
 [-1.93106713e+00]]


 Corrector Step
2018-07-13 19:35:30
[[ 4.38102560e+03]
 [ 3.07753610e+03]
 [-4.71299792e+03]
 [-4.37829145e+00]
 [-2.29898871e+00]
 [-5.59269367e+00]]
[[ 1.70295704e-04 -1.36724032e-04  4.29943578e-05  2.83869206e-07
  -2.91104566e-08  4.94764110e-08]
 [-1.36724032e-04  1.12706261e-03 -2.26209676e-04  1.49504688e-08
   7.65502660e-07 -1.31106300e-07]
 [ 4.29943578e-05 -2.26209676e-04  1.90925013e-04  7.66962124e-08
  -9.05406901e-08  2.18277733e-07]
 [ 2.83869206e-07  1.49504688e-08  7.66962124e-08  2.40376441e-09
   2.11160836e-10  5.87307242e-10]
 [-2.91104566e-08  7.65502660e-07 -9.05406901e-08  2.11160836e-10
   2.41136103e-09  2.11359462e-10]
 [ 4.94764110e-08 -1.31106300e-07  2.18277733e-07  5.87307242e-10
   2.11359462e-10  3.36362584e-09]]
9.08790663753415e-73
post
sphere_lamr_small
Ybar_post [[ 1.92640703]
 [-0.50150303]
 [15.2981777 ]]
resids [[-7.33879928e-06]
 [ 9.77757843e-06]
 [-1.93107474e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [834809029.1715004, 9.08790663753415e-73]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.38098638e+03],
       [ 3.07768070e+03],
       [-4.71304558e+03],
       [-4.37842925e+00],
       [-2.29889212e+00],
       [-5.59284235e+00]]), 'est_covars': array([[ 3.04897268e-03, -7.60395489e-03,  4.17056620e-03,
         1.99366605e-05,  8.21268739e-07,  2.48716422e-05],
       [-7.60395489e-03,  2.25199207e-02, -1.20292670e-02,
        -4.47760335e-05,  3.19715529e-06, -7.18038598e-05],
       [ 4.17056620e-03, -1.20292670e-02,  7.09079166e-03,
         2.45495717e-05,  1.39756104e-06,  4.45028731e-05],
       [ 1.99366605e-05, -4.47760335e-05,  2.45495717e-05,
         1.88963742e-07, -9.35545791e-10,  1.47640834e-07],
       [ 8.21268739e-07,  3.19715529e-06,  1.39756104e-06,
        -9.35545791e-10,  1.73158905e-07, -8.40344572e-10],
       [ 2.48716422e-05, -7.18038598e-05,  4.45028731e-05,
         1.47640834e-07, -8.40344572e-10,  3.40790875e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.38102560e+03],
       [ 3.07753610e+03],
       [-4.71299792e+03],
       [-4.37829145e+00],
       [-2.29898871e+00],
       [-5.59269367e+00]]), 'covar': array([[ 1.70295704e-04, -1.36724032e-04,  4.29943578e-05,
         2.83869206e-07, -2.91104566e-08,  4.94764110e-08],
       [-1.36724032e-04,  1.12706261e-03, -2.26209676e-04,
         1.49504688e-08,  7.65502660e-07, -1.31106300e-07],
       [ 4.29943578e-05, -2.26209676e-04,  1.90925013e-04,
         7.66962124e-08, -9.05406901e-08,  2.18277733e-07],
       [ 2.83869206e-07,  1.49504688e-08,  7.66962124e-08,
         2.40376441e-09,  2.11160836e-10,  5.87307242e-10],
       [-2.91104566e-08,  7.65502660e-07, -9.05406901e-08,
         2.11160836e-10,  2.41136103e-09,  2.11359462e-10],
       [ 4.94764110e-08, -1.31106300e-07,  2.18277733e-07,
         5.87307242e-10,  2.11359462e-10,  3.36362584e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-7.33879928e-06],
       [ 9.77757843e-06],
       [-1.93107474e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.38098638e+03],
       [ 3.07768070e+03],
       [-4.71304558e+03],
       [-4.37842925e+00],
       [-2.29889212e+00],
       [-5.59284235e+00],
       [ 7.17165442e-01],
       [ 2.30792648e-01],
       [-6.37656935e-01],
       [ 1.60630368e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65716168e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.04897268e-03, -7.60395489e-03,  4.17056620e-03,
         1.99366605e-05,  8.21268739e-07,  2.48716422e-05],
       [-7.60395489e-03,  2.25199207e-02, -1.20292670e-02,
        -4.47760335e-05,  3.19715529e-06, -7.18038598e-05],
       [ 4.17056620e-03, -1.20292670e-02,  7.09079166e-03,
         2.45495717e-05,  1.39756104e-06,  4.45028731e-05],
       [ 1.99366605e-05, -4.47760335e-05,  2.45495717e-05,
         1.88963742e-07, -9.35545791e-10,  1.47640834e-07],
       [ 8.21268739e-07,  3.19715529e-06,  1.39756104e-06,
        -9.35545791e-10,  1.73158905e-07, -8.40344572e-10],
       [ 2.48716422e-05, -7.18038598e-05,  4.45028731e-05,
         1.47640834e-07, -8.40344572e-10,  3.40790875e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.81335247e-07],
       [-4.06560817e-06],
       [ 1.75787407e-02]])}}
Current time:  2018-07-13 19:35:40
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.38098638e+03],
       [ 3.07768070e+03],
       [-4.71304558e+03],
       [-4.37842925e+00],
       [-2.29889212e+00],
       [-5.59284235e+00],
       [ 7.17165442e-01],
       [ 2.30792648e-01],
       [-6.37656935e-01],
       [ 1.60630368e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65716168e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.04897268e-03, -7.60395489e-03,  4.17056620e-03,
         1.99366605e-05,  8.21268739e-07,  2.48716422e-05],
       [-7.60395489e-03,  2.25199207e-02, -1.20292670e-02,
        -4.47760335e-05,  3.19715529e-06, -7.18038598e-05],
       [ 4.17056620e-03, -1.20292670e-02,  7.09079166e-03,
         2.45495717e-05,  1.39756104e-06,  4.45028731e-05],
       [ 1.99366605e-05, -4.47760335e-05,  2.45495717e-05,
         1.88963742e-07, -9.35545791e-10,  1.47640834e-07],
       [ 8.21268739e-07,  3.19715529e-06,  1.39756104e-06,
        -9.35545791e-10,  1.73158905e-07, -8.40344572e-10],
       [ 2.48716422e-05, -7.18038598e-05,  4.45028731e-05,
         1.47640834e-07, -8.40344572e-10,  3.40790875e-07]])}
[[ 4.38098638e+03]
 [ 3.07768070e+03]
 [-4.71304558e+03]
 [-4.37842925e+00]
 [-2.29889212e+00]
 [-5.59284235e+00]
 [ 7.17165442e-01]
 [ 2.30792648e-01]
 [-6.37656935e-01]
 [ 1.60630368e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65716168e-18]]
2018-07-13 19:35:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:40
[[ 4.33696265e+03]
 [ 3.05452339e+03]
 [-4.76871362e+03]
 [-4.42623018e+00]
 [-2.33251522e+00]
 [-5.54071819e+00]
 [ 7.13826260e-01]
 [ 2.29950801e-01]
 [-6.41392789e-01]
 [ 1.61833219e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65737397e-18]]
[[ 3.46560165e-03 -8.04171764e-03  4.67871616e-03  2.17469652e-05
   8.37574749e-07  2.63893537e-05]
 [-8.04171764e-03  2.26008257e-02 -1.27340982e-02 -4.44345103e-05
   4.91697301e-06 -7.19642512e-05]
 [ 4.67871616e-03 -1.27340982e-02  8.01632101e-03  2.58191665e-05
   1.41750015e-06  4.80504820e-05]
 [ 2.17469652e-05 -4.44345103e-05  2.58191665e-05  1.97574397e-07
  -7.57491377e-10  1.46667982e-07]
 [ 8.37574749e-07  4.91697301e-06  1.41750015e-06 -7.57491377e-10
   1.83107123e-07 -7.46173534e-10]
 [ 2.63893537e-05 -7.19642512e-05  4.80504820e-05  1.46667982e-07
  -7.46173534e-10  3.51793283e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.38102560e+03],
       [ 3.07753610e+03],
       [-4.71299792e+03],
       [-4.37829145e+00],
       [-2.29898871e+00],
       [-5.59269367e+00]]), 'covar': array([[ 1.70295704e-04, -1.36724032e-04,  4.29943578e-05,
         2.83869206e-07, -2.91104566e-08,  4.94764110e-08],
       [-1.36724032e-04,  1.12706261e-03, -2.26209676e-04,
         1.49504688e-08,  7.65502660e-07, -1.31106300e-07],
       [ 4.29943578e-05, -2.26209676e-04,  1.90925013e-04,
         7.66962124e-08, -9.05406901e-08,  2.18277733e-07],
       [ 2.83869206e-07,  1.49504688e-08,  7.66962124e-08,
         2.40376441e-09,  2.11160836e-10,  5.87307242e-10],
       [-2.91104566e-08,  7.65502660e-07, -9.05406901e-08,
         2.11160836e-10,  2.41136103e-09,  2.11359462e-10],
       [ 4.94764110e-08, -1.31106300e-07,  2.18277733e-07,
         5.87307242e-10,  2.11359462e-10,  3.36362584e-09]])}
[[ 4.38102560e+03]
 [ 3.07753610e+03]
 [-4.71299792e+03]
 [-4.37829145e+00]
 [-2.29898871e+00]
 [-5.59269367e+00]]
2018-07-13 19:35:30
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:40
[[ 4.33700307e+03]
 [ 3.05437791e+03]
 [-4.76866453e+03]
 [-4.42609419e+00]
 [-2.33261114e+00]
 [-5.54056833e+00]]
[[ 1.76374673e-04 -1.36780119e-04  4.41214098e-05  3.06825355e-07
  -2.53051110e-08  5.42724231e-08]
 [-1.36780119e-04  1.14256939e-03 -2.28448146e-04  2.97563977e-08
   7.85481416e-07 -1.38699989e-07]
 [ 4.41214098e-05 -2.28448146e-04  1.95810428e-04  7.80766577e-08
  -8.86951625e-08  2.54840744e-07]
 [ 3.06825355e-07  2.97563977e-08  7.80766577e-08  2.50284261e-09
   2.20733742e-10  5.79205898e-10]
 [-2.53051110e-08  7.85481416e-07 -8.86951625e-08  2.20733742e-10
   2.50503570e-09  2.03088994e-10]
 [ 5.42724231e-08 -1.38699989e-07  2.54840744e-07  5.79205898e-10
   2.03088994e-10  3.46664281e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 30), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.33700307e+03],
       [ 3.05437791e+03],
       [-4.76866453e+03],
       [-4.42609419e+00],
       [-2.33261114e+00],
       [-5.54056833e+00]]), 'covar': array([[ 1.76374673e-04, -1.36780119e-04,  4.41214098e-05,
         3.06825355e-07, -2.53051110e-08,  5.42724231e-08],
       [-1.36780119e-04,  1.14256939e-03, -2.28448146e-04,
         2.97563977e-08,  7.85481416e-07, -1.38699989e-07],
       [ 4.41214098e-05, -2.28448146e-04,  1.95810428e-04,
         7.80766577e-08, -8.86951625e-08,  2.54840744e-07],
       [ 3.06825355e-07,  2.97563977e-08,  7.80766577e-08,
         2.50284261e-09,  2.20733742e-10,  5.79205898e-10],
       [-2.53051110e-08,  7.85481416e-07, -8.86951625e-08,
         2.20733742e-10,  2.50503570e-09,  2.03088994e-10],
       [ 5.42724231e-08, -1.38699989e-07,  2.54840744e-07,
         5.79205898e-10,  2.03088994e-10,  3.46664281e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-7.33879928e-06],
       [ 9.77757843e-06],
       [-1.93107474e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 30), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.33696265e+03],
       [ 3.05452339e+03],
       [-4.76871362e+03],
       [-4.42623018e+00],
       [-2.33251522e+00],
       [-5.54071819e+00],
       [ 7.13826260e-01],
       [ 2.29950801e-01],
       [-6.41392789e-01],
       [ 1.61833219e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65737397e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.46560165e-03, -8.04171764e-03,  4.67871616e-03,
         2.17469652e-05,  8.37574749e-07,  2.63893537e-05],
       [-8.04171764e-03,  2.26008257e-02, -1.27340982e-02,
        -4.44345103e-05,  4.91697301e-06, -7.19642512e-05],
       [ 4.67871616e-03, -1.27340982e-02,  8.01632101e-03,
         2.58191665e-05,  1.41750015e-06,  4.80504820e-05],
       [ 2.17469652e-05, -4.44345103e-05,  2.58191665e-05,
         1.97574397e-07, -7.57491377e-10,  1.46667982e-07],
       [ 8.37574749e-07,  4.91697301e-06,  1.41750015e-06,
        -7.57491377e-10,  1.83107123e-07, -7.46173534e-10],
       [ 2.63893537e-05, -7.19642512e-05,  4.80504820e-05,
         1.46667982e-07, -7.46173534e-10,  3.51793283e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.81335247e-07],
       [-4.06560817e-06],
       [ 1.75787407e-02]])}}
Yi [[ 1.9527527 ]
 [-0.52594781]
 [13.32910438]]
posterior
[[ 4.33696265e+03]
 [ 3.05452339e+03]
 [-4.76871362e+03]
 [-4.42623018e+00]
 [-2.33251522e+00]
 [-5.54071819e+00]
 [ 7.13826260e-01]
 [ 2.29950801e-01]
 [-6.41392789e-01]
 [ 1.61833219e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65737397e-18]]
[[ 4.33696014e+03]
 [ 3.05453521e+03]
 [-4.76871354e+03]
 [-4.42624201e+00]
 [-2.33247745e+00]
 [-5.54069615e+00]
 [ 7.13826260e-01]
 [ 2.29950801e-01]
 [-6.41392789e-01]
 [ 1.61833219e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65737397e-18]]
[[ 3.41138810e-03 -8.01830895e-03  4.72574104e-03  2.11908704e-05
   9.61554602e-07  2.69038524e-05]
 [-8.01830895e-03  2.19614782e-02 -1.26260132e-02 -4.50147600e-05
   3.01122741e-06 -7.20292564e-05]
 [ 4.72574104e-03 -1.26260132e-02  7.94929661e-03  2.64689420e-05
   1.68771449e-06  4.75717920e-05]
 [ 2.11908704e-05 -4.50147600e-05  2.64689420e-05  1.90800695e-07
  -1.90042902e-09  1.52150616e-07]
 [ 9.61554602e-07  3.01122741e-06  1.68771449e-06 -1.90042902e-09
   1.77370727e-07 -1.46173264e-09]
 [ 2.69038524e-05 -7.20292564e-05  4.75717920e-05  1.52150616e-07
  -1.46173264e-09  3.46868161e-07]]
[[ 1.95275688]
 [-0.52596223]
 [13.3790319 ]]
[[-4.18411803e-06]
 [ 1.44199373e-05]
 [-4.99275166e-02]]


 Corrector Step
2018-07-13 19:35:40
[[ 4.33696014e+03]
 [ 3.05453521e+03]
 [-4.76871354e+03]
 [-4.42624201e+00]
 [-2.33247745e+00]
 [-5.54069615e+00]
 [ 7.13826260e-01]
 [ 2.29950801e-01]
 [-6.41392789e-01]
 [ 1.61833219e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65737397e-18]]
[[ 3.41138810e-03 -8.01830895e-03  4.72574104e-03  2.11908704e-05
   9.61554602e-07  2.69038524e-05]
 [-8.01830895e-03  2.19614782e-02 -1.26260132e-02 -4.50147600e-05
   3.01122741e-06 -7.20292564e-05]
 [ 4.72574104e-03 -1.26260132e-02  7.94929661e-03  2.64689420e-05
   1.68771449e-06  4.75717920e-05]
 [ 2.11908704e-05 -4.50147600e-05  2.64689420e-05  1.90800695e-07
  -1.90042902e-09  1.52150616e-07]
 [ 9.61554602e-07  3.01122741e-06  1.68771449e-06 -1.90042902e-09
   1.77370727e-07 -1.46173264e-09]
 [ 2.69038524e-05 -7.20292564e-05  4.75717920e-05  1.52150616e-07
  -1.46173264e-09  3.46868161e-07]]
654377865.4875444
post
cubesat_nadir
Ybar_post [[ 1.95275581]
 [-0.52595945]
 [13.37904067]]
resids [[-3.11646285e-06]
 [ 1.16481836e-05]
 [-4.99362937e-02]]
posterior
[[ 4.33700307e+03]
 [ 3.05437791e+03]
 [-4.76866453e+03]
 [-4.42609419e+00]
 [-2.33261114e+00]
 [-5.54056833e+00]]
[[ 4.33700302e+03]
 [ 3.05438818e+03]
 [-4.76866379e+03]
 [-4.42609071e+00]
 [-2.33260246e+00]
 [-5.54056527e+00]]
[[ 1.69579568e-04 -1.44138716e-04  4.74429881e-05  2.92664155e-07
  -3.25668856e-08  5.73517151e-08]
 [-1.44138716e-04  1.06327311e-03 -2.29231932e-04 -1.01597029e-08
   7.17600000e-07 -1.55408876e-07]
 [ 4.74429881e-05 -2.29231932e-04  1.93917693e-04  8.34892215e-08
  -8.88316452e-08  2.52104455e-07]
 [ 2.92664155e-07 -1.01597029e-08  8.34892215e-08  2.46485939e-09
   1.84917025e-10  5.78715905e-10]
 [-3.25668856e-08  7.17600000e-07 -8.88316452e-08  1.84917025e-10
   2.44677439e-09  1.89514412e-10]
 [ 5.73517151e-08 -1.55408876e-07  2.52104455e-07  5.78715905e-10
   1.89514412e-10  3.45961497e-09]]
[[ 1.95276582]
 [-0.52597728]
 [15.23582458]]
[[-1.31248147e-05]
 [ 2.94701101e-05]
 [-1.90672020e+00]]


 Corrector Step
2018-07-13 19:35:40
[[ 4.33700302e+03]
 [ 3.05438818e+03]
 [-4.76866379e+03]
 [-4.42609071e+00]
 [-2.33260246e+00]
 [-5.54056527e+00]]
[[ 1.69579568e-04 -1.44138716e-04  4.74429881e-05  2.92664155e-07
  -3.25668856e-08  5.73517151e-08]
 [-1.44138716e-04  1.06327311e-03 -2.29231932e-04 -1.01597029e-08
   7.17600000e-07 -1.55408876e-07]
 [ 4.74429881e-05 -2.29231932e-04  1.93917693e-04  8.34892215e-08
  -8.88316452e-08  2.52104455e-07]
 [ 2.92664155e-07 -1.01597029e-08  8.34892215e-08  2.46485939e-09
   1.84917025e-10  5.78715905e-10]
 [-3.25668856e-08  7.17600000e-07 -8.88316452e-08  1.84917025e-10
   2.44677439e-09  1.89514412e-10]
 [ 5.73517151e-08 -1.55408876e-07  2.52104455e-07  5.78715905e-10
   1.89514412e-10  3.45961497e-09]]
5.029993280531973e-71
post
sphere_lamr_small
Ybar_post [[ 1.95276377]
 [-0.52597481]
 [15.23584043]]
resids [[-1.10725047e-05]
 [ 2.69998532e-05]
 [-1.90673605e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [654377865.4875444, 5.029993280531973e-71]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.33696014e+03],
       [ 3.05453521e+03],
       [-4.76871354e+03],
       [-4.42624201e+00],
       [-2.33247745e+00],
       [-5.54069615e+00]]), 'est_covars': array([[ 3.41138810e-03, -8.01830895e-03,  4.72574104e-03,
         2.11908704e-05,  9.61554602e-07,  2.69038524e-05],
       [-8.01830895e-03,  2.19614782e-02, -1.26260132e-02,
        -4.50147600e-05,  3.01122741e-06, -7.20292564e-05],
       [ 4.72574104e-03, -1.26260132e-02,  7.94929661e-03,
         2.64689420e-05,  1.68771449e-06,  4.75717920e-05],
       [ 2.11908704e-05, -4.50147600e-05,  2.64689420e-05,
         1.90800695e-07, -1.90042902e-09,  1.52150616e-07],
       [ 9.61554602e-07,  3.01122741e-06,  1.68771449e-06,
        -1.90042902e-09,  1.77370727e-07, -1.46173264e-09],
       [ 2.69038524e-05, -7.20292564e-05,  4.75717920e-05,
         1.52150616e-07, -1.46173264e-09,  3.46868161e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.33700302e+03],
       [ 3.05438818e+03],
       [-4.76866379e+03],
       [-4.42609071e+00],
       [-2.33260246e+00],
       [-5.54056527e+00]]), 'covar': array([[ 1.69579568e-04, -1.44138716e-04,  4.74429881e-05,
         2.92664155e-07, -3.25668856e-08,  5.73517151e-08],
       [-1.44138716e-04,  1.06327311e-03, -2.29231932e-04,
        -1.01597029e-08,  7.17600000e-07, -1.55408876e-07],
       [ 4.74429881e-05, -2.29231932e-04,  1.93917693e-04,
         8.34892215e-08, -8.88316452e-08,  2.52104455e-07],
       [ 2.92664155e-07, -1.01597029e-08,  8.34892215e-08,
         2.46485939e-09,  1.84917025e-10,  5.78715905e-10],
       [-3.25668856e-08,  7.17600000e-07, -8.88316452e-08,
         1.84917025e-10,  2.44677439e-09,  1.89514412e-10],
       [ 5.73517151e-08, -1.55408876e-07,  2.52104455e-07,
         5.78715905e-10,  1.89514412e-10,  3.45961497e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.10725047e-05],
       [ 2.69998532e-05],
       [-1.90673605e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.33696014e+03],
       [ 3.05453521e+03],
       [-4.76871354e+03],
       [-4.42624201e+00],
       [-2.33247745e+00],
       [-5.54069615e+00],
       [ 7.13826260e-01],
       [ 2.29950801e-01],
       [-6.41392789e-01],
       [ 1.61833219e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65737397e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.41138810e-03, -8.01830895e-03,  4.72574104e-03,
         2.11908704e-05,  9.61554602e-07,  2.69038524e-05],
       [-8.01830895e-03,  2.19614782e-02, -1.26260132e-02,
        -4.50147600e-05,  3.01122741e-06, -7.20292564e-05],
       [ 4.72574104e-03, -1.26260132e-02,  7.94929661e-03,
         2.64689420e-05,  1.68771449e-06,  4.75717920e-05],
       [ 2.11908704e-05, -4.50147600e-05,  2.64689420e-05,
         1.90800695e-07, -1.90042902e-09,  1.52150616e-07],
       [ 9.61554602e-07,  3.01122741e-06,  1.68771449e-06,
        -1.90042902e-09,  1.77370727e-07, -1.46173264e-09],
       [ 2.69038524e-05, -7.20292564e-05,  4.75717920e-05,
         1.52150616e-07, -1.46173264e-09,  3.46868161e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.11646285e-06],
       [ 1.16481836e-05],
       [-4.99362937e-02]])}}
Current time:  2018-07-13 19:35:50
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.33696014e+03],
       [ 3.05453521e+03],
       [-4.76871354e+03],
       [-4.42624201e+00],
       [-2.33247745e+00],
       [-5.54069615e+00],
       [ 7.13826260e-01],
       [ 2.29950801e-01],
       [-6.41392789e-01],
       [ 1.61833219e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65737397e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.41138810e-03, -8.01830895e-03,  4.72574104e-03,
         2.11908704e-05,  9.61554602e-07,  2.69038524e-05],
       [-8.01830895e-03,  2.19614782e-02, -1.26260132e-02,
        -4.50147600e-05,  3.01122741e-06, -7.20292564e-05],
       [ 4.72574104e-03, -1.26260132e-02,  7.94929661e-03,
         2.64689420e-05,  1.68771449e-06,  4.75717920e-05],
       [ 2.11908704e-05, -4.50147600e-05,  2.64689420e-05,
         1.90800695e-07, -1.90042902e-09,  1.52150616e-07],
       [ 9.61554602e-07,  3.01122741e-06,  1.68771449e-06,
        -1.90042902e-09,  1.77370727e-07, -1.46173264e-09],
       [ 2.69038524e-05, -7.20292564e-05,  4.75717920e-05,
         1.52150616e-07, -1.46173264e-09,  3.46868161e-07]])}
[[ 4.33696014e+03]
 [ 3.05453521e+03]
 [-4.76871354e+03]
 [-4.42624201e+00]
 [-2.33247745e+00]
 [-5.54069615e+00]
 [ 7.13826260e-01]
 [ 2.29950801e-01]
 [-6.41392789e-01]
 [ 1.61833219e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65737397e-18]]
2018-07-13 19:35:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:50
[[ 4.29246063e+03]
 [ 3.03104338e+03]
 [-4.82385737e+03]
 [-4.47355127e+00]
 [-2.36584060e+00]
 [-5.48796960e+00]
 [ 7.10467617e-01]
 [ 2.29102684e-01]
 [-6.45111156e-01]
 [ 1.63031658e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65758626e-18]]
[[ 3.85325542e-03 -8.45714048e-03  5.27381405e-03  2.30087155e-05
   9.67983167e-07  2.84694140e-05]
 [-8.45714048e-03  2.20391156e-02 -1.33301761e-02 -4.46814843e-05
   4.77764753e-06 -7.21923161e-05]
 [ 5.27381405e-03 -1.33301761e-02  8.93658284e-03  2.77677943e-05
   1.70099020e-06  5.11846303e-05]
 [ 2.30087155e-05 -4.46814843e-05  2.77677943e-05  1.99360733e-07
  -1.73467274e-09  1.51143360e-07]
 [ 9.67983167e-07  4.77764753e-06  1.70099020e-06 -1.73467274e-09
   1.87316364e-07 -1.37612609e-09]
 [ 2.84694140e-05 -7.21923161e-05  5.11846303e-05  1.51143360e-07
  -1.37612609e-09  3.57880178e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.33700302e+03],
       [ 3.05438818e+03],
       [-4.76866379e+03],
       [-4.42609071e+00],
       [-2.33260246e+00],
       [-5.54056527e+00]]), 'covar': array([[ 1.69579568e-04, -1.44138716e-04,  4.74429881e-05,
         2.92664155e-07, -3.25668856e-08,  5.73517151e-08],
       [-1.44138716e-04,  1.06327311e-03, -2.29231932e-04,
        -1.01597029e-08,  7.17600000e-07, -1.55408876e-07],
       [ 4.74429881e-05, -2.29231932e-04,  1.93917693e-04,
         8.34892215e-08, -8.88316452e-08,  2.52104455e-07],
       [ 2.92664155e-07, -1.01597029e-08,  8.34892215e-08,
         2.46485939e-09,  1.84917025e-10,  5.78715905e-10],
       [-3.25668856e-08,  7.17600000e-07, -8.88316452e-08,
         1.84917025e-10,  2.44677439e-09,  1.89514412e-10],
       [ 5.73517151e-08, -1.55408876e-07,  2.52104455e-07,
         5.78715905e-10,  1.89514412e-10,  3.45961497e-09]])}
[[ 4.33700302e+03]
 [ 3.05438818e+03]
 [-4.76866379e+03]
 [-4.42609071e+00]
 [-2.33260246e+00]
 [-5.54056527e+00]]
2018-07-13 19:35:40
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:35:50
[[ 4.29250490e+03]
 [ 3.03089503e+03]
 [-4.82380656e+03]
 [-4.47340182e+00]
 [-2.36596505e+00]
 [-5.48783750e+00]]
[[ 1.75819740e-04 -1.44382142e-04  4.90282695e-05  3.15987948e-07
  -2.89683175e-08  6.21718233e-08]
 [-1.44382142e-04  1.07787972e-03 -2.31609318e-04  3.64946892e-09
   7.38130508e-07 -1.62739477e-07]
 [ 4.90282695e-05 -2.31609318e-04  1.99467615e-04  8.45803391e-08
  -8.72958108e-08  2.89368916e-07]
 [ 3.15987948e-07  3.64946892e-09  8.45803391e-08  2.56328584e-09
   1.94035526e-10  5.70237818e-10]
 [-2.89683175e-08  7.38130508e-07 -8.72958108e-08  1.94035526e-10
   2.54064665e-09  1.81471120e-10]
 [ 6.21718233e-08 -1.62739477e-07  2.89368916e-07  5.70237818e-10
   1.81471120e-10  3.56332805e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 40), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.29250490e+03],
       [ 3.03089503e+03],
       [-4.82380656e+03],
       [-4.47340182e+00],
       [-2.36596505e+00],
       [-5.48783750e+00]]), 'covar': array([[ 1.75819740e-04, -1.44382142e-04,  4.90282695e-05,
         3.15987948e-07, -2.89683175e-08,  6.21718233e-08],
       [-1.44382142e-04,  1.07787972e-03, -2.31609318e-04,
         3.64946892e-09,  7.38130508e-07, -1.62739477e-07],
       [ 4.90282695e-05, -2.31609318e-04,  1.99467615e-04,
         8.45803391e-08, -8.72958108e-08,  2.89368916e-07],
       [ 3.15987948e-07,  3.64946892e-09,  8.45803391e-08,
         2.56328584e-09,  1.94035526e-10,  5.70237818e-10],
       [-2.89683175e-08,  7.38130508e-07, -8.72958108e-08,
         1.94035526e-10,  2.54064665e-09,  1.81471120e-10],
       [ 6.21718233e-08, -1.62739477e-07,  2.89368916e-07,
         5.70237818e-10,  1.81471120e-10,  3.56332805e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.10725047e-05],
       [ 2.69998532e-05],
       [-1.90673605e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 40), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.29246063e+03],
       [ 3.03104338e+03],
       [-4.82385737e+03],
       [-4.47355127e+00],
       [-2.36584060e+00],
       [-5.48796960e+00],
       [ 7.10467617e-01],
       [ 2.29102684e-01],
       [-6.45111156e-01],
       [ 1.63031658e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65758626e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.85325542e-03, -8.45714048e-03,  5.27381405e-03,
         2.30087155e-05,  9.67983167e-07,  2.84694140e-05],
       [-8.45714048e-03,  2.20391156e-02, -1.33301761e-02,
        -4.46814843e-05,  4.77764753e-06, -7.21923161e-05],
       [ 5.27381405e-03, -1.33301761e-02,  8.93658284e-03,
         2.77677943e-05,  1.70099020e-06,  5.11846303e-05],
       [ 2.30087155e-05, -4.46814843e-05,  2.77677943e-05,
         1.99360733e-07, -1.73467274e-09,  1.51143360e-07],
       [ 9.67983167e-07,  4.77764753e-06,  1.70099020e-06,
        -1.73467274e-09,  1.87316364e-07, -1.37612609e-09],
       [ 2.84694140e-05, -7.21923161e-05,  5.11846303e-05,
         1.51143360e-07, -1.37612609e-09,  3.57880178e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-3.11646285e-06],
       [ 1.16481836e-05],
       [-4.99362937e-02]])}}
Yi [[ 1.97967083]
 [-0.54951652]
 [13.42359917]]
posterior
[[ 4.29246063e+03]
 [ 3.03104338e+03]
 [-4.82385737e+03]
 [-4.47355127e+00]
 [-2.36584060e+00]
 [-5.48796960e+00]
 [ 7.10467617e-01]
 [ 2.29102684e-01]
 [-6.45111156e-01]
 [ 1.63031658e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65758626e-18]]
[[ 4.29246216e+03]
 [ 3.03103094e+03]
 [-4.82385574e+03]
 [-4.47355254e+00]
 [-2.36588167e+00]
 [-5.48797737e+00]
 [ 7.10467617e-01]
 [ 2.29102684e-01]
 [-6.45111156e-01]
 [ 1.63031658e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65758626e-18]]
[[ 3.80499698e-03 -8.42767589e-03  5.31921766e-03  2.25237838e-05
   1.14192219e-06  2.89668833e-05]
 [-8.42767589e-03  2.14099539e-02 -1.31937935e-02 -4.52715565e-05
   2.78893341e-06 -7.20592497e-05]
 [ 5.31921766e-03 -1.31937935e-02  8.84975740e-03  2.84620191e-05
   2.04260334e-06  5.05989138e-05]
 [ 2.25237838e-05 -4.52715565e-05  2.84620191e-05  1.93202941e-07
  -2.71612472e-09  1.56775945e-07]
 [ 1.14192219e-06  2.78893341e-06  2.04260334e-06 -2.71612472e-09
   1.80890007e-07 -1.82556280e-09]
 [ 2.89668833e-05 -7.20592497e-05  5.05989138e-05  1.56775945e-07
  -1.82556280e-09  3.52436422e-07]]
[[ 1.97966266]
 [-0.54950508]
 [13.41297007]]
[[ 8.17305057e-06]
 [-1.14347024e-05]
 [ 1.06290994e-02]]


 Corrector Step
2018-07-13 19:35:50
[[ 4.29246216e+03]
 [ 3.03103094e+03]
 [-4.82385574e+03]
 [-4.47355254e+00]
 [-2.36588167e+00]
 [-5.48797737e+00]
 [ 7.10467617e-01]
 [ 2.29102684e-01]
 [-6.45111156e-01]
 [ 1.63031658e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65758626e-18]]
[[ 3.80499698e-03 -8.42767589e-03  5.31921766e-03  2.25237838e-05
   1.14192219e-06  2.89668833e-05]
 [-8.42767589e-03  2.14099539e-02 -1.31937935e-02 -4.52715565e-05
   2.78893341e-06 -7.20592497e-05]
 [ 5.31921766e-03 -1.31937935e-02  8.84975740e-03  2.84620191e-05
   2.04260334e-06  5.05989138e-05]
 [ 2.25237838e-05 -4.52715565e-05  2.84620191e-05  1.93202941e-07
  -2.71612472e-09  1.56775945e-07]
 [ 1.14192219e-06  2.78893341e-06  2.04260334e-06 -2.71612472e-09
   1.80890007e-07 -1.82556280e-09]
 [ 2.89668833e-05 -7.20592497e-05  5.05989138e-05  1.56775945e-07
  -1.82556280e-09  3.52436422e-07]]
753772055.5236894
post
cubesat_nadir
Ybar_post [[ 1.97966456]
 [-0.54950733]
 [13.41296174]]
resids [[ 6.27075376e-06]
 [-9.18654717e-06]
 [ 1.06374247e-02]]
posterior
[[ 4.29250490e+03]
 [ 3.03089503e+03]
 [-4.82380656e+03]
 [-4.47340182e+00]
 [-2.36596505e+00]
 [-5.48783750e+00]]
[[ 4.29250482e+03]
 [ 3.03089645e+03]
 [-4.82380638e+03]
 [-4.47340142e+00]
 [-2.36596382e+00]
 [-5.48783690e+00]]
[[ 1.69610125e-04 -1.50391307e-04  5.22816787e-05  3.02699089e-07
  -3.50302217e-08  6.59542670e-08]
 [-1.50391307e-04  1.00218663e-03 -2.31089081e-04 -3.38708018e-08
   6.73131024e-07 -1.78970150e-07]
 [ 5.22816787e-05 -2.31089081e-04  1.97664187e-04  9.06152842e-08
  -8.63438378e-08  2.86639031e-07]
 [ 3.02699089e-07 -3.38708018e-08  9.06152842e-08  2.52614426e-09
   1.60194248e-10  5.71312734e-10]
 [-3.50302217e-08  6.73131024e-07 -8.63438378e-08  1.60194248e-10
   2.48468820e-09  1.68331063e-10]
 [ 6.59542670e-08 -1.78970150e-07  2.86639031e-07  5.71312734e-10
   1.68331063e-10  3.55536195e-09]]
[[ 1.9796724 ]
 [-0.54952187]
 [15.17828321]]
[[-1.57230885e-06]
 [ 5.35145570e-06]
 [-1.75468405e+00]]


 Corrector Step
2018-07-13 19:35:50
[[ 4.29250482e+03]
 [ 3.03089645e+03]
 [-4.82380638e+03]
 [-4.47340142e+00]
 [-2.36596382e+00]
 [-5.48783690e+00]]
[[ 1.69610125e-04 -1.50391307e-04  5.22816787e-05  3.02699089e-07
  -3.50302217e-08  6.59542670e-08]
 [-1.50391307e-04  1.00218663e-03 -2.31089081e-04 -3.38708018e-08
   6.73131024e-07 -1.78970150e-07]
 [ 5.22816787e-05 -2.31089081e-04  1.97664187e-04  9.06152842e-08
  -8.63438378e-08  2.86639031e-07]
 [ 3.02699089e-07 -3.38708018e-08  9.06152842e-08  2.52614426e-09
   1.60194248e-10  5.71312734e-10]
 [-3.50302217e-08  6.73131024e-07 -8.63438378e-08  1.60194248e-10
   2.48468820e-09  1.68331063e-10]
 [ 6.59542670e-08 -1.78970150e-07  2.86639031e-07  5.71312734e-10
   1.68331063e-10  3.55536195e-09]]
1.342161058494894e-58
post
sphere_lamr_small
Ybar_post [[ 1.97967218]
 [-0.54952151]
 [15.17828603]]
resids [[-1.35266548e-06]
 [ 4.98683552e-06]
 [-1.75468686e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [753772055.5236894, 1.342161058494894e-58]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.29246216e+03],
       [ 3.03103094e+03],
       [-4.82385574e+03],
       [-4.47355254e+00],
       [-2.36588167e+00],
       [-5.48797737e+00]]), 'est_covars': array([[ 3.80499698e-03, -8.42767589e-03,  5.31921766e-03,
         2.25237838e-05,  1.14192219e-06,  2.89668833e-05],
       [-8.42767589e-03,  2.14099539e-02, -1.31937935e-02,
        -4.52715565e-05,  2.78893341e-06, -7.20592497e-05],
       [ 5.31921766e-03, -1.31937935e-02,  8.84975740e-03,
         2.84620191e-05,  2.04260334e-06,  5.05989138e-05],
       [ 2.25237838e-05, -4.52715565e-05,  2.84620191e-05,
         1.93202941e-07, -2.71612472e-09,  1.56775945e-07],
       [ 1.14192219e-06,  2.78893341e-06,  2.04260334e-06,
        -2.71612472e-09,  1.80890007e-07, -1.82556280e-09],
       [ 2.89668833e-05, -7.20592497e-05,  5.05989138e-05,
         1.56775945e-07, -1.82556280e-09,  3.52436422e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.29250482e+03],
       [ 3.03089645e+03],
       [-4.82380638e+03],
       [-4.47340142e+00],
       [-2.36596382e+00],
       [-5.48783690e+00]]), 'covar': array([[ 1.69610125e-04, -1.50391307e-04,  5.22816787e-05,
         3.02699089e-07, -3.50302217e-08,  6.59542670e-08],
       [-1.50391307e-04,  1.00218663e-03, -2.31089081e-04,
        -3.38708018e-08,  6.73131024e-07, -1.78970150e-07],
       [ 5.22816787e-05, -2.31089081e-04,  1.97664187e-04,
         9.06152842e-08, -8.63438378e-08,  2.86639031e-07],
       [ 3.02699089e-07, -3.38708018e-08,  9.06152842e-08,
         2.52614426e-09,  1.60194248e-10,  5.71312734e-10],
       [-3.50302217e-08,  6.73131024e-07, -8.63438378e-08,
         1.60194248e-10,  2.48468820e-09,  1.68331063e-10],
       [ 6.59542670e-08, -1.78970150e-07,  2.86639031e-07,
         5.71312734e-10,  1.68331063e-10,  3.55536195e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.35266548e-06],
       [ 4.98683552e-06],
       [-1.75468686e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.29246216e+03],
       [ 3.03103094e+03],
       [-4.82385574e+03],
       [-4.47355254e+00],
       [-2.36588167e+00],
       [-5.48797737e+00],
       [ 7.10467617e-01],
       [ 2.29102684e-01],
       [-6.45111156e-01],
       [ 1.63031658e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65758626e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.80499698e-03, -8.42767589e-03,  5.31921766e-03,
         2.25237838e-05,  1.14192219e-06,  2.89668833e-05],
       [-8.42767589e-03,  2.14099539e-02, -1.31937935e-02,
        -4.52715565e-05,  2.78893341e-06, -7.20592497e-05],
       [ 5.31921766e-03, -1.31937935e-02,  8.84975740e-03,
         2.84620191e-05,  2.04260334e-06,  5.05989138e-05],
       [ 2.25237838e-05, -4.52715565e-05,  2.84620191e-05,
         1.93202941e-07, -2.71612472e-09,  1.56775945e-07],
       [ 1.14192219e-06,  2.78893341e-06,  2.04260334e-06,
        -2.71612472e-09,  1.80890007e-07, -1.82556280e-09],
       [ 2.89668833e-05, -7.20592497e-05,  5.05989138e-05,
         1.56775945e-07, -1.82556280e-09,  3.52436422e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 6.27075376e-06],
       [-9.18654717e-06],
       [ 1.06374247e-02]])}}
Current time:  2018-07-13 19:36:00
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.29246216e+03],
       [ 3.03103094e+03],
       [-4.82385574e+03],
       [-4.47355254e+00],
       [-2.36588167e+00],
       [-5.48797737e+00],
       [ 7.10467617e-01],
       [ 2.29102684e-01],
       [-6.45111156e-01],
       [ 1.63031658e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65758626e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 3.80499698e-03, -8.42767589e-03,  5.31921766e-03,
         2.25237838e-05,  1.14192219e-06,  2.89668833e-05],
       [-8.42767589e-03,  2.14099539e-02, -1.31937935e-02,
        -4.52715565e-05,  2.78893341e-06, -7.20592497e-05],
       [ 5.31921766e-03, -1.31937935e-02,  8.84975740e-03,
         2.84620191e-05,  2.04260334e-06,  5.05989138e-05],
       [ 2.25237838e-05, -4.52715565e-05,  2.84620191e-05,
         1.93202941e-07, -2.71612472e-09,  1.56775945e-07],
       [ 1.14192219e-06,  2.78893341e-06,  2.04260334e-06,
        -2.71612472e-09,  1.80890007e-07, -1.82556280e-09],
       [ 2.89668833e-05, -7.20592497e-05,  5.05989138e-05,
         1.56775945e-07, -1.82556280e-09,  3.52436422e-07]])}
[[ 4.29246216e+03]
 [ 3.03103094e+03]
 [-4.82385574e+03]
 [-4.47355254e+00]
 [-2.36588167e+00]
 [-5.48797737e+00]
 [ 7.10467617e-01]
 [ 2.29102684e-01]
 [-6.45111156e-01]
 [ 1.63031658e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65758626e-18]]
2018-07-13 19:35:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:36:00
[[ 4.24749198e+03]
 [ 3.00720630e+03]
 [-4.87846927e+03]
 [-4.52036563e+00]
 [-2.39898139e+00]
 [-5.43465399e+00]
 [ 7.07089605e-01]
 [ 2.28248322e-01]
 [-6.48811936e-01]
 [ 1.64225653e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65779854e-18]]
[[ 4.27366861e-03 -8.86730862e-03  5.90818932e-03  2.43544326e-05
   1.13992264e-06  3.05814592e-05]
 [-8.86730862e-03  2.14835669e-02 -1.38947658e-02 -4.49450803e-05
   4.59499775e-06 -7.22227729e-05]
 [ 5.90818932e-03 -1.38947658e-02  9.89823230e-03  2.97909700e-05
   2.05147241e-06  5.42719111e-05]
 [ 2.43544326e-05 -4.49450803e-05  2.97909700e-05  2.01709254e-07
  -2.56426981e-09  1.55736579e-07]
 [ 1.13992264e-06  4.59499775e-06  2.05147241e-06 -2.56426981e-09
   1.90832831e-07 -1.74910433e-09]
 [ 3.05814592e-05 -7.22227729e-05  5.42719111e-05  1.55736579e-07
  -1.74910433e-09  3.63457128e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.29250482e+03],
       [ 3.03089645e+03],
       [-4.82380638e+03],
       [-4.47340142e+00],
       [-2.36596382e+00],
       [-5.48783690e+00]]), 'covar': array([[ 1.69610125e-04, -1.50391307e-04,  5.22816787e-05,
         3.02699089e-07, -3.50302217e-08,  6.59542670e-08],
       [-1.50391307e-04,  1.00218663e-03, -2.31089081e-04,
        -3.38708018e-08,  6.73131024e-07, -1.78970150e-07],
       [ 5.22816787e-05, -2.31089081e-04,  1.97664187e-04,
         9.06152842e-08, -8.63438378e-08,  2.86639031e-07],
       [ 3.02699089e-07, -3.38708018e-08,  9.06152842e-08,
         2.52614426e-09,  1.60194248e-10,  5.71312734e-10],
       [-3.50302217e-08,  6.73131024e-07, -8.63438378e-08,
         1.60194248e-10,  2.48468820e-09,  1.68331063e-10],
       [ 6.59542670e-08, -1.78970150e-07,  2.86639031e-07,
         5.71312734e-10,  1.68331063e-10,  3.55536195e-09]])}
[[ 4.29250482e+03]
 [ 3.03089645e+03]
 [-4.82380638e+03]
 [-4.47340142e+00]
 [-2.36596382e+00]
 [-5.48783690e+00]]
2018-07-13 19:35:50
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:36:00
[[ 4.24753626e+03]
 [ 3.00707104e+03]
 [-4.87841877e+03]
 [-4.52021613e+00]
 [-2.39906290e+00]
 [-5.43451249e+00]]
[[ 1.75918336e-04 -1.50986061e-04  5.39104124e-05  3.26566131e-07
  -3.16714751e-08  7.08993763e-08]
 [-1.50986061e-04  1.01586665e-03 -2.33749249e-04 -2.08828809e-08
   6.94273552e-07 -1.85911966e-07]
 [ 5.39104124e-05 -2.33749249e-04  2.03829534e-04  9.16138837e-08
  -8.49522805e-08  3.24961666e-07]
 [ 3.26566131e-07 -2.08828809e-08  9.16138837e-08  2.62389673e-09
   1.68836538e-10  5.62379914e-10]
 [-3.16714751e-08  6.94273552e-07 -8.49522805e-08  1.68836538e-10
   2.57881056e-09  1.60481050e-10]
 [ 7.08993763e-08 -1.85911966e-07  3.24961666e-07  5.62379914e-10
   1.60481050e-10  3.65983916e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 35, 50), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.24753626e+03],
       [ 3.00707104e+03],
       [-4.87841877e+03],
       [-4.52021613e+00],
       [-2.39906290e+00],
       [-5.43451249e+00]]), 'covar': array([[ 1.75918336e-04, -1.50986061e-04,  5.39104124e-05,
         3.26566131e-07, -3.16714751e-08,  7.08993763e-08],
       [-1.50986061e-04,  1.01586665e-03, -2.33749249e-04,
        -2.08828809e-08,  6.94273552e-07, -1.85911966e-07],
       [ 5.39104124e-05, -2.33749249e-04,  2.03829534e-04,
         9.16138837e-08, -8.49522805e-08,  3.24961666e-07],
       [ 3.26566131e-07, -2.08828809e-08,  9.16138837e-08,
         2.62389673e-09,  1.68836538e-10,  5.62379914e-10],
       [-3.16714751e-08,  6.94273552e-07, -8.49522805e-08,
         1.68836538e-10,  2.57881056e-09,  1.60481050e-10],
       [ 7.08993763e-08, -1.85911966e-07,  3.24961666e-07,
         5.62379914e-10,  1.60481050e-10,  3.65983916e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-1.35266548e-06],
       [ 4.98683552e-06],
       [-1.75468686e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 35, 50), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.24749198e+03],
       [ 3.00720630e+03],
       [-4.87846927e+03],
       [-4.52036563e+00],
       [-2.39898139e+00],
       [-5.43465399e+00],
       [ 7.07089605e-01],
       [ 2.28248322e-01],
       [-6.48811936e-01],
       [ 1.64225653e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65779854e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.27366861e-03, -8.86730862e-03,  5.90818932e-03,
         2.43544326e-05,  1.13992264e-06,  3.05814592e-05],
       [-8.86730862e-03,  2.14835669e-02, -1.38947658e-02,
        -4.49450803e-05,  4.59499775e-06, -7.22227729e-05],
       [ 5.90818932e-03, -1.38947658e-02,  9.89823230e-03,
         2.97909700e-05,  2.05147241e-06,  5.42719111e-05],
       [ 2.43544326e-05, -4.49450803e-05,  2.97909700e-05,
         2.01709254e-07, -2.56426981e-09,  1.55736579e-07],
       [ 1.13992264e-06,  4.59499775e-06,  2.05147241e-06,
        -2.56426981e-09,  1.90832831e-07, -1.74910433e-09],
       [ 3.05814592e-05, -7.22227729e-05,  5.42719111e-05,
         1.55736579e-07, -1.74910433e-09,  3.63457128e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 6.27075376e-06],
       [-9.18654717e-06],
       [ 1.06374247e-02]])}}
Yi [[ 2.007094  ]
 [-0.57210474]
 [13.43363725]]
posterior
[[ 4.24749198e+03]
 [ 3.00720630e+03]
 [-4.87846927e+03]
 [-4.52036563e+00]
 [-2.39898139e+00]
 [-5.43465399e+00]
 [ 7.07089605e-01]
 [ 2.28248322e-01]
 [-6.48811936e-01]
 [ 1.64225653e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65779854e-18]]
[[ 4.24749645e+03]
 [ 3.00719393e+03]
 [-4.87847064e+03]
 [-4.52033602e+00]
 [-2.39903159e+00]
 [-5.43469148e+00]
 [ 7.07089605e-01]
 [ 2.28248322e-01]
 [-6.48811936e-01]
 [ 1.64225653e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65779854e-18]]
[[ 4.23041564e-03 -8.82881311e-03  5.94970555e-03  2.39364947e-05
   1.37078518e-06  3.10486134e-05]
 [-8.82881311e-03  2.08557905e-02 -1.37281325e-02 -4.55300864e-05
   2.51363857e-06 -7.18974463e-05]
 [ 5.94970555e-03 -1.37281325e-02  9.78849994e-03  3.05204354e-05
   2.47308382e-06  5.35688695e-05]
 [ 2.39364947e-05 -4.55300864e-05  3.05204354e-05  1.96127801e-07
  -3.35791841e-09  1.61445922e-07]
 [ 1.37078518e-06  2.51363857e-06  2.47308382e-06 -3.35791841e-09
   1.83670382e-07 -1.90231375e-09]
 [ 3.10486134e-05 -7.18974463e-05  5.35688695e-05  1.61445922e-07
  -1.90231375e-09  3.57482507e-07]]
[[ 2.00709224]
 [-0.57208446]
 [13.45050383]]
[[ 1.75875997e-06]
 [-2.02880143e-05]
 [-1.68665784e-02]]


 Corrector Step
2018-07-13 19:36:00
[[ 4.24749645e+03]
 [ 3.00719393e+03]
 [-4.87847064e+03]
 [-4.52033602e+00]
 [-2.39903159e+00]
 [-5.43469148e+00]
 [ 7.07089605e-01]
 [ 2.28248322e-01]
 [-6.48811936e-01]
 [ 1.64225653e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65779854e-18]]
[[ 4.23041564e-03 -8.82881311e-03  5.94970555e-03  2.39364947e-05
   1.37078518e-06  3.10486134e-05]
 [-8.82881311e-03  2.08557905e-02 -1.37281325e-02 -4.55300864e-05
   2.51363857e-06 -7.18974463e-05]
 [ 5.94970555e-03 -1.37281325e-02  9.78849994e-03  3.05204354e-05
   2.47308382e-06  5.35688695e-05]
 [ 2.39364947e-05 -4.55300864e-05  3.05204354e-05  1.96127801e-07
  -3.35791841e-09  1.61445922e-07]
 [ 1.37078518e-06  2.51363857e-06  2.47308382e-06 -3.35791841e-09
   1.83670382e-07 -1.90231375e-09]
 [ 3.10486134e-05 -7.18974463e-05  5.35688695e-05  1.61445922e-07
  -1.90231375e-09  3.57482507e-07]]
641336869.5893685
post
cubesat_nadir
Ybar_post [[ 2.00709289]
 [-0.57208817]
 [13.45049553]]
resids [[ 1.10124810e-06]
 [-1.65784040e-05]
 [-1.68582791e-02]]
posterior
[[ 4.24753626e+03]
 [ 3.00707104e+03]
 [-4.87841877e+03]
 [-4.52021613e+00]
 [-2.39906290e+00]
 [-5.43451249e+00]]
[[ 4.24753716e+03]
 [ 3.00707138e+03]
 [-4.87841920e+03]
 [-4.52021429e+00]
 [-2.39906244e+00]
 [-5.43451318e+00]]
[[ 1.70210446e-04 -1.55767101e-04  5.70825564e-05  3.14040362e-07
  -3.66478929e-08  7.53517722e-08]
 [-1.55767101e-04  9.44112797e-04 -2.32121605e-04 -5.60320437e-08
   6.32258880e-07 -2.01417312e-07]
 [ 5.70825564e-05 -2.32121605e-04  2.02050964e-04  9.82003861e-08
  -8.30655967e-08  3.22194965e-07]
 [ 3.14040362e-07 -5.60320437e-08  9.82003861e-08  2.58743531e-09
   1.36862762e-10  5.65150034e-10]
 [-3.66478929e-08  6.32258880e-07 -8.30655967e-08  1.36862762e-10
   2.52508089e-09  1.47939619e-10]
 [ 7.53517722e-08 -2.01417312e-07  3.22194965e-07  5.65150034e-10
   1.47939619e-10  3.65090507e-09]]
[[ 2.00710133]
 [-0.57209975]
 [15.12547088]]
[[-7.33094836e-06]
 [-4.99197234e-06]
 [-1.69183363e+00]]


 Corrector Step
2018-07-13 19:36:00
[[ 4.24753716e+03]
 [ 3.00707138e+03]
 [-4.87841920e+03]
 [-4.52021429e+00]
 [-2.39906244e+00]
 [-5.43451318e+00]]
[[ 1.70210446e-04 -1.55767101e-04  5.70825564e-05  3.14040362e-07
  -3.66478929e-08  7.53517722e-08]
 [-1.55767101e-04  9.44112797e-04 -2.32121605e-04 -5.60320437e-08
   6.32258880e-07 -2.01417312e-07]
 [ 5.70825564e-05 -2.32121605e-04  2.02050964e-04  9.82003861e-08
  -8.30655967e-08  3.22194965e-07]
 [ 3.14040362e-07 -5.60320437e-08  9.82003861e-08  2.58743531e-09
   1.36862762e-10  5.65150034e-10]
 [-3.66478929e-08  6.32258880e-07 -8.30655967e-08  1.36862762e-10
   2.52508089e-09  1.47939619e-10]
 [ 7.53517722e-08 -2.01417312e-07  3.22194965e-07  5.65150034e-10
   1.47939619e-10  3.65090507e-09]]
6.540254962918147e-54
post
sphere_lamr_small
Ybar_post [[ 2.00710085]
 [-0.57209994]
 [15.12547024]]
resids [[-6.85521300e-06]
 [-4.80858422e-06]
 [-1.69183299e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [641336869.5893685, 6.540254962918147e-54]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.24749645e+03],
       [ 3.00719393e+03],
       [-4.87847064e+03],
       [-4.52033602e+00],
       [-2.39903159e+00],
       [-5.43469148e+00]]), 'est_covars': array([[ 4.23041564e-03, -8.82881311e-03,  5.94970555e-03,
         2.39364947e-05,  1.37078518e-06,  3.10486134e-05],
       [-8.82881311e-03,  2.08557905e-02, -1.37281325e-02,
        -4.55300864e-05,  2.51363857e-06, -7.18974463e-05],
       [ 5.94970555e-03, -1.37281325e-02,  9.78849994e-03,
         3.05204354e-05,  2.47308382e-06,  5.35688695e-05],
       [ 2.39364947e-05, -4.55300864e-05,  3.05204354e-05,
         1.96127801e-07, -3.35791841e-09,  1.61445922e-07],
       [ 1.37078518e-06,  2.51363857e-06,  2.47308382e-06,
        -3.35791841e-09,  1.83670382e-07, -1.90231375e-09],
       [ 3.10486134e-05, -7.18974463e-05,  5.35688695e-05,
         1.61445922e-07, -1.90231375e-09,  3.57482507e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 36), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.24753716e+03],
       [ 3.00707138e+03],
       [-4.87841920e+03],
       [-4.52021429e+00],
       [-2.39906244e+00],
       [-5.43451318e+00]]), 'covar': array([[ 1.70210446e-04, -1.55767101e-04,  5.70825564e-05,
         3.14040362e-07, -3.66478929e-08,  7.53517722e-08],
       [-1.55767101e-04,  9.44112797e-04, -2.32121605e-04,
        -5.60320437e-08,  6.32258880e-07, -2.01417312e-07],
       [ 5.70825564e-05, -2.32121605e-04,  2.02050964e-04,
         9.82003861e-08, -8.30655967e-08,  3.22194965e-07],
       [ 3.14040362e-07, -5.60320437e-08,  9.82003861e-08,
         2.58743531e-09,  1.36862762e-10,  5.65150034e-10],
       [-3.66478929e-08,  6.32258880e-07, -8.30655967e-08,
         1.36862762e-10,  2.52508089e-09,  1.47939619e-10],
       [ 7.53517722e-08, -2.01417312e-07,  3.22194965e-07,
         5.65150034e-10,  1.47939619e-10,  3.65090507e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-6.85521300e-06],
       [-4.80858422e-06],
       [-1.69183299e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 36), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.24749645e+03],
       [ 3.00719393e+03],
       [-4.87847064e+03],
       [-4.52033602e+00],
       [-2.39903159e+00],
       [-5.43469148e+00],
       [ 7.07089605e-01],
       [ 2.28248322e-01],
       [-6.48811936e-01],
       [ 1.64225653e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65779854e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.23041564e-03, -8.82881311e-03,  5.94970555e-03,
         2.39364947e-05,  1.37078518e-06,  3.10486134e-05],
       [-8.82881311e-03,  2.08557905e-02, -1.37281325e-02,
        -4.55300864e-05,  2.51363857e-06, -7.18974463e-05],
       [ 5.94970555e-03, -1.37281325e-02,  9.78849994e-03,
         3.05204354e-05,  2.47308382e-06,  5.35688695e-05],
       [ 2.39364947e-05, -4.55300864e-05,  3.05204354e-05,
         1.96127801e-07, -3.35791841e-09,  1.61445922e-07],
       [ 1.37078518e-06,  2.51363857e-06,  2.47308382e-06,
        -3.35791841e-09,  1.83670382e-07, -1.90231375e-09],
       [ 3.10486134e-05, -7.18974463e-05,  5.35688695e-05,
         1.61445922e-07, -1.90231375e-09,  3.57482507e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.10124810e-06],
       [-1.65784040e-05],
       [-1.68582791e-02]])}}
Current time:  2018-07-13 19:36:10
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 36), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.24749645e+03],
       [ 3.00719393e+03],
       [-4.87847064e+03],
       [-4.52033602e+00],
       [-2.39903159e+00],
       [-5.43469148e+00],
       [ 7.07089605e-01],
       [ 2.28248322e-01],
       [-6.48811936e-01],
       [ 1.64225653e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65779854e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.23041564e-03, -8.82881311e-03,  5.94970555e-03,
         2.39364947e-05,  1.37078518e-06,  3.10486134e-05],
       [-8.82881311e-03,  2.08557905e-02, -1.37281325e-02,
        -4.55300864e-05,  2.51363857e-06, -7.18974463e-05],
       [ 5.94970555e-03, -1.37281325e-02,  9.78849994e-03,
         3.05204354e-05,  2.47308382e-06,  5.35688695e-05],
       [ 2.39364947e-05, -4.55300864e-05,  3.05204354e-05,
         1.96127801e-07, -3.35791841e-09,  1.61445922e-07],
       [ 1.37078518e-06,  2.51363857e-06,  2.47308382e-06,
        -3.35791841e-09,  1.83670382e-07, -1.90231375e-09],
       [ 3.10486134e-05, -7.18974463e-05,  5.35688695e-05,
         1.61445922e-07, -1.90231375e-09,  3.57482507e-07]])}
[[ 4.24749645e+03]
 [ 3.00719393e+03]
 [-4.87847064e+03]
 [-4.52033602e+00]
 [-2.39903159e+00]
 [-5.43469148e+00]
 [ 7.07089605e-01]
 [ 2.28248322e-01]
 [-6.48811936e-01]
 [ 1.64225653e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65779854e-18]]
2018-07-13 19:36:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:36:10
[[ 4.20206103e+03]
 [ 2.98303919e+03]
 [-4.93254846e+03]
 [-4.56664798e+00]
 [-2.43186387e+00]
 [-5.38077729e+00]
 [ 7.03692316e-01]
 [ 2.27387737e-01]
 [-6.52495029e-01]
 [ 1.65415170e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65801083e-18]]
[[ 4.72744793e-03 -9.26884700e-03  6.58054184e-03  2.57847283e-05
   1.36169950e-06  3.27128154e-05]
 [-9.26884700e-03  2.09241944e-02 -1.44231450e-02 -4.52088409e-05
   4.35183879e-06 -7.20587666e-05]
 [ 6.58054184e-03 -1.44231450e-02  1.08968769e-02  3.18796126e-05
   2.48016928e-06  5.72967097e-05]
 [ 2.57847283e-05 -4.52088409e-05  3.18796126e-05  2.04577929e-07
  -3.22168908e-09  1.60376534e-07]
 [ 1.36169950e-06  4.35183879e-06  2.48016928e-06 -3.22168908e-09
   1.93610240e-07 -1.83521890e-09]
 [ 3.27128154e-05 -7.20587666e-05  5.72967097e-05  1.60376534e-07
  -1.83521890e-09  3.68511348e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 36), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.24753716e+03],
       [ 3.00707138e+03],
       [-4.87841920e+03],
       [-4.52021429e+00],
       [-2.39906244e+00],
       [-5.43451318e+00]]), 'covar': array([[ 1.70210446e-04, -1.55767101e-04,  5.70825564e-05,
         3.14040362e-07, -3.66478929e-08,  7.53517722e-08],
       [-1.55767101e-04,  9.44112797e-04, -2.32121605e-04,
        -5.60320437e-08,  6.32258880e-07, -2.01417312e-07],
       [ 5.70825564e-05, -2.32121605e-04,  2.02050964e-04,
         9.82003861e-08, -8.30655967e-08,  3.22194965e-07],
       [ 3.14040362e-07, -5.60320437e-08,  9.82003861e-08,
         2.58743531e-09,  1.36862762e-10,  5.65150034e-10],
       [-3.66478929e-08,  6.32258880e-07, -8.30655967e-08,
         1.36862762e-10,  2.52508089e-09,  1.47939619e-10],
       [ 7.53517722e-08, -2.01417312e-07,  3.22194965e-07,
         5.65150034e-10,  1.47939619e-10,  3.65090507e-09]])}
[[ 4.24753716e+03]
 [ 3.00707138e+03]
 [-4.87841920e+03]
 [-4.52021429e+00]
 [-2.39906244e+00]
 [-5.43451318e+00]]
2018-07-13 19:36:00
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:36:10
[[ 4.20210283e+03]
 [ 2.98291624e+03]
 [-4.93249496e+03]
 [-4.56652755e+00]
 [-2.43189415e+00]
 [-5.38059833e+00]]
[[ 1.76887753e-04 -1.56513982e-04  5.86560498e-05  3.38257387e-07
  -3.36921356e-08  8.02786131e-08]
 [-1.56513982e-04  9.57042357e-04 -2.35121820e-04 -4.39493714e-08
   6.53916622e-07 -2.08072051e-07]
 [ 5.86560498e-05 -2.35121820e-04  2.09119680e-04  9.94001663e-08
  -8.17362159e-08  3.61760885e-07]
 [ 3.38257387e-07 -4.39493714e-08  9.94001663e-08  2.68453561e-09
   1.45317600e-10  5.55633693e-10]
 [-3.36921356e-08  6.53916622e-07 -8.17362159e-08  1.45317600e-10
   2.61951460e-09  1.40450118e-10]
 [ 8.02786131e-08 -2.08072051e-07  3.61760885e-07  5.55633693e-10
   1.40450118e-10  3.75595382e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 36), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.20210283e+03],
       [ 2.98291624e+03],
       [-4.93249496e+03],
       [-4.56652755e+00],
       [-2.43189415e+00],
       [-5.38059833e+00]]), 'covar': array([[ 1.76887753e-04, -1.56513982e-04,  5.86560498e-05,
         3.38257387e-07, -3.36921356e-08,  8.02786131e-08],
       [-1.56513982e-04,  9.57042357e-04, -2.35121820e-04,
        -4.39493714e-08,  6.53916622e-07, -2.08072051e-07],
       [ 5.86560498e-05, -2.35121820e-04,  2.09119680e-04,
         9.94001663e-08, -8.17362159e-08,  3.61760885e-07],
       [ 3.38257387e-07, -4.39493714e-08,  9.94001663e-08,
         2.68453561e-09,  1.45317600e-10,  5.55633693e-10],
       [-3.36921356e-08,  6.53916622e-07, -8.17362159e-08,
         1.45317600e-10,  2.61951460e-09,  1.40450118e-10],
       [ 8.02786131e-08, -2.08072051e-07,  3.61760885e-07,
         5.55633693e-10,  1.40450118e-10,  3.75595382e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-6.85521300e-06],
       [-4.80858422e-06],
       [-1.69183299e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 36), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.20206103e+03],
       [ 2.98303919e+03],
       [-4.93254846e+03],
       [-4.56664798e+00],
       [-2.43186387e+00],
       [-5.38077729e+00],
       [ 7.03692316e-01],
       [ 2.27387737e-01],
       [-6.52495029e-01],
       [ 1.65415170e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65801083e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.72744793e-03, -9.26884700e-03,  6.58054184e-03,
         2.57847283e-05,  1.36169950e-06,  3.27128154e-05],
       [-9.26884700e-03,  2.09241944e-02, -1.44231450e-02,
        -4.52088409e-05,  4.35183879e-06, -7.20587666e-05],
       [ 6.58054184e-03, -1.44231450e-02,  1.08968769e-02,
         3.18796126e-05,  2.48016928e-06,  5.72967097e-05],
       [ 2.57847283e-05, -4.52088409e-05,  3.18796126e-05,
         2.04577929e-07, -3.22168908e-09,  1.60376534e-07],
       [ 1.36169950e-06,  4.35183879e-06,  2.48016928e-06,
        -3.22168908e-09,  1.93610240e-07, -1.83521890e-09],
       [ 3.27128154e-05, -7.20587666e-05,  5.72967097e-05,
         1.60376534e-07, -1.83521890e-09,  3.68511348e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 1.10124810e-06],
       [-1.65784040e-05],
       [-1.68582791e-02]])}}
Yi [[ 2.0349901 ]
 [-0.59366327]
 [13.49925425]]
posterior
[[ 4.20206103e+03]
 [ 2.98303919e+03]
 [-4.93254846e+03]
 [-4.56664798e+00]
 [-2.43186387e+00]
 [-5.38077729e+00]
 [ 7.03692316e-01]
 [ 2.27387737e-01]
 [-6.52495029e-01]
 [ 1.65415170e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65801083e-18]]
[[ 4.20206220e+03]
 [ 2.98305218e+03]
 [-4.93255572e+03]
 [-4.56661135e+00]
 [-2.43182670e+00]
 [-5.38081685e+00]
 [ 7.03692316e-01]
 [ 2.27387737e-01]
 [-6.52495029e-01]
 [ 1.65415170e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65801083e-18]]
[[ 4.68796050e-03 -9.21859842e-03  6.61580162e-03  2.54278415e-05
   1.65589302e-06  3.31374270e-05]
 [-9.21859842e-03  2.02925198e-02 -1.42251002e-02 -4.57741203e-05
   2.17479765e-06 -7.15493043e-05]
 [ 6.61580162e-03 -1.42251002e-02  1.07613976e-02  3.26345386e-05
   2.98847862e-06  5.64678953e-05]
 [ 2.54278415e-05 -4.57741203e-05  3.26345386e-05  1.99521818e-07
  -3.79931833e-09  1.66099760e-07]
 [ 1.65589302e-06  2.17479765e-06  2.98847862e-06 -3.79931833e-09
   1.85693036e-07 -1.66785396e-09]
 [ 3.31374270e-05 -7.15493043e-05  5.64678953e-05  1.66099760e-07
  -1.66785396e-09  3.62000243e-07]]
[[ 2.03500745]
 [-0.59366257]
 [13.49095154]]
[[-1.73517008e-05]
 [-7.04382103e-07]
 [ 8.30271588e-03]]


 Corrector Step
2018-07-13 19:36:10
[[ 4.20206220e+03]
 [ 2.98305218e+03]
 [-4.93255572e+03]
 [-4.56661135e+00]
 [-2.43182670e+00]
 [-5.38081685e+00]
 [ 7.03692316e-01]
 [ 2.27387737e-01]
 [-6.52495029e-01]
 [ 1.65415170e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65801083e-18]]
[[ 4.68796050e-03 -9.21859842e-03  6.61580162e-03  2.54278415e-05
   1.65589302e-06  3.31374270e-05]
 [-9.21859842e-03  2.02925198e-02 -1.42251002e-02 -4.57741203e-05
   2.17479765e-06 -7.15493043e-05]
 [ 6.61580162e-03 -1.42251002e-02  1.07613976e-02  3.26345386e-05
   2.98847862e-06  5.64678953e-05]
 [ 2.54278415e-05 -4.57741203e-05  3.26345386e-05  1.99521818e-07
  -3.79931833e-09  1.66099760e-07]
 [ 1.65589302e-06  2.17479765e-06  2.98847862e-06 -3.79931833e-09
   1.85693036e-07 -1.66785396e-09]
 [ 3.31374270e-05 -7.15493043e-05  5.64678953e-05  1.66099760e-07
  -1.66785396e-09  3.62000243e-07]]
707243311.9593722
post
cubesat_nadir
Ybar_post [[ 2.03500383]
 [-0.5936625 ]
 [13.49096043]]
resids [[-1.37373456e-05]
 [-7.68261095e-07]
 [ 8.29382733e-03]]
posterior
[[ 4.20210283e+03]
 [ 2.98291624e+03]
 [-4.93249496e+03]
 [-4.56652755e+00]
 [-2.43189415e+00]
 [-5.38059833e+00]]
[[ 4.20210424e+03]
 [ 2.98292482e+03]
 [-4.93249576e+03]
 [-4.56652151e+00]
 [-2.43188650e+00]
 [-5.38059743e+00]]
[[ 1.71581509e-04 -1.60232065e-04  6.17575169e-05  3.26375127e-07
  -3.77111875e-08  8.53778815e-08]
 [-1.60232065e-04  8.89362009e-04 -2.32566414e-04 -7.68107608e-08
   5.94887986e-07 -2.22654402e-07]
 [ 6.17575169e-05 -2.32566414e-04  2.07304629e-04  1.06489375e-07
  -7.90569566e-08  3.58886991e-07]
 [ 3.26375127e-07 -7.68107608e-08  1.06489375e-07  2.64867698e-09
   1.15123748e-10  5.60207265e-10]
 [-3.77111875e-08  5.94887986e-07 -7.90569566e-08  1.15123748e-10
   2.56791360e-09  1.28629571e-10]
 [ 8.53778815e-08 -2.22654402e-07  3.58886991e-07  5.60207265e-10
   1.28629571e-10  3.74598817e-09]]
[[ 2.03501686]
 [-0.59367484]
 [15.07730126]]
[[-2.67692347e-05]
 [ 1.15667241e-05]
 [-1.57804701e+00]]


 Corrector Step
2018-07-13 19:36:10
[[ 4.20210424e+03]
 [ 2.98292482e+03]
 [-4.93249576e+03]
 [-4.56652151e+00]
 [-2.43188650e+00]
 [-5.38059743e+00]]
[[ 1.71581509e-04 -1.60232065e-04  6.17575169e-05  3.26375127e-07
  -3.77111875e-08  8.53778815e-08]
 [-1.60232065e-04  8.89362009e-04 -2.32566414e-04 -7.68107608e-08
   5.94887986e-07 -2.22654402e-07]
 [ 6.17575169e-05 -2.32566414e-04  2.07304629e-04  1.06489375e-07
  -7.90569566e-08  3.58886991e-07]
 [ 3.26375127e-07 -7.68107608e-08  1.06489375e-07  2.64867698e-09
   1.15123748e-10  5.60207265e-10]
 [-3.77111875e-08  5.94887986e-07 -7.90569566e-08  1.15123748e-10
   2.56791360e-09  1.28629571e-10]
 [ 8.53778815e-08 -2.22654402e-07  3.58886991e-07  5.60207265e-10
   1.28629571e-10  3.74598817e-09]]
4.381969999577534e-46
post
sphere_lamr_small
Ybar_post [[ 2.03501425]
 [-0.59367341]
 [15.07731237]]
resids [[-2.41547361e-05]
 [ 1.01337903e-05]
 [-1.57805811e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [707243311.9593722, 4.381969999577534e-46]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.20206220e+03],
       [ 2.98305218e+03],
       [-4.93255572e+03],
       [-4.56661135e+00],
       [-2.43182670e+00],
       [-5.38081685e+00]]), 'est_covars': array([[ 4.68796050e-03, -9.21859842e-03,  6.61580162e-03,
         2.54278415e-05,  1.65589302e-06,  3.31374270e-05],
       [-9.21859842e-03,  2.02925198e-02, -1.42251002e-02,
        -4.57741203e-05,  2.17479765e-06, -7.15493043e-05],
       [ 6.61580162e-03, -1.42251002e-02,  1.07613976e-02,
         3.26345386e-05,  2.98847862e-06,  5.64678953e-05],
       [ 2.54278415e-05, -4.57741203e-05,  3.26345386e-05,
         1.99521818e-07, -3.79931833e-09,  1.66099760e-07],
       [ 1.65589302e-06,  2.17479765e-06,  2.98847862e-06,
        -3.79931833e-09,  1.85693036e-07, -1.66785396e-09],
       [ 3.31374270e-05, -7.15493043e-05,  5.64678953e-05,
         1.66099760e-07, -1.66785396e-09,  3.62000243e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 36, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.20210424e+03],
       [ 2.98292482e+03],
       [-4.93249576e+03],
       [-4.56652151e+00],
       [-2.43188650e+00],
       [-5.38059743e+00]]), 'covar': array([[ 1.71581509e-04, -1.60232065e-04,  6.17575169e-05,
         3.26375127e-07, -3.77111875e-08,  8.53778815e-08],
       [-1.60232065e-04,  8.89362009e-04, -2.32566414e-04,
        -7.68107608e-08,  5.94887986e-07, -2.22654402e-07],
       [ 6.17575169e-05, -2.32566414e-04,  2.07304629e-04,
         1.06489375e-07, -7.90569566e-08,  3.58886991e-07],
       [ 3.26375127e-07, -7.68107608e-08,  1.06489375e-07,
         2.64867698e-09,  1.15123748e-10,  5.60207265e-10],
       [-3.77111875e-08,  5.94887986e-07, -7.90569566e-08,
         1.15123748e-10,  2.56791360e-09,  1.28629571e-10],
       [ 8.53778815e-08, -2.22654402e-07,  3.58886991e-07,
         5.60207265e-10,  1.28629571e-10,  3.74598817e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.41547361e-05],
       [ 1.01337903e-05],
       [-1.57805811e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 36, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.20206220e+03],
       [ 2.98305218e+03],
       [-4.93255572e+03],
       [-4.56661135e+00],
       [-2.43182670e+00],
       [-5.38081685e+00],
       [ 7.03692316e-01],
       [ 2.27387737e-01],
       [-6.52495029e-01],
       [ 1.65415170e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65801083e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.68796050e-03, -9.21859842e-03,  6.61580162e-03,
         2.54278415e-05,  1.65589302e-06,  3.31374270e-05],
       [-9.21859842e-03,  2.02925198e-02, -1.42251002e-02,
        -4.57741203e-05,  2.17479765e-06, -7.15493043e-05],
       [ 6.61580162e-03, -1.42251002e-02,  1.07613976e-02,
         3.26345386e-05,  2.98847862e-06,  5.64678953e-05],
       [ 2.54278415e-05, -4.57741203e-05,  3.26345386e-05,
         1.99521818e-07, -3.79931833e-09,  1.66099760e-07],
       [ 1.65589302e-06,  2.17479765e-06,  2.98847862e-06,
        -3.79931833e-09,  1.85693036e-07, -1.66785396e-09],
       [ 3.31374270e-05, -7.15493043e-05,  5.64678953e-05,
         1.66099760e-07, -1.66785396e-09,  3.62000243e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.37373456e-05],
       [-7.68261095e-07],
       [ 8.29382733e-03]])}}
Current time:  2018-07-13 19:36:20
cubesat_nadir
{'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 36, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.20206220e+03],
       [ 2.98305218e+03],
       [-4.93255572e+03],
       [-4.56661135e+00],
       [-2.43182670e+00],
       [-5.38081685e+00],
       [ 7.03692316e-01],
       [ 2.27387737e-01],
       [-6.52495029e-01],
       [ 1.65415170e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65801083e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 4.68796050e-03, -9.21859842e-03,  6.61580162e-03,
         2.54278415e-05,  1.65589302e-06,  3.31374270e-05],
       [-9.21859842e-03,  2.02925198e-02, -1.42251002e-02,
        -4.57741203e-05,  2.17479765e-06, -7.15493043e-05],
       [ 6.61580162e-03, -1.42251002e-02,  1.07613976e-02,
         3.26345386e-05,  2.98847862e-06,  5.64678953e-05],
       [ 2.54278415e-05, -4.57741203e-05,  3.26345386e-05,
         1.99521818e-07, -3.79931833e-09,  1.66099760e-07],
       [ 1.65589302e-06,  2.17479765e-06,  2.98847862e-06,
        -3.79931833e-09,  1.85693036e-07, -1.66785396e-09],
       [ 3.31374270e-05, -7.15493043e-05,  5.64678953e-05,
         1.66099760e-07, -1.66785396e-09,  3.62000243e-07]])}
[[ 4.20206220e+03]
 [ 2.98305218e+03]
 [-4.93255572e+03]
 [-4.56661135e+00]
 [-2.43182670e+00]
 [-5.38081685e+00]
 [ 7.03692316e-01]
 [ 2.27387737e-01]
 [-6.52495029e-01]
 [ 1.65415170e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65801083e-18]]
2018-07-13 19:36:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:36:20
[[ 4.15616647e+03]
 [ 2.95857086e+03]
 [-4.98609187e+03]
 [-4.61241665e+00]
 [-2.46438842e+00]
 [-5.32631845e+00]
 [ 7.00275843e-01]
 [ 2.26520953e-01]
 [-6.56160332e-01]
 [ 1.66600178e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65822312e-18]]
[[ 5.21514010e-03 -9.65826986e-03  7.28905039e-03  2.72977881e-05
   1.64163529e-06  3.48511791e-05]
 [-9.65826986e-03  2.03543897e-02 -1.49114471e-02 -4.54564634e-05
   4.03757743e-06 -7.17054818e-05]
 [ 7.28905039e-03 -1.49114471e-02  1.19282522e-02  3.40236120e-05
   2.99649378e-06  6.02453268e-05]
 [ 2.72977881e-05 -4.54564634e-05  3.40236120e-05  2.07913742e-07
  -3.68072550e-09  1.65002782e-07]
 [ 1.64163529e-06  4.03757743e-06  2.99649378e-06 -3.68072550e-09
   1.95629825e-07 -1.61055300e-09]
 [ 3.48511791e-05 -7.17054818e-05  6.02453268e-05  1.65002782e-07
  -1.61055300e-09  3.73036280e-07]]
sphere_lamr_small
{'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 36, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.20210424e+03],
       [ 2.98292482e+03],
       [-4.93249576e+03],
       [-4.56652151e+00],
       [-2.43188650e+00],
       [-5.38059743e+00]]), 'covar': array([[ 1.71581509e-04, -1.60232065e-04,  6.17575169e-05,
         3.26375127e-07, -3.77111875e-08,  8.53778815e-08],
       [-1.60232065e-04,  8.89362009e-04, -2.32566414e-04,
        -7.68107608e-08,  5.94887986e-07, -2.22654402e-07],
       [ 6.17575169e-05, -2.32566414e-04,  2.07304629e-04,
         1.06489375e-07, -7.90569566e-08,  3.58886991e-07],
       [ 3.26375127e-07, -7.68107608e-08,  1.06489375e-07,
         2.64867698e-09,  1.15123748e-10,  5.60207265e-10],
       [-3.77111875e-08,  5.94887986e-07, -7.90569566e-08,
         1.15123748e-10,  2.56791360e-09,  1.28629571e-10],
       [ 8.53778815e-08, -2.22654402e-07,  3.58886991e-07,
         5.60207265e-10,  1.28629571e-10,  3.74598817e-09]])}
[[ 4.20210424e+03]
 [ 2.98292482e+03]
 [-4.93249576e+03]
 [-4.56652151e+00]
 [-2.43188650e+00]
 [-5.38059743e+00]]
2018-07-13 19:36:10
delta_t 10.0

 Process Noise


 Predictor Step
2018-07-13 19:36:20
[[ 4.15620949e+03]
 [ 2.95844286e+03]
 [-4.98602962e+03]
 [-4.61232856e+00]
 [-2.46444768e+00]
 [-5.32609818e+00]]
[[ 1.78377126e-04 -1.61290383e-04  6.36796009e-05  3.51238512e-07
  -3.48930903e-08  9.04101721e-08]
 [-1.61290383e-04  9.01492728e-04 -2.35629041e-04 -6.53886874e-08
   6.17244129e-07 -2.28964157e-07]
 [ 6.36796009e-05 -2.35629041e-04  2.14915942e-04  1.07391402e-07
  -7.80544853e-08  3.99343063e-07]
 [ 3.51238512e-07 -6.53886874e-08  1.07391402e-07  2.74489897e-09
   1.23100959e-10  5.50048432e-10]
 [-3.48930903e-08  6.17244129e-07 -7.80544853e-08  1.23100959e-10
   2.66245846e-09  1.21256116e-10]
 [ 9.04101721e-08 -2.28964157e-07  3.99343063e-07  5.50048432e-10
   1.21256116e-10  3.85173328e-09]]
predictor
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 36, 10), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.15620949e+03],
       [ 2.95844286e+03],
       [-4.98602962e+03],
       [-4.61232856e+00],
       [-2.46444768e+00],
       [-5.32609818e+00]]), 'covar': array([[ 1.78377126e-04, -1.61290383e-04,  6.36796009e-05,
         3.51238512e-07, -3.48930903e-08,  9.04101721e-08],
       [-1.61290383e-04,  9.01492728e-04, -2.35629041e-04,
        -6.53886874e-08,  6.17244129e-07, -2.28964157e-07],
       [ 6.36796009e-05, -2.35629041e-04,  2.14915942e-04,
         1.07391402e-07, -7.80544853e-08,  3.99343063e-07],
       [ 3.51238512e-07, -6.53886874e-08,  1.07391402e-07,
         2.74489897e-09,  1.23100959e-10,  5.50048432e-10],
       [-3.48930903e-08,  6.17244129e-07, -7.80544853e-08,
         1.23100959e-10,  2.66245846e-09,  1.21256116e-10],
       [ 9.04101721e-08, -2.28964157e-07,  3.99343063e-07,
         5.50048432e-10,  1.21256116e-10,  3.85173328e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[-2.41547361e-05],
       [ 1.01337903e-05],
       [-1.57805811e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 36, 10), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.15616647e+03],
       [ 2.95857086e+03],
       [-4.98609187e+03],
       [-4.61241665e+00],
       [-2.46438842e+00],
       [-5.32631845e+00],
       [ 7.00275843e-01],
       [ 2.26520953e-01],
       [-6.56160332e-01],
       [ 1.66600178e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65822312e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.21514010e-03, -9.65826986e-03,  7.28905039e-03,
         2.72977881e-05,  1.64163529e-06,  3.48511791e-05],
       [-9.65826986e-03,  2.03543897e-02, -1.49114471e-02,
        -4.54564634e-05,  4.03757743e-06, -7.17054818e-05],
       [ 7.28905039e-03, -1.49114471e-02,  1.19282522e-02,
         3.40236120e-05,  2.99649378e-06,  6.02453268e-05],
       [ 2.72977881e-05, -4.54564634e-05,  3.40236120e-05,
         2.07913742e-07, -3.68072550e-09,  1.65002782e-07],
       [ 1.64163529e-06,  4.03757743e-06,  2.99649378e-06,
        -3.68072550e-09,  1.95629825e-07, -1.61055300e-09],
       [ 3.48511791e-05, -7.17054818e-05,  6.02453268e-05,
         1.65002782e-07, -1.61055300e-09,  3.73036280e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[-1.37373456e-05],
       [-7.68261095e-07],
       [ 8.29382733e-03]])}}
Yi [[ 2.06337967]
 [-0.61422242]
 [13.53024317]]
posterior
[[ 4.15616647e+03]
 [ 2.95857086e+03]
 [-4.98609187e+03]
 [-4.61241665e+00]
 [-2.46438842e+00]
 [-5.32631845e+00]
 [ 7.00275843e-01]
 [ 2.26520953e-01]
 [-6.56160332e-01]
 [ 1.66600178e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65822312e-18]]
[[ 4.15616977e+03]
 [ 2.95855321e+03]
 [-4.98608799e+03]
 [-4.61241365e+00]
 [-2.46445787e+00]
 [-5.32632139e+00]
 [ 7.00275843e-01]
 [ 2.26520953e-01]
 [-6.56160332e-01]
 [ 1.66600178e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65822312e-18]]
[[ 5.17794811e-03 -9.59409482e-03  7.31580940e-03  2.69945408e-05
   2.00421239e-06  3.52228923e-05]
 [-9.59409482e-03  1.97164157e-02 -1.46816513e-02 -4.59889658e-05
   1.76807580e-06 -7.10223847e-05]
 [ 7.31580940e-03 -1.46816513e-02  1.17644818e-02  3.47944907e-05
   3.59570916e-06  5.92840623e-05]
 [ 2.69945408e-05 -4.59889658e-05  3.47944907e-05  2.03326999e-07
  -4.01569879e-09  1.70686488e-07]
 [ 2.00421239e-06  1.76807580e-06  3.59570916e-06 -4.01569879e-09
   1.86967918e-07 -1.10753186e-09]
 [ 3.52228923e-05 -7.10223847e-05  5.92840623e-05  1.70686488e-07
  -1.10753186e-09  3.65989497e-07]]
[[ 2.06336683]
 [-0.6142066 ]
 [13.53372979]]
[[ 1.28424685e-05]
 [-1.58237720e-05]
 [-3.48662525e-03]]


 Corrector Step
2018-07-13 19:36:20
[[ 4.15616977e+03]
 [ 2.95855321e+03]
 [-4.98608799e+03]
 [-4.61241365e+00]
 [-2.46445787e+00]
 [-5.32632139e+00]
 [ 7.00275843e-01]
 [ 2.26520953e-01]
 [-6.56160332e-01]
 [ 1.66600178e-01]
 [-2.54109884e-20]
 [-1.04426738e-03]
 [-2.65822312e-18]]
[[ 5.17794811e-03 -9.59409482e-03  7.31580940e-03  2.69945408e-05
   2.00421239e-06  3.52228923e-05]
 [-9.59409482e-03  1.97164157e-02 -1.46816513e-02 -4.59889658e-05
   1.76807580e-06 -7.10223847e-05]
 [ 7.31580940e-03 -1.46816513e-02  1.17644818e-02  3.47944907e-05
   3.59570916e-06  5.92840623e-05]
 [ 2.69945408e-05 -4.59889658e-05  3.47944907e-05  2.03326999e-07
  -4.01569879e-09  1.70686488e-07]
 [ 2.00421239e-06  1.76807580e-06  3.59570916e-06 -4.01569879e-09
   1.86967918e-07 -1.10753186e-09]
 [ 3.52228923e-05 -7.10223847e-05  5.92840623e-05  1.70686488e-07
  -1.10753186e-09  3.65989497e-07]]
655793371.7673777
post
cubesat_nadir
Ybar_post [[ 2.06336977]
 [-0.61420954]
 [13.53371905]]
resids [[ 9.90466808e-06]
 [-1.28801032e-05]
 [-3.47588756e-03]]
posterior
[[ 4.15620949e+03]
 [ 2.95844286e+03]
 [-4.98602962e+03]
 [-4.61232856e+00]
 [-2.46444768e+00]
 [-5.32609818e+00]]
[[ 4.15620974e+03]
 [ 2.95844159e+03]
 [-4.98602968e+03]
 [-4.61232852e+00]
 [-2.46444872e+00]
 [-5.32609871e+00]]
[[ 1.73428932e-04 -1.64074250e-04  6.66879335e-05  3.39917780e-07
  -3.80737269e-08  9.60966134e-08]
 [-1.64074250e-04  8.37917776e-04 -2.32341781e-04 -9.60428525e-08
   5.61119568e-07 -2.42481972e-07]
 [ 6.66879335e-05 -2.32341781e-04  2.13045948e-04  1.14898588e-07
  -7.47233642e-08  3.96315798e-07]
 [ 3.39917780e-07 -9.60428525e-08  1.14898588e-07  2.70948782e-09
   9.45443344e-11  5.56511102e-10]
 [-3.80737269e-08  5.61119568e-07 -7.47233642e-08  9.45443344e-11
   2.61280286e-09  1.10262989e-10]
 [ 9.60966134e-08 -2.42481972e-07  3.96315798e-07  5.56511102e-10
   1.10262989e-10  3.84069160e-09]]
[[ 2.06337899]
 [-0.61421795]
 [15.03366256]]
[[ 6.83120991e-07]
 [-4.46908717e-06]
 [-1.50341939e+00]]


 Corrector Step
2018-07-13 19:36:20
[[ 4.15620974e+03]
 [ 2.95844159e+03]
 [-4.98602968e+03]
 [-4.61232852e+00]
 [-2.46444872e+00]
 [-5.32609871e+00]]
[[ 1.73428932e-04 -1.64074250e-04  6.66879335e-05  3.39917780e-07
  -3.80737269e-08  9.60966134e-08]
 [-1.64074250e-04  8.37917776e-04 -2.32341781e-04 -9.60428525e-08
   5.61119568e-07 -2.42481972e-07]
 [ 6.66879335e-05 -2.32341781e-04  2.13045948e-04  1.14898588e-07
  -7.47233642e-08  3.96315798e-07]
 [ 3.39917780e-07 -9.60428525e-08  1.14898588e-07  2.70948782e-09
   9.45443344e-11  5.56511102e-10]
 [-3.80737269e-08  5.61119568e-07 -7.47233642e-08  9.45443344e-11
   2.61280286e-09  1.10262989e-10]
 [ 9.60966134e-08 -2.42481972e-07  3.96315798e-07  5.56511102e-10
   1.10262989e-10  3.84069160e-09]]
8.136331176837681e-41
post
sphere_lamr_small
Ybar_post [[ 2.0633792 ]
 [-0.61421829]
 [15.03366045]]
resids [[ 4.68282661e-07]
 [-4.13366440e-06]
 [-1.50341728e+00]]
Update Weights
wbar [array(1.), array(0.)]
beta_list [655793371.7673777, 8.136331176837681e-41]
wf_list [1.0, 0.0]
corrector
extracted model
{'est_weights': array([1.]), 'est_means': array([[ 4.15616977e+03],
       [ 2.95855321e+03],
       [-4.98608799e+03],
       [-4.61241365e+00],
       [-2.46445787e+00],
       [-5.32632139e+00]]), 'est_covars': array([[ 5.17794811e-03, -9.59409482e-03,  7.31580940e-03,
         2.69945408e-05,  2.00421239e-06,  3.52228923e-05],
       [-9.59409482e-03,  1.97164157e-02, -1.46816513e-02,
        -4.59889658e-05,  1.76807580e-06, -7.10223847e-05],
       [ 7.31580940e-03, -1.46816513e-02,  1.17644818e-02,
         3.47944907e-05,  3.59570916e-06,  5.92840623e-05],
       [ 2.69945408e-05, -4.59889658e-05,  3.47944907e-05,
         2.03326999e-07, -4.01569879e-09,  1.70686488e-07],
       [ 2.00421239e-06,  1.76807580e-06,  3.59570916e-06,
        -4.01569879e-09,  1.86967918e-07, -1.10753186e-09],
       [ 3.52228923e-05, -7.10223847e-05,  5.92840623e-05,
         1.70686488e-07, -1.10753186e-09,  3.65989497e-07]])}
model bank
{'sphere_lamr_small': {'weight': array(0.), 'spacecraftConfig': {'type': '3DoF', 'mass': 1.0, 'radius': 5.641895835477564e-05, 'time': datetime.datetime(2018, 7, 13, 19, 36, 20), 'brdf_function': <function lambertian_sphere at 0x000001D436FF1F28>, 'intfcn': <function ode_twobody_j2_drag_srp_ukf at 0x000001D436FF7B70>, 'integrator': 'dop853', 'X': array([[ 4.15620974e+03],
       [ 2.95844159e+03],
       [-4.98602968e+03],
       [-4.61232852e+00],
       [-2.46444872e+00],
       [-5.32609871e+00]]), 'covar': array([[ 1.73428932e-04, -1.64074250e-04,  6.66879335e-05,
         3.39917780e-07, -3.80737269e-08,  9.60966134e-08],
       [-1.64074250e-04,  8.37917776e-04, -2.32341781e-04,
        -9.60428525e-08,  5.61119568e-07, -2.42481972e-07],
       [ 6.66879335e-05, -2.32341781e-04,  2.13045948e-04,
         1.14898588e-07, -7.47233642e-08,  3.96315798e-07],
       [ 3.39917780e-07, -9.60428525e-08,  1.14898588e-07,
         2.70948782e-09,  9.45443344e-11,  5.56511102e-10],
       [-3.80737269e-08,  5.61119568e-07, -7.47233642e-08,
         9.45443344e-11,  2.61280286e-09,  1.10262989e-10],
       [ 9.60966134e-08, -2.42481972e-07,  3.96315798e-07,
         5.56511102e-10,  1.10262989e-10,  3.84069160e-09]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 2.2, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-12, 0.e+00, 0.e+00],
       [0.e+00, 1.e-12, 0.e+00],
       [0.e+00, 0.e+00, 1.e-12]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455.0, 'd': 1.0, 'rho': 0.75, 's': 0.0, 'Fo': 0.5}}}, 'resids': array([[ 4.68282661e-07],
       [-4.13366440e-06],
       [-1.50341728e+00]])}, 'cubesat_nadir': {'weight': array(1.), 'spacecraftConfig': {'type': '3att', 'mass': 1.0, 'time': datetime.datetime(2018, 7, 13, 19, 36, 20), 'brdf_function': <function ashikhmin_premoze at 0x000001D436FF70D0>, 'intfcn': <function ode_twobody_j2_drag_srp_notorque_ukf at 0x000001D436FF7EA0>, 'integrator': 'dop853', 'X': array([[ 4.15616977e+03],
       [ 2.95855321e+03],
       [-4.98608799e+03],
       [-4.61241365e+00],
       [-2.46445787e+00],
       [-5.32632139e+00],
       [ 7.00275843e-01],
       [ 2.26520953e-01],
       [-6.56160332e-01],
       [ 1.66600178e-01],
       [-2.54109884e-20],
       [-1.04426738e-03],
       [-2.65822312e-18]]), 'moi': array([[1.66666667e-09, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 8.33333333e-09, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 8.33333333e-09]]), 'comOffset': array([0., 0., 0.]), 'covar': array([[ 5.17794811e-03, -9.59409482e-03,  7.31580940e-03,
         2.69945408e-05,  2.00421239e-06,  3.52228923e-05],
       [-9.59409482e-03,  1.97164157e-02, -1.46816513e-02,
        -4.59889658e-05,  1.76807580e-06, -7.10223847e-05],
       [ 7.31580940e-03, -1.46816513e-02,  1.17644818e-02,
         3.47944907e-05,  3.59570916e-06,  5.92840623e-05],
       [ 2.69945408e-05, -4.59889658e-05,  3.47944907e-05,
         2.03326999e-07, -4.01569879e-09,  1.70686488e-07],
       [ 2.00421239e-06,  1.76807580e-06,  3.59570916e-06,
        -4.01569879e-09,  1.86967918e-07, -1.10753186e-09],
       [ 3.52228923e-05, -7.10223847e-05,  5.92840623e-05,
         1.70686488e-07, -1.10753186e-09,  3.65989497e-07]])}, 'forcesCoeff': {'order': 2, 'degree': 0, 'dragCoeff': 3.0, 'emissivity': 0.05, 'solar_flux': 1367.0, 'Q': array([[1.e-10, 0.e+00, 0.e+00],
       [0.e+00, 1.e-10, 0.e+00],
       [0.e+00, 0.e+00, 1.e-10]])}, 'surfaces': {0: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[0.00015],
       [0.     ],
       [0.     ]]), 'norm_body_hat': array([[1.],
       [0.],
       [0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 1: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 1.0000000000000002e-08, 'center': array([[-0.00015],
       [ 0.     ],
       [ 0.     ]]), 'norm_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'u_body_hat': array([[0.],
       [1.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [ 0.],
       [-1.]])}, 2: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [5.e-05],
       [0.e+00]]), 'norm_body_hat': array([[0.],
       [1.],
       [0.]]), 'u_body_hat': array([[-1.],
       [ 0.],
       [ 0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 3: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [-5.e-05],
       [ 0.e+00]]), 'norm_body_hat': array([[ 0.],
       [-1.],
       [ 0.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [0.],
       [1.]])}, 4: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[0.e+00],
       [0.e+00],
       [5.e-05]]), 'norm_body_hat': array([[0.],
       [0.],
       [1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[0.],
       [1.],
       [0.]])}, 5: {'brdf_params': {'cSunVis': 455, 'd': 0.5, 'rho': 0.75, 's': 0.5, 'Fo': 0.75, 'nu': 10, 'nv': 10}, 'area': 3e-08, 'center': array([[ 0.e+00],
       [ 0.e+00],
       [-5.e-05]]), 'norm_body_hat': array([[ 0.],
       [ 0.],
       [-1.]]), 'u_body_hat': array([[1.],
       [0.],
       [0.]]), 'v_body_hat': array([[ 0.],
       [-1.],
       [ 0.]])}}, 'resids': array([[ 9.90466808e-06],
       [-1.28801032e-05],
       [-3.47588756e-03]])}}
